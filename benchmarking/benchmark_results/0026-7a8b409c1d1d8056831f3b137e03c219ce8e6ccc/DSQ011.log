<<Query Profiling Information>>
WITH year_total AS (SELECT c_customer_id customer_id, c_first_name customer_first_name, c_last_name customer_last_name, c_preferred_cust_flag customer_preferred_cust_flag, c_birth_country customer_birth_country, c_login customer_login, c_email_address customer_email_address, d_year dyear, sum(ss_ext_list_price-ss_ext_discount_amt) year_total, 's' sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id customer_id, c_first_name customer_first_name, c_last_name customer_last_name, c_preferred_cust_flag customer_preferred_cust_flag, c_birth_country customer_birth_country, c_login customer_login, c_email_address customer_email_address, d_year dyear, sum(ws_ext_list_price-ws_ext_discount_amt) year_total, 'w' sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year) SELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total t_s_firstyear, year_total t_s_secyear, year_total t_w_firstyear, year_total t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2001+1 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2001+1 AND t_s_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_w_firstyear.year_total > 0 THEN (t_w_secyear.year_total*1.0000) / t_w_firstyear.year_total ELSE 0.0 END > CASE WHEN t_s_firstyear.year_total > 0 THEN (t_s_secyear.year_total*1.0000) / t_s_firstyear.year_total ELSE 0.0 END ORDER BY t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag LIMIT 100;
<<Timing>>
Total Time: 15.978252s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|      FILTER      |
| CASE((year_total |
|      > 0.000     |
| 000), ((year_tot |
|     al * 1.0     |
|     00000) /     |
|    year_total)   |
|     , 0.0000     |
|    00) > CASE    |
|   ((year_total   |
|      > 0.000     |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    customer_id   |
|   =customer_id   |
|      (0.04s)     |
|        180       |
--------------------
--------------------                                                                                                                                                                                                                                                                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                                                                                                                                                    |      FILTER      |
|       INNER      |                                                                                                                                                                                                                                                                                                                                                    |   dyear = 2002   |
|    customer_id   |                                                                                                                                                                                                                                                                                                                                                    |   sale_type = w  |
|   =customer_id   |                                                                                                                                                                                                                                                                                                                                                    |                  |
|      (0.05s)     |                                                                                                                                                                                                                                                                                                                                                    |      (0.00s)     |
|       1659       |                                                                                                                                                                                                                                                                                                                                                    |       11252      |
--------------------                                                                                                                                                                                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                                                            --------------------                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                            |      FILTER      |                                                                                                    |       UNION      |
|       INNER      |                                                                                                                                                                                                                            |    year_total    |                                                                                                    |                  |
|    customer_id   |                                                                                                                                                                                                                            |     > 0.000000   |                                                                                                    |                  |
|   =customer_id   |                                                                                                                                                                                                                            |   dyear = 2001   |                                                                                                    |                  |
|                  |                                                                                                                                                                                                                            |   sale_type = w  |                                                                                                    |                  |
|      (0.07s)     |                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |
|       14467      |                                                                                                                                                                                                                            |       11552      |                                                                                                    |      247230      |
--------------------                                                                                                                                                                                                                            --------------------                                                                                                    --------------------
--------------------                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------
|      FILTER      |                                                                                                    |      FILTER      |                                                                                                    |       UNION      |                                                                                                    |    PROJECTION    |                                        |    PROJECTION    |
|    year_total    |                                                                                                    |   dyear = 2002   |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|     > 0.000000   |                                                                                                    |   sale_type = s  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|   dyear = 2001   |                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|   sale_type = s  |                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |
|       37923      |                                                                                                    |       38175      |                                                                                                    |      247230      |                                                                                                    |      190581      |                                        |       56649      |
--------------------                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------                                        --------------------                                        --------------------
|       UNION      |                                                                                                    |       UNION      |                                                                                                    |    PROJECTION    |                                        |    PROJECTION    |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |
|      247230      |                                                                                                    |      247230      |                                                                                                    |      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |
--------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
|    PROJECTION    |                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |       INNER      |                                        |       INNER      |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |    =d_date_sk    |                                        |    =d_date_sk    |
|      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |
|      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      2880404     |                                        |      719384      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    --------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  ||       r_sk       |                    |                  |
|      (1.93s)     |                                        |      (0.49s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.38s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     |
|      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      2880404     |                                        |      719384      |                                        |      2880404     |                    |       73049      ||      719384      |                    |       73049      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||                  ||                  |                    |                  ||                  |
|    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||                  ||                  |                    |                  ||                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  ||       r_sk       |                    |                  ||                  ||                  |                    |                  ||                  |
|      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.40s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      2880404     |                                        |      719384      |                                        |      2880404     |                                        |      719384      |                                        |      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      100000      ||      2880404     |                    |      100000      ||      719384      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
--------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||                  ||                  |                    |                  ||                  |
|  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||                  ||                  |                    |                  ||                  |
|                  |                    |                  ||       r_sk       |                    |                  ||                  |                    |                  ||       r_sk       |                    |                  ||                  ||                  |                    |                  ||                  |
|      (0.40s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.40s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      100000      ||      2880404     |                    |      100000      ||      719384      |
--------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|     customer     ||    store_sales   |                    |     customer     ||     web_sales    |                    |     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      100000      ||      2880404     |                    |      100000      ||      719384      |                    |      100000      ||      2880404     |                    |      100000      ||      719384      |
----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------

<<Query Profiling Information>>
WITH year_total AS (SELECT c_customer_id customer_id, c_first_name customer_first_name, c_last_name customer_last_name, c_preferred_cust_flag customer_preferred_cust_flag, c_birth_country customer_birth_country, c_login customer_login, c_email_address customer_email_address, d_year dyear, sum(ss_ext_list_price-ss_ext_discount_amt) year_total, 's' sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id customer_id, c_first_name customer_first_name, c_last_name customer_last_name, c_preferred_cust_flag customer_preferred_cust_flag, c_birth_country customer_birth_country, c_login customer_login, c_email_address customer_email_address, d_year dyear, sum(ws_ext_list_price-ws_ext_discount_amt) year_total, 'w' sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year) SELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total t_s_firstyear, year_total t_s_secyear, year_total t_w_firstyear, year_total t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2001+1 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2001+1 AND t_s_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_w_firstyear.year_total > 0 THEN (t_w_secyear.year_total*1.0000) / t_w_firstyear.year_total ELSE 0.0 END > CASE WHEN t_s_firstyear.year_total > 0 THEN (t_s_secyear.year_total*1.0000) / t_s_firstyear.year_total ELSE 0.0 END ORDER BY t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag LIMIT 100;
<<Timing>>
Total Time: 15.971681s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|      FILTER      |
| CASE((year_total |
|      > 0.000     |
| 000), ((year_tot |
|     al * 1.0     |
|     00000) /     |
|    year_total)   |
|     , 0.0000     |
|    00) > CASE    |
|   ((year_total   |
|      > 0.000     |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    customer_id   |
|   =customer_id   |
|      (0.04s)     |
|        180       |
--------------------
--------------------                                                                                                                                                                                                                                                                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                                                                                                                                                    |      FILTER      |
|       INNER      |                                                                                                                                                                                                                                                                                                                                                    |   dyear = 2002   |
|    customer_id   |                                                                                                                                                                                                                                                                                                                                                    |   sale_type = w  |
|   =customer_id   |                                                                                                                                                                                                                                                                                                                                                    |                  |
|      (0.05s)     |                                                                                                                                                                                                                                                                                                                                                    |      (0.00s)     |
|       1659       |                                                                                                                                                                                                                                                                                                                                                    |       11252      |
--------------------                                                                                                                                                                                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                                                            --------------------                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                            |      FILTER      |                                                                                                    |       UNION      |
|       INNER      |                                                                                                                                                                                                                            |    year_total    |                                                                                                    |                  |
|    customer_id   |                                                                                                                                                                                                                            |     > 0.000000   |                                                                                                    |                  |
|   =customer_id   |                                                                                                                                                                                                                            |   dyear = 2001   |                                                                                                    |                  |
|                  |                                                                                                                                                                                                                            |   sale_type = w  |                                                                                                    |                  |
|      (0.07s)     |                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |
|       14467      |                                                                                                                                                                                                                            |       11552      |                                                                                                    |      247230      |
--------------------                                                                                                                                                                                                                            --------------------                                                                                                    --------------------
--------------------                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------
|      FILTER      |                                                                                                    |      FILTER      |                                                                                                    |       UNION      |                                                                                                    |    PROJECTION    |                                        |    PROJECTION    |
|    year_total    |                                                                                                    |   dyear = 2002   |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|     > 0.000000   |                                                                                                    |   sale_type = s  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|   dyear = 2001   |                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|   sale_type = s  |                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |
|       37923      |                                                                                                    |       38175      |                                                                                                    |      247230      |                                                                                                    |      190581      |                                        |       56649      |
--------------------                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------                                        --------------------                                        --------------------
|       UNION      |                                                                                                    |       UNION      |                                                                                                    |    PROJECTION    |                                        |    PROJECTION    |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |
|      247230      |                                                                                                    |      247230      |                                                                                                    |      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |
--------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
|    PROJECTION    |                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |       INNER      |                                        |       INNER      |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |    =d_date_sk    |                                        |    =d_date_sk    |
|      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |
|      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      2880404     |                                        |      719384      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    --------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  ||       r_sk       |                    |                  |
|      (1.94s)     |                                        |      (0.49s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.38s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     |
|      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      2880404     |                                        |      719384      |                                        |      2880404     |                    |       73049      ||      719384      |                    |       73049      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||                  ||                  |                    |                  ||                  |
|    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||                  ||                  |                    |                  ||                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  ||       r_sk       |                    |                  ||                  ||                  |                    |                  ||                  |
|      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.38s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      2880404     |                                        |      719384      |                                        |      2880404     |                                        |      719384      |                                        |      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      100000      ||      2880404     |                    |      100000      ||      719384      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
--------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||                  ||                  |                    |                  ||                  |
|  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||                  ||                  |                    |                  ||                  |
|                  |                    |                  ||       r_sk       |                    |                  ||                  |                    |                  ||       r_sk       |                    |                  ||                  ||                  |                    |                  ||                  |
|      (0.41s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.40s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      100000      ||      2880404     |                    |      100000      ||      719384      |
--------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|     customer     ||    store_sales   |                    |     customer     ||     web_sales    |                    |     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      100000      ||      2880404     |                    |      100000      ||      719384      |                    |      100000      ||      2880404     |                    |      100000      ||      719384      |
----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------

<<Query Profiling Information>>
WITH year_total AS (SELECT c_customer_id customer_id, c_first_name customer_first_name, c_last_name customer_last_name, c_preferred_cust_flag customer_preferred_cust_flag, c_birth_country customer_birth_country, c_login customer_login, c_email_address customer_email_address, d_year dyear, sum(ss_ext_list_price-ss_ext_discount_amt) year_total, 's' sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id customer_id, c_first_name customer_first_name, c_last_name customer_last_name, c_preferred_cust_flag customer_preferred_cust_flag, c_birth_country customer_birth_country, c_login customer_login, c_email_address customer_email_address, d_year dyear, sum(ws_ext_list_price-ws_ext_discount_amt) year_total, 'w' sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year) SELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total t_s_firstyear, year_total t_s_secyear, year_total t_w_firstyear, year_total t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2001+1 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2001+1 AND t_s_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_w_firstyear.year_total > 0 THEN (t_w_secyear.year_total*1.0000) / t_w_firstyear.year_total ELSE 0.0 END > CASE WHEN t_s_firstyear.year_total > 0 THEN (t_s_secyear.year_total*1.0000) / t_s_firstyear.year_total ELSE 0.0 END ORDER BY t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag LIMIT 100;
<<Timing>>
Total Time: 15.960836s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|      FILTER      |
| CASE((year_total |
|      > 0.000     |
| 000), ((year_tot |
|     al * 1.0     |
|     00000) /     |
|    year_total)   |
|     , 0.0000     |
|    00) > CASE    |
|   ((year_total   |
|      > 0.000     |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    customer_id   |
|   =customer_id   |
|      (0.04s)     |
|        180       |
--------------------
--------------------                                                                                                                                                                                                                                                                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                                                                                                                                                    |      FILTER      |
|       INNER      |                                                                                                                                                                                                                                                                                                                                                    |   dyear = 2002   |
|    customer_id   |                                                                                                                                                                                                                                                                                                                                                    |   sale_type = w  |
|   =customer_id   |                                                                                                                                                                                                                                                                                                                                                    |                  |
|      (0.05s)     |                                                                                                                                                                                                                                                                                                                                                    |      (0.00s)     |
|       1659       |                                                                                                                                                                                                                                                                                                                                                    |       11252      |
--------------------                                                                                                                                                                                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                                                            --------------------                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                            |      FILTER      |                                                                                                    |       UNION      |
|       INNER      |                                                                                                                                                                                                                            |    year_total    |                                                                                                    |                  |
|    customer_id   |                                                                                                                                                                                                                            |     > 0.000000   |                                                                                                    |                  |
|   =customer_id   |                                                                                                                                                                                                                            |   dyear = 2001   |                                                                                                    |                  |
|                  |                                                                                                                                                                                                                            |   sale_type = w  |                                                                                                    |                  |
|      (0.07s)     |                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |
|       14467      |                                                                                                                                                                                                                            |       11552      |                                                                                                    |      247230      |
--------------------                                                                                                                                                                                                                            --------------------                                                                                                    --------------------
--------------------                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------
|      FILTER      |                                                                                                    |      FILTER      |                                                                                                    |       UNION      |                                                                                                    |    PROJECTION    |                                        |    PROJECTION    |
|    year_total    |                                                                                                    |   dyear = 2002   |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|     > 0.000000   |                                                                                                    |   sale_type = s  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|   dyear = 2001   |                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|   sale_type = s  |                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |
|       37923      |                                                                                                    |       38175      |                                                                                                    |      247230      |                                                                                                    |      190581      |                                        |       56649      |
--------------------                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------                                        --------------------                                        --------------------
|       UNION      |                                                                                                    |       UNION      |                                                                                                    |    PROJECTION    |                                        |    PROJECTION    |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |
|      247230      |                                                                                                    |      247230      |                                                                                                    |      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |
--------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
|    PROJECTION    |                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |       INNER      |                                        |       INNER      |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |    =d_date_sk    |                                        |    =d_date_sk    |
|      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |
|      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      2880404     |                                        |      719384      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    --------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  ||       r_sk       |                    |                  |
|      (1.93s)     |                                        |      (0.49s)     |                                        |      (1.93s)     |                                        |      (0.47s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.38s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     |
|      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      2880404     |                                        |      719384      |                                        |      2880404     |                    |       73049      ||      719384      |                    |       73049      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||                  ||                  |                    |                  ||                  |
|    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||                  ||                  |                    |                  ||                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  ||       r_sk       |                    |                  ||                  ||                  |                    |                  ||                  |
|      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.38s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      2880404     |                                        |      719384      |                                        |      2880404     |                                        |      719384      |                                        |      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      100000      ||      2880404     |                    |      100000      ||      719384      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
--------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||                  ||                  |                    |                  ||                  |
|  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||                  ||                  |                    |                  ||                  |
|                  |                    |                  ||       r_sk       |                    |                  ||                  |                    |                  ||       r_sk       |                    |                  ||                  ||                  |                    |                  ||                  |
|      (0.41s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.38s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      100000      ||      2880404     |                    |      100000      ||      719384      |
--------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|     customer     ||    store_sales   |                    |     customer     ||     web_sales    |                    |     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      100000      ||      2880404     |                    |      100000      ||      719384      |                    |      100000      ||      2880404     |                    |      100000      ||      719384      |
----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------

<<Query Profiling Information>>
WITH year_total AS (SELECT c_customer_id customer_id, c_first_name customer_first_name, c_last_name customer_last_name, c_preferred_cust_flag customer_preferred_cust_flag, c_birth_country customer_birth_country, c_login customer_login, c_email_address customer_email_address, d_year dyear, sum(ss_ext_list_price-ss_ext_discount_amt) year_total, 's' sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id customer_id, c_first_name customer_first_name, c_last_name customer_last_name, c_preferred_cust_flag customer_preferred_cust_flag, c_birth_country customer_birth_country, c_login customer_login, c_email_address customer_email_address, d_year dyear, sum(ws_ext_list_price-ws_ext_discount_amt) year_total, 'w' sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year) SELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total t_s_firstyear, year_total t_s_secyear, year_total t_w_firstyear, year_total t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2001+1 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2001+1 AND t_s_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_w_firstyear.year_total > 0 THEN (t_w_secyear.year_total*1.0000) / t_w_firstyear.year_total ELSE 0.0 END > CASE WHEN t_s_firstyear.year_total > 0 THEN (t_s_secyear.year_total*1.0000) / t_s_firstyear.year_total ELSE 0.0 END ORDER BY t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag LIMIT 100;
<<Timing>>
Total Time: 15.927078s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|      FILTER      |
| CASE((year_total |
|      > 0.000     |
| 000), ((year_tot |
|     al * 1.0     |
|     00000) /     |
|    year_total)   |
|     , 0.0000     |
|    00) > CASE    |
|   ((year_total   |
|      > 0.000     |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    customer_id   |
|   =customer_id   |
|      (0.04s)     |
|        180       |
--------------------
--------------------                                                                                                                                                                                                                                                                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                                                                                                                                                    |      FILTER      |
|       INNER      |                                                                                                                                                                                                                                                                                                                                                    |   dyear = 2002   |
|    customer_id   |                                                                                                                                                                                                                                                                                                                                                    |   sale_type = w  |
|   =customer_id   |                                                                                                                                                                                                                                                                                                                                                    |                  |
|      (0.05s)     |                                                                                                                                                                                                                                                                                                                                                    |      (0.00s)     |
|       1659       |                                                                                                                                                                                                                                                                                                                                                    |       11252      |
--------------------                                                                                                                                                                                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                                                            --------------------                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                            |      FILTER      |                                                                                                    |       UNION      |
|       INNER      |                                                                                                                                                                                                                            |    year_total    |                                                                                                    |                  |
|    customer_id   |                                                                                                                                                                                                                            |     > 0.000000   |                                                                                                    |                  |
|   =customer_id   |                                                                                                                                                                                                                            |   dyear = 2001   |                                                                                                    |                  |
|                  |                                                                                                                                                                                                                            |   sale_type = w  |                                                                                                    |                  |
|      (0.07s)     |                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |
|       14467      |                                                                                                                                                                                                                            |       11552      |                                                                                                    |      247230      |
--------------------                                                                                                                                                                                                                            --------------------                                                                                                    --------------------
--------------------                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------
|      FILTER      |                                                                                                    |      FILTER      |                                                                                                    |       UNION      |                                                                                                    |    PROJECTION    |                                        |    PROJECTION    |
|    year_total    |                                                                                                    |   dyear = 2002   |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|     > 0.000000   |                                                                                                    |   sale_type = s  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|   dyear = 2001   |                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|   sale_type = s  |                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |
|       37923      |                                                                                                    |       38175      |                                                                                                    |      247230      |                                                                                                    |      190581      |                                        |       56649      |
--------------------                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------                                        --------------------                                        --------------------
|       UNION      |                                                                                                    |       UNION      |                                                                                                    |    PROJECTION    |                                        |    PROJECTION    |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |
|      247230      |                                                                                                    |      247230      |                                                                                                    |      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |
--------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
|    PROJECTION    |                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |       INNER      |                                        |       INNER      |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |    =d_date_sk    |                                        |    =d_date_sk    |
|      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |
|      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      2880404     |                                        |      719384      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    --------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  ||       r_sk       |                    |                  |
|      (1.92s)     |                                        |      (0.48s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.38s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     |
|      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      2880404     |                                        |      719384      |                                        |      2880404     |                    |       73049      ||      719384      |                    |       73049      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||                  ||                  |                    |                  ||                  |
|    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||                  ||                  |                    |                  ||                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  ||       r_sk       |                    |                  ||                  ||                  |                    |                  ||                  |
|      (0.78s)     |                                        |      (0.23s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.38s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      2880404     |                                        |      719384      |                                        |      2880404     |                                        |      719384      |                                        |      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      100000      ||      2880404     |                    |      100000      ||      719384      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
--------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||                  ||                  |                    |                  ||                  |
|  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||                  ||                  |                    |                  ||                  |
|                  |                    |                  ||       r_sk       |                    |                  ||                  |                    |                  ||       r_sk       |                    |                  ||                  ||                  |                    |                  ||                  |
|      (0.40s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.38s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      100000      ||      2880404     |                    |      100000      ||      719384      |
--------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|     customer     ||    store_sales   |                    |     customer     ||     web_sales    |                    |     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      100000      ||      2880404     |                    |      100000      ||      719384      |                    |      100000      ||      2880404     |                    |      100000      ||      719384      |
----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------

<<Query Profiling Information>>
WITH year_total AS (SELECT c_customer_id customer_id, c_first_name customer_first_name, c_last_name customer_last_name, c_preferred_cust_flag customer_preferred_cust_flag, c_birth_country customer_birth_country, c_login customer_login, c_email_address customer_email_address, d_year dyear, sum(ss_ext_list_price-ss_ext_discount_amt) year_total, 's' sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id customer_id, c_first_name customer_first_name, c_last_name customer_last_name, c_preferred_cust_flag customer_preferred_cust_flag, c_birth_country customer_birth_country, c_login customer_login, c_email_address customer_email_address, d_year dyear, sum(ws_ext_list_price-ws_ext_discount_amt) year_total, 'w' sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year) SELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total t_s_firstyear, year_total t_s_secyear, year_total t_w_firstyear, year_total t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2001+1 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2001+1 AND t_s_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_w_firstyear.year_total > 0 THEN (t_w_secyear.year_total*1.0000) / t_w_firstyear.year_total ELSE 0.0 END > CASE WHEN t_s_firstyear.year_total > 0 THEN (t_s_secyear.year_total*1.0000) / t_s_firstyear.year_total ELSE 0.0 END ORDER BY t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag LIMIT 100;
<<Timing>>
Total Time: 15.908922s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|      FILTER      |
| CASE((year_total |
|      > 0.000     |
| 000), ((year_tot |
|     al * 1.0     |
|     00000) /     |
|    year_total)   |
|     , 0.0000     |
|    00) > CASE    |
|   ((year_total   |
|      > 0.000     |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    customer_id   |
|   =customer_id   |
|      (0.04s)     |
|        180       |
--------------------
--------------------                                                                                                                                                                                                                                                                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                                                                                                                                                    |      FILTER      |
|       INNER      |                                                                                                                                                                                                                                                                                                                                                    |   dyear = 2002   |
|    customer_id   |                                                                                                                                                                                                                                                                                                                                                    |   sale_type = w  |
|   =customer_id   |                                                                                                                                                                                                                                                                                                                                                    |                  |
|      (0.05s)     |                                                                                                                                                                                                                                                                                                                                                    |      (0.00s)     |
|       1659       |                                                                                                                                                                                                                                                                                                                                                    |       11252      |
--------------------                                                                                                                                                                                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                                                            --------------------                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                            |      FILTER      |                                                                                                    |       UNION      |
|       INNER      |                                                                                                                                                                                                                            |    year_total    |                                                                                                    |                  |
|    customer_id   |                                                                                                                                                                                                                            |     > 0.000000   |                                                                                                    |                  |
|   =customer_id   |                                                                                                                                                                                                                            |   dyear = 2001   |                                                                                                    |                  |
|                  |                                                                                                                                                                                                                            |   sale_type = w  |                                                                                                    |                  |
|      (0.07s)     |                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |
|       14467      |                                                                                                                                                                                                                            |       11552      |                                                                                                    |      247230      |
--------------------                                                                                                                                                                                                                            --------------------                                                                                                    --------------------
--------------------                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------
|      FILTER      |                                                                                                    |      FILTER      |                                                                                                    |       UNION      |                                                                                                    |    PROJECTION    |                                        |    PROJECTION    |
|    year_total    |                                                                                                    |   dyear = 2002   |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|     > 0.000000   |                                                                                                    |   sale_type = s  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|   dyear = 2001   |                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|   sale_type = s  |                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |
|       37923      |                                                                                                    |       38175      |                                                                                                    |      247230      |                                                                                                    |      190581      |                                        |       56649      |
--------------------                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------                                        --------------------                                        --------------------
|       UNION      |                                                                                                    |       UNION      |                                                                                                    |    PROJECTION    |                                        |    PROJECTION    |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |
|      247230      |                                                                                                    |      247230      |                                                                                                    |      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |
--------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
|    PROJECTION    |                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |       INNER      |                                        |       INNER      |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |    =d_date_sk    |                                        |    =d_date_sk    |
|      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |
|      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      2880404     |                                        |      719384      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    --------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  ||       r_sk       |                    |                  |
|      (1.93s)     |                                        |      (0.48s)     |                                        |      (1.92s)     |                                        |      (0.47s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.38s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     |
|      190581      |                                        |       56649      |                                        |      190581      |                                        |       56649      |                                        |      2880404     |                                        |      719384      |                                        |      2880404     |                    |       73049      ||      719384      |                    |       73049      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||                  ||                  |                    |                  ||                  |
|    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =d_date_sk    |                                        |  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||                  ||                  |                    |                  ||                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  ||       r_sk       |                    |                  ||                  ||                  |                    |                  ||                  |
|      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.77s)     |                                        |      (0.23s)     |                                        |      (0.38s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      2880404     |                                        |      719384      |                                        |      2880404     |                                        |      719384      |                                        |      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      100000      ||      2880404     |                    |      100000      ||      719384      |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
--------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||       INNER      |                    |     date_dim     ||     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||   c_customer_sk  |                    |                  ||                  ||                  |                    |                  ||                  |
|  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||  =ss_customer_sk |                    |                  || =ws_bill_custome |                    |                  ||                  ||                  |                    |                  ||                  |
|                  |                    |                  ||       r_sk       |                    |                  ||                  |                    |                  ||       r_sk       |                    |                  ||                  ||                  |                    |                  ||                  |
|      (0.37s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.38s)     |                    |      (0.00s)     ||      (0.10s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      100000      ||      2880404     |                    |      100000      ||      719384      |
--------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|     customer     ||    store_sales   |                    |     customer     ||     web_sales    |                    |     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     |
|      100000      ||      2880404     |                    |      100000      ||      719384      |                    |      100000      ||      2880404     |                    |      100000      ||      719384      |
----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------

