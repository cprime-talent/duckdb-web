<<Query Profiling Information>>
WITH results AS (SELECT i_product_name , i_brand , i_class , i_category , inv_quantity_on_hand qoh FROM inventory , date_dim , item , warehouse WHERE inv_date_sk=d_date_sk AND inv_item_sk=i_item_sk AND inv_warehouse_sk = w_warehouse_sk AND d_month_seq BETWEEN 1200 AND 1200 + 11 ), results_rollup AS (SELECT i_product_name, i_brand, i_class, i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand, i_class, i_category UNION ALL SELECT i_product_name, i_brand, i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand, i_class UNION ALL SELECT i_product_name, i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand UNION ALL SELECT i_product_name, NULL i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name UNION ALL SELECT NULL i_product_name, NULL i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results) SELECT i_product_name, i_brand, i_class, i_category, qoh FROM results_rollup ORDER BY qoh, i_product_name, i_brand, i_class, i_category LIMIT 100;
<<Timing>>
Total Time: 5.678662s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.06s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       36001      |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       36001      |
--------------------
--------------------                                                            --------------------
|   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|      (0.64s)     |                                                            |      (0.00s)     |
|       9000       |                                                            |       27001      |
--------------------                                                            --------------------
--------------------                                                            --------------------
|    PROJECTION    |                                                            |       UNION      |
|      (0.00s)     |                                                            |      (0.00s)     |
|      2340000     |                                                            |       27001      |
--------------------                                                            --------------------
--------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|       INNER      |                                                            |                  |                                                            |                  |
| inv_warehouse_sk |                                                            |                  |                                                            |                  |
|  =w_warehouse_sk |                                                            |                  |                                                            |                  |
|      (0.34s)     |                                                            |      (0.53s)     |                                                            |      (0.00s)     |
|      2340000     |                                                            |       9000       |                                                            |       18001      |
--------------------                                                            --------------------                                                            --------------------
--------------------                                        ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |       UNION      |
|       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
|    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
|    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
|      (0.18s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|      2340000     |                                        |         5        ||      2340000     |                                                            |       18001      |
--------------------                                        ----------------------------------------                                                            --------------------
--------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |                                                            |                  |
|    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |                                                            |                  |
|    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |                                                            |                  |
|      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.41s)     |                                                            |      (0.00s)     |
|      2340000     |                    |       18000      |                    |      2340000     |                                                            |       9000       |                                                            |       9001       |
--------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
|     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |       UNION      |
|     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
|                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
|                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
|                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |                                                            |                  |
|      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |                                                            |       9001       |
----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |                                                            |                  |
                    |                  |                                        |    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |                                                            |                  |
                    |                  |                                        |    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |                                                            |                  |
                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.26s)     |                                                            |      (0.00s)     |
                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                                            |       9000       |                                                            |         1        |
                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |   HASH_GROUP_BY  |
                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
                                                                                |                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
                                                                                |                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
                                                                                |                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |                                                            |                  |
                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.08s)     |
                                                                                |     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |                                                            |         1        |
                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------
                                                                                                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |    PROJECTION    |
                                                                                                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |
                                                                                                    |                  |                                        |    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |
                                                                                                    |                  |                                        |    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |
                                                                                                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.00s)     |
                                                                                                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                                            |      2340000     |
                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------
                                                                                                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------
                                                                                                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |
                                                                                                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||       INNER      |
                                                                                                                                                                |                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  || inv_warehouse_sk |
                                                                                                                                                                |                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||  =w_warehouse_sk |
                                                                                                                                                                |                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |
                                                                                                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.34s)     |
                                                                                                                                                                |     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |
                                                                                                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------
                                                                                                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     |
                                                                                                                                                                                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                        |     warehouse    |
                                                                                                                                                                                    |                  |                                        |    inv_date_sk   |                    |                  |                    |    inv_item_sk   |                                        |                  |
                                                                                                                                                                                    |                  |                                        |    =d_date_sk    |                    |                  |                    |    =i_item_sk    |                                        |                  |
                                                                                                                                                                                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.17s)     |                                        |      (0.00s)     |
                                                                                                                                                                                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                        |         5        |
                                                                                                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                                                                                ----------------------------------------                                        --------------------                    --------------------
                                                                                                                                                                                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |
                                                                                                                                                                                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                    |       item       |
                                                                                                                                                                                                                                                |                  ||      <= 1211     |                                        |    inv_date_sk   |                    |                  |
                                                                                                                                                                                                                                                |                  ||    d_month_seq   |                                        |    =d_date_sk    |                    |                  |
                                                                                                                                                                                                                                                |                  ||      >= 1200     |                                        |                  |                    |                  |
                                                                                                                                                                                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |
                                                                                                                                                                                                                                                |     11745000     ||        366       |                                        |      2340000     |                    |       18000      |
                                                                                                                                                                                                                                                ----------------------------------------                                        --------------------                    --------------------
                                                                                                                                                                                                                                                                    --------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                    |     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      |
                                                                                                                                                                                                                                                                    |     date_dim     |                                        |     inventory    ||    d_month_seq   |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||      <= 1211     |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||    d_month_seq   |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||      >= 1200     |
                                                                                                                                                                                                                                                                    |      (0.00s)     |                                        |      (0.05s)     ||      (0.00s)     |
                                                                                                                                                                                                                                                                    |       73049      |                                        |     11745000     ||        366       |
                                                                                                                                                                                                                                                                    --------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                    --------------------
                                                                                                                                                                                                                                                                                                                                                    |     SEQ_SCAN     |
                                                                                                                                                                                                                                                                                                                                                    |     date_dim     |
                                                                                                                                                                                                                                                                                                                                                    |      (0.00s)     |
                                                                                                                                                                                                                                                                                                                                                    |       73049      |
                                                                                                                                                                                                                                                                                                                                                    --------------------

<<Query Profiling Information>>
WITH results AS (SELECT i_product_name , i_brand , i_class , i_category , inv_quantity_on_hand qoh FROM inventory , date_dim , item , warehouse WHERE inv_date_sk=d_date_sk AND inv_item_sk=i_item_sk AND inv_warehouse_sk = w_warehouse_sk AND d_month_seq BETWEEN 1200 AND 1200 + 11 ), results_rollup AS (SELECT i_product_name, i_brand, i_class, i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand, i_class, i_category UNION ALL SELECT i_product_name, i_brand, i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand, i_class UNION ALL SELECT i_product_name, i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand UNION ALL SELECT i_product_name, NULL i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name UNION ALL SELECT NULL i_product_name, NULL i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results) SELECT i_product_name, i_brand, i_class, i_category, qoh FROM results_rollup ORDER BY qoh, i_product_name, i_brand, i_class, i_category LIMIT 100;
<<Timing>>
Total Time: 5.673853s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.06s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       36001      |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       36001      |
--------------------
--------------------                                                            --------------------
|   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|      (0.63s)     |                                                            |      (0.00s)     |
|       9000       |                                                            |       27001      |
--------------------                                                            --------------------
--------------------                                                            --------------------
|    PROJECTION    |                                                            |       UNION      |
|      (0.00s)     |                                                            |      (0.00s)     |
|      2340000     |                                                            |       27001      |
--------------------                                                            --------------------
--------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|       INNER      |                                                            |                  |                                                            |                  |
| inv_warehouse_sk |                                                            |                  |                                                            |                  |
|  =w_warehouse_sk |                                                            |                  |                                                            |                  |
|      (0.34s)     |                                                            |      (0.53s)     |                                                            |      (0.00s)     |
|      2340000     |                                                            |       9000       |                                                            |       18001      |
--------------------                                                            --------------------                                                            --------------------
--------------------                                        ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |       UNION      |
|       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
|    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
|    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
|      (0.18s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|      2340000     |                                        |         5        ||      2340000     |                                                            |       18001      |
--------------------                                        ----------------------------------------                                                            --------------------
--------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |                                                            |                  |
|    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |                                                            |                  |
|    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |                                                            |                  |
|      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.41s)     |                                                            |      (0.00s)     |
|      2340000     |                    |       18000      |                    |      2340000     |                                                            |       9000       |                                                            |       9001       |
--------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
|     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |       UNION      |
|     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
|                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
|                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
|                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |                                                            |                  |
|      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |                                                            |       9001       |
----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |                                                            |                  |
                    |                  |                                        |    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |                                                            |                  |
                    |                  |                                        |    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |                                                            |                  |
                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.26s)     |                                                            |      (0.00s)     |
                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                                            |       9000       |                                                            |         1        |
                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |   HASH_GROUP_BY  |
                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
                                                                                |                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
                                                                                |                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
                                                                                |                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |                                                            |                  |
                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.08s)     |
                                                                                |     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |                                                            |         1        |
                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------
                                                                                                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |    PROJECTION    |
                                                                                                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |
                                                                                                    |                  |                                        |    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |
                                                                                                    |                  |                                        |    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |
                                                                                                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.00s)     |
                                                                                                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                                            |      2340000     |
                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------
                                                                                                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------
                                                                                                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |
                                                                                                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||       INNER      |
                                                                                                                                                                |                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  || inv_warehouse_sk |
                                                                                                                                                                |                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||  =w_warehouse_sk |
                                                                                                                                                                |                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |
                                                                                                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.34s)     |
                                                                                                                                                                |     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |
                                                                                                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------
                                                                                                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     |
                                                                                                                                                                                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                        |     warehouse    |
                                                                                                                                                                                    |                  |                                        |    inv_date_sk   |                    |                  |                    |    inv_item_sk   |                                        |                  |
                                                                                                                                                                                    |                  |                                        |    =d_date_sk    |                    |                  |                    |    =i_item_sk    |                                        |                  |
                                                                                                                                                                                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.17s)     |                                        |      (0.00s)     |
                                                                                                                                                                                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                        |         5        |
                                                                                                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                                                                                ----------------------------------------                                        --------------------                    --------------------
                                                                                                                                                                                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |
                                                                                                                                                                                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                    |       item       |
                                                                                                                                                                                                                                                |                  ||      <= 1211     |                                        |    inv_date_sk   |                    |                  |
                                                                                                                                                                                                                                                |                  ||    d_month_seq   |                                        |    =d_date_sk    |                    |                  |
                                                                                                                                                                                                                                                |                  ||      >= 1200     |                                        |                  |                    |                  |
                                                                                                                                                                                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |
                                                                                                                                                                                                                                                |     11745000     ||        366       |                                        |      2340000     |                    |       18000      |
                                                                                                                                                                                                                                                ----------------------------------------                                        --------------------                    --------------------
                                                                                                                                                                                                                                                                    --------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                    |     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      |
                                                                                                                                                                                                                                                                    |     date_dim     |                                        |     inventory    ||    d_month_seq   |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||      <= 1211     |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||    d_month_seq   |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||      >= 1200     |
                                                                                                                                                                                                                                                                    |      (0.00s)     |                                        |      (0.05s)     ||      (0.00s)     |
                                                                                                                                                                                                                                                                    |       73049      |                                        |     11745000     ||        366       |
                                                                                                                                                                                                                                                                    --------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                    --------------------
                                                                                                                                                                                                                                                                                                                                                    |     SEQ_SCAN     |
                                                                                                                                                                                                                                                                                                                                                    |     date_dim     |
                                                                                                                                                                                                                                                                                                                                                    |      (0.00s)     |
                                                                                                                                                                                                                                                                                                                                                    |       73049      |
                                                                                                                                                                                                                                                                                                                                                    --------------------

<<Query Profiling Information>>
WITH results AS (SELECT i_product_name , i_brand , i_class , i_category , inv_quantity_on_hand qoh FROM inventory , date_dim , item , warehouse WHERE inv_date_sk=d_date_sk AND inv_item_sk=i_item_sk AND inv_warehouse_sk = w_warehouse_sk AND d_month_seq BETWEEN 1200 AND 1200 + 11 ), results_rollup AS (SELECT i_product_name, i_brand, i_class, i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand, i_class, i_category UNION ALL SELECT i_product_name, i_brand, i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand, i_class UNION ALL SELECT i_product_name, i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand UNION ALL SELECT i_product_name, NULL i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name UNION ALL SELECT NULL i_product_name, NULL i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results) SELECT i_product_name, i_brand, i_class, i_category, qoh FROM results_rollup ORDER BY qoh, i_product_name, i_brand, i_class, i_category LIMIT 100;
<<Timing>>
Total Time: 5.676160s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.06s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       36001      |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       36001      |
--------------------
--------------------                                                            --------------------
|   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|      (0.63s)     |                                                            |      (0.00s)     |
|       9000       |                                                            |       27001      |
--------------------                                                            --------------------
--------------------                                                            --------------------
|    PROJECTION    |                                                            |       UNION      |
|      (0.00s)     |                                                            |      (0.00s)     |
|      2340000     |                                                            |       27001      |
--------------------                                                            --------------------
--------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|       INNER      |                                                            |                  |                                                            |                  |
| inv_warehouse_sk |                                                            |                  |                                                            |                  |
|  =w_warehouse_sk |                                                            |                  |                                                            |                  |
|      (0.34s)     |                                                            |      (0.53s)     |                                                            |      (0.00s)     |
|      2340000     |                                                            |       9000       |                                                            |       18001      |
--------------------                                                            --------------------                                                            --------------------
--------------------                                        ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |       UNION      |
|       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
|    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
|    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
|      (0.18s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|      2340000     |                                        |         5        ||      2340000     |                                                            |       18001      |
--------------------                                        ----------------------------------------                                                            --------------------
--------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |                                                            |                  |
|    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |                                                            |                  |
|    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |                                                            |                  |
|      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.41s)     |                                                            |      (0.00s)     |
|      2340000     |                    |       18000      |                    |      2340000     |                                                            |       9000       |                                                            |       9001       |
--------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
|     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |       UNION      |
|     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
|                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
|                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
|                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |                                                            |                  |
|      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |                                                            |       9001       |
----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |                                                            |                  |
                    |                  |                                        |    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |                                                            |                  |
                    |                  |                                        |    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |                                                            |                  |
                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.26s)     |                                                            |      (0.00s)     |
                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                                            |       9000       |                                                            |         1        |
                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |   HASH_GROUP_BY  |
                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
                                                                                |                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
                                                                                |                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
                                                                                |                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |                                                            |                  |
                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.08s)     |
                                                                                |     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |                                                            |         1        |
                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------
                                                                                                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |    PROJECTION    |
                                                                                                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |
                                                                                                    |                  |                                        |    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |
                                                                                                    |                  |                                        |    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |
                                                                                                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.00s)     |
                                                                                                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                                            |      2340000     |
                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------
                                                                                                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------
                                                                                                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |
                                                                                                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||       INNER      |
                                                                                                                                                                |                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  || inv_warehouse_sk |
                                                                                                                                                                |                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||  =w_warehouse_sk |
                                                                                                                                                                |                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |
                                                                                                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.34s)     |
                                                                                                                                                                |     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |
                                                                                                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------
                                                                                                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     |
                                                                                                                                                                                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                        |     warehouse    |
                                                                                                                                                                                    |                  |                                        |    inv_date_sk   |                    |                  |                    |    inv_item_sk   |                                        |                  |
                                                                                                                                                                                    |                  |                                        |    =d_date_sk    |                    |                  |                    |    =i_item_sk    |                                        |                  |
                                                                                                                                                                                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.17s)     |                                        |      (0.00s)     |
                                                                                                                                                                                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                        |         5        |
                                                                                                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                                                                                ----------------------------------------                                        --------------------                    --------------------
                                                                                                                                                                                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |
                                                                                                                                                                                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                    |       item       |
                                                                                                                                                                                                                                                |                  ||      <= 1211     |                                        |    inv_date_sk   |                    |                  |
                                                                                                                                                                                                                                                |                  ||    d_month_seq   |                                        |    =d_date_sk    |                    |                  |
                                                                                                                                                                                                                                                |                  ||      >= 1200     |                                        |                  |                    |                  |
                                                                                                                                                                                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |
                                                                                                                                                                                                                                                |     11745000     ||        366       |                                        |      2340000     |                    |       18000      |
                                                                                                                                                                                                                                                ----------------------------------------                                        --------------------                    --------------------
                                                                                                                                                                                                                                                                    --------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                    |     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      |
                                                                                                                                                                                                                                                                    |     date_dim     |                                        |     inventory    ||    d_month_seq   |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||      <= 1211     |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||    d_month_seq   |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||      >= 1200     |
                                                                                                                                                                                                                                                                    |      (0.00s)     |                                        |      (0.05s)     ||      (0.00s)     |
                                                                                                                                                                                                                                                                    |       73049      |                                        |     11745000     ||        366       |
                                                                                                                                                                                                                                                                    --------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                    --------------------
                                                                                                                                                                                                                                                                                                                                                    |     SEQ_SCAN     |
                                                                                                                                                                                                                                                                                                                                                    |     date_dim     |
                                                                                                                                                                                                                                                                                                                                                    |      (0.00s)     |
                                                                                                                                                                                                                                                                                                                                                    |       73049      |
                                                                                                                                                                                                                                                                                                                                                    --------------------

<<Query Profiling Information>>
WITH results AS (SELECT i_product_name , i_brand , i_class , i_category , inv_quantity_on_hand qoh FROM inventory , date_dim , item , warehouse WHERE inv_date_sk=d_date_sk AND inv_item_sk=i_item_sk AND inv_warehouse_sk = w_warehouse_sk AND d_month_seq BETWEEN 1200 AND 1200 + 11 ), results_rollup AS (SELECT i_product_name, i_brand, i_class, i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand, i_class, i_category UNION ALL SELECT i_product_name, i_brand, i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand, i_class UNION ALL SELECT i_product_name, i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand UNION ALL SELECT i_product_name, NULL i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name UNION ALL SELECT NULL i_product_name, NULL i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results) SELECT i_product_name, i_brand, i_class, i_category, qoh FROM results_rollup ORDER BY qoh, i_product_name, i_brand, i_class, i_category LIMIT 100;
<<Timing>>
Total Time: 5.672974s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.06s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       36001      |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       36001      |
--------------------
--------------------                                                            --------------------
|   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|      (0.64s)     |                                                            |      (0.00s)     |
|       9000       |                                                            |       27001      |
--------------------                                                            --------------------
--------------------                                                            --------------------
|    PROJECTION    |                                                            |       UNION      |
|      (0.00s)     |                                                            |      (0.00s)     |
|      2340000     |                                                            |       27001      |
--------------------                                                            --------------------
--------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|       INNER      |                                                            |                  |                                                            |                  |
| inv_warehouse_sk |                                                            |                  |                                                            |                  |
|  =w_warehouse_sk |                                                            |                  |                                                            |                  |
|      (0.34s)     |                                                            |      (0.53s)     |                                                            |      (0.00s)     |
|      2340000     |                                                            |       9000       |                                                            |       18001      |
--------------------                                                            --------------------                                                            --------------------
--------------------                                        ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |       UNION      |
|       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
|    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
|    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
|      (0.18s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|      2340000     |                                        |         5        ||      2340000     |                                                            |       18001      |
--------------------                                        ----------------------------------------                                                            --------------------
--------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |                                                            |                  |
|    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |                                                            |                  |
|    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |                                                            |                  |
|      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.41s)     |                                                            |      (0.00s)     |
|      2340000     |                    |       18000      |                    |      2340000     |                                                            |       9000       |                                                            |       9001       |
--------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
|     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |       UNION      |
|     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
|                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
|                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
|                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |                                                            |                  |
|      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |                                                            |       9001       |
----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |                                                            |                  |
                    |                  |                                        |    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |                                                            |                  |
                    |                  |                                        |    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |                                                            |                  |
                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.26s)     |                                                            |      (0.00s)     |
                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                                            |       9000       |                                                            |         1        |
                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |   HASH_GROUP_BY  |
                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
                                                                                |                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
                                                                                |                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
                                                                                |                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |                                                            |                  |
                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.08s)     |
                                                                                |     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |                                                            |         1        |
                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------
                                                                                                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |    PROJECTION    |
                                                                                                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |
                                                                                                    |                  |                                        |    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |
                                                                                                    |                  |                                        |    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |
                                                                                                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.00s)     |
                                                                                                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                                            |      2340000     |
                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------
                                                                                                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------
                                                                                                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |
                                                                                                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||       INNER      |
                                                                                                                                                                |                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  || inv_warehouse_sk |
                                                                                                                                                                |                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||  =w_warehouse_sk |
                                                                                                                                                                |                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |
                                                                                                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.34s)     |
                                                                                                                                                                |     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |
                                                                                                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------
                                                                                                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     |
                                                                                                                                                                                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                        |     warehouse    |
                                                                                                                                                                                    |                  |                                        |    inv_date_sk   |                    |                  |                    |    inv_item_sk   |                                        |                  |
                                                                                                                                                                                    |                  |                                        |    =d_date_sk    |                    |                  |                    |    =i_item_sk    |                                        |                  |
                                                                                                                                                                                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.17s)     |                                        |      (0.00s)     |
                                                                                                                                                                                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                        |         5        |
                                                                                                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                                                                                ----------------------------------------                                        --------------------                    --------------------
                                                                                                                                                                                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |
                                                                                                                                                                                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                    |       item       |
                                                                                                                                                                                                                                                |                  ||      <= 1211     |                                        |    inv_date_sk   |                    |                  |
                                                                                                                                                                                                                                                |                  ||    d_month_seq   |                                        |    =d_date_sk    |                    |                  |
                                                                                                                                                                                                                                                |                  ||      >= 1200     |                                        |                  |                    |                  |
                                                                                                                                                                                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |
                                                                                                                                                                                                                                                |     11745000     ||        366       |                                        |      2340000     |                    |       18000      |
                                                                                                                                                                                                                                                ----------------------------------------                                        --------------------                    --------------------
                                                                                                                                                                                                                                                                    --------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                    |     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      |
                                                                                                                                                                                                                                                                    |     date_dim     |                                        |     inventory    ||    d_month_seq   |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||      <= 1211     |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||    d_month_seq   |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||      >= 1200     |
                                                                                                                                                                                                                                                                    |      (0.00s)     |                                        |      (0.05s)     ||      (0.00s)     |
                                                                                                                                                                                                                                                                    |       73049      |                                        |     11745000     ||        366       |
                                                                                                                                                                                                                                                                    --------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                    --------------------
                                                                                                                                                                                                                                                                                                                                                    |     SEQ_SCAN     |
                                                                                                                                                                                                                                                                                                                                                    |     date_dim     |
                                                                                                                                                                                                                                                                                                                                                    |      (0.00s)     |
                                                                                                                                                                                                                                                                                                                                                    |       73049      |
                                                                                                                                                                                                                                                                                                                                                    --------------------

<<Query Profiling Information>>
WITH results AS (SELECT i_product_name , i_brand , i_class , i_category , inv_quantity_on_hand qoh FROM inventory , date_dim , item , warehouse WHERE inv_date_sk=d_date_sk AND inv_item_sk=i_item_sk AND inv_warehouse_sk = w_warehouse_sk AND d_month_seq BETWEEN 1200 AND 1200 + 11 ), results_rollup AS (SELECT i_product_name, i_brand, i_class, i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand, i_class, i_category UNION ALL SELECT i_product_name, i_brand, i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand, i_class UNION ALL SELECT i_product_name, i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name, i_brand UNION ALL SELECT i_product_name, NULL i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results GROUP BY i_product_name UNION ALL SELECT NULL i_product_name, NULL i_brand, NULL i_class, NULL i_category, avg(qoh) qoh FROM results) SELECT i_product_name, i_brand, i_class, i_category, qoh FROM results_rollup ORDER BY qoh, i_product_name, i_brand, i_class, i_category LIMIT 100;
<<Timing>>
Total Time: 5.674737s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.06s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       36001      |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       36001      |
--------------------
--------------------                                                            --------------------
|   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|      (0.63s)     |                                                            |      (0.00s)     |
|       9000       |                                                            |       27001      |
--------------------                                                            --------------------
--------------------                                                            --------------------
|    PROJECTION    |                                                            |       UNION      |
|      (0.00s)     |                                                            |      (0.00s)     |
|      2340000     |                                                            |       27001      |
--------------------                                                            --------------------
--------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|       INNER      |                                                            |                  |                                                            |                  |
| inv_warehouse_sk |                                                            |                  |                                                            |                  |
|  =w_warehouse_sk |                                                            |                  |                                                            |                  |
|      (0.34s)     |                                                            |      (0.53s)     |                                                            |      (0.00s)     |
|      2340000     |                                                            |       9000       |                                                            |       18001      |
--------------------                                                            --------------------                                                            --------------------
--------------------                                        ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |       UNION      |
|       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
|    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
|    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
|      (0.18s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|      2340000     |                                        |         5        ||      2340000     |                                                            |       18001      |
--------------------                                        ----------------------------------------                                                            --------------------
--------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
|       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |                                                            |                  |
|    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |                                                            |                  |
|    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |                                                            |                  |
|      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.41s)     |                                                            |      (0.00s)     |
|      2340000     |                    |       18000      |                    |      2340000     |                                                            |       9000       |                                                            |       9001       |
--------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
|     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |       UNION      |
|     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
|                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
|                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
|                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |                                                            |                  |
|      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |                                                            |       9001       |
----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |    PROJECTION    |
                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |                                                            |                  |
                    |                  |                                        |    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |                                                            |                  |
                    |                  |                                        |    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |                                                            |                  |
                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.26s)     |                                                            |      (0.00s)     |
                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                                            |       9000       |                                                            |         1        |
                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------                                                            --------------------
                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||    PROJECTION    |                                                            |   HASH_GROUP_BY  |
                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||                  |                                                            |                  |
                                                                                |                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  ||                  |                                                            |                  |
                                                                                |                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||                  |                                                            |                  |
                                                                                |                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |                                                            |                  |
                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.08s)     |
                                                                                |     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |                                                            |         1        |
                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------                                                            --------------------
                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------
                                                                                                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                                            |    PROJECTION    |
                                                                                                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                                            |                  |
                                                                                                    |                  |                                        |    inv_date_sk   |                    |                  |                    | inv_warehouse_sk |                                                            |                  |
                                                                                                    |                  |                                        |    =d_date_sk    |                    |                  |                    |  =w_warehouse_sk |                                                            |                  |
                                                                                                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.34s)     |                                                            |      (0.00s)     |
                                                                                                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                                            |      2340000     |
                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                                            --------------------
                                                                                                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------
                                                                                                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |
                                                                                                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                                        |     warehouse    ||       INNER      |
                                                                                                                                                                |                  ||      <= 1211     |                                        |    inv_item_sk   |                                        |                  || inv_warehouse_sk |
                                                                                                                                                                |                  ||    d_month_seq   |                                        |    =i_item_sk    |                                        |                  ||  =w_warehouse_sk |
                                                                                                                                                                |                  ||      >= 1200     |                                        |                  |                                        |                  ||                  |
                                                                                                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.17s)     |                                        |      (0.00s)     ||      (0.34s)     |
                                                                                                                                                                |     11745000     ||        366       |                                        |      2340000     |                                        |         5        ||      2340000     |
                                                                                                                                                                ----------------------------------------                                        --------------------                                        ----------------------------------------
                                                                                                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                    |     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     |
                                                                                                                                                                                    |     date_dim     |                                        |       INNER      |                    |       item       |                    |       INNER      |                                        |     warehouse    |
                                                                                                                                                                                    |                  |                                        |    inv_date_sk   |                    |                  |                    |    inv_item_sk   |                                        |                  |
                                                                                                                                                                                    |                  |                                        |    =d_date_sk    |                    |                  |                    |    =i_item_sk    |                                        |                  |
                                                                                                                                                                                    |      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |                    |      (0.17s)     |                                        |      (0.00s)     |
                                                                                                                                                                                    |       73049      |                                        |      2340000     |                    |       18000      |                    |      2340000     |                                        |         5        |
                                                                                                                                                                                    --------------------                                        --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                                                                                ----------------------------------------                                        --------------------                    --------------------
                                                                                                                                                                                                                                                |     SEQ_SCAN     ||      FILTER      |                                        |     HASH_JOIN    |                    |     SEQ_SCAN     |
                                                                                                                                                                                                                                                |     inventory    ||    d_month_seq   |                                        |       INNER      |                    |       item       |
                                                                                                                                                                                                                                                |                  ||      <= 1211     |                                        |    inv_date_sk   |                    |                  |
                                                                                                                                                                                                                                                |                  ||    d_month_seq   |                                        |    =d_date_sk    |                    |                  |
                                                                                                                                                                                                                                                |                  ||      >= 1200     |                                        |                  |                    |                  |
                                                                                                                                                                                                                                                |      (0.05s)     ||      (0.00s)     |                                        |      (0.16s)     |                    |      (0.00s)     |
                                                                                                                                                                                                                                                |     11745000     ||        366       |                                        |      2340000     |                    |       18000      |
                                                                                                                                                                                                                                                ----------------------------------------                                        --------------------                    --------------------
                                                                                                                                                                                                                                                                    --------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                    |     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      |
                                                                                                                                                                                                                                                                    |     date_dim     |                                        |     inventory    ||    d_month_seq   |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||      <= 1211     |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||    d_month_seq   |
                                                                                                                                                                                                                                                                    |                  |                                        |                  ||      >= 1200     |
                                                                                                                                                                                                                                                                    |      (0.00s)     |                                        |      (0.05s)     ||      (0.00s)     |
                                                                                                                                                                                                                                                                    |       73049      |                                        |     11745000     ||        366       |
                                                                                                                                                                                                                                                                    --------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                    --------------------
                                                                                                                                                                                                                                                                                                                                                    |     SEQ_SCAN     |
                                                                                                                                                                                                                                                                                                                                                    |     date_dim     |
                                                                                                                                                                                                                                                                                                                                                    |      (0.00s)     |
                                                                                                                                                                                                                                                                                                                                                    |       73049      |
                                                                                                                                                                                                                                                                                                                                                    --------------------

