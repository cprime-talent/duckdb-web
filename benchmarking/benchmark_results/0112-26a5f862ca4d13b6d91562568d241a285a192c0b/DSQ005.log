<<Query Profiling Information>>
WITH ssr AS (SELECT s_store_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT ss_store_sk AS store_sk, ss_sold_date_sk AS date_sk, ss_ext_sales_price AS sales_price, ss_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM store_sales UNION ALL SELECT sr_store_sk AS store_sk, sr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, sr_return_amt AS return_amt, sr_net_loss AS net_loss FROM store_returns ) salesreturns, date_dim, store WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND store_sk = s_store_sk GROUP BY s_store_id) , csr AS (SELECT cp_catalog_page_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT cs_catalog_page_sk AS page_sk, cs_sold_date_sk AS date_sk, cs_ext_sales_price AS sales_price, cs_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM catalog_sales UNION ALL SELECT cr_catalog_page_sk AS page_sk, cr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, cr_return_amount AS return_amt, cr_net_loss AS net_loss FROM catalog_returns ) salesreturns, date_dim, catalog_page WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND page_sk = cp_catalog_page_sk GROUP BY cp_catalog_page_id) , wsr AS (SELECT web_site_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT ws_web_site_sk AS wsr_web_site_sk, ws_sold_date_sk AS date_sk, ws_ext_sales_price AS sales_price, ws_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM web_sales UNION ALL SELECT ws_web_site_sk AS wsr_web_site_sk, wr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, wr_return_amt AS return_amt, wr_net_loss AS net_loss FROM web_returns LEFT OUTER JOIN web_sales ON (wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND wsr_web_site_sk = web_site_sk GROUP BY web_site_id) , results AS (SELECT channel , id , sum(sales) AS sales , sum(returns_) AS returns_ , sum(profit) AS profit FROM (SELECT 'store channel' AS channel , concat('store', s_store_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel , concat('catalog_page', cp_catalog_page_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM csr UNION ALL SELECT 'web channel' AS channel , concat('web_site', web_site_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM wsr ) x GROUP BY channel, id) SELECT channel, id, sales, returns_, profit FROM (SELECT channel, id, sales, returns_, profit FROM results UNION SELECT channel, NULL AS id, sum(sales), sum(returns_), sum(profit) FROM results GROUP BY channel UNION SELECT NULL AS channel, NULL AS id, sum(sales), sum(returns_), sum(profit) FROM results) foo ORDER BY channel, id LIMIT 100;
<<Timing>>
Total Time: 0.660571s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|        702       |
--------------------
--------------------                                                                                                                                                                                                                                                --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         4        |
--------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                                                                                                                                                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |       UNION      |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         4        |
--------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                                                                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|       UNION      |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         3        |                                                                                                                                                                                                                                                |         1        |
--------------------                                                                                                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|    PROJECTION    |                                                            |       UNION      |                                                                                                                                                                |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                            |      (0.00s)     |                                                                                                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|         6        |                                                            |        692       |                                                                                                                                                                |        698       |                                                                                                                                                                                                                                                |        698       |
--------------------                                                            --------------------                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |                                                                                |       UNION      |                                                                                                                                                                                                                                                |       UNION      |
|      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|         6        |                                                            |        677       |                                                            |        15        |                                                                                |        698       |                                                                                                                                                                                                                                                |        698       |
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                                                                                                                                --------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                            |       UNION      |                                                                                                                                                                |    PROJECTION    |                                                            |       UNION      |
|       INNER      |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|     store_sk     |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|    =s_store_sk   |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                                                                                |      (0.00s)     |                                                            |      (0.00s)     |
|       32884      |                                                            |        677       |                                                            |        15        |                                                                                |         6        |                                                            |        692       |                                                                                                                                                                |         6        |                                                            |        692       |
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                                                                                                                                --------------------                                                            --------------------
--------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |                                                                                |   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |
|       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
| date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |
|       32884      |                                        |        12        ||       16080      |                                                            |       8427       |                                                                                |         6        |                                                            |        677       |                                                            |        15        |                                                                                |         6        |                                                            |        677       |                                                            |        15        |
--------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
--------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
|       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |                                                                                |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |
|                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     ||       INNER      |                                                            |                  |                                                            |                  |                                                                                |       INNER      |                                                            |                  |                                                            |                  |
|                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  ||     store_sk     |                                                            |                  |                                                            |                  |                                                                                |     store_sk     |                                                            |                  |                                                            |                  |
|                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  ||    =s_store_sk   |                                                            |                  |                                                            |                  |                                                                                |    =s_store_sk   |                                                            |                  |                                                            |                  |
|                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  ||                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |
|      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        ||       32884      |                                                            |        677       |                                                            |        15        |                                                                                |       32884      |                                                            |        677       |                                                            |        15        |
--------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    --------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                        ----------------------------------------                                                            --------------------
|    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |                                                                                |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |
|                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |                    |       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |                                                                                |       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |
|                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |                                                                                | date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |
|                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |                    |         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |                                                                                |         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |
|                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  |                                                                                |                  |                                        |                  ||                  |                                                            |                  |
|      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |                    |      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |                    |       32884      |                                        |        12        ||       16080      |                                                            |       8427       |                                                                                |       32884      |                                        |        12        ||       16080      |                                                            |       8427       |
------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    --------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                        ----------------------------------------                                                            --------------------
----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    --------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            --------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     ||       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     |
|    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |                    |                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     ||                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  ||                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  ||                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  ||                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  |
|      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     |
|      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |                    |      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        ||      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        |
----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    --------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            --------------------
                                                                                ----------------------------------------                                        ----------------------------------------                                                            ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------
                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |                    |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |
                                                                                |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |                                                            |                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |                    |                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |
                                                                                |                  ||                  |                                        |                  ||    wr_item_sk    |                                                            |                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |                    |                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |
                                                                                |                  ||                  |                                        |                  ||    =ws_item_sk   |                                                            |                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |                    |                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |
                                                                                |                  ||                  |                                        |                  ||  wr_order_number |                                                            |                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |                    |                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |
                                                                                |                  ||                  |                                        |                  || =ws_order_number |                                                            |                  ||                  ||                  |                    |                  |                    |                  |                    |                  |                                        |                  |                    |                  ||                  ||                  |                    |                  |                    |                  |                    |                  |                                        |                  |
                                                                                |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |                                                            |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |
                                                                                |      1441548     ||      144067      |                                        |      719384      ||       71654      |                                                            |      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |                    |      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |
                                                                                ----------------------------------------                                        ----------------------------------------                                                            ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------
                                                                                                                                                                                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |
                                                                                                                                                                                    |    web_returns   ||     web_sales    |                                        |    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |                    |    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |
                                                                                                                                                                                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |
                                                                                                                                                                                    |       71654      ||      719384      |                                        |      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |                    |      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |
                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------
                                                                                                                                                                                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                                                                                                                            ----------------------------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |
                                                                                                                                                                                                                                                                                                                                                    |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |                                                                                                                                            |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||    wr_item_sk    |                                                                                                                                            |                  ||                  |                                        |                  ||    wr_item_sk    |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||    =ws_item_sk   |                                                                                                                                            |                  ||                  |                                        |                  ||    =ws_item_sk   |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||  wr_order_number |                                                                                                                                            |                  ||                  |                                        |                  ||  wr_order_number |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  || =ws_order_number |                                                                                                                                            |                  ||                  |                                        |                  || =ws_order_number |
                                                                                                                                                                                                                                                                                                                                                    |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |                                                                                                                                            |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |
                                                                                                                                                                                                                                                                                                                                                    |      1441548     ||      144067      |                                        |      719384      ||       71654      |                                                                                                                                            |      1441548     ||      144067      |                                        |      719384      ||       71654      |
                                                                                                                                                                                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                                                                                                                            ----------------------------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                                                                                                                        ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |    web_returns   ||     web_sales    |                                                                                                                                                                                                                            |    web_returns   ||     web_sales    |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                                            |      (0.00s)     ||      (0.00s)     |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |       71654      ||      719384      |                                                                                                                                                                                                                            |       71654      ||      719384      |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------

<<Query Profiling Information>>
WITH ssr AS (SELECT s_store_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT ss_store_sk AS store_sk, ss_sold_date_sk AS date_sk, ss_ext_sales_price AS sales_price, ss_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM store_sales UNION ALL SELECT sr_store_sk AS store_sk, sr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, sr_return_amt AS return_amt, sr_net_loss AS net_loss FROM store_returns ) salesreturns, date_dim, store WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND store_sk = s_store_sk GROUP BY s_store_id) , csr AS (SELECT cp_catalog_page_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT cs_catalog_page_sk AS page_sk, cs_sold_date_sk AS date_sk, cs_ext_sales_price AS sales_price, cs_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM catalog_sales UNION ALL SELECT cr_catalog_page_sk AS page_sk, cr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, cr_return_amount AS return_amt, cr_net_loss AS net_loss FROM catalog_returns ) salesreturns, date_dim, catalog_page WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND page_sk = cp_catalog_page_sk GROUP BY cp_catalog_page_id) , wsr AS (SELECT web_site_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT ws_web_site_sk AS wsr_web_site_sk, ws_sold_date_sk AS date_sk, ws_ext_sales_price AS sales_price, ws_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM web_sales UNION ALL SELECT ws_web_site_sk AS wsr_web_site_sk, wr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, wr_return_amt AS return_amt, wr_net_loss AS net_loss FROM web_returns LEFT OUTER JOIN web_sales ON (wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND wsr_web_site_sk = web_site_sk GROUP BY web_site_id) , results AS (SELECT channel , id , sum(sales) AS sales , sum(returns_) AS returns_ , sum(profit) AS profit FROM (SELECT 'store channel' AS channel , concat('store', s_store_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel , concat('catalog_page', cp_catalog_page_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM csr UNION ALL SELECT 'web channel' AS channel , concat('web_site', web_site_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM wsr ) x GROUP BY channel, id) SELECT channel, id, sales, returns_, profit FROM (SELECT channel, id, sales, returns_, profit FROM results UNION SELECT channel, NULL AS id, sum(sales), sum(returns_), sum(profit) FROM results GROUP BY channel UNION SELECT NULL AS channel, NULL AS id, sum(sales), sum(returns_), sum(profit) FROM results) foo ORDER BY channel, id LIMIT 100;
<<Timing>>
Total Time: 0.661112s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|        702       |
--------------------
--------------------                                                                                                                                                                                                                                                --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         4        |
--------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                                                                                                                                                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |       UNION      |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         4        |
--------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                                                                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|       UNION      |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         3        |                                                                                                                                                                                                                                                |         1        |
--------------------                                                                                                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|    PROJECTION    |                                                            |       UNION      |                                                                                                                                                                |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                            |      (0.00s)     |                                                                                                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|         6        |                                                            |        692       |                                                                                                                                                                |        698       |                                                                                                                                                                                                                                                |        698       |
--------------------                                                            --------------------                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |                                                                                |       UNION      |                                                                                                                                                                                                                                                |       UNION      |
|      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|         6        |                                                            |        677       |                                                            |        15        |                                                                                |        698       |                                                                                                                                                                                                                                                |        698       |
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                                                                                                                                --------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                            |       UNION      |                                                                                                                                                                |    PROJECTION    |                                                            |       UNION      |
|       INNER      |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|     store_sk     |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|    =s_store_sk   |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                                                                                |      (0.00s)     |                                                            |      (0.00s)     |
|       32884      |                                                            |        677       |                                                            |        15        |                                                                                |         6        |                                                            |        692       |                                                                                                                                                                |         6        |                                                            |        692       |
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                                                                                                                                --------------------                                                            --------------------
--------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |                                                                                |   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |
|       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
| date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |
|       32884      |                                        |        12        ||       16080      |                                                            |       8427       |                                                                                |         6        |                                                            |        677       |                                                            |        15        |                                                                                |         6        |                                                            |        677       |                                                            |        15        |
--------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
--------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
|       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |                                                                                |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |
|                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     ||       INNER      |                                                            |                  |                                                            |                  |                                                                                |       INNER      |                                                            |                  |                                                            |                  |
|                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  ||     store_sk     |                                                            |                  |                                                            |                  |                                                                                |     store_sk     |                                                            |                  |                                                            |                  |
|                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  ||    =s_store_sk   |                                                            |                  |                                                            |                  |                                                                                |    =s_store_sk   |                                                            |                  |                                                            |                  |
|                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  ||                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |
|      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        ||       32884      |                                                            |        677       |                                                            |        15        |                                                                                |       32884      |                                                            |        677       |                                                            |        15        |
--------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    --------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                        ----------------------------------------                                                            --------------------
|    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |                                                                                |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |
|                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |                    |       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |                                                                                |       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |
|                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |                                                                                | date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |
|                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |                    |         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |                                                                                |         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |
|                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  |                                                                                |                  |                                        |                  ||                  |                                                            |                  |
|      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |                    |      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |                    |       32884      |                                        |        12        ||       16080      |                                                            |       8427       |                                                                                |       32884      |                                        |        12        ||       16080      |                                                            |       8427       |
------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    --------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                        ----------------------------------------                                                            --------------------
----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    --------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            --------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     ||       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     |
|    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |                    |                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     ||                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  ||                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  ||                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  ||                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  |
|      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     |
|      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |                    |      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        ||      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        |
----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    --------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            --------------------
                                                                                ----------------------------------------                                        ----------------------------------------                                                            ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------
                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |                    |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |
                                                                                |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |                                                            |                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |                    |                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |
                                                                                |                  ||                  |                                        |                  ||    wr_item_sk    |                                                            |                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |                    |                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |
                                                                                |                  ||                  |                                        |                  ||    =ws_item_sk   |                                                            |                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |                    |                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |
                                                                                |                  ||                  |                                        |                  ||  wr_order_number |                                                            |                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |                    |                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |
                                                                                |                  ||                  |                                        |                  || =ws_order_number |                                                            |                  ||                  ||                  |                    |                  |                    |                  |                    |                  |                                        |                  |                    |                  ||                  ||                  |                    |                  |                    |                  |                    |                  |                                        |                  |
                                                                                |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |                                                            |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |
                                                                                |      1441548     ||      144067      |                                        |      719384      ||       71654      |                                                            |      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |                    |      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |
                                                                                ----------------------------------------                                        ----------------------------------------                                                            ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------
                                                                                                                                                                                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |
                                                                                                                                                                                    |    web_returns   ||     web_sales    |                                        |    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |                    |    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |
                                                                                                                                                                                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |
                                                                                                                                                                                    |       71654      ||      719384      |                                        |      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |                    |      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |
                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------
                                                                                                                                                                                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                                                                                                                            ----------------------------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |
                                                                                                                                                                                                                                                                                                                                                    |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |                                                                                                                                            |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||    wr_item_sk    |                                                                                                                                            |                  ||                  |                                        |                  ||    wr_item_sk    |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||    =ws_item_sk   |                                                                                                                                            |                  ||                  |                                        |                  ||    =ws_item_sk   |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||  wr_order_number |                                                                                                                                            |                  ||                  |                                        |                  ||  wr_order_number |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  || =ws_order_number |                                                                                                                                            |                  ||                  |                                        |                  || =ws_order_number |
                                                                                                                                                                                                                                                                                                                                                    |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |                                                                                                                                            |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |
                                                                                                                                                                                                                                                                                                                                                    |      1441548     ||      144067      |                                        |      719384      ||       71654      |                                                                                                                                            |      1441548     ||      144067      |                                        |      719384      ||       71654      |
                                                                                                                                                                                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                                                                                                                            ----------------------------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                                                                                                                        ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |    web_returns   ||     web_sales    |                                                                                                                                                                                                                            |    web_returns   ||     web_sales    |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                                            |      (0.00s)     ||      (0.00s)     |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |       71654      ||      719384      |                                                                                                                                                                                                                            |       71654      ||      719384      |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------

<<Query Profiling Information>>
WITH ssr AS (SELECT s_store_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT ss_store_sk AS store_sk, ss_sold_date_sk AS date_sk, ss_ext_sales_price AS sales_price, ss_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM store_sales UNION ALL SELECT sr_store_sk AS store_sk, sr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, sr_return_amt AS return_amt, sr_net_loss AS net_loss FROM store_returns ) salesreturns, date_dim, store WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND store_sk = s_store_sk GROUP BY s_store_id) , csr AS (SELECT cp_catalog_page_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT cs_catalog_page_sk AS page_sk, cs_sold_date_sk AS date_sk, cs_ext_sales_price AS sales_price, cs_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM catalog_sales UNION ALL SELECT cr_catalog_page_sk AS page_sk, cr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, cr_return_amount AS return_amt, cr_net_loss AS net_loss FROM catalog_returns ) salesreturns, date_dim, catalog_page WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND page_sk = cp_catalog_page_sk GROUP BY cp_catalog_page_id) , wsr AS (SELECT web_site_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT ws_web_site_sk AS wsr_web_site_sk, ws_sold_date_sk AS date_sk, ws_ext_sales_price AS sales_price, ws_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM web_sales UNION ALL SELECT ws_web_site_sk AS wsr_web_site_sk, wr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, wr_return_amt AS return_amt, wr_net_loss AS net_loss FROM web_returns LEFT OUTER JOIN web_sales ON (wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND wsr_web_site_sk = web_site_sk GROUP BY web_site_id) , results AS (SELECT channel , id , sum(sales) AS sales , sum(returns_) AS returns_ , sum(profit) AS profit FROM (SELECT 'store channel' AS channel , concat('store', s_store_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel , concat('catalog_page', cp_catalog_page_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM csr UNION ALL SELECT 'web channel' AS channel , concat('web_site', web_site_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM wsr ) x GROUP BY channel, id) SELECT channel, id, sales, returns_, profit FROM (SELECT channel, id, sales, returns_, profit FROM results UNION SELECT channel, NULL AS id, sum(sales), sum(returns_), sum(profit) FROM results GROUP BY channel UNION SELECT NULL AS channel, NULL AS id, sum(sales), sum(returns_), sum(profit) FROM results) foo ORDER BY channel, id LIMIT 100;
<<Timing>>
Total Time: 0.661563s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|        702       |
--------------------
--------------------                                                                                                                                                                                                                                                --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         4        |
--------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                                                                                                                                                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |       UNION      |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         4        |
--------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                                                                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|       UNION      |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         3        |                                                                                                                                                                                                                                                |         1        |
--------------------                                                                                                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|    PROJECTION    |                                                            |       UNION      |                                                                                                                                                                |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                            |      (0.00s)     |                                                                                                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|         6        |                                                            |        692       |                                                                                                                                                                |        698       |                                                                                                                                                                                                                                                |        698       |
--------------------                                                            --------------------                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |                                                                                |       UNION      |                                                                                                                                                                                                                                                |       UNION      |
|      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|         6        |                                                            |        677       |                                                            |        15        |                                                                                |        698       |                                                                                                                                                                                                                                                |        698       |
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                                                                                                                                --------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                            |       UNION      |                                                                                                                                                                |    PROJECTION    |                                                            |       UNION      |
|       INNER      |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|     store_sk     |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|    =s_store_sk   |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                                                                                |      (0.00s)     |                                                            |      (0.00s)     |
|       32884      |                                                            |        677       |                                                            |        15        |                                                                                |         6        |                                                            |        692       |                                                                                                                                                                |         6        |                                                            |        692       |
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                                                                                                                                --------------------                                                            --------------------
--------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |                                                                                |   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |
|       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
| date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |
|       32884      |                                        |        12        ||       16080      |                                                            |       8427       |                                                                                |         6        |                                                            |        677       |                                                            |        15        |                                                                                |         6        |                                                            |        677       |                                                            |        15        |
--------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
--------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
|       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |                                                                                |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |
|                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     ||       INNER      |                                                            |                  |                                                            |                  |                                                                                |       INNER      |                                                            |                  |                                                            |                  |
|                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  ||     store_sk     |                                                            |                  |                                                            |                  |                                                                                |     store_sk     |                                                            |                  |                                                            |                  |
|                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  ||    =s_store_sk   |                                                            |                  |                                                            |                  |                                                                                |    =s_store_sk   |                                                            |                  |                                                            |                  |
|                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  ||                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |
|      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        ||       32884      |                                                            |        677       |                                                            |        15        |                                                                                |       32884      |                                                            |        677       |                                                            |        15        |
--------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    --------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                        ----------------------------------------                                                            --------------------
|    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |                                                                                |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |
|                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |                    |       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |                                                                                |       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |
|                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |                                                                                | date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |
|                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |                    |         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |                                                                                |         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |
|                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  |                                                                                |                  |                                        |                  ||                  |                                                            |                  |
|      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |                    |      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |                    |       32884      |                                        |        12        ||       16080      |                                                            |       8427       |                                                                                |       32884      |                                        |        12        ||       16080      |                                                            |       8427       |
------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    --------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                        ----------------------------------------                                                            --------------------
----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    --------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            --------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     ||       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     |
|    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |                    |                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     ||                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  ||                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  ||                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  ||                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  |
|      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     |
|      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |                    |      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        ||      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        |
----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    --------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            --------------------
                                                                                ----------------------------------------                                        ----------------------------------------                                                            ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------
                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |                    |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |
                                                                                |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |                                                            |                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |                    |                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |
                                                                                |                  ||                  |                                        |                  ||    wr_item_sk    |                                                            |                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |                    |                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |
                                                                                |                  ||                  |                                        |                  ||    =ws_item_sk   |                                                            |                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |                    |                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |
                                                                                |                  ||                  |                                        |                  ||  wr_order_number |                                                            |                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |                    |                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |
                                                                                |                  ||                  |                                        |                  || =ws_order_number |                                                            |                  ||                  ||                  |                    |                  |                    |                  |                    |                  |                                        |                  |                    |                  ||                  ||                  |                    |                  |                    |                  |                    |                  |                                        |                  |
                                                                                |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |                                                            |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |
                                                                                |      1441548     ||      144067      |                                        |      719384      ||       71654      |                                                            |      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |                    |      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |
                                                                                ----------------------------------------                                        ----------------------------------------                                                            ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------
                                                                                                                                                                                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |
                                                                                                                                                                                    |    web_returns   ||     web_sales    |                                        |    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |                    |    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |
                                                                                                                                                                                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |
                                                                                                                                                                                    |       71654      ||      719384      |                                        |      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |                    |      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |
                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------
                                                                                                                                                                                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                                                                                                                            ----------------------------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |
                                                                                                                                                                                                                                                                                                                                                    |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |                                                                                                                                            |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||    wr_item_sk    |                                                                                                                                            |                  ||                  |                                        |                  ||    wr_item_sk    |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||    =ws_item_sk   |                                                                                                                                            |                  ||                  |                                        |                  ||    =ws_item_sk   |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||  wr_order_number |                                                                                                                                            |                  ||                  |                                        |                  ||  wr_order_number |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  || =ws_order_number |                                                                                                                                            |                  ||                  |                                        |                  || =ws_order_number |
                                                                                                                                                                                                                                                                                                                                                    |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |                                                                                                                                            |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |
                                                                                                                                                                                                                                                                                                                                                    |      1441548     ||      144067      |                                        |      719384      ||       71654      |                                                                                                                                            |      1441548     ||      144067      |                                        |      719384      ||       71654      |
                                                                                                                                                                                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                                                                                                                            ----------------------------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                                                                                                                        ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |    web_returns   ||     web_sales    |                                                                                                                                                                                                                            |    web_returns   ||     web_sales    |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                                            |      (0.00s)     ||      (0.00s)     |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |       71654      ||      719384      |                                                                                                                                                                                                                            |       71654      ||      719384      |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------

<<Query Profiling Information>>
WITH ssr AS (SELECT s_store_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT ss_store_sk AS store_sk, ss_sold_date_sk AS date_sk, ss_ext_sales_price AS sales_price, ss_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM store_sales UNION ALL SELECT sr_store_sk AS store_sk, sr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, sr_return_amt AS return_amt, sr_net_loss AS net_loss FROM store_returns ) salesreturns, date_dim, store WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND store_sk = s_store_sk GROUP BY s_store_id) , csr AS (SELECT cp_catalog_page_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT cs_catalog_page_sk AS page_sk, cs_sold_date_sk AS date_sk, cs_ext_sales_price AS sales_price, cs_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM catalog_sales UNION ALL SELECT cr_catalog_page_sk AS page_sk, cr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, cr_return_amount AS return_amt, cr_net_loss AS net_loss FROM catalog_returns ) salesreturns, date_dim, catalog_page WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND page_sk = cp_catalog_page_sk GROUP BY cp_catalog_page_id) , wsr AS (SELECT web_site_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT ws_web_site_sk AS wsr_web_site_sk, ws_sold_date_sk AS date_sk, ws_ext_sales_price AS sales_price, ws_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM web_sales UNION ALL SELECT ws_web_site_sk AS wsr_web_site_sk, wr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, wr_return_amt AS return_amt, wr_net_loss AS net_loss FROM web_returns LEFT OUTER JOIN web_sales ON (wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND wsr_web_site_sk = web_site_sk GROUP BY web_site_id) , results AS (SELECT channel , id , sum(sales) AS sales , sum(returns_) AS returns_ , sum(profit) AS profit FROM (SELECT 'store channel' AS channel , concat('store', s_store_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel , concat('catalog_page', cp_catalog_page_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM csr UNION ALL SELECT 'web channel' AS channel , concat('web_site', web_site_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM wsr ) x GROUP BY channel, id) SELECT channel, id, sales, returns_, profit FROM (SELECT channel, id, sales, returns_, profit FROM results UNION SELECT channel, NULL AS id, sum(sales), sum(returns_), sum(profit) FROM results GROUP BY channel UNION SELECT NULL AS channel, NULL AS id, sum(sales), sum(returns_), sum(profit) FROM results) foo ORDER BY channel, id LIMIT 100;
<<Timing>>
Total Time: 0.660578s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|        702       |
--------------------
--------------------                                                                                                                                                                                                                                                --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         4        |
--------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                                                                                                                                                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |       UNION      |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         4        |
--------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                                                                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|       UNION      |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         3        |                                                                                                                                                                                                                                                |         1        |
--------------------                                                                                                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|    PROJECTION    |                                                            |       UNION      |                                                                                                                                                                |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                            |      (0.00s)     |                                                                                                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|         6        |                                                            |        692       |                                                                                                                                                                |        698       |                                                                                                                                                                                                                                                |        698       |
--------------------                                                            --------------------                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |                                                                                |       UNION      |                                                                                                                                                                                                                                                |       UNION      |
|      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|         6        |                                                            |        677       |                                                            |        15        |                                                                                |        698       |                                                                                                                                                                                                                                                |        698       |
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                                                                                                                                --------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                            |       UNION      |                                                                                                                                                                |    PROJECTION    |                                                            |       UNION      |
|       INNER      |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|     store_sk     |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|    =s_store_sk   |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                                                                                |      (0.00s)     |                                                            |      (0.00s)     |
|       32884      |                                                            |        677       |                                                            |        15        |                                                                                |         6        |                                                            |        692       |                                                                                                                                                                |         6        |                                                            |        692       |
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                                                                                                                                --------------------                                                            --------------------
--------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |                                                                                |   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |
|       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
| date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |
|       32884      |                                        |        12        ||       16080      |                                                            |       8427       |                                                                                |         6        |                                                            |        677       |                                                            |        15        |                                                                                |         6        |                                                            |        677       |                                                            |        15        |
--------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
--------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
|       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |                                                                                |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |
|                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     ||       INNER      |                                                            |                  |                                                            |                  |                                                                                |       INNER      |                                                            |                  |                                                            |                  |
|                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  ||     store_sk     |                                                            |                  |                                                            |                  |                                                                                |     store_sk     |                                                            |                  |                                                            |                  |
|                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  ||    =s_store_sk   |                                                            |                  |                                                            |                  |                                                                                |    =s_store_sk   |                                                            |                  |                                                            |                  |
|                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  ||                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |
|      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        ||       32884      |                                                            |        677       |                                                            |        15        |                                                                                |       32884      |                                                            |        677       |                                                            |        15        |
--------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    --------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                        ----------------------------------------                                                            --------------------
|    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |                                                                                |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |
|                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |                    |       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |                                                                                |       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |
|                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |                                                                                | date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |
|                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |                    |         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |                                                                                |         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |
|                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  |                                                                                |                  |                                        |                  ||                  |                                                            |                  |
|      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |                    |      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |                    |       32884      |                                        |        12        ||       16080      |                                                            |       8427       |                                                                                |       32884      |                                        |        12        ||       16080      |                                                            |       8427       |
------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    --------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                        ----------------------------------------                                                            --------------------
----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    --------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            --------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     ||       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     |
|    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |                    |                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     ||                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  ||                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  ||                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  ||                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  |
|      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     |
|      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |                    |      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        ||      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        |
----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    --------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            --------------------
                                                                                ----------------------------------------                                        ----------------------------------------                                                            ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------
                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |                    |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |
                                                                                |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |                                                            |                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |                    |                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |
                                                                                |                  ||                  |                                        |                  ||    wr_item_sk    |                                                            |                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |                    |                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |
                                                                                |                  ||                  |                                        |                  ||    =ws_item_sk   |                                                            |                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |                    |                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |
                                                                                |                  ||                  |                                        |                  ||  wr_order_number |                                                            |                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |                    |                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |
                                                                                |                  ||                  |                                        |                  || =ws_order_number |                                                            |                  ||                  ||                  |                    |                  |                    |                  |                    |                  |                                        |                  |                    |                  ||                  ||                  |                    |                  |                    |                  |                    |                  |                                        |                  |
                                                                                |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |                                                            |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |
                                                                                |      1441548     ||      144067      |                                        |      719384      ||       71654      |                                                            |      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |                    |      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |
                                                                                ----------------------------------------                                        ----------------------------------------                                                            ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------
                                                                                                                                                                                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |
                                                                                                                                                                                    |    web_returns   ||     web_sales    |                                        |    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |                    |    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |
                                                                                                                                                                                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |
                                                                                                                                                                                    |       71654      ||      719384      |                                        |      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |                    |      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |
                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------
                                                                                                                                                                                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                                                                                                                            ----------------------------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |
                                                                                                                                                                                                                                                                                                                                                    |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |                                                                                                                                            |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||    wr_item_sk    |                                                                                                                                            |                  ||                  |                                        |                  ||    wr_item_sk    |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||    =ws_item_sk   |                                                                                                                                            |                  ||                  |                                        |                  ||    =ws_item_sk   |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||  wr_order_number |                                                                                                                                            |                  ||                  |                                        |                  ||  wr_order_number |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  || =ws_order_number |                                                                                                                                            |                  ||                  |                                        |                  || =ws_order_number |
                                                                                                                                                                                                                                                                                                                                                    |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |                                                                                                                                            |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |
                                                                                                                                                                                                                                                                                                                                                    |      1441548     ||      144067      |                                        |      719384      ||       71654      |                                                                                                                                            |      1441548     ||      144067      |                                        |      719384      ||       71654      |
                                                                                                                                                                                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                                                                                                                            ----------------------------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                                                                                                                        ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |    web_returns   ||     web_sales    |                                                                                                                                                                                                                            |    web_returns   ||     web_sales    |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                                            |      (0.00s)     ||      (0.00s)     |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |       71654      ||      719384      |                                                                                                                                                                                                                            |       71654      ||      719384      |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------

<<Query Profiling Information>>
WITH ssr AS (SELECT s_store_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT ss_store_sk AS store_sk, ss_sold_date_sk AS date_sk, ss_ext_sales_price AS sales_price, ss_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM store_sales UNION ALL SELECT sr_store_sk AS store_sk, sr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, sr_return_amt AS return_amt, sr_net_loss AS net_loss FROM store_returns ) salesreturns, date_dim, store WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND store_sk = s_store_sk GROUP BY s_store_id) , csr AS (SELECT cp_catalog_page_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT cs_catalog_page_sk AS page_sk, cs_sold_date_sk AS date_sk, cs_ext_sales_price AS sales_price, cs_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM catalog_sales UNION ALL SELECT cr_catalog_page_sk AS page_sk, cr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, cr_return_amount AS return_amt, cr_net_loss AS net_loss FROM catalog_returns ) salesreturns, date_dim, catalog_page WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND page_sk = cp_catalog_page_sk GROUP BY cp_catalog_page_id) , wsr AS (SELECT web_site_id, sum(sales_price) AS sales, sum(profit) AS profit, sum(return_amt) AS returns_, sum(net_loss) AS profit_loss FROM (SELECT ws_web_site_sk AS wsr_web_site_sk, ws_sold_date_sk AS date_sk, ws_ext_sales_price AS sales_price, ws_net_profit AS profit, cast(0 AS decimal(7,2)) AS return_amt, cast(0 AS decimal(7,2)) AS net_loss FROM web_sales UNION ALL SELECT ws_web_site_sk AS wsr_web_site_sk, wr_returned_date_sk AS date_sk, cast(0 AS decimal(7,2)) AS sales_price, cast(0 AS decimal(7,2)) AS profit, wr_return_amt AS return_amt, wr_net_loss AS net_loss FROM web_returns LEFT OUTER JOIN web_sales ON (wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site WHERE date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-06' AS date) AND wsr_web_site_sk = web_site_sk GROUP BY web_site_id) , results AS (SELECT channel , id , sum(sales) AS sales , sum(returns_) AS returns_ , sum(profit) AS profit FROM (SELECT 'store channel' AS channel , concat('store', s_store_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel , concat('catalog_page', cp_catalog_page_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM csr UNION ALL SELECT 'web channel' AS channel , concat('web_site', web_site_id) AS id , sales , returns_ , (profit - profit_loss) AS profit FROM wsr ) x GROUP BY channel, id) SELECT channel, id, sales, returns_, profit FROM (SELECT channel, id, sales, returns_, profit FROM results UNION SELECT channel, NULL AS id, sum(sales), sum(returns_), sum(profit) FROM results GROUP BY channel UNION SELECT NULL AS channel, NULL AS id, sum(sales), sum(returns_), sum(profit) FROM results) foo ORDER BY channel, id LIMIT 100;
<<Timing>>
Total Time: 0.661062s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        702       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|        702       |
--------------------
--------------------                                                                                                                                                                                                                                                --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         4        |
--------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                                                                                                                                                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |       UNION      |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         4        |
--------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                                                                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|       UNION      |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|        698       |                                                                                                                                                                                                                                                |         3        |                                                                                                                                                                                                                                                |         1        |
--------------------                                                                                                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|    PROJECTION    |                                                            |       UNION      |                                                                                                                                                                |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                            |      (0.00s)     |                                                                                                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|         6        |                                                            |        692       |                                                                                                                                                                |        698       |                                                                                                                                                                                                                                                |        698       |
--------------------                                                            --------------------                                                                                                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                                                                                                                                                                                                                --------------------
|   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |                                                                                |       UNION      |                                                                                                                                                                                                                                                |       UNION      |
|      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|         6        |                                                            |        677       |                                                            |        15        |                                                                                |        698       |                                                                                                                                                                                                                                                |        698       |
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                                                                                                                                --------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                            |       UNION      |                                                                                                                                                                |    PROJECTION    |                                                            |       UNION      |
|       INNER      |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|     store_sk     |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|    =s_store_sk   |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                                                                                                                                |                  |                                                            |                  |
|      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                                                                                |      (0.00s)     |                                                            |      (0.00s)     |
|       32884      |                                                            |        677       |                                                            |        15        |                                                                                |         6        |                                                            |        692       |                                                                                                                                                                |         6        |                                                            |        692       |
--------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                                                                                                                                --------------------                                                            --------------------
--------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |                                                                                |   HASH_GROUP_BY  |                                                            |    PROJECTION    |                                                            |    PROJECTION    |
|       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
| date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |                                                                                |                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |
|       32884      |                                        |        12        ||       16080      |                                                            |       8427       |                                                                                |         6        |                                                            |        677       |                                                            |        15        |                                                                                |         6        |                                                            |        677       |                                                            |        15        |
--------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
--------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
|       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |                                                                                |     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |                                                            |   HASH_GROUP_BY  |
|                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     ||       INNER      |                                                            |                  |                                                            |                  |                                                                                |       INNER      |                                                            |                  |                                                            |                  |
|                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  ||     store_sk     |                                                            |                  |                                                            |                  |                                                                                |     store_sk     |                                                            |                  |                                                            |                  |
|                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  ||    =s_store_sk   |                                                            |                  |                                                            |                  |                                                                                |    =s_store_sk   |                                                            |                  |                                                            |                  |
|                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  ||                  |                                                            |                  |                                                            |                  |                                                                                |                  |                                                            |                  |                                                            |                  |
|      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.01s)     |                                                            |      (0.00s)     |                                                            |      (0.00s)     |
|      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        ||       32884      |                                                            |        677       |                                                            |        15        |                                                                                |       32884      |                                                            |        677       |                                                            |        15        |
--------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                                                            --------------------                                                            --------------------                                                                                --------------------                                                            --------------------                                                            --------------------
------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    --------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                        ----------------------------------------                                                            --------------------
|    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |                                                                                |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     HASH_JOIN    |
|                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |                    |       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |                                                                                |       INNER      |                                        |       store      ||       INNER      |                                                            |       INNER      |
|                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |                                                                                | date_sk=d_date_s |                                        |                  || page_sk=cp_catal |                                                            |  wsr_web_site_sk |
|                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |                    |         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |                                                                                |         k        |                                        |                  ||    og_page_sk    |                                                            |   =web_site_sk   |
|                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  |                                                                                |                  |                                        |                  ||                  |                                                            |                  |
|      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |                    |      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |                                                                                |      (0.04s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |                    |       32884      |                                        |        12        ||       16080      |                                                            |       8427       |                                                                                |       32884      |                                        |        12        ||       16080      |                                                            |       8427       |
------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    --------------------                                        ----------------------------------------                                                            --------------------                                                                                --------------------                                        ----------------------------------------                                                            --------------------
----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    --------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            --------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     ||       UNION      |                    |      FILTER      |                    |     HASH_JOIN    |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |     SEQ_SCAN     |
|    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |                    |                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     ||                  |                    |     d_date <     |                    |       INNER      |                                        |   catalog_page   ||       INNER      |                                                            |     web_site     |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  ||                  |                    |   = 2000-09-06   |                    | date_sk=d_date_s |                                        |                  || date_sk=d_date_s |                                                            |                  |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  ||                  |                    |     d_date >     |                    |         k        |                                        |                  ||         k        |                                                            |                  |
|                  ||                  |                                        |                  ||                  ||                  |                    |                  ||                  |                    |                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  ||                  |                    |   = 2000-08-23   |                    |                  |                                        |                  ||                  |                                                            |                  |
|      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     |                                        |      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     |
|      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |                    |      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        ||      3168271     |                    |        15        |                    |       16080      |                                        |       11718      ||       8427       |                                                            |        30        |
----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    --------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            ----------------------------------------                    --------------------                    --------------------                                        ----------------------------------------                                                            --------------------
                                                                                ----------------------------------------                                        ----------------------------------------                                                            ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------
                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                            |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |                    |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |                    |       UNION      |                                        |      FILTER      |
                                                                                |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |                                                            |                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |                    |                  ||                  ||     date_dim     |                    |                  |                    |     d_date <     |                    |                  |                                        |     d_date <     |
                                                                                |                  ||                  |                                        |                  ||    wr_item_sk    |                                                            |                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |                    |                  ||                  ||                  |                    |                  |                    |   = 2000-09-06   |                    |                  |                                        |   = 2000-09-06   |
                                                                                |                  ||                  |                                        |                  ||    =ws_item_sk   |                                                            |                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |                    |                  ||                  ||                  |                    |                  |                    |     d_date >     |                    |                  |                                        |     d_date >     |
                                                                                |                  ||                  |                                        |                  ||  wr_order_number |                                                            |                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |                    |                  ||                  ||                  |                    |                  |                    |   = 2000-08-23   |                    |                  |                                        |   = 2000-08-23   |
                                                                                |                  ||                  |                                        |                  || =ws_order_number |                                                            |                  ||                  ||                  |                    |                  |                    |                  |                    |                  |                                        |                  |                    |                  ||                  ||                  |                    |                  |                    |                  |                    |                  |                                        |                  |
                                                                                |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |                                                            |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |                                        |      (0.00s)     |
                                                                                |      1441548     ||      144067      |                                        |      719384      ||       71654      |                                                            |      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |                    |      2880404     ||      287867      ||       73049      |                    |      1585615     |                    |        15        |                    |      791038      |                                        |        15        |
                                                                                ----------------------------------------                                        ----------------------------------------                                                            ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------                    ------------------------------------------------------------                    --------------------                    --------------------                    --------------------                                        --------------------
                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------
                                                                                                                                                                                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |                    |    PROJECTION    ||    PROJECTION    |                    |     SEQ_SCAN     |
                                                                                                                                                                                    |    web_returns   ||     web_sales    |                                        |    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |                    |    store_sales   ||   store_returns  |                                        |                  ||                  ||     date_dim     |                    |                  ||                  |                    |     date_dim     |
                                                                                                                                                                                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                    |      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |
                                                                                                                                                                                    |       71654      ||      719384      |                                        |      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |                    |      2880404     ||      287867      |                                        |      1441548     ||      144067      ||       73049      |                    |      719384      ||       71654      |                    |       73049      |
                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                    ----------------------------------------                    --------------------
                                                                                                                                                                                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                                                                                                                            ----------------------------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     HASH_JOIN    |
                                                                                                                                                                                                                                                                                                                                                    |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |                                                                                                                                            |   catalog_sales  ||  catalog_returns |                                        |     web_sales    ||       LEFT       |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||    wr_item_sk    |                                                                                                                                            |                  ||                  |                                        |                  ||    wr_item_sk    |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||    =ws_item_sk   |                                                                                                                                            |                  ||                  |                                        |                  ||    =ws_item_sk   |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  ||  wr_order_number |                                                                                                                                            |                  ||                  |                                        |                  ||  wr_order_number |
                                                                                                                                                                                                                                                                                                                                                    |                  ||                  |                                        |                  || =ws_order_number |                                                                                                                                            |                  ||                  |                                        |                  || =ws_order_number |
                                                                                                                                                                                                                                                                                                                                                    |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |                                                                                                                                            |      (0.01s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.08s)     |
                                                                                                                                                                                                                                                                                                                                                    |      1441548     ||      144067      |                                        |      719384      ||       71654      |                                                                                                                                            |      1441548     ||      144067      |                                        |      719384      ||       71654      |
                                                                                                                                                                                                                                                                                                                                                    ----------------------------------------                                        ----------------------------------------                                                                                                                                            ----------------------------------------                                        ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                                                                                                                        ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |    web_returns   ||     web_sales    |                                                                                                                                                                                                                            |    web_returns   ||     web_sales    |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                                            |      (0.00s)     ||      (0.00s)     |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        |       71654      ||      719384      |                                                                                                                                                                                                                            |       71654      ||      719384      |
                                                                                                                                                                                                                                                                                                                                                                                                                                                        ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------

