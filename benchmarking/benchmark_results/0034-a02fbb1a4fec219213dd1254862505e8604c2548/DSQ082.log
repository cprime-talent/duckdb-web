<<Query Profiling Information>>
WITH ws AS (SELECT d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp FROM web_sales LEFT JOIN web_returns ON wr_order_number=ws_order_number AND ws_item_sk=wr_item_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE wr_order_number IS NULL GROUP BY d_year, ws_item_sk, ws_bill_customer_sk ), cs AS (SELECT d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp FROM catalog_sales LEFT JOIN catalog_returns ON cr_order_number=cs_order_number AND cs_item_sk=cr_item_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE cr_order_number IS NULL GROUP BY d_year, cs_item_sk, cs_bill_customer_sk ), ss AS (SELECT d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp FROM store_sales LEFT JOIN store_returns ON sr_ticket_number=ss_ticket_number AND ss_item_sk=sr_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE sr_ticket_number IS NULL GROUP BY d_year, ss_item_sk, ss_customer_sk ) SELECT ss_sold_year, ss_item_sk, ss_customer_sk, round((ss_qty*1.00)/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price FROM ss LEFT JOIN ws ON (ws_sold_year=ss_sold_year AND ws_item_sk=ss_item_sk AND ws_customer_sk=ss_customer_sk) LEFT JOIN cs ON (cs_sold_year=ss_sold_year AND cs_item_sk=ss_item_sk AND cs_customer_sk=ss_customer_sk) WHERE (coalesce(ws_qty,0)>0 OR coalesce(cs_qty, 0)>0) AND ss_sold_year=2000 ORDER BY ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty DESC, ss_wc DESC, ss_sp DESC, other_chan_qty, other_chan_wholesale_cost, other_chan_sales_price, ratio LIMIT 100;
<<Timing>>
Total Time: 3.182034s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        223       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        223       |
--------------------
--------------------
|      FILTER      |
|   ss_sold_year   |
|       = 2000     |
|     OR((CASE     |
|   (IS_NOT_NULL   |
|     (ws_qty)     |
|     , ws_qty     |
|     , 0) > 0)    |
| , (CASE(IS_NOT_N |
|    ULL(cs_qty)   |
| , cs_qty, 0) > 0 |
|      (0.07s)     |
|        223       |
--------------------
--------------------
|     HASH_JOIN    |
|       LEFT       |
|  ss_customer_sk  |
|  =cs_customer_sk |
|    ss_item_sk    |
|    =cs_item_sk   |
|   ss_sold_year   |
|   =cs_sold_year  |
|      (0.43s)     |
|      2591390     |
--------------------
--------------------                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                    |   HASH_GROUP_BY  |
|       LEFT       |                                                                                                    |                  |
|  ss_customer_sk  |                                                                                                    |                  |
|  =ws_customer_sk |                                                                                                    |                  |
|    ss_item_sk    |                                                                                                    |                  |
|    =ws_item_sk   |                                                                                                    |                  |
|   ss_sold_year   |                                                                                                    |                  |
|   =ws_sold_year  |                                                                                                    |                  |
|      (0.20s)     |                                                                                                    |      (0.47s)     |
|      2591390     |                                                                                                    |      1297350     |
--------------------                                                                                                    --------------------
--------------------                                        --------------------                                        --------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |
|                  |                                        |                  |                                        |       INNER      |
|                  |                                        |                  |                                        |  cs_sold_date_sk |
|                  |                                        |                  |                                        |    =d_date_sk    |
|      (0.97s)     |                                        |      (0.23s)     |                                        |      (0.08s)     |
|      2591390     |                                        |      647712      |                                        |      1297481     |
--------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                    --------------------
|      FILTER      |                                        |      FILTER      |                                        |      FILTER      |                    |     SEQ_SCAN     |
| IS_NULL(sr_ticke |                                        | IS_NULL(wr_order |                                        | IS_NULL(cr_order |                    |     date_dim     |
|     t_number     |                                        |      _number     |                                        |      _number     |                    |                  |
|      (0.03s)     |                                        |      (0.01s)     |                                        |      (0.01s)     |                    |      (0.00s)     |
|      2592537     |                                        |      647730      |                                        |      1297481     |                    |       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------
--------------------                                        --------------------                                        --------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |
|       INNER      |                                        |       INNER      |                                        |       LEFT       |
|  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |    cs_item_sk    |
|    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =cr_item_sk   |
|                  |                                        |                  |                                        |  cs_order_number |
|                  |                                        |                  |                                        | =cr_order_number |
|      (0.25s)     |                                        |      (0.07s)     |                                        |      (0.08s)     |
|      2880404     |                                        |      719384      |                                        |      1441548     |
--------------------                                        --------------------                                        --------------------
--------------------                    ----------------------------------------                    ------------------------------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|       LEFT       |                    |     date_dim     ||       LEFT       |                    |     date_dim     ||   catalog_sales  ||  catalog_returns |
|    ss_item_sk    |                    |                  ||    ws_item_sk    |                    |                  ||                  ||                  |
|    =sr_item_sk   |                    |                  ||    =wr_item_sk   |                    |                  ||                  ||                  |
| ss_ticket_number |                    |                  ||  ws_order_number |                    |                  ||                  ||                  |
| =sr_ticket_numbe |                    |                  || =wr_order_number |                    |                  ||                  ||                  |
|         r        |                    |                  ||                  |                    |                  ||                  ||                  |
|      (0.17s)     |                    |      (0.00s)     ||      (0.04s)     |                    |      (0.00s)     ||      (0.02s)     ||      (0.00s)     |
|      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      1441548     ||      144067      |
--------------------                    ----------------------------------------                    ------------------------------------------------------------
----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||   store_returns  |                    |     web_sales    ||    web_returns   |
|      (0.03s)     ||      (0.00s)     |                    |      (0.01s)     ||      (0.00s)     |
|      2880404     ||      287867      |                    |      719384      ||       71654      |
----------------------------------------                    ----------------------------------------

<<Query Profiling Information>>
WITH ws AS (SELECT d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp FROM web_sales LEFT JOIN web_returns ON wr_order_number=ws_order_number AND ws_item_sk=wr_item_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE wr_order_number IS NULL GROUP BY d_year, ws_item_sk, ws_bill_customer_sk ), cs AS (SELECT d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp FROM catalog_sales LEFT JOIN catalog_returns ON cr_order_number=cs_order_number AND cs_item_sk=cr_item_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE cr_order_number IS NULL GROUP BY d_year, cs_item_sk, cs_bill_customer_sk ), ss AS (SELECT d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp FROM store_sales LEFT JOIN store_returns ON sr_ticket_number=ss_ticket_number AND ss_item_sk=sr_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE sr_ticket_number IS NULL GROUP BY d_year, ss_item_sk, ss_customer_sk ) SELECT ss_sold_year, ss_item_sk, ss_customer_sk, round((ss_qty*1.00)/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price FROM ss LEFT JOIN ws ON (ws_sold_year=ss_sold_year AND ws_item_sk=ss_item_sk AND ws_customer_sk=ss_customer_sk) LEFT JOIN cs ON (cs_sold_year=ss_sold_year AND cs_item_sk=ss_item_sk AND cs_customer_sk=ss_customer_sk) WHERE (coalesce(ws_qty,0)>0 OR coalesce(cs_qty, 0)>0) AND ss_sold_year=2000 ORDER BY ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty DESC, ss_wc DESC, ss_sp DESC, other_chan_qty, other_chan_wholesale_cost, other_chan_sales_price, ratio LIMIT 100;
<<Timing>>
Total Time: 3.179849s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        223       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        223       |
--------------------
--------------------
|      FILTER      |
|   ss_sold_year   |
|       = 2000     |
|     OR((CASE     |
|   (IS_NOT_NULL   |
|     (ws_qty)     |
|     , ws_qty     |
|     , 0) > 0)    |
| , (CASE(IS_NOT_N |
|    ULL(cs_qty)   |
| , cs_qty, 0) > 0 |
|      (0.07s)     |
|        223       |
--------------------
--------------------
|     HASH_JOIN    |
|       LEFT       |
|  ss_customer_sk  |
|  =cs_customer_sk |
|    ss_item_sk    |
|    =cs_item_sk   |
|   ss_sold_year   |
|   =cs_sold_year  |
|      (0.42s)     |
|      2591390     |
--------------------
--------------------                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                    |   HASH_GROUP_BY  |
|       LEFT       |                                                                                                    |                  |
|  ss_customer_sk  |                                                                                                    |                  |
|  =ws_customer_sk |                                                                                                    |                  |
|    ss_item_sk    |                                                                                                    |                  |
|    =ws_item_sk   |                                                                                                    |                  |
|   ss_sold_year   |                                                                                                    |                  |
|   =ws_sold_year  |                                                                                                    |                  |
|      (0.19s)     |                                                                                                    |      (0.47s)     |
|      2591390     |                                                                                                    |      1297350     |
--------------------                                                                                                    --------------------
--------------------                                        --------------------                                        --------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |
|                  |                                        |                  |                                        |       INNER      |
|                  |                                        |                  |                                        |  cs_sold_date_sk |
|                  |                                        |                  |                                        |    =d_date_sk    |
|      (0.97s)     |                                        |      (0.23s)     |                                        |      (0.08s)     |
|      2591390     |                                        |      647712      |                                        |      1297481     |
--------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                    --------------------
|      FILTER      |                                        |      FILTER      |                                        |      FILTER      |                    |     SEQ_SCAN     |
| IS_NULL(sr_ticke |                                        | IS_NULL(wr_order |                                        | IS_NULL(cr_order |                    |     date_dim     |
|     t_number     |                                        |      _number     |                                        |      _number     |                    |                  |
|      (0.03s)     |                                        |      (0.01s)     |                                        |      (0.01s)     |                    |      (0.00s)     |
|      2592537     |                                        |      647730      |                                        |      1297481     |                    |       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------
--------------------                                        --------------------                                        --------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |
|       INNER      |                                        |       INNER      |                                        |       LEFT       |
|  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |    cs_item_sk    |
|    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =cr_item_sk   |
|                  |                                        |                  |                                        |  cs_order_number |
|                  |                                        |                  |                                        | =cr_order_number |
|      (0.25s)     |                                        |      (0.07s)     |                                        |      (0.08s)     |
|      2880404     |                                        |      719384      |                                        |      1441548     |
--------------------                                        --------------------                                        --------------------
--------------------                    ----------------------------------------                    ------------------------------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|       LEFT       |                    |     date_dim     ||       LEFT       |                    |     date_dim     ||   catalog_sales  ||  catalog_returns |
|    ss_item_sk    |                    |                  ||    ws_item_sk    |                    |                  ||                  ||                  |
|    =sr_item_sk   |                    |                  ||    =wr_item_sk   |                    |                  ||                  ||                  |
| ss_ticket_number |                    |                  ||  ws_order_number |                    |                  ||                  ||                  |
| =sr_ticket_numbe |                    |                  || =wr_order_number |                    |                  ||                  ||                  |
|         r        |                    |                  ||                  |                    |                  ||                  ||                  |
|      (0.17s)     |                    |      (0.00s)     ||      (0.04s)     |                    |      (0.00s)     ||      (0.02s)     ||      (0.00s)     |
|      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      1441548     ||      144067      |
--------------------                    ----------------------------------------                    ------------------------------------------------------------
----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||   store_returns  |                    |     web_sales    ||    web_returns   |
|      (0.03s)     ||      (0.00s)     |                    |      (0.01s)     ||      (0.00s)     |
|      2880404     ||      287867      |                    |      719384      ||       71654      |
----------------------------------------                    ----------------------------------------

<<Query Profiling Information>>
WITH ws AS (SELECT d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp FROM web_sales LEFT JOIN web_returns ON wr_order_number=ws_order_number AND ws_item_sk=wr_item_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE wr_order_number IS NULL GROUP BY d_year, ws_item_sk, ws_bill_customer_sk ), cs AS (SELECT d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp FROM catalog_sales LEFT JOIN catalog_returns ON cr_order_number=cs_order_number AND cs_item_sk=cr_item_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE cr_order_number IS NULL GROUP BY d_year, cs_item_sk, cs_bill_customer_sk ), ss AS (SELECT d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp FROM store_sales LEFT JOIN store_returns ON sr_ticket_number=ss_ticket_number AND ss_item_sk=sr_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE sr_ticket_number IS NULL GROUP BY d_year, ss_item_sk, ss_customer_sk ) SELECT ss_sold_year, ss_item_sk, ss_customer_sk, round((ss_qty*1.00)/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price FROM ss LEFT JOIN ws ON (ws_sold_year=ss_sold_year AND ws_item_sk=ss_item_sk AND ws_customer_sk=ss_customer_sk) LEFT JOIN cs ON (cs_sold_year=ss_sold_year AND cs_item_sk=ss_item_sk AND cs_customer_sk=ss_customer_sk) WHERE (coalesce(ws_qty,0)>0 OR coalesce(cs_qty, 0)>0) AND ss_sold_year=2000 ORDER BY ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty DESC, ss_wc DESC, ss_sp DESC, other_chan_qty, other_chan_wholesale_cost, other_chan_sales_price, ratio LIMIT 100;
<<Timing>>
Total Time: 3.178591s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        223       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        223       |
--------------------
--------------------
|      FILTER      |
|   ss_sold_year   |
|       = 2000     |
|     OR((CASE     |
|   (IS_NOT_NULL   |
|     (ws_qty)     |
|     , ws_qty     |
|     , 0) > 0)    |
| , (CASE(IS_NOT_N |
|    ULL(cs_qty)   |
| , cs_qty, 0) > 0 |
|      (0.07s)     |
|        223       |
--------------------
--------------------
|     HASH_JOIN    |
|       LEFT       |
|  ss_customer_sk  |
|  =cs_customer_sk |
|    ss_item_sk    |
|    =cs_item_sk   |
|   ss_sold_year   |
|   =cs_sold_year  |
|      (0.43s)     |
|      2591390     |
--------------------
--------------------                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                    |   HASH_GROUP_BY  |
|       LEFT       |                                                                                                    |                  |
|  ss_customer_sk  |                                                                                                    |                  |
|  =ws_customer_sk |                                                                                                    |                  |
|    ss_item_sk    |                                                                                                    |                  |
|    =ws_item_sk   |                                                                                                    |                  |
|   ss_sold_year   |                                                                                                    |                  |
|   =ws_sold_year  |                                                                                                    |                  |
|      (0.19s)     |                                                                                                    |      (0.47s)     |
|      2591390     |                                                                                                    |      1297350     |
--------------------                                                                                                    --------------------
--------------------                                        --------------------                                        --------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |
|                  |                                        |                  |                                        |       INNER      |
|                  |                                        |                  |                                        |  cs_sold_date_sk |
|                  |                                        |                  |                                        |    =d_date_sk    |
|      (0.97s)     |                                        |      (0.23s)     |                                        |      (0.08s)     |
|      2591390     |                                        |      647712      |                                        |      1297481     |
--------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                    --------------------
|      FILTER      |                                        |      FILTER      |                                        |      FILTER      |                    |     SEQ_SCAN     |
| IS_NULL(sr_ticke |                                        | IS_NULL(wr_order |                                        | IS_NULL(cr_order |                    |     date_dim     |
|     t_number     |                                        |      _number     |                                        |      _number     |                    |                  |
|      (0.03s)     |                                        |      (0.01s)     |                                        |      (0.01s)     |                    |      (0.00s)     |
|      2592537     |                                        |      647730      |                                        |      1297481     |                    |       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------
--------------------                                        --------------------                                        --------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |
|       INNER      |                                        |       INNER      |                                        |       LEFT       |
|  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |    cs_item_sk    |
|    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =cr_item_sk   |
|                  |                                        |                  |                                        |  cs_order_number |
|                  |                                        |                  |                                        | =cr_order_number |
|      (0.25s)     |                                        |      (0.07s)     |                                        |      (0.08s)     |
|      2880404     |                                        |      719384      |                                        |      1441548     |
--------------------                                        --------------------                                        --------------------
--------------------                    ----------------------------------------                    ------------------------------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|       LEFT       |                    |     date_dim     ||       LEFT       |                    |     date_dim     ||   catalog_sales  ||  catalog_returns |
|    ss_item_sk    |                    |                  ||    ws_item_sk    |                    |                  ||                  ||                  |
|    =sr_item_sk   |                    |                  ||    =wr_item_sk   |                    |                  ||                  ||                  |
| ss_ticket_number |                    |                  ||  ws_order_number |                    |                  ||                  ||                  |
| =sr_ticket_numbe |                    |                  || =wr_order_number |                    |                  ||                  ||                  |
|         r        |                    |                  ||                  |                    |                  ||                  ||                  |
|      (0.17s)     |                    |      (0.00s)     ||      (0.04s)     |                    |      (0.00s)     ||      (0.02s)     ||      (0.00s)     |
|      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      1441548     ||      144067      |
--------------------                    ----------------------------------------                    ------------------------------------------------------------
----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||   store_returns  |                    |     web_sales    ||    web_returns   |
|      (0.03s)     ||      (0.00s)     |                    |      (0.01s)     ||      (0.00s)     |
|      2880404     ||      287867      |                    |      719384      ||       71654      |
----------------------------------------                    ----------------------------------------

<<Query Profiling Information>>
WITH ws AS (SELECT d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp FROM web_sales LEFT JOIN web_returns ON wr_order_number=ws_order_number AND ws_item_sk=wr_item_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE wr_order_number IS NULL GROUP BY d_year, ws_item_sk, ws_bill_customer_sk ), cs AS (SELECT d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp FROM catalog_sales LEFT JOIN catalog_returns ON cr_order_number=cs_order_number AND cs_item_sk=cr_item_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE cr_order_number IS NULL GROUP BY d_year, cs_item_sk, cs_bill_customer_sk ), ss AS (SELECT d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp FROM store_sales LEFT JOIN store_returns ON sr_ticket_number=ss_ticket_number AND ss_item_sk=sr_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE sr_ticket_number IS NULL GROUP BY d_year, ss_item_sk, ss_customer_sk ) SELECT ss_sold_year, ss_item_sk, ss_customer_sk, round((ss_qty*1.00)/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price FROM ss LEFT JOIN ws ON (ws_sold_year=ss_sold_year AND ws_item_sk=ss_item_sk AND ws_customer_sk=ss_customer_sk) LEFT JOIN cs ON (cs_sold_year=ss_sold_year AND cs_item_sk=ss_item_sk AND cs_customer_sk=ss_customer_sk) WHERE (coalesce(ws_qty,0)>0 OR coalesce(cs_qty, 0)>0) AND ss_sold_year=2000 ORDER BY ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty DESC, ss_wc DESC, ss_sp DESC, other_chan_qty, other_chan_wholesale_cost, other_chan_sales_price, ratio LIMIT 100;
<<Timing>>
Total Time: 3.211012s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        223       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        223       |
--------------------
--------------------
|      FILTER      |
|   ss_sold_year   |
|       = 2000     |
|     OR((CASE     |
|   (IS_NOT_NULL   |
|     (ws_qty)     |
|     , ws_qty     |
|     , 0) > 0)    |
| , (CASE(IS_NOT_N |
|    ULL(cs_qty)   |
| , cs_qty, 0) > 0 |
|      (0.07s)     |
|        223       |
--------------------
--------------------
|     HASH_JOIN    |
|       LEFT       |
|  ss_customer_sk  |
|  =cs_customer_sk |
|    ss_item_sk    |
|    =cs_item_sk   |
|   ss_sold_year   |
|   =cs_sold_year  |
|      (0.42s)     |
|      2591390     |
--------------------
--------------------                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                    |   HASH_GROUP_BY  |
|       LEFT       |                                                                                                    |                  |
|  ss_customer_sk  |                                                                                                    |                  |
|  =ws_customer_sk |                                                                                                    |                  |
|    ss_item_sk    |                                                                                                    |                  |
|    =ws_item_sk   |                                                                                                    |                  |
|   ss_sold_year   |                                                                                                    |                  |
|   =ws_sold_year  |                                                                                                    |                  |
|      (0.19s)     |                                                                                                    |      (0.47s)     |
|      2591390     |                                                                                                    |      1297350     |
--------------------                                                                                                    --------------------
--------------------                                        --------------------                                        --------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |
|                  |                                        |                  |                                        |       INNER      |
|                  |                                        |                  |                                        |  cs_sold_date_sk |
|                  |                                        |                  |                                        |    =d_date_sk    |
|      (0.99s)     |                                        |      (0.23s)     |                                        |      (0.08s)     |
|      2591390     |                                        |      647712      |                                        |      1297481     |
--------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                    --------------------
|      FILTER      |                                        |      FILTER      |                                        |      FILTER      |                    |     SEQ_SCAN     |
| IS_NULL(sr_ticke |                                        | IS_NULL(wr_order |                                        | IS_NULL(cr_order |                    |     date_dim     |
|     t_number     |                                        |      _number     |                                        |      _number     |                    |                  |
|      (0.03s)     |                                        |      (0.01s)     |                                        |      (0.01s)     |                    |      (0.00s)     |
|      2592537     |                                        |      647730      |                                        |      1297481     |                    |       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------
--------------------                                        --------------------                                        --------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |
|       INNER      |                                        |       INNER      |                                        |       LEFT       |
|  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |    cs_item_sk    |
|    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =cr_item_sk   |
|                  |                                        |                  |                                        |  cs_order_number |
|                  |                                        |                  |                                        | =cr_order_number |
|      (0.25s)     |                                        |      (0.07s)     |                                        |      (0.08s)     |
|      2880404     |                                        |      719384      |                                        |      1441548     |
--------------------                                        --------------------                                        --------------------
--------------------                    ----------------------------------------                    ------------------------------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|       LEFT       |                    |     date_dim     ||       LEFT       |                    |     date_dim     ||   catalog_sales  ||  catalog_returns |
|    ss_item_sk    |                    |                  ||    ws_item_sk    |                    |                  ||                  ||                  |
|    =sr_item_sk   |                    |                  ||    =wr_item_sk   |                    |                  ||                  ||                  |
| ss_ticket_number |                    |                  ||  ws_order_number |                    |                  ||                  ||                  |
| =sr_ticket_numbe |                    |                  || =wr_order_number |                    |                  ||                  ||                  |
|         r        |                    |                  ||                  |                    |                  ||                  ||                  |
|      (0.17s)     |                    |      (0.00s)     ||      (0.04s)     |                    |      (0.00s)     ||      (0.02s)     ||      (0.00s)     |
|      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      1441548     ||      144067      |
--------------------                    ----------------------------------------                    ------------------------------------------------------------
----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||   store_returns  |                    |     web_sales    ||    web_returns   |
|      (0.03s)     ||      (0.00s)     |                    |      (0.01s)     ||      (0.00s)     |
|      2880404     ||      287867      |                    |      719384      ||       71654      |
----------------------------------------                    ----------------------------------------

<<Query Profiling Information>>
WITH ws AS (SELECT d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp FROM web_sales LEFT JOIN web_returns ON wr_order_number=ws_order_number AND ws_item_sk=wr_item_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE wr_order_number IS NULL GROUP BY d_year, ws_item_sk, ws_bill_customer_sk ), cs AS (SELECT d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp FROM catalog_sales LEFT JOIN catalog_returns ON cr_order_number=cs_order_number AND cs_item_sk=cr_item_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE cr_order_number IS NULL GROUP BY d_year, cs_item_sk, cs_bill_customer_sk ), ss AS (SELECT d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp FROM store_sales LEFT JOIN store_returns ON sr_ticket_number=ss_ticket_number AND ss_item_sk=sr_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE sr_ticket_number IS NULL GROUP BY d_year, ss_item_sk, ss_customer_sk ) SELECT ss_sold_year, ss_item_sk, ss_customer_sk, round((ss_qty*1.00)/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price FROM ss LEFT JOIN ws ON (ws_sold_year=ss_sold_year AND ws_item_sk=ss_item_sk AND ws_customer_sk=ss_customer_sk) LEFT JOIN cs ON (cs_sold_year=ss_sold_year AND cs_item_sk=ss_item_sk AND cs_customer_sk=ss_customer_sk) WHERE (coalesce(ws_qty,0)>0 OR coalesce(cs_qty, 0)>0) AND ss_sold_year=2000 ORDER BY ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty DESC, ss_wc DESC, ss_sp DESC, other_chan_qty, other_chan_wholesale_cost, other_chan_sales_price, ratio LIMIT 100;
<<Timing>>
Total Time: 3.161377s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        223       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        223       |
--------------------
--------------------
|      FILTER      |
|   ss_sold_year   |
|       = 2000     |
|     OR((CASE     |
|   (IS_NOT_NULL   |
|     (ws_qty)     |
|     , ws_qty     |
|     , 0) > 0)    |
| , (CASE(IS_NOT_N |
|    ULL(cs_qty)   |
| , cs_qty, 0) > 0 |
|      (0.07s)     |
|        223       |
--------------------
--------------------
|     HASH_JOIN    |
|       LEFT       |
|  ss_customer_sk  |
|  =cs_customer_sk |
|    ss_item_sk    |
|    =cs_item_sk   |
|   ss_sold_year   |
|   =cs_sold_year  |
|      (0.42s)     |
|      2591390     |
--------------------
--------------------                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                    |   HASH_GROUP_BY  |
|       LEFT       |                                                                                                    |                  |
|  ss_customer_sk  |                                                                                                    |                  |
|  =ws_customer_sk |                                                                                                    |                  |
|    ss_item_sk    |                                                                                                    |                  |
|    =ws_item_sk   |                                                                                                    |                  |
|   ss_sold_year   |                                                                                                    |                  |
|   =ws_sold_year  |                                                                                                    |                  |
|      (0.19s)     |                                                                                                    |      (0.47s)     |
|      2591390     |                                                                                                    |      1297350     |
--------------------                                                                                                    --------------------
--------------------                                        --------------------                                        --------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |     HASH_JOIN    |
|                  |                                        |                  |                                        |       INNER      |
|                  |                                        |                  |                                        |  cs_sold_date_sk |
|                  |                                        |                  |                                        |    =d_date_sk    |
|      (0.97s)     |                                        |      (0.23s)     |                                        |      (0.08s)     |
|      2591390     |                                        |      647712      |                                        |      1297481     |
--------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                    --------------------
|      FILTER      |                                        |      FILTER      |                                        |      FILTER      |                    |     SEQ_SCAN     |
| IS_NULL(sr_ticke |                                        | IS_NULL(wr_order |                                        | IS_NULL(cr_order |                    |     date_dim     |
|     t_number     |                                        |      _number     |                                        |      _number     |                    |                  |
|      (0.03s)     |                                        |      (0.01s)     |                                        |      (0.01s)     |                    |      (0.00s)     |
|      2592537     |                                        |      647730      |                                        |      1297481     |                    |       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------
--------------------                                        --------------------                                        --------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |
|       INNER      |                                        |       INNER      |                                        |       LEFT       |
|  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |    cs_item_sk    |
|    =d_date_sk    |                                        |    =d_date_sk    |                                        |    =cr_item_sk   |
|                  |                                        |                  |                                        |  cs_order_number |
|                  |                                        |                  |                                        | =cr_order_number |
|      (0.25s)     |                                        |      (0.06s)     |                                        |      (0.08s)     |
|      2880404     |                                        |      719384      |                                        |      1441548     |
--------------------                                        --------------------                                        --------------------
--------------------                    ----------------------------------------                    ------------------------------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|       LEFT       |                    |     date_dim     ||       LEFT       |                    |     date_dim     ||   catalog_sales  ||  catalog_returns |
|    ss_item_sk    |                    |                  ||    ws_item_sk    |                    |                  ||                  ||                  |
|    =sr_item_sk   |                    |                  ||    =wr_item_sk   |                    |                  ||                  ||                  |
| ss_ticket_number |                    |                  ||  ws_order_number |                    |                  ||                  ||                  |
| =sr_ticket_numbe |                    |                  || =wr_order_number |                    |                  ||                  ||                  |
|         r        |                    |                  ||                  |                    |                  ||                  ||                  |
|      (0.17s)     |                    |      (0.00s)     ||      (0.04s)     |                    |      (0.00s)     ||      (0.02s)     ||      (0.00s)     |
|      2880404     |                    |       73049      ||      719384      |                    |       73049      ||      1441548     ||      144067      |
--------------------                    ----------------------------------------                    ------------------------------------------------------------
----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||   store_returns  |                    |     web_sales    ||    web_returns   |
|      (0.03s)     ||      (0.00s)     |                    |      (0.01s)     ||      (0.00s)     |
|      2880404     ||      287867      |                    |      719384      ||       71654      |
----------------------------------------                    ----------------------------------------

