<<Query Profiling Information>>
select  s_name,  count(*) as numwait from  supplier,  lineitem l1,  orders,  nation where  s_suppkey = l1.l_suppkey  and o_orderkey = l1.l_orderkey  and o_orderstatus = 'F'  and l1.l_receiptdate > l1.l_commitdate  and exists (  select  *  from  lineitem l2  where  l2.l_orderkey = l1.l_orderkey  and l2.l_suppkey <> l1.l_suppkey  )  and not exists (  select  *  from  lineitem l3  where  l3.l_orderkey = l1.l_orderkey  and l3.l_suppkey <> l1.l_suppkey  and l3.l_receiptdate > l3.l_commitdate  )  and s_nationkey = n_nationkey  and n_name = 'SAUDI ARABIA' group by  s_name order by  numwait desc,  s_name limit 100; 
<<Timing>>
Total Time: 30.296636s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         0        |
--------------------
--------------------
| NESTED_LOOP_JOIN |
|   l_suppkey!=#0  |
|   l_orderkey=#1  |
|      (5.66s)     |
|        310       |
--------------------
--------------------                                                                                --------------------
| NESTED_LOOP_JOIN |                                                                                |   HASH_GROUP_BY  |
|   l_suppkey!=#0  |                                                                                |                  |
|   l_orderkey=#1  |                                                                                |                  |
|     (22.08s)     |                                                                                |      (0.94s)     |
|        518       |                                                                                |      5999989     |
--------------------                                                                                --------------------
--------------------                                                            ----------------------------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  ||     SEQ_SCAN     |
|    s_nationkey   |                                                            |                  ||     lineitem     |
|   =n_nationkey   |                                                            |                  ||                  |
|      (0.03s)     |                                                            |      (0.54s)     ||      (0.21s)     |
|       5729       |                                                            |      3792811     ||      6001215     |
--------------------                                                            ----------------------------------------
--------------------                                        ----------------------------------------
|     HASH_JOIN    |                                        |      FILTER      ||      FILTER      |
|    l_orderkey    |                                        |     n_name =     ||   l_receiptdate  |
|    =o_orderkey   |                                        |    SAUDI ARABIA  ||   > l_commitdate |
|      (0.14s)     |                                        |      (0.00s)     ||      (0.03s)     |
|      117753      |                                        |         1        ||      3793296     |
--------------------                                        ----------------------------------------
--------------------                    ------------------------------------------------------------
|     HASH_JOIN    |                    |      FILTER      ||     SEQ_SCAN     ||     SEQ_SCAN     |
|     s_suppkey    |                    |   o_orderstatus  ||      nation      ||     lineitem     |
|    =l_suppkey    |                    |        = F       ||                  ||                  |
|      (0.36s)     |                    |      (0.01s)     ||      (0.00s)     ||      (0.20s)     |
|      244613      |                    |      729413      ||        25        ||      6001215     |
--------------------                    ------------------------------------------------------------
------------------------------------------------------------
|     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |
|     supplier     ||   l_receiptdate  ||      orders      |
|                  ||   > l_commitdate ||                  |
|      (0.00s)     ||      (0.03s)     ||      (0.01s)     |
|       1024       ||      3793296     ||      1500000     |
------------------------------------------------------------
                    --------------------
                    |     SEQ_SCAN     |
                    |     lineitem     |
                    |      (0.03s)     |
                    |      6001215     |
                    --------------------

