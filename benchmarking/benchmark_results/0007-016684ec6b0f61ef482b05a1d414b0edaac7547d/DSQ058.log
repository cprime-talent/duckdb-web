<<Query Profiling Information>>
WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk FROM web_sales) cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Women' AND i_class = 'maternity' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 12 AND d_year = 1998 ), my_revenue AS (SELECT c_customer_sk, sum(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq+1 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) AND (SELECT DISTINCT d_month_seq+3 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) GROUP BY c_customer_sk), segments AS (SELECT cast((revenue/50) AS int) AS SEGMENT FROM my_revenue) SELECT SEGMENT, count(*) AS num_customers, SEGMENT*50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT, num_customers LIMIT 100;
<<Timing>>
Total Time: 0.416069s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|PIECEWISE_MERGE_JO|
|       INNER      |
|  d_month_seq>=#0 |
|      (0.00s)     |
|        384       |
--------------------
--------------------                                                                                                                                                                                    --------------------
|PIECEWISE_MERGE_JO|                                                                                                                                                                                    |   HASH_GROUP_BY  |
|       INNER      |                                                                                                                                                                                    |                  |
|  d_month_seq<=#0 |                                                                                                                                                                                    |                  |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        384       |                                                                                                                                                                                    |         1        |
--------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                ----------------------------------------
|     HASH_JOIN    |                                                                                                                                                                |   HASH_GROUP_BY  ||    PROJECTION    |
|       INNER      |                                                                                                                                                                |                  ||                  |
|  ss_sold_date_sk |                                                                                                                                                                |                  ||                  |
|    =d_date_sk    |                                                                                                                                                                |                  ||                  |
|      (0.01s)     |                                                                                                                                                                |      (0.00s)     ||      (0.00s)     |
|        540       |                                                                                                                                                                |         1        ||        31        |
--------------------                                                                                                                                                                ----------------------------------------
--------------------                                                                                                                                            ------------------------------------------------------------
|     HASH_JOIN    |                                                                                                                                            |     SEQ_SCAN     ||    PROJECTION    ||      FILTER      |
|       INNER      |                                                                                                                                            |     date_dim     ||                  ||    d_moy = 12    |
| ca_state=s_state |                                                                                                                                            |                  ||                  ||   d_year = 1998  |
|     ca_county    |                                                                                                                                            |                  ||                  ||                  |
|     =s_county    |                                                                                                                                            |                  ||                  ||                  |
|      (0.01s)     |                                                                                                                                            |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|        540       |                                                                                                                                            |       73049      ||        31        ||        31        |
--------------------                                                                                                                                            ------------------------------------------------------------
--------------------                                                                                                                        --------------------                    ----------------------------------------
|     HASH_JOIN    |                                                                                                                        |     SEQ_SCAN     |                    |      FILTER      ||     SEQ_SCAN     |
|       INNER      |                                                                                                                        |       store      |                    |    d_moy = 12    ||     date_dim     |
| c_current_addr_s |                                                                                                                        |                  |                    |   d_year = 1998  ||                  |
|  k=ca_address_sk |                                                                                                                        |                  |                    |                  ||                  |
|      (0.01s)     |                                                                                                                        |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|       42508      |                                                                                                                        |        12        |                    |        31        ||       73049      |
--------------------                                                                                                                        --------------------                    ----------------------------------------
--------------------                                                                                                    --------------------                                        --------------------
|     HASH_JOIN    |                                                                                                    |     SEQ_SCAN     |                                        |     SEQ_SCAN     |
|       INNER      |                                                                                                    | customer_address |                                        |     date_dim     |
|   c_customer_sk  |                                                                                                    |                  |                                        |                  |
|  =ss_customer_sk |                                                                                                    |                  |                                        |                  |
|      (0.27s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |
|       42508      |                                                                                                    |       50000      |                                        |       73049      |
--------------------                                                                                                    --------------------                                        --------------------
--------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |     SEQ_SCAN     |
|                  |                                                                                |    store_sales   |
|      (0.00s)     |                                                                                |      (0.02s)     |
|       1484       |                                                                                |      2880404     |
--------------------                                                                                --------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       1641       |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    customer_sk   |
|  =c_customer_sk  |
|      (0.01s)     |
|       1641       |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     SEQ_SCAN     |
|       INNER      |                                                            |     customer     |
|   sold_date_sk   |                                                            |                  |
|    =d_date_sk    |                                                            |                  |
|      (0.01s)     |                                                            |      (0.00s)     |
|       1641       |                                                            |      100000      |
--------------------                                                            --------------------
--------------------                                        --------------------
|     HASH_JOIN    |                                        |      FILTER      |
|       INNER      |                                        |   d_year = 1998  |
| item_sk=i_item_s |                                        |    d_moy = 12    |
|         k        |                                        |                  |
|      (0.04s)     |                                        |      (0.00s)     |
|       48849      |                                        |        31        |
--------------------                                        --------------------
--------------------                    ----------------------------------------
|       UNION      |                    |      FILTER      ||     SEQ_SCAN     |
|                  |                    |     i_class      ||     date_dim     |
|                  |                    |    = maternity   ||                  |
|                  |                    |    i_category    ||                  |
|                  |                    |      = Women     ||                  |
|      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2160932     |                    |        418       ||       73049      |
--------------------                    ----------------------------------------
------------------------------------------------------------
|    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |
|                  ||                  ||       item       |
|      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|      1441548     ||      719384      ||       18000      |
------------------------------------------------------------
----------------------------------------
|    PROJECTION    ||    PROJECTION    |
|      (0.00s)     ||      (0.00s)     |
|      1441548     ||      719384      |
----------------------------------------
----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |
|   catalog_sales  ||     web_sales    |
|      (0.01s)     ||      (0.00s)     |
|      1441548     ||      719384      |
----------------------------------------

<<Query Profiling Information>>
WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk FROM web_sales) cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Women' AND i_class = 'maternity' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 12 AND d_year = 1998 ), my_revenue AS (SELECT c_customer_sk, sum(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq+1 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) AND (SELECT DISTINCT d_month_seq+3 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) GROUP BY c_customer_sk), segments AS (SELECT cast((revenue/50) AS int) AS SEGMENT FROM my_revenue) SELECT SEGMENT, count(*) AS num_customers, SEGMENT*50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT, num_customers LIMIT 100;
<<Timing>>
Total Time: 0.415263s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|PIECEWISE_MERGE_JO|
|       INNER      |
|  d_month_seq>=#0 |
|      (0.00s)     |
|        384       |
--------------------
--------------------                                                                                                                                                                                    --------------------
|PIECEWISE_MERGE_JO|                                                                                                                                                                                    |   HASH_GROUP_BY  |
|       INNER      |                                                                                                                                                                                    |                  |
|  d_month_seq<=#0 |                                                                                                                                                                                    |                  |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        384       |                                                                                                                                                                                    |         1        |
--------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                ----------------------------------------
|     HASH_JOIN    |                                                                                                                                                                |   HASH_GROUP_BY  ||    PROJECTION    |
|       INNER      |                                                                                                                                                                |                  ||                  |
|  ss_sold_date_sk |                                                                                                                                                                |                  ||                  |
|    =d_date_sk    |                                                                                                                                                                |                  ||                  |
|      (0.01s)     |                                                                                                                                                                |      (0.00s)     ||      (0.00s)     |
|        540       |                                                                                                                                                                |         1        ||        31        |
--------------------                                                                                                                                                                ----------------------------------------
--------------------                                                                                                                                            ------------------------------------------------------------
|     HASH_JOIN    |                                                                                                                                            |     SEQ_SCAN     ||    PROJECTION    ||      FILTER      |
|       INNER      |                                                                                                                                            |     date_dim     ||                  ||    d_moy = 12    |
| ca_state=s_state |                                                                                                                                            |                  ||                  ||   d_year = 1998  |
|     ca_county    |                                                                                                                                            |                  ||                  ||                  |
|     =s_county    |                                                                                                                                            |                  ||                  ||                  |
|      (0.01s)     |                                                                                                                                            |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|        540       |                                                                                                                                            |       73049      ||        31        ||        31        |
--------------------                                                                                                                                            ------------------------------------------------------------
--------------------                                                                                                                        --------------------                    ----------------------------------------
|     HASH_JOIN    |                                                                                                                        |     SEQ_SCAN     |                    |      FILTER      ||     SEQ_SCAN     |
|       INNER      |                                                                                                                        |       store      |                    |    d_moy = 12    ||     date_dim     |
| c_current_addr_s |                                                                                                                        |                  |                    |   d_year = 1998  ||                  |
|  k=ca_address_sk |                                                                                                                        |                  |                    |                  ||                  |
|      (0.01s)     |                                                                                                                        |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|       42508      |                                                                                                                        |        12        |                    |        31        ||       73049      |
--------------------                                                                                                                        --------------------                    ----------------------------------------
--------------------                                                                                                    --------------------                                        --------------------
|     HASH_JOIN    |                                                                                                    |     SEQ_SCAN     |                                        |     SEQ_SCAN     |
|       INNER      |                                                                                                    | customer_address |                                        |     date_dim     |
|   c_customer_sk  |                                                                                                    |                  |                                        |                  |
|  =ss_customer_sk |                                                                                                    |                  |                                        |                  |
|      (0.27s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |
|       42508      |                                                                                                    |       50000      |                                        |       73049      |
--------------------                                                                                                    --------------------                                        --------------------
--------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |     SEQ_SCAN     |
|                  |                                                                                |    store_sales   |
|      (0.00s)     |                                                                                |      (0.02s)     |
|       1484       |                                                                                |      2880404     |
--------------------                                                                                --------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       1641       |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    customer_sk   |
|  =c_customer_sk  |
|      (0.01s)     |
|       1641       |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     SEQ_SCAN     |
|       INNER      |                                                            |     customer     |
|   sold_date_sk   |                                                            |                  |
|    =d_date_sk    |                                                            |                  |
|      (0.02s)     |                                                            |      (0.00s)     |
|       1641       |                                                            |      100000      |
--------------------                                                            --------------------
--------------------                                        --------------------
|     HASH_JOIN    |                                        |      FILTER      |
|       INNER      |                                        |   d_year = 1998  |
| item_sk=i_item_s |                                        |    d_moy = 12    |
|         k        |                                        |                  |
|      (0.04s)     |                                        |      (0.00s)     |
|       48849      |                                        |        31        |
--------------------                                        --------------------
--------------------                    ----------------------------------------
|       UNION      |                    |      FILTER      ||     SEQ_SCAN     |
|                  |                    |     i_class      ||     date_dim     |
|                  |                    |    = maternity   ||                  |
|                  |                    |    i_category    ||                  |
|                  |                    |      = Women     ||                  |
|      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2160932     |                    |        418       ||       73049      |
--------------------                    ----------------------------------------
------------------------------------------------------------
|    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |
|                  ||                  ||       item       |
|      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|      1441548     ||      719384      ||       18000      |
------------------------------------------------------------
----------------------------------------
|    PROJECTION    ||    PROJECTION    |
|      (0.00s)     ||      (0.00s)     |
|      1441548     ||      719384      |
----------------------------------------
----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |
|   catalog_sales  ||     web_sales    |
|      (0.01s)     ||      (0.00s)     |
|      1441548     ||      719384      |
----------------------------------------

<<Query Profiling Information>>
WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk FROM web_sales) cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Women' AND i_class = 'maternity' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 12 AND d_year = 1998 ), my_revenue AS (SELECT c_customer_sk, sum(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq+1 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) AND (SELECT DISTINCT d_month_seq+3 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) GROUP BY c_customer_sk), segments AS (SELECT cast((revenue/50) AS int) AS SEGMENT FROM my_revenue) SELECT SEGMENT, count(*) AS num_customers, SEGMENT*50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT, num_customers LIMIT 100;
<<Timing>>
Total Time: 0.418732s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|PIECEWISE_MERGE_JO|
|       INNER      |
|  d_month_seq>=#0 |
|      (0.00s)     |
|        384       |
--------------------
--------------------                                                                                                                                                                                    --------------------
|PIECEWISE_MERGE_JO|                                                                                                                                                                                    |   HASH_GROUP_BY  |
|       INNER      |                                                                                                                                                                                    |                  |
|  d_month_seq<=#0 |                                                                                                                                                                                    |                  |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        384       |                                                                                                                                                                                    |         1        |
--------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                ----------------------------------------
|     HASH_JOIN    |                                                                                                                                                                |   HASH_GROUP_BY  ||    PROJECTION    |
|       INNER      |                                                                                                                                                                |                  ||                  |
|  ss_sold_date_sk |                                                                                                                                                                |                  ||                  |
|    =d_date_sk    |                                                                                                                                                                |                  ||                  |
|      (0.01s)     |                                                                                                                                                                |      (0.00s)     ||      (0.00s)     |
|        540       |                                                                                                                                                                |         1        ||        31        |
--------------------                                                                                                                                                                ----------------------------------------
--------------------                                                                                                                                            ------------------------------------------------------------
|     HASH_JOIN    |                                                                                                                                            |     SEQ_SCAN     ||    PROJECTION    ||      FILTER      |
|       INNER      |                                                                                                                                            |     date_dim     ||                  ||    d_moy = 12    |
| ca_state=s_state |                                                                                                                                            |                  ||                  ||   d_year = 1998  |
|     ca_county    |                                                                                                                                            |                  ||                  ||                  |
|     =s_county    |                                                                                                                                            |                  ||                  ||                  |
|      (0.01s)     |                                                                                                                                            |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|        540       |                                                                                                                                            |       73049      ||        31        ||        31        |
--------------------                                                                                                                                            ------------------------------------------------------------
--------------------                                                                                                                        --------------------                    ----------------------------------------
|     HASH_JOIN    |                                                                                                                        |     SEQ_SCAN     |                    |      FILTER      ||     SEQ_SCAN     |
|       INNER      |                                                                                                                        |       store      |                    |    d_moy = 12    ||     date_dim     |
| c_current_addr_s |                                                                                                                        |                  |                    |   d_year = 1998  ||                  |
|  k=ca_address_sk |                                                                                                                        |                  |                    |                  ||                  |
|      (0.01s)     |                                                                                                                        |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|       42508      |                                                                                                                        |        12        |                    |        31        ||       73049      |
--------------------                                                                                                                        --------------------                    ----------------------------------------
--------------------                                                                                                    --------------------                                        --------------------
|     HASH_JOIN    |                                                                                                    |     SEQ_SCAN     |                                        |     SEQ_SCAN     |
|       INNER      |                                                                                                    | customer_address |                                        |     date_dim     |
|   c_customer_sk  |                                                                                                    |                  |                                        |                  |
|  =ss_customer_sk |                                                                                                    |                  |                                        |                  |
|      (0.27s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |
|       42508      |                                                                                                    |       50000      |                                        |       73049      |
--------------------                                                                                                    --------------------                                        --------------------
--------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |     SEQ_SCAN     |
|                  |                                                                                |    store_sales   |
|      (0.00s)     |                                                                                |      (0.02s)     |
|       1484       |                                                                                |      2880404     |
--------------------                                                                                --------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       1641       |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    customer_sk   |
|  =c_customer_sk  |
|      (0.01s)     |
|       1641       |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     SEQ_SCAN     |
|       INNER      |                                                            |     customer     |
|   sold_date_sk   |                                                            |                  |
|    =d_date_sk    |                                                            |                  |
|      (0.02s)     |                                                            |      (0.00s)     |
|       1641       |                                                            |      100000      |
--------------------                                                            --------------------
--------------------                                        --------------------
|     HASH_JOIN    |                                        |      FILTER      |
|       INNER      |                                        |   d_year = 1998  |
| item_sk=i_item_s |                                        |    d_moy = 12    |
|         k        |                                        |                  |
|      (0.04s)     |                                        |      (0.00s)     |
|       48849      |                                        |        31        |
--------------------                                        --------------------
--------------------                    ----------------------------------------
|       UNION      |                    |      FILTER      ||     SEQ_SCAN     |
|                  |                    |     i_class      ||     date_dim     |
|                  |                    |    = maternity   ||                  |
|                  |                    |    i_category    ||                  |
|                  |                    |      = Women     ||                  |
|      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2160932     |                    |        418       ||       73049      |
--------------------                    ----------------------------------------
------------------------------------------------------------
|    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |
|                  ||                  ||       item       |
|      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|      1441548     ||      719384      ||       18000      |
------------------------------------------------------------
----------------------------------------
|    PROJECTION    ||    PROJECTION    |
|      (0.00s)     ||      (0.00s)     |
|      1441548     ||      719384      |
----------------------------------------
----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |
|   catalog_sales  ||     web_sales    |
|      (0.01s)     ||      (0.00s)     |
|      1441548     ||      719384      |
----------------------------------------

<<Query Profiling Information>>
WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk FROM web_sales) cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Women' AND i_class = 'maternity' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 12 AND d_year = 1998 ), my_revenue AS (SELECT c_customer_sk, sum(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq+1 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) AND (SELECT DISTINCT d_month_seq+3 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) GROUP BY c_customer_sk), segments AS (SELECT cast((revenue/50) AS int) AS SEGMENT FROM my_revenue) SELECT SEGMENT, count(*) AS num_customers, SEGMENT*50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT, num_customers LIMIT 100;
<<Timing>>
Total Time: 0.417997s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|PIECEWISE_MERGE_JO|
|       INNER      |
|  d_month_seq>=#0 |
|      (0.00s)     |
|        384       |
--------------------
--------------------                                                                                                                                                                                    --------------------
|PIECEWISE_MERGE_JO|                                                                                                                                                                                    |   HASH_GROUP_BY  |
|       INNER      |                                                                                                                                                                                    |                  |
|  d_month_seq<=#0 |                                                                                                                                                                                    |                  |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        384       |                                                                                                                                                                                    |         1        |
--------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                ----------------------------------------
|     HASH_JOIN    |                                                                                                                                                                |   HASH_GROUP_BY  ||    PROJECTION    |
|       INNER      |                                                                                                                                                                |                  ||                  |
|  ss_sold_date_sk |                                                                                                                                                                |                  ||                  |
|    =d_date_sk    |                                                                                                                                                                |                  ||                  |
|      (0.01s)     |                                                                                                                                                                |      (0.00s)     ||      (0.00s)     |
|        540       |                                                                                                                                                                |         1        ||        31        |
--------------------                                                                                                                                                                ----------------------------------------
--------------------                                                                                                                                            ------------------------------------------------------------
|     HASH_JOIN    |                                                                                                                                            |     SEQ_SCAN     ||    PROJECTION    ||      FILTER      |
|       INNER      |                                                                                                                                            |     date_dim     ||                  ||    d_moy = 12    |
| ca_state=s_state |                                                                                                                                            |                  ||                  ||   d_year = 1998  |
|     ca_county    |                                                                                                                                            |                  ||                  ||                  |
|     =s_county    |                                                                                                                                            |                  ||                  ||                  |
|      (0.01s)     |                                                                                                                                            |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|        540       |                                                                                                                                            |       73049      ||        31        ||        31        |
--------------------                                                                                                                                            ------------------------------------------------------------
--------------------                                                                                                                        --------------------                    ----------------------------------------
|     HASH_JOIN    |                                                                                                                        |     SEQ_SCAN     |                    |      FILTER      ||     SEQ_SCAN     |
|       INNER      |                                                                                                                        |       store      |                    |    d_moy = 12    ||     date_dim     |
| c_current_addr_s |                                                                                                                        |                  |                    |   d_year = 1998  ||                  |
|  k=ca_address_sk |                                                                                                                        |                  |                    |                  ||                  |
|      (0.01s)     |                                                                                                                        |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|       42508      |                                                                                                                        |        12        |                    |        31        ||       73049      |
--------------------                                                                                                                        --------------------                    ----------------------------------------
--------------------                                                                                                    --------------------                                        --------------------
|     HASH_JOIN    |                                                                                                    |     SEQ_SCAN     |                                        |     SEQ_SCAN     |
|       INNER      |                                                                                                    | customer_address |                                        |     date_dim     |
|   c_customer_sk  |                                                                                                    |                  |                                        |                  |
|  =ss_customer_sk |                                                                                                    |                  |                                        |                  |
|      (0.27s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |
|       42508      |                                                                                                    |       50000      |                                        |       73049      |
--------------------                                                                                                    --------------------                                        --------------------
--------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |     SEQ_SCAN     |
|                  |                                                                                |    store_sales   |
|      (0.00s)     |                                                                                |      (0.02s)     |
|       1484       |                                                                                |      2880404     |
--------------------                                                                                --------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       1641       |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    customer_sk   |
|  =c_customer_sk  |
|      (0.01s)     |
|       1641       |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     SEQ_SCAN     |
|       INNER      |                                                            |     customer     |
|   sold_date_sk   |                                                            |                  |
|    =d_date_sk    |                                                            |                  |
|      (0.02s)     |                                                            |      (0.00s)     |
|       1641       |                                                            |      100000      |
--------------------                                                            --------------------
--------------------                                        --------------------
|     HASH_JOIN    |                                        |      FILTER      |
|       INNER      |                                        |   d_year = 1998  |
| item_sk=i_item_s |                                        |    d_moy = 12    |
|         k        |                                        |                  |
|      (0.04s)     |                                        |      (0.00s)     |
|       48849      |                                        |        31        |
--------------------                                        --------------------
--------------------                    ----------------------------------------
|       UNION      |                    |      FILTER      ||     SEQ_SCAN     |
|                  |                    |     i_class      ||     date_dim     |
|                  |                    |    = maternity   ||                  |
|                  |                    |    i_category    ||                  |
|                  |                    |      = Women     ||                  |
|      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2160932     |                    |        418       ||       73049      |
--------------------                    ----------------------------------------
------------------------------------------------------------
|    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |
|                  ||                  ||       item       |
|      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|      1441548     ||      719384      ||       18000      |
------------------------------------------------------------
----------------------------------------
|    PROJECTION    ||    PROJECTION    |
|      (0.00s)     ||      (0.00s)     |
|      1441548     ||      719384      |
----------------------------------------
----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |
|   catalog_sales  ||     web_sales    |
|      (0.01s)     ||      (0.00s)     |
|      1441548     ||      719384      |
----------------------------------------

<<Query Profiling Information>>
WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk FROM web_sales) cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Women' AND i_class = 'maternity' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 12 AND d_year = 1998 ), my_revenue AS (SELECT c_customer_sk, sum(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq+1 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) AND (SELECT DISTINCT d_month_seq+3 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) GROUP BY c_customer_sk), segments AS (SELECT cast((revenue/50) AS int) AS SEGMENT FROM my_revenue) SELECT SEGMENT, count(*) AS num_customers, SEGMENT*50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT, num_customers LIMIT 100;
<<Timing>>
Total Time: 0.413777s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|PIECEWISE_MERGE_JO|
|       INNER      |
|  d_month_seq>=#0 |
|      (0.00s)     |
|        384       |
--------------------
--------------------                                                                                                                                                                                    --------------------
|PIECEWISE_MERGE_JO|                                                                                                                                                                                    |   HASH_GROUP_BY  |
|       INNER      |                                                                                                                                                                                    |                  |
|  d_month_seq<=#0 |                                                                                                                                                                                    |                  |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        384       |                                                                                                                                                                                    |         1        |
--------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                ----------------------------------------
|     HASH_JOIN    |                                                                                                                                                                |   HASH_GROUP_BY  ||    PROJECTION    |
|       INNER      |                                                                                                                                                                |                  ||                  |
|  ss_sold_date_sk |                                                                                                                                                                |                  ||                  |
|    =d_date_sk    |                                                                                                                                                                |                  ||                  |
|      (0.01s)     |                                                                                                                                                                |      (0.00s)     ||      (0.00s)     |
|        540       |                                                                                                                                                                |         1        ||        31        |
--------------------                                                                                                                                                                ----------------------------------------
--------------------                                                                                                                                            ------------------------------------------------------------
|     HASH_JOIN    |                                                                                                                                            |     SEQ_SCAN     ||    PROJECTION    ||      FILTER      |
|       INNER      |                                                                                                                                            |     date_dim     ||                  ||    d_moy = 12    |
| ca_state=s_state |                                                                                                                                            |                  ||                  ||   d_year = 1998  |
|     ca_county    |                                                                                                                                            |                  ||                  ||                  |
|     =s_county    |                                                                                                                                            |                  ||                  ||                  |
|      (0.01s)     |                                                                                                                                            |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|        540       |                                                                                                                                            |       73049      ||        31        ||        31        |
--------------------                                                                                                                                            ------------------------------------------------------------
--------------------                                                                                                                        --------------------                    ----------------------------------------
|     HASH_JOIN    |                                                                                                                        |     SEQ_SCAN     |                    |      FILTER      ||     SEQ_SCAN     |
|       INNER      |                                                                                                                        |       store      |                    |    d_moy = 12    ||     date_dim     |
| c_current_addr_s |                                                                                                                        |                  |                    |   d_year = 1998  ||                  |
|  k=ca_address_sk |                                                                                                                        |                  |                    |                  ||                  |
|      (0.01s)     |                                                                                                                        |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|       42508      |                                                                                                                        |        12        |                    |        31        ||       73049      |
--------------------                                                                                                                        --------------------                    ----------------------------------------
--------------------                                                                                                    --------------------                                        --------------------
|     HASH_JOIN    |                                                                                                    |     SEQ_SCAN     |                                        |     SEQ_SCAN     |
|       INNER      |                                                                                                    | customer_address |                                        |     date_dim     |
|   c_customer_sk  |                                                                                                    |                  |                                        |                  |
|  =ss_customer_sk |                                                                                                    |                  |                                        |                  |
|      (0.27s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |
|       42508      |                                                                                                    |       50000      |                                        |       73049      |
--------------------                                                                                                    --------------------                                        --------------------
--------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |     SEQ_SCAN     |
|                  |                                                                                |    store_sales   |
|      (0.00s)     |                                                                                |      (0.02s)     |
|       1484       |                                                                                |      2880404     |
--------------------                                                                                --------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       1641       |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    customer_sk   |
|  =c_customer_sk  |
|      (0.01s)     |
|       1641       |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     SEQ_SCAN     |
|       INNER      |                                                            |     customer     |
|   sold_date_sk   |                                                            |                  |
|    =d_date_sk    |                                                            |                  |
|      (0.01s)     |                                                            |      (0.00s)     |
|       1641       |                                                            |      100000      |
--------------------                                                            --------------------
--------------------                                        --------------------
|     HASH_JOIN    |                                        |      FILTER      |
|       INNER      |                                        |   d_year = 1998  |
| item_sk=i_item_s |                                        |    d_moy = 12    |
|         k        |                                        |                  |
|      (0.04s)     |                                        |      (0.00s)     |
|       48849      |                                        |        31        |
--------------------                                        --------------------
--------------------                    ----------------------------------------
|       UNION      |                    |      FILTER      ||     SEQ_SCAN     |
|                  |                    |     i_class      ||     date_dim     |
|                  |                    |    = maternity   ||                  |
|                  |                    |    i_category    ||                  |
|                  |                    |      = Women     ||                  |
|      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2160932     |                    |        418       ||       73049      |
--------------------                    ----------------------------------------
------------------------------------------------------------
|    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |
|                  ||                  ||       item       |
|      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|      1441548     ||      719384      ||       18000      |
------------------------------------------------------------
----------------------------------------
|    PROJECTION    ||    PROJECTION    |
|      (0.00s)     ||      (0.00s)     |
|      1441548     ||      719384      |
----------------------------------------
----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |
|   catalog_sales  ||     web_sales    |
|      (0.01s)     ||      (0.00s)     |
|      1441548     ||      719384      |
----------------------------------------

