<<Query Profiling Information>>
WITH cross_items AS (SELECT i_item_sk ss_item_sk FROM item, (SELECT iss.i_brand_id brand_id, iss.i_class_id class_id, iss.i_category_id category_id FROM store_sales, item iss, date_dim d1 WHERE ss_item_sk = iss.i_item_sk AND ss_sold_date_sk = d1.d_date_sk AND d1.d_year BETWEEN 1999 AND 1999 + 2 INTERSECT SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales, item ics, date_dim d2 WHERE cs_item_sk = ics.i_item_sk AND cs_sold_date_sk = d2.d_date_sk AND d2.d_year BETWEEN 1999 AND 1999 + 2 INTERSECT SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales, item iws, date_dim d3 WHERE ws_item_sk = iws.i_item_sk AND ws_sold_date_sk = d3.d_date_sk AND d3.d_year BETWEEN 1999 AND 1999 + 2) x WHERE i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id ), avg_sales AS (SELECT avg(quantity*list_price) average_sales FROM (SELECT ss_quantity quantity, ss_list_price list_price FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2 UNION ALL SELECT cs_quantity quantity, cs_list_price list_price FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2 UNION ALL SELECT ws_quantity quantity, ws_list_price list_price FROM web_sales, date_dim WHERE ws_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2) x) SELECT this_year.channel ty_channel, this_year.i_brand_id ty_brand, this_year.i_class_id ty_class, this_year.i_category_id ty_category, this_year.sales ty_sales, this_year.number_sales ty_number_sales, last_year.channel ly_channel, last_year.i_brand_id ly_brand, last_year.i_class_id ly_class, last_year.i_category_id ly_category, last_year.sales ly_sales, last_year.number_sales ly_number_sales FROM (SELECT 'store' channel, i_brand_id, i_class_id, i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales FROM store_sales, item, date_dim WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 + 1 AND d_moy = 12 AND d_dom = 11) GROUP BY i_brand_id, i_class_id, i_category_id HAVING sum(ss_quantity*ss_list_price) > (SELECT average_sales FROM avg_sales)) this_year, (SELECT 'store' channel, i_brand_id, i_class_id, i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales FROM store_sales, item, date_dim WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 AND d_moy = 12 AND d_dom = 11) GROUP BY i_brand_id, i_class_id, i_category_id HAVING sum(ss_quantity*ss_list_price) > (SELECT average_sales FROM avg_sales)) last_year WHERE this_year.i_brand_id= last_year.i_brand_id AND this_year.i_class_id = last_year.i_class_id AND this_year.i_category_id = last_year.i_category_id ORDER BY this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id LIMIT 100;
<<Timing>>
Total Time: 30.338781s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|   i_category_id  |
|  =i_category_id  |
|    i_class_id    |
|    =i_class_id   |
|    i_brand_id    |
|    =i_brand_id   |
|      (0.00s)     |
|         0        |
--------------------
--------------------                                                                                                                                                                                                                                                --------------------
|      FILTER      |                                                                                                                                                                                                                                                |      FILTER      |
|   #4 > SUBQUERY  |                                                                                                                                                                                                                                                |   #4 > SUBQUERY  |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|         0        |                                                                                                                                                                                                                                                |         0        |
--------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                                                                                                                                                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                                                                                                                                                                                |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|         0        |                                                                                                                                                                                                                                                |         0        |
--------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                                                                                                                                                                                                                --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                                                |     HASH_JOIN    |
|       INNER      |                                                                                                                                                                                                                                                |       INNER      |
|  ss_sold_date_sk |                                                                                                                                                                                                                                                |  ss_sold_date_sk |
|    =d_date_sk    |                                                                                                                                                                                                                                                |    =d_date_sk    |
|      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
|         0        |                                                                                                                                                                                                                                                |         0        |
--------------------                                                                                                                                                                                                                                                --------------------
--------------------                                                                                                                                                                                                                            ----------------------------------------                                                                                                                                                                                                                            --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                            |      FILTER      ||     HASH_JOIN    |                                                                                                                                                                                                                            |      FILTER      |
|       INNER      |                                                                                                                                                                                                                            |    d_week_seq    ||       INNER      |                                                                                                                                                                                                                            |    d_week_seq    |
|    ss_item_sk    |                                                                                                                                                                                                                            |     = SUBQUERY   ||    ss_item_sk    |                                                                                                                                                                                                                            |     = SUBQUERY   |
|    =i_item_sk    |                                                                                                                                                                                                                            |                  ||    =i_item_sk    |                                                                                                                                                                                                                            |                  |
|      (0.00s)     |                                                                                                                                                                                                                            |      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                                            |      (0.10s)     |
|         0        |                                                                                                                                                                                                                            |         0        ||         0        |                                                                                                                                                                                                                            |         7        |
--------------------                                                                                                                                                                                                                            ----------------------------------------                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                        ------------------------------------------------------------                                                                                                                                                                                                        ------------------------------------------------------------
|     HASH_JOIN    |                                                                                                                                                                                                        |     SEQ_SCAN     ||     SEQ_SCAN     ||     HASH_JOIN    |                                                                                                                                                                                                        |     SEQ_SCAN     ||     SEQ_SCAN     ||    PROJECTION    |
|       SEMI       |                                                                                                                                                                                                        |       item       ||     date_dim     ||       SEMI       |                                                                                                                                                                                                        |       item       ||     date_dim     ||                  |
|   ss_item_sk=#0  |                                                                                                                                                                                                        |                  ||                  ||   ss_item_sk=#0  |                                                                                                                                                                                                        |                  ||                  ||                  |
|      (0.00s)     |                                                                                                                                                                                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                        |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |
|         0        |                                                                                                                                                                                                        |         0        ||         0        ||         0        |                                                                                                                                                                                                        |         0        ||       62464      ||       61878      |
--------------------                                                                                                                                                                                                        ------------------------------------------------------------                                                                                                                                                                                                        ------------------------------------------------------------
----------------------------------------                                                                                                                                                                                                                            ----------------------------------------                                                                                                                                                                                                                            --------------------
|     SEQ_SCAN     ||    PROJECTION    |                                                                                                                                                                                                                            |     SEQ_SCAN     ||    PROJECTION    |                                                                                                                                                                                                                            |      FILTER      |
|    store_sales   ||                  |                                                                                                                                                                                                                            |    store_sales   ||                  |                                                                                                                                                                                                                            |    d_dom = 11    |
|                  ||                  |                                                                                                                                                                                                                            |                  ||                  |                                                                                                                                                                                                                            |    d_moy = 12    |
|                  ||                  |                                                                                                                                                                                                                            |                  ||                  |                                                                                                                                                                                                                            |   d_year = 1999  |
|      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                                            |      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                                            |     (18.42s)     |
|         0        ||         0        |                                                                                                                                                                                                                            |         0        ||         0        |                                                                                                                                                                                                                            |       61878      |
----------------------------------------                                                                                                                                                                                                                            ----------------------------------------                                                                                                                                                                                                                            --------------------
                    --------------------                                                                                                                                                                                                                                                --------------------                                                                                                                                                                                                                            --------------------
                    |    PROJECTION    |                                                                                                                                                                                                                                                |    PROJECTION    |                                                                                                                                                                                                                            |     SEQ_SCAN     |
                    |                  |                                                                                                                                                                                                                                                |                  |                                                                                                                                                                                                                            |     date_dim     |
                    |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |                                                                                                                                                                                                                            |     (11.45s)     |
                    |         0        |                                                                                                                                                                                                                                                |         0        |                                                                                                                                                                                                                            |    2281071616    |
                    --------------------                                                                                                                                                                                                                                                --------------------                                                                                                                                                                                                                            --------------------
                    --------------------                                                                                                                                                                                                                                                --------------------
                    |   CROSS_PRODUCT  |                                                                                                                                                                                                                                                |   CROSS_PRODUCT  |
                    |      (0.00s)     |                                                                                                                                                                                                                                                |      (0.00s)     |
                    |         0        |                                                                                                                                                                                                                                                |         0        |
                    --------------------                                                                                                                                                                                                                                                --------------------
                    --------------------                                                                                                                                                                --------------------                                                            --------------------                                                                                                                                                                --------------------
                    |     HASH_JOIN    |                                                                                                                                                                |     SEQ_SCAN     |                                                            |     HASH_JOIN    |                                                                                                                                                                |     SEQ_SCAN     |
                    |       SEMI       |                                                                                                                                                                |       item       |                                                            |       SEMI       |                                                                                                                                                                |       item       |
                    |       #0=#0      |                                                                                                                                                                |                  |                                                            |       #0=#0      |                                                                                                                                                                |                  |
                    |       #1=#1      |                                                                                                                                                                |                  |                                                            |       #1=#1      |                                                                                                                                                                |                  |
                    |       #2=#2      |                                                                                                                                                                |                  |                                                            |       #2=#2      |                                                                                                                                                                |                  |
                    |      (0.00s)     |                                                                                                                                                                |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                                                                                |      (0.00s)     |
                    |         0        |                                                                                                                                                                |         0        |                                                            |         0        |                                                                                                                                                                |         0        |
                    --------------------                                                                                                                                                                --------------------                                                            --------------------                                                                                                                                                                --------------------
                    --------------------                                                                                                    --------------------                                                                                                                        --------------------                                                                                                    --------------------
                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                                        |    PROJECTION    |                                                                                                    |    PROJECTION    |
                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                                        |      (0.00s)     |                                                                                                    |      (0.00s)     |
                    |         0        |                                                                                                    |         0        |                                                                                                                        |         0        |                                                                                                    |         0        |
                    --------------------                                                                                                    --------------------                                                                                                                        --------------------                                                                                                    --------------------
                    --------------------                                                                                                    --------------------                                                                                                                        --------------------                                                                                                    --------------------
                    |     HASH_JOIN    |                                                                                                    |    PROJECTION    |                                                                                                                        |     HASH_JOIN    |                                                                                                    |    PROJECTION    |
                    |       SEMI       |                                                                                                    |                  |                                                                                                                        |       SEMI       |                                                                                                    |                  |
                    |       #0=#0      |                                                                                                    |                  |                                                                                                                        |       #0=#0      |                                                                                                    |                  |
                    |       #1=#1      |                                                                                                    |                  |                                                                                                                        |       #1=#1      |                                                                                                    |                  |
                    |       #2=#2      |                                                                                                    |                  |                                                                                                                        |       #2=#2      |                                                                                                    |                  |
                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                                        |      (0.00s)     |                                                                                                    |      (0.00s)     |
                    |         0        |                                                                                                    |         0        |                                                                                                                        |         0        |                                                                                                    |         0        |
                    --------------------                                                                                                    --------------------                                                                                                                        --------------------                                                                                                    --------------------
                    --------------------                                        --------------------                                        --------------------                                                                                                                        --------------------                                        --------------------                                        --------------------
                    |    PROJECTION    |                                        |    PROJECTION    |                                        |      FILTER      |                                                                                                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |      FILTER      |
                    |                  |                                        |                  |                                        |  d_year <= 2001  |                                                                                                                        |                  |                                        |                  |                                        |  d_year <= 2001  |
                    |                  |                                        |                  |                                        |  ws_sold_date_sk |                                                                                                                        |                  |                                        |                  |                                        |  ws_sold_date_sk |
                    |                  |                                        |                  |                                        |    = d_date_sk   |                                                                                                                        |                  |                                        |                  |                                        |    = d_date_sk   |
                    |                  |                                        |                  |                                        |  d_year >= 1999  |                                                                                                                        |                  |                                        |                  |                                        |  d_year >= 1999  |
                    |                  |                                        |                  |                                        |    ws_item_sk    |                                                                                                                        |                  |                                        |                  |                                        |    ws_item_sk    |
                    |                  |                                        |                  |                                        |    = i_item_sk   |                                                                                                                        |                  |                                        |                  |                                        |    = i_item_sk   |
                    |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                                                                                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |
                    |         0        |                                        |         0        |                                        |         0        |                                                                                                                        |         0        |                                        |         0        |                                        |         0        |
                    --------------------                                        --------------------                                        --------------------                                                                                                                        --------------------                                        --------------------                                        --------------------
                    --------------------                                        --------------------                                        --------------------                                                                                                                        --------------------                                        --------------------                                        --------------------
                    |    PROJECTION    |                                        |    PROJECTION    |                                        |   CROSS_PRODUCT  |                                                                                                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |   CROSS_PRODUCT  |
                    |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                                                                                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |
                    |         0        |                                        |         0        |                                        |         0        |                                                                                                                        |         0        |                                        |         0        |                                        |         0        |
                    --------------------                                        --------------------                                        --------------------                                                                                                                        --------------------                                        --------------------                                        --------------------
                    --------------------                                        --------------------                                        --------------------                    --------------------                                                                                --------------------                                        --------------------                                        --------------------                    --------------------
                    |      FILTER      |                                        |      FILTER      |                                        |   CROSS_PRODUCT  |                    |     SEQ_SCAN     |                                                                                |      FILTER      |                                        |      FILTER      |                                        |   CROSS_PRODUCT  |                    |     SEQ_SCAN     |
                    |  d_year <= 2001  |                                        |  d_year <= 2001  |                                        |                  |                    |     date_dim     |                                                                                |  d_year <= 2001  |                                        |  d_year <= 2001  |                                        |                  |                    |     date_dim     |
                    |  ss_sold_date_sk |                                        |  cs_sold_date_sk |                                        |                  |                    |                  |                                                                                |  ss_sold_date_sk |                                        |  cs_sold_date_sk |                                        |                  |                    |                  |
                    |    = d_date_sk   |                                        |    = d_date_sk   |                                        |                  |                    |                  |                                                                                |    = d_date_sk   |                                        |    = d_date_sk   |                                        |                  |                    |                  |
                    |  d_year >= 1999  |                                        |  d_year >= 1999  |                                        |                  |                    |                  |                                                                                |  d_year >= 1999  |                                        |  d_year >= 1999  |                                        |                  |                    |                  |
                    |    ss_item_sk    |                                        |    cs_item_sk    |                                        |                  |                    |                  |                                                                                |    ss_item_sk    |                                        |    cs_item_sk    |                                        |                  |                    |                  |
                    |    = i_item_sk   |                                        |    = i_item_sk   |                                        |                  |                    |                  |                                                                                |    = i_item_sk   |                                        |    = i_item_sk   |                                        |                  |                    |                  |
                    |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                    |      (0.00s)     |                                                                                |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                    |      (0.00s)     |
                    |         0        |                                        |         0        |                                        |         0        |                    |         0        |                                                                                |         0        |                                        |         0        |                                        |         0        |                    |         0        |
                    --------------------                                        --------------------                                        --------------------                    --------------------                                                                                --------------------                                        --------------------                                        --------------------                    --------------------
                    --------------------                                        --------------------                                        ----------------------------------------                                                                                                    --------------------                                        --------------------                                        ----------------------------------------
                    |   CROSS_PRODUCT  |                                        |   CROSS_PRODUCT  |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                    |   CROSS_PRODUCT  |                                        |   CROSS_PRODUCT  |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |
                    |                  |                                        |                  |                                        |     web_sales    ||       item       |                                                                                                    |                  |                                        |                  |                                        |     web_sales    ||       item       |
                    |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |
                    |         0        |                                        |         0        |                                        |         0        ||         0        |                                                                                                    |         0        |                                        |         0        |                                        |         0        ||         0        |
                    --------------------                                        --------------------                                        ----------------------------------------                                                                                                    --------------------                                        --------------------                                        ----------------------------------------
                    --------------------                    ----------------------------------------                    --------------------                                                                                                                                            --------------------                    ----------------------------------------                    --------------------
                    |   CROSS_PRODUCT  |                    |     SEQ_SCAN     ||   CROSS_PRODUCT  |                    |     SEQ_SCAN     |                                                                                                                                            |   CROSS_PRODUCT  |                    |     SEQ_SCAN     ||   CROSS_PRODUCT  |                    |     SEQ_SCAN     |
                    |                  |                    |     date_dim     ||                  |                    |     date_dim     |                                                                                                                                            |                  |                    |     date_dim     ||                  |                    |     date_dim     |
                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |                                                                                                                                            |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |
                    |         0        |                    |         0        ||         0        |                    |         0        |                                                                                                                                            |         0        |                    |         0        ||         0        |                    |         0        |
                    --------------------                    ----------------------------------------                    --------------------                                                                                                                                            --------------------                    ----------------------------------------                    --------------------
                    ----------------------------------------                    ----------------------------------------                                                                                                                                                                ----------------------------------------                    ----------------------------------------
                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
                    |    store_sales   ||       item       |                    |   catalog_sales  ||       item       |                                                                                                                                                                |    store_sales   ||       item       |                    |   catalog_sales  ||       item       |
                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                                                                                                                                                |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
                    |         0        ||         0        |                    |         0        ||         0        |                                                                                                                                                                |         0        ||         0        |                    |         0        ||         0        |
                    ----------------------------------------                    ----------------------------------------                                                                                                                                                                ----------------------------------------                    ----------------------------------------

