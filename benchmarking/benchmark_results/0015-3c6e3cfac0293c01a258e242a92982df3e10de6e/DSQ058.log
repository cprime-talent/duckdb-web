<<Query Profiling Information>>
WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk FROM web_sales) cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Women' AND i_class = 'maternity' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 12 AND d_year = 1998 ), my_revenue AS (SELECT c_customer_sk, sum(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq+1 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) AND (SELECT DISTINCT d_month_seq+3 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) GROUP BY c_customer_sk), segments AS (SELECT cast((revenue/50) AS int) AS SEGMENT FROM my_revenue) SELECT SEGMENT, count(*) AS num_customers, SEGMENT*50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT, num_customers LIMIT 100;
<<Timing>>
Total Time: 30.344257s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (8.07s)     |
|         0        |
--------------------
--------------------
|PIECEWISE_MERGE_JO|
|       INNER      |
|  d_month_seq>=#0 |
|     (21.52s)     |
|     235231190    |
--------------------
--------------------                                                                                                                                                                                    --------------------
|PIECEWISE_MERGE_JO|                                                                                                                                                                                    |   HASH_GROUP_BY  |
|       INNER      |                                                                                                                                                                                    |                  |
|  d_month_seq<=#0 |                                                                                                                                                                                    |                  |
|      (0.02s)     |                                                                                                                                                                                    |      (0.00s)     |
|      194762      |                                                                                                                                                                                    |       2401       |
--------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                ----------------------------------------
|     HASH_JOIN    |                                                                                                                                                                |   HASH_GROUP_BY  ||    PROJECTION    |
|       INNER      |                                                                                                                                                                |                  ||                  |
|  ss_sold_date_sk |                                                                                                                                                                |                  ||                  |
|    =d_date_sk    |                                                                                                                                                                |                  ||                  |
|      (0.01s)     |                                                                                                                                                                |      (0.00s)     ||      (0.00s)     |
|        163       |                                                                                                                                                                |       2401       ||       73049      |
--------------------                                                                                                                                                                ----------------------------------------
--------------------                                                                                                                                            ------------------------------------------------------------
|     HASH_JOIN    |                                                                                                                                            |     SEQ_SCAN     ||    PROJECTION    ||     SEQ_SCAN     |
|       INNER      |                                                                                                                                            |     date_dim     ||                  ||     date_dim     |
| ca_state=s_state |                                                                                                                                            |                  ||                  ||                  |
|     ca_county    |                                                                                                                                            |                  ||                  ||                  |
|     =s_county    |                                                                                                                                            |                  ||                  ||                  |
|      (0.13s)     |                                                                                                                                            |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|        164       |                                                                                                                                            |       73049      ||       73049      ||       73049      |
--------------------                                                                                                                                            ------------------------------------------------------------
--------------------                                                                                                                        --------------------                    --------------------
|     HASH_JOIN    |                                                                                                                        |     SEQ_SCAN     |                    |     SEQ_SCAN     |
|       INNER      |                                                                                                                        |       store      |                    |     date_dim     |
| c_current_addr_s |                                                                                                                        |                  |                    |                  |
|  k=ca_address_sk |                                                                                                                        |                  |                    |                  |
|      (0.08s)     |                                                                                                                        |      (0.00s)     |                    |      (0.00s)     |
|      711764      |                                                                                                                        |        12        |                    |       73049      |
--------------------                                                                                                                        --------------------                    --------------------
--------------------                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                    |     SEQ_SCAN     |
|       INNER      |                                                                                                    | customer_address |
|   c_customer_sk  |                                                                                                    |                  |
|  =ss_customer_sk |                                                                                                    |                  |
|      (0.29s)     |                                                                                                    |      (0.00s)     |
|      711931      |                                                                                                    |       50000      |
--------------------                                                                                                    --------------------
--------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |     SEQ_SCAN     |
|                  |                                                                                |    store_sales   |
|      (0.02s)     |                                                                                |      (0.02s)     |
|       25600      |                                                                                |      2880404     |
--------------------                                                                                --------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       48849      |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    customer_sk   |
|  =c_customer_sk  |
|      (0.04s)     |
|       48849      |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     SEQ_SCAN     |
|       INNER      |                                                            |     customer     |
|   sold_date_sk   |                                                            |                  |
|    =d_date_sk    |                                                            |                  |
|      (0.02s)     |                                                            |      (0.00s)     |
|       48849      |                                                            |      100000      |
--------------------                                                            --------------------
--------------------                                        --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     |
|       INNER      |                                        |     date_dim     |
| item_sk=i_item_s |                                        |                  |
|         k        |                                        |                  |
|      (0.04s)     |                                        |      (0.00s)     |
|       48849      |                                        |       73049      |
--------------------                                        --------------------
--------------------                    --------------------
|       UNION      |                    |      FILTER      |
|                  |                    |     i_class      |
|                  |                    |    = maternity   |
|                  |                    |    i_category    |
|                  |                    |      = Women     |
|      (0.00s)     |                    |      (0.00s)     |
|      2160932     |                    |        418       |
--------------------                    --------------------
------------------------------------------------------------
|    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |
|                  ||                  ||       item       |
|      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|      1441548     ||      719384      ||       18000      |
------------------------------------------------------------
----------------------------------------
|    PROJECTION    ||    PROJECTION    |
|      (0.00s)     ||      (0.00s)     |
|      1441548     ||      719384      |
----------------------------------------
----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |
|   catalog_sales  ||     web_sales    |
|      (0.01s)     ||      (0.00s)     |
|      1441548     ||      719384      |
----------------------------------------

