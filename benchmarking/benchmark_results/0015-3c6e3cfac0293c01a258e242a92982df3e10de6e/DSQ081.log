<<Query Profiling Information>>
WITH ss AS (SELECT s_store_sk, sum(ss_ext_sales_price) AS sales, sum(ss_net_profit) AS profit FROM store_sales, date_dim, store WHERE ss_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND ss_store_sk = s_store_sk GROUP BY s_store_sk) , sr AS (SELECT s_store_sk, sum(sr_return_amt) AS returns_, sum(sr_net_loss) AS profit_loss FROM store_returns, date_dim, store WHERE sr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND sr_store_sk = s_store_sk GROUP BY s_store_sk), cs AS (SELECT cs_call_center_sk, sum(cs_ext_sales_price) AS sales, sum(cs_net_profit) AS profit FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) GROUP BY cs_call_center_sk), cr AS (SELECT cr_call_center_sk, sum(cr_return_amount) AS returns_, sum(cr_net_loss) AS profit_loss FROM catalog_returns, date_dim WHERE cr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) GROUP BY cr_call_center_sk), ws AS (SELECT wp_web_page_sk, sum(ws_ext_sales_price) AS sales, sum(ws_net_profit) AS profit FROM web_sales, date_dim, web_page WHERE ws_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND ws_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk), wr AS (SELECT wp_web_page_sk, sum(wr_return_amt) AS returns_, sum(wr_net_loss) AS profit_loss FROM web_returns, date_dim, web_page WHERE wr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND wr_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk) , results AS (SELECT channel , id , sum(sales) AS sales , sum(returns_) AS returns_ , sum(profit) AS profit FROM (SELECT 'store channel' AS channel , ss.s_store_sk AS id , sales , coalesce(returns_, 0) AS returns_ , (profit - coalesce(profit_loss,0)) AS profit FROM ss LEFT JOIN sr ON ss.s_store_sk = sr.s_store_sk UNION ALL SELECT 'catalog channel' AS channel , cs_call_center_sk AS id , sales , returns_ , (profit - profit_loss) AS profit FROM cs , cr UNION ALL SELECT 'web channel' AS channel , ws.wp_web_page_sk AS id , sales , coalesce(returns_, 0) returns_ , (profit - coalesce(profit_loss,0)) AS profit FROM ws LEFT JOIN wr ON ws.wp_web_page_sk = wr.wp_web_page_sk ) x GROUP BY channel, id) SELECT * FROM ( SELECT channel, id, sales, returns_, profit FROM results UNION SELECT channel, NULL AS id, sum(sales) AS sales, sum(returns_) AS returns_, sum(profit) AS profit FROM results GROUP BY channel UNION SELECT NULL AS channel, NULL AS id, sum(sales) AS sales, sum(returns_) AS returns_, sum(profit) AS profit FROM results) foo ORDER BY channel, id LIMIT 100;
<<Timing>>
Total Time: 2.008702s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|        76        |
--------------------
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        75        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |         1        |
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
|       UNION      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        75        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |         1        |
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                            |    PROJECTION    |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |         3        |                                                                                                                                                                                                                                                                                                            |        72        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |       UNION      |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |         3        |                                                                                                                                                                                                                                                                                                            |        102       |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
|   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |        72        |                                                                                                                                                                                                                                                                                                            |        42        |                                                                                                                                                                                    |        60        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
|       UNION      |                                                                                                                                                                                                                                                                                                            |       UNION      |                                                                                                                                                                                                                                                                                                            |       UNION      |                                                                                                                                                                                    |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        102       |                                                                                                                                                                                                                                                                                                            |        102       |                                                                                                                                                                                                                                                                                                            |        42        |                                                                                                                                                                                    |        60        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |       LEFT       |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |
|        42        |                                                                                                                                                                                    |        60        |                                                                                                    |        42        |                                                                                                                                                                                    |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
|       UNION      |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |       UNION      |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |
|        42        |                                                                                                                                                                                    |        60        |                                                                                                    |        42        |                                                                                                                                                                                    |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
|    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |                                                                                                    |     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |
|                  |                                                                                                    |                  |                                                            |       LEFT       |                                                                                                    |                  |                                                                                                    |                  |                                                            |       LEFT       |                                                                                                    |       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |
|                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |                                                                                                    |    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |
|                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                                                                                    |                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                                                                                    |    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |
--------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    --------------------
|    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |                                        |      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |                                        |         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |                                        |         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        |
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |                                        |       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |
|    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |                                        |    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |                                        |    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |
|    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |                                        |    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |                                        |    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |                                        |      (0.16s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |                                        |         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |                                        |      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------
--------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     ||                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     ||       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |
|                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  ||                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  ||  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |
|                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |
|      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        ||         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        ||      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
--------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |                    |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |                    |    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |
|    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |                    |    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |
|    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |                    |    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |
|      (0.15s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.16s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |                    |      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |                    |      2880404     ||       73049      |                    |      287867      ||       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
--------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------                                                                                                                        --------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |                                                                                                                        |       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |
|  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |                                                                                                                        |  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |
|    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |                                                                                                                        |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |
|      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                                                                                        |      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |                                                                                                                        |      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |
--------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------                                                                                                                        --------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
----------------------------------------                    ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |                                                                                                                                                                                                                            |    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |
|      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                                            |      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2880404     ||       73049      |                    |      287867      ||       73049      |                                                                                                                                                                                                                            |      2880404     ||       73049      |                    |      287867      ||       73049      |
----------------------------------------                    ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------                    ----------------------------------------

<<Query Profiling Information>>
WITH ss AS (SELECT s_store_sk, sum(ss_ext_sales_price) AS sales, sum(ss_net_profit) AS profit FROM store_sales, date_dim, store WHERE ss_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND ss_store_sk = s_store_sk GROUP BY s_store_sk) , sr AS (SELECT s_store_sk, sum(sr_return_amt) AS returns_, sum(sr_net_loss) AS profit_loss FROM store_returns, date_dim, store WHERE sr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND sr_store_sk = s_store_sk GROUP BY s_store_sk), cs AS (SELECT cs_call_center_sk, sum(cs_ext_sales_price) AS sales, sum(cs_net_profit) AS profit FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) GROUP BY cs_call_center_sk), cr AS (SELECT cr_call_center_sk, sum(cr_return_amount) AS returns_, sum(cr_net_loss) AS profit_loss FROM catalog_returns, date_dim WHERE cr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) GROUP BY cr_call_center_sk), ws AS (SELECT wp_web_page_sk, sum(ws_ext_sales_price) AS sales, sum(ws_net_profit) AS profit FROM web_sales, date_dim, web_page WHERE ws_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND ws_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk), wr AS (SELECT wp_web_page_sk, sum(wr_return_amt) AS returns_, sum(wr_net_loss) AS profit_loss FROM web_returns, date_dim, web_page WHERE wr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND wr_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk) , results AS (SELECT channel , id , sum(sales) AS sales , sum(returns_) AS returns_ , sum(profit) AS profit FROM (SELECT 'store channel' AS channel , ss.s_store_sk AS id , sales , coalesce(returns_, 0) AS returns_ , (profit - coalesce(profit_loss,0)) AS profit FROM ss LEFT JOIN sr ON ss.s_store_sk = sr.s_store_sk UNION ALL SELECT 'catalog channel' AS channel , cs_call_center_sk AS id , sales , returns_ , (profit - profit_loss) AS profit FROM cs , cr UNION ALL SELECT 'web channel' AS channel , ws.wp_web_page_sk AS id , sales , coalesce(returns_, 0) returns_ , (profit - coalesce(profit_loss,0)) AS profit FROM ws LEFT JOIN wr ON ws.wp_web_page_sk = wr.wp_web_page_sk ) x GROUP BY channel, id) SELECT * FROM ( SELECT channel, id, sales, returns_, profit FROM results UNION SELECT channel, NULL AS id, sum(sales) AS sales, sum(returns_) AS returns_, sum(profit) AS profit FROM results GROUP BY channel UNION SELECT NULL AS channel, NULL AS id, sum(sales) AS sales, sum(returns_) AS returns_, sum(profit) AS profit FROM results) foo ORDER BY channel, id LIMIT 100;
<<Timing>>
Total Time: 1.988954s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|        76        |
--------------------
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        75        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |         1        |
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
|       UNION      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        75        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |         1        |
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                            |    PROJECTION    |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |         3        |                                                                                                                                                                                                                                                                                                            |        72        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |       UNION      |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |         3        |                                                                                                                                                                                                                                                                                                            |        102       |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
|   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |        72        |                                                                                                                                                                                                                                                                                                            |        42        |                                                                                                                                                                                    |        60        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
|       UNION      |                                                                                                                                                                                                                                                                                                            |       UNION      |                                                                                                                                                                                                                                                                                                            |       UNION      |                                                                                                                                                                                    |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        102       |                                                                                                                                                                                                                                                                                                            |        102       |                                                                                                                                                                                                                                                                                                            |        42        |                                                                                                                                                                                    |        60        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |       LEFT       |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |
|        42        |                                                                                                                                                                                    |        60        |                                                                                                    |        42        |                                                                                                                                                                                    |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
|       UNION      |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |       UNION      |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |
|        42        |                                                                                                                                                                                    |        60        |                                                                                                    |        42        |                                                                                                                                                                                    |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
|    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |                                                                                                    |     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |
|                  |                                                                                                    |                  |                                                            |       LEFT       |                                                                                                    |                  |                                                                                                    |                  |                                                            |       LEFT       |                                                                                                    |       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |
|                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |                                                                                                    |    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |
|                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                                                                                    |                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                                                                                    |    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |
--------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    --------------------
|    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |                                        |      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |                                        |         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |                                        |         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        |
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |                                        |       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |
|    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |                                        |    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |                                        |    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |
|    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |                                        |    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |                                        |    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |                                        |      (0.15s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |                                        |         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |                                        |      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------
--------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     ||                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     ||       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |
|                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  ||                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  ||  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |
|                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |
|      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        ||         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        ||      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
--------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |                    |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |                    |    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |
|    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |                    |    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |
|    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |                    |    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |
|      (0.16s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.15s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |                    |      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |                    |      2880404     ||       73049      |                    |      287867      ||       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
--------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------                                                                                                                        --------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |                                                                                                                        |       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |
|  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |                                                                                                                        |  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |
|    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |                                                                                                                        |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |
|      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                                                                                        |      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |                                                                                                                        |      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |
--------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------                                                                                                                        --------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
----------------------------------------                    ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |                                                                                                                                                                                                                            |    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |
|      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                                            |      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2880404     ||       73049      |                    |      287867      ||       73049      |                                                                                                                                                                                                                            |      2880404     ||       73049      |                    |      287867      ||       73049      |
----------------------------------------                    ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------                    ----------------------------------------

<<Query Profiling Information>>
WITH ss AS (SELECT s_store_sk, sum(ss_ext_sales_price) AS sales, sum(ss_net_profit) AS profit FROM store_sales, date_dim, store WHERE ss_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND ss_store_sk = s_store_sk GROUP BY s_store_sk) , sr AS (SELECT s_store_sk, sum(sr_return_amt) AS returns_, sum(sr_net_loss) AS profit_loss FROM store_returns, date_dim, store WHERE sr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND sr_store_sk = s_store_sk GROUP BY s_store_sk), cs AS (SELECT cs_call_center_sk, sum(cs_ext_sales_price) AS sales, sum(cs_net_profit) AS profit FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) GROUP BY cs_call_center_sk), cr AS (SELECT cr_call_center_sk, sum(cr_return_amount) AS returns_, sum(cr_net_loss) AS profit_loss FROM catalog_returns, date_dim WHERE cr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) GROUP BY cr_call_center_sk), ws AS (SELECT wp_web_page_sk, sum(ws_ext_sales_price) AS sales, sum(ws_net_profit) AS profit FROM web_sales, date_dim, web_page WHERE ws_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND ws_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk), wr AS (SELECT wp_web_page_sk, sum(wr_return_amt) AS returns_, sum(wr_net_loss) AS profit_loss FROM web_returns, date_dim, web_page WHERE wr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND wr_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk) , results AS (SELECT channel , id , sum(sales) AS sales , sum(returns_) AS returns_ , sum(profit) AS profit FROM (SELECT 'store channel' AS channel , ss.s_store_sk AS id , sales , coalesce(returns_, 0) AS returns_ , (profit - coalesce(profit_loss,0)) AS profit FROM ss LEFT JOIN sr ON ss.s_store_sk = sr.s_store_sk UNION ALL SELECT 'catalog channel' AS channel , cs_call_center_sk AS id , sales , returns_ , (profit - profit_loss) AS profit FROM cs , cr UNION ALL SELECT 'web channel' AS channel , ws.wp_web_page_sk AS id , sales , coalesce(returns_, 0) returns_ , (profit - coalesce(profit_loss,0)) AS profit FROM ws LEFT JOIN wr ON ws.wp_web_page_sk = wr.wp_web_page_sk ) x GROUP BY channel, id) SELECT * FROM ( SELECT channel, id, sales, returns_, profit FROM results UNION SELECT channel, NULL AS id, sum(sales) AS sales, sum(returns_) AS returns_, sum(profit) AS profit FROM results GROUP BY channel UNION SELECT NULL AS channel, NULL AS id, sum(sales) AS sales, sum(returns_) AS returns_, sum(profit) AS profit FROM results) foo ORDER BY channel, id LIMIT 100;
<<Timing>>
Total Time: 1.993335s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|        76        |
--------------------
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        75        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |         1        |
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
|       UNION      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        75        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |         1        |
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                            |    PROJECTION    |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |         3        |                                                                                                                                                                                                                                                                                                            |        72        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |       UNION      |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |         3        |                                                                                                                                                                                                                                                                                                            |        102       |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
|   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |        72        |                                                                                                                                                                                                                                                                                                            |        42        |                                                                                                                                                                                    |        60        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
|       UNION      |                                                                                                                                                                                                                                                                                                            |       UNION      |                                                                                                                                                                                                                                                                                                            |       UNION      |                                                                                                                                                                                    |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        102       |                                                                                                                                                                                                                                                                                                            |        102       |                                                                                                                                                                                                                                                                                                            |        42        |                                                                                                                                                                                    |        60        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |       LEFT       |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |
|        42        |                                                                                                                                                                                    |        60        |                                                                                                    |        42        |                                                                                                                                                                                    |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
|       UNION      |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |       UNION      |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |
|        42        |                                                                                                                                                                                    |        60        |                                                                                                    |        42        |                                                                                                                                                                                    |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
|    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |                                                                                                    |     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |
|                  |                                                                                                    |                  |                                                            |       LEFT       |                                                                                                    |                  |                                                                                                    |                  |                                                            |       LEFT       |                                                                                                    |       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |
|                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |                                                                                                    |    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |
|                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                                                                                    |                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                                                                                    |    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |
--------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    --------------------
|    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |                                        |      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |                                        |         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |                                        |         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        |
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |                                        |       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |
|    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |                                        |    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |                                        |    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |
|    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |                                        |    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |                                        |    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |                                        |      (0.15s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |                                        |         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |                                        |      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------
--------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     ||                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     ||       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |
|                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  ||                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  ||  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |
|                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |
|      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        ||         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        ||      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
--------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |                    |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |                    |    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |
|    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |                    |    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |
|    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |                    |    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |
|      (0.16s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.15s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |                    |      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |                    |      2880404     ||       73049      |                    |      287867      ||       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
--------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------                                                                                                                        --------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |                                                                                                                        |       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |
|  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |                                                                                                                        |  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |
|    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |                                                                                                                        |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |
|      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                                                                                        |      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |                                                                                                                        |      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |
--------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------                                                                                                                        --------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
----------------------------------------                    ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |                                                                                                                                                                                                                            |    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |
|      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                                            |      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2880404     ||       73049      |                    |      287867      ||       73049      |                                                                                                                                                                                                                            |      2880404     ||       73049      |                    |      287867      ||       73049      |
----------------------------------------                    ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------                    ----------------------------------------

<<Query Profiling Information>>
WITH ss AS (SELECT s_store_sk, sum(ss_ext_sales_price) AS sales, sum(ss_net_profit) AS profit FROM store_sales, date_dim, store WHERE ss_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND ss_store_sk = s_store_sk GROUP BY s_store_sk) , sr AS (SELECT s_store_sk, sum(sr_return_amt) AS returns_, sum(sr_net_loss) AS profit_loss FROM store_returns, date_dim, store WHERE sr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND sr_store_sk = s_store_sk GROUP BY s_store_sk), cs AS (SELECT cs_call_center_sk, sum(cs_ext_sales_price) AS sales, sum(cs_net_profit) AS profit FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) GROUP BY cs_call_center_sk), cr AS (SELECT cr_call_center_sk, sum(cr_return_amount) AS returns_, sum(cr_net_loss) AS profit_loss FROM catalog_returns, date_dim WHERE cr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) GROUP BY cr_call_center_sk), ws AS (SELECT wp_web_page_sk, sum(ws_ext_sales_price) AS sales, sum(ws_net_profit) AS profit FROM web_sales, date_dim, web_page WHERE ws_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND ws_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk), wr AS (SELECT wp_web_page_sk, sum(wr_return_amt) AS returns_, sum(wr_net_loss) AS profit_loss FROM web_returns, date_dim, web_page WHERE wr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND wr_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk) , results AS (SELECT channel , id , sum(sales) AS sales , sum(returns_) AS returns_ , sum(profit) AS profit FROM (SELECT 'store channel' AS channel , ss.s_store_sk AS id , sales , coalesce(returns_, 0) AS returns_ , (profit - coalesce(profit_loss,0)) AS profit FROM ss LEFT JOIN sr ON ss.s_store_sk = sr.s_store_sk UNION ALL SELECT 'catalog channel' AS channel , cs_call_center_sk AS id , sales , returns_ , (profit - profit_loss) AS profit FROM cs , cr UNION ALL SELECT 'web channel' AS channel , ws.wp_web_page_sk AS id , sales , coalesce(returns_, 0) returns_ , (profit - coalesce(profit_loss,0)) AS profit FROM ws LEFT JOIN wr ON ws.wp_web_page_sk = wr.wp_web_page_sk ) x GROUP BY channel, id) SELECT * FROM ( SELECT channel, id, sales, returns_, profit FROM results UNION SELECT channel, NULL AS id, sum(sales) AS sales, sum(returns_) AS returns_, sum(profit) AS profit FROM results GROUP BY channel UNION SELECT NULL AS channel, NULL AS id, sum(sales) AS sales, sum(returns_) AS returns_, sum(profit) AS profit FROM results) foo ORDER BY channel, id LIMIT 100;
<<Timing>>
Total Time: 1.993989s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|        76        |
--------------------
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        75        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |         1        |
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
|       UNION      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        75        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |         1        |
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                            |    PROJECTION    |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |         3        |                                                                                                                                                                                                                                                                                                            |        72        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |       UNION      |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |         3        |                                                                                                                                                                                                                                                                                                            |        102       |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
|   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |        72        |                                                                                                                                                                                                                                                                                                            |        42        |                                                                                                                                                                                    |        60        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
|       UNION      |                                                                                                                                                                                                                                                                                                            |       UNION      |                                                                                                                                                                                                                                                                                                            |       UNION      |                                                                                                                                                                                    |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        102       |                                                                                                                                                                                                                                                                                                            |        102       |                                                                                                                                                                                                                                                                                                            |        42        |                                                                                                                                                                                    |        60        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |       LEFT       |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |
|        42        |                                                                                                                                                                                    |        60        |                                                                                                    |        42        |                                                                                                                                                                                    |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
|       UNION      |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |       UNION      |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |
|        42        |                                                                                                                                                                                    |        60        |                                                                                                    |        42        |                                                                                                                                                                                    |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
|    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |                                                                                                    |     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |
|                  |                                                                                                    |                  |                                                            |       LEFT       |                                                                                                    |                  |                                                                                                    |                  |                                                            |       LEFT       |                                                                                                    |       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |
|                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |                                                                                                    |    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |
|                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                                                                                    |                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                                                                                    |    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |
--------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    --------------------
|    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |                                        |      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |                                        |         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |                                        |         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        |
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |                                        |       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |
|    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |                                        |    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |                                        |    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |
|    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |                                        |    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |                                        |    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |                                        |      (0.15s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |                                        |         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |                                        |      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------
--------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     ||                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     ||       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |
|                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  ||                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  ||  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |
|                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |
|      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        ||         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        ||      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
--------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |                    |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |                    |    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |
|    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |                    |    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |
|    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |                    |    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |
|      (0.16s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.15s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |                    |      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |                    |      2880404     ||       73049      |                    |      287867      ||       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
--------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------                                                                                                                        --------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |                                                                                                                        |       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |
|  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |                                                                                                                        |  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |
|    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |                                                                                                                        |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |
|      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                                                                                        |      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |                                                                                                                        |      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |
--------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------                                                                                                                        --------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
----------------------------------------                    ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |                                                                                                                                                                                                                            |    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |
|      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                                            |      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2880404     ||       73049      |                    |      287867      ||       73049      |                                                                                                                                                                                                                            |      2880404     ||       73049      |                    |      287867      ||       73049      |
----------------------------------------                    ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------                    ----------------------------------------

<<Query Profiling Information>>
WITH ss AS (SELECT s_store_sk, sum(ss_ext_sales_price) AS sales, sum(ss_net_profit) AS profit FROM store_sales, date_dim, store WHERE ss_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND ss_store_sk = s_store_sk GROUP BY s_store_sk) , sr AS (SELECT s_store_sk, sum(sr_return_amt) AS returns_, sum(sr_net_loss) AS profit_loss FROM store_returns, date_dim, store WHERE sr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND sr_store_sk = s_store_sk GROUP BY s_store_sk), cs AS (SELECT cs_call_center_sk, sum(cs_ext_sales_price) AS sales, sum(cs_net_profit) AS profit FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) GROUP BY cs_call_center_sk), cr AS (SELECT cr_call_center_sk, sum(cr_return_amount) AS returns_, sum(cr_net_loss) AS profit_loss FROM catalog_returns, date_dim WHERE cr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) GROUP BY cr_call_center_sk), ws AS (SELECT wp_web_page_sk, sum(ws_ext_sales_price) AS sales, sum(ws_net_profit) AS profit FROM web_sales, date_dim, web_page WHERE ws_sold_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND ws_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk), wr AS (SELECT wp_web_page_sk, sum(wr_return_amt) AS returns_, sum(wr_net_loss) AS profit_loss FROM web_returns, date_dim, web_page WHERE wr_returned_date_sk = d_date_sk AND d_date BETWEEN cast('2000-08-23' AS date) AND cast('2000-09-22' AS date) AND wr_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk) , results AS (SELECT channel , id , sum(sales) AS sales , sum(returns_) AS returns_ , sum(profit) AS profit FROM (SELECT 'store channel' AS channel , ss.s_store_sk AS id , sales , coalesce(returns_, 0) AS returns_ , (profit - coalesce(profit_loss,0)) AS profit FROM ss LEFT JOIN sr ON ss.s_store_sk = sr.s_store_sk UNION ALL SELECT 'catalog channel' AS channel , cs_call_center_sk AS id , sales , returns_ , (profit - profit_loss) AS profit FROM cs , cr UNION ALL SELECT 'web channel' AS channel , ws.wp_web_page_sk AS id , sales , coalesce(returns_, 0) returns_ , (profit - coalesce(profit_loss,0)) AS profit FROM ws LEFT JOIN wr ON ws.wp_web_page_sk = wr.wp_web_page_sk ) x GROUP BY channel, id) SELECT * FROM ( SELECT channel, id, sales, returns_, profit FROM results UNION SELECT channel, NULL AS id, sum(sales) AS sales, sum(returns_) AS returns_, sum(profit) AS profit FROM results GROUP BY channel UNION SELECT NULL AS channel, NULL AS id, sum(sales) AS sales, sum(returns_) AS returns_, sum(profit) AS profit FROM results) foo ORDER BY channel, id LIMIT 100;
<<Timing>>
Total Time: 1.994866s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        76        |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|        76        |
--------------------
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        75        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |         1        |
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
|       UNION      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        75        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |         1        |
--------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                            |    PROJECTION    |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |         3        |                                                                                                                                                                                                                                                                                                            |        72        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |       UNION      |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |         3        |                                                                                                                                                                                                                                                                                                            |        102       |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
|   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |   HASH_GROUP_BY  |                                                                                                                                                                                                                                                                                                            |    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        72        |                                                                                                                                                                                                                                                                                                            |        72        |                                                                                                                                                                                                                                                                                                            |        42        |                                                                                                                                                                                    |        60        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
|       UNION      |                                                                                                                                                                                                                                                                                                            |       UNION      |                                                                                                                                                                                                                                                                                                            |       UNION      |                                                                                                                                                                                    |    PROJECTION    |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |
|        102       |                                                                                                                                                                                                                                                                                                            |        102       |                                                                                                                                                                                                                                                                                                            |        42        |                                                                                                                                                                                    |        60        |
--------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                                                                                                                                            --------------------                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------
|    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |       LEFT       |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |
|                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |
|        42        |                                                                                                                                                                                    |        60        |                                                                                                    |        42        |                                                                                                                                                                                    |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
|       UNION      |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |       UNION      |                                                                                                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |
|        42        |                                                                                                                                                                                    |        60        |                                                                                                    |        42        |                                                                                                                                                                                    |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |
--------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
|    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |                                                                                                    |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |     HASH_JOIN    |                                                                                                    |     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |
|                  |                                                                                                    |                  |                                                            |       LEFT       |                                                                                                    |                  |                                                                                                    |                  |                                                            |       LEFT       |                                                                                                    |       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |
|                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |                                                                                                    |                  |                                                                                                    |                  |                                                            |  wp_web_page_sk  |                                                                                                    |    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |
|                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                                                                                    |                  |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                                                                                    |    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |        60        |                                                                                                    |         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |
--------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                                                                                    --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    --------------------
|    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |    PROJECTION    |                                                                                                    |    PROJECTION    |                                                            |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  |
|                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                                                                                    |                  |                                                            |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.03s)     |                                        |      (0.00s)     |                                        |      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |                                        |         6        |                                                                                                    |        36        |                                                            |        60        |                                        |        60        |                                        |         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        |
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    --------------------
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                                                                                    |   CROSS_PRODUCT  |                                                            |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |                                        |       LEFT       |                                                                                                    |                  |                                                            |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |
|    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |                                        |    s_store_sk    |                                                                                                    |                  |                                                            |  ws_web_page_sk  |                                        |  wr_web_page_sk  |                                        |    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |
|    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |                                        |    =s_store_sk   |                                                                                                    |                  |                                                            |  =wp_web_page_sk |                                        |  =wp_web_page_sk |                                        |    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                            |      (0.04s)     |                                        |      (0.00s)     |                                        |      (0.15s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |                                        |         6        |                                                                                                    |        36        |                                                            |      719384      |                                        |       71654      |                                        |      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |
--------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                                                                                    --------------------                                                            --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------
--------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     ||                  |                                        |                  |                                        |                  |                    |                  |                    |       INNER      |                    |     web_page     ||       INNER      |                    |     web_page     ||       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |
|                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  ||                  |                                        |                  |                                        |                  |                    |                  |                    |  ws_sold_date_sk |                    |                  || wr_returned_date |                    |                  ||  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |
|                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  |                                        |                  |                                        |                  |                    |                  |                    |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |
|      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.11s)     |                                        |      (0.01s)     |                                        |      (0.05s)     |                    |      (0.01s)     |                    |      (0.03s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        ||         6        |                                        |         6        |                                        |         6        |                    |         6        |                    |      719384      |                    |        60        ||       71654      |                    |        60        ||      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                                        --------------------                                        --------------------                    --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
--------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
|     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     HASH_JOIN    |                                        |     HASH_JOIN    |                                        |     HASH_JOIN    |                    |     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |                    |       INNER      |                                        |       INNER      |                                        |       INNER      |                    |       INNER      |                    |     web_sales    ||     date_dim     |                    |    web_returns   ||     date_dim     |                    |    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |
|    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |                    |    ss_store_sk   |                                        |    sr_store_sk   |                                        |  cs_sold_date_sk |                    | cr_returned_date |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |
|    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |                    |    =s_store_sk   |                                        |    =s_store_sk   |                                        |    =d_date_sk    |                    |   _sk=d_date_sk  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |                    |                  ||                  |
|      (0.16s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.15s)     |                                        |      (0.02s)     |                                        |      (0.04s)     |                    |      (0.01s)     |                    |      (0.01s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |                    |      2880404     |                                        |      287867      |                                        |      1441548     |                    |      144067      |                    |      719384      ||       73049      |                    |       71654      ||       73049      |                    |      2880404     ||       73049      |                    |      287867      ||       73049      |
--------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    --------------------                                        --------------------                                        --------------------                    --------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
--------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------                                                                                                                        --------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                        |     HASH_JOIN    |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |                                                                                                                        |       INNER      |                    |       store      ||       INNER      |                    |       store      ||   catalog_sales  ||     date_dim     ||  catalog_returns ||     date_dim     |
|  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |                                                                                                                        |  ss_sold_date_sk |                    |                  || sr_returned_date |                    |                  ||                  ||                  ||                  ||                  |
|    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |                                                                                                                        |    =d_date_sk    |                    |                  ||   _sk=d_date_sk  |                    |                  ||                  ||                  ||                  ||                  |
|      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                                                                                        |      (0.09s)     |                    |      (0.00s)     ||      (0.02s)     |                    |      (0.00s)     ||      (0.01s)     ||      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
|      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |                                                                                                                        |      2880404     |                    |        12        ||      287867      |                    |        12        ||      1441548     ||       73049      ||      144067      ||       73049      |
--------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------                                                                                                                        --------------------                    ----------------------------------------                    ----------------------------------------------------------------------------------------------------
----------------------------------------                    ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                                                                                                                                                                                                                            |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |                                                                                                                                                                                                                            |    store_sales   ||     date_dim     |                    |   store_returns  ||     date_dim     |
|      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                                                                                                                                                                                                            |      (0.02s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      2880404     ||       73049      |                    |      287867      ||       73049      |                                                                                                                                                                                                                            |      2880404     ||       73049      |                    |      287867      ||       73049      |
----------------------------------------                    ----------------------------------------                                                                                                                                                                                                                            ----------------------------------------                    ----------------------------------------

