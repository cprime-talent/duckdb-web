<<Query Profiling Information>>
WITH ss AS (SELECT i_item_id, sum(ss_ext_sales_price) total_sales FROM store_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category ='Music') AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), cs AS (SELECT i_item_id, sum(cs_ext_sales_price) total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category ='Music') AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), ws AS (SELECT i_item_id, sum(ws_ext_sales_price) total_sales FROM web_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category = 'Music') AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id) SELECT i_item_id, sum(total_sales) total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100;
<<Timing>>
Total Time: 0.176564s
<<Operator Tree>>
--------------------
|       PRUNE      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.01s)     |
|       1024       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|       1729       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       3743       |
--------------------
--------------------                                                                                --------------------
|    PROJECTION    |                                                                                |       UNION      |
|      (0.00s)     |                                                                                |      (0.00s)     |
|       1631       |                                                                                |       2112       |
--------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                                                |    PROJECTION    |
|      (0.00s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       1631       |                                                                                |       1277       |                                                                                |        835       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                                                |   HASH_GROUP_BY  |
|       SEMI       |                                                                                |                  |                                                                                |                  |
|   i_item_id=#0   |                                                                                |                  |                                                                                |                  |
|      (0.02s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       4780       |                                                                                |       1277       |                                                                                |        835       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                            ----------------------------------------                                                                                --------------------
|     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                                                |     HASH_JOIN    |
|       INNER      |                                                            |                  ||       SEMI       |                                                                                |       SEMI       |
|    ss_item_sk    |                                                            |                  ||   i_item_id=#0   |                                                                                |   i_item_id=#0   |
|    =i_item_sk    |                                                            |                  ||                  |                                                                                |                  |
|      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.01s)     |
|       24499      |                                                            |       1863       ||       2286       |                                                                                |       1148       |
--------------------                                                            ----------------------------------------                                                                                --------------------
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                            |    PROJECTION    |
|       INNER      |                                        |       item       ||    i_category    ||       INNER      |                                                            |                  ||       INNER      |                                                            |                  |
|    ss_addr_sk    |                                        |                  ||      = Music     ||    cs_item_sk    |                                                            |                  ||    ws_item_sk    |                                                            |                  |
|  =ca_address_sk  |                                        |                  ||                  ||    =i_item_sk    |                                                            |                  ||    =i_item_sk    |                                                            |                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|       24499      |                                        |       18000      ||       1863       ||       11921      |                                                            |       1863       ||       6120       |                                                            |       1863       |
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
|     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      |
|       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                                        |       item       ||    i_category    ||       INNER      |                                        |       item       ||    i_category    |
|  ss_sold_date_sk |                    |    = -5.000000   |                    |                  ||  cs_bill_addr_sk |                                        |                  ||      = Music     ||  ws_bill_addr_sk |                                        |                  ||      = Music     |
|    =d_date_sk    |                    |                  |                    |                  ||  =ca_address_sk  |                                        |                  ||                  ||  =ca_address_sk  |                                        |                  ||                  |
|      (0.04s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |
|       65349      |                    |       18832      |                    |       18000      ||       11921      |                                        |       18000      ||       1863       ||       6120       |                                        |       18000      ||       1863       |
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
|     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     |
|    store_sales   ||     d_moy = 9    || customer_address |                                        |       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                    |   ca_gmt_offset  |                    |       item       |
|                  ||   d_year = 1998  ||                  |                                        |  cs_sold_date_sk |                    |    = -5.000000   |                    |                  ||  ws_sold_date_sk |                    |    = -5.000000   |                    |                  |
|                  ||                  ||                  |                                        |    =d_date_sk    |                    |                  |                    |                  ||    =d_date_sk    |                    |                  |                    |                  |
|      (0.02s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |                    |      (0.00s)     |
|      2880404     ||        30        ||       50000      |                                        |       30985      |                    |       18832      |                    |       18000      ||       15635      |                    |       18832      |                    |       18000      |
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                    |     SEQ_SCAN     |                                                            |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |
                    |     date_dim     |                                                            |   catalog_sales  ||     d_moy = 9    || customer_address |                                        |     web_sales    ||     d_moy = 9    || customer_address |
                    |                  |                                                            |                  ||   d_year = 1998  ||                  |                                        |                  ||   d_year = 1998  ||                  |
                    |      (0.00s)     |                                                            |      (0.01s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                    |       73049      |                                                            |      1441548     ||        30        ||       50000      |                                        |      719384      ||        30        ||       50000      |
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                                                                                                                        --------------------                                                                                --------------------
                                                                                                                        |     SEQ_SCAN     |                                                                                |     SEQ_SCAN     |
                                                                                                                        |     date_dim     |                                                                                |     date_dim     |
                                                                                                                        |      (0.00s)     |                                                                                |      (0.00s)     |
                                                                                                                        |       73049      |                                                                                |       73049      |
                                                                                                                        --------------------                                                                                --------------------

<<Query Profiling Information>>
WITH ss AS (SELECT i_item_id, sum(ss_ext_sales_price) total_sales FROM store_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category ='Music') AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), cs AS (SELECT i_item_id, sum(cs_ext_sales_price) total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category ='Music') AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), ws AS (SELECT i_item_id, sum(ws_ext_sales_price) total_sales FROM web_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category = 'Music') AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id) SELECT i_item_id, sum(total_sales) total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100;
<<Timing>>
Total Time: 0.176252s
<<Operator Tree>>
--------------------
|       PRUNE      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.01s)     |
|       1024       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|       1729       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       3743       |
--------------------
--------------------                                                                                --------------------
|    PROJECTION    |                                                                                |       UNION      |
|      (0.00s)     |                                                                                |      (0.00s)     |
|       1631       |                                                                                |       2112       |
--------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                                                |    PROJECTION    |
|      (0.00s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       1631       |                                                                                |       1277       |                                                                                |        835       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                                                |   HASH_GROUP_BY  |
|       SEMI       |                                                                                |                  |                                                                                |                  |
|   i_item_id=#0   |                                                                                |                  |                                                                                |                  |
|      (0.02s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       4780       |                                                                                |       1277       |                                                                                |        835       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                            ----------------------------------------                                                                                --------------------
|     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                                                |     HASH_JOIN    |
|       INNER      |                                                            |                  ||       SEMI       |                                                                                |       SEMI       |
|    ss_item_sk    |                                                            |                  ||   i_item_id=#0   |                                                                                |   i_item_id=#0   |
|    =i_item_sk    |                                                            |                  ||                  |                                                                                |                  |
|      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.01s)     |
|       24499      |                                                            |       1863       ||       2286       |                                                                                |       1148       |
--------------------                                                            ----------------------------------------                                                                                --------------------
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                            |    PROJECTION    |
|       INNER      |                                        |       item       ||    i_category    ||       INNER      |                                                            |                  ||       INNER      |                                                            |                  |
|    ss_addr_sk    |                                        |                  ||      = Music     ||    cs_item_sk    |                                                            |                  ||    ws_item_sk    |                                                            |                  |
|  =ca_address_sk  |                                        |                  ||                  ||    =i_item_sk    |                                                            |                  ||    =i_item_sk    |                                                            |                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|       24499      |                                        |       18000      ||       1863       ||       11921      |                                                            |       1863       ||       6120       |                                                            |       1863       |
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
|     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      |
|       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                                        |       item       ||    i_category    ||       INNER      |                                        |       item       ||    i_category    |
|  ss_sold_date_sk |                    |    = -5.000000   |                    |                  ||  cs_bill_addr_sk |                                        |                  ||      = Music     ||  ws_bill_addr_sk |                                        |                  ||      = Music     |
|    =d_date_sk    |                    |                  |                    |                  ||  =ca_address_sk  |                                        |                  ||                  ||  =ca_address_sk  |                                        |                  ||                  |
|      (0.04s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |
|       65349      |                    |       18832      |                    |       18000      ||       11921      |                                        |       18000      ||       1863       ||       6120       |                                        |       18000      ||       1863       |
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
|     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     |
|    store_sales   ||     d_moy = 9    || customer_address |                                        |       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                    |   ca_gmt_offset  |                    |       item       |
|                  ||   d_year = 1998  ||                  |                                        |  cs_sold_date_sk |                    |    = -5.000000   |                    |                  ||  ws_sold_date_sk |                    |    = -5.000000   |                    |                  |
|                  ||                  ||                  |                                        |    =d_date_sk    |                    |                  |                    |                  ||    =d_date_sk    |                    |                  |                    |                  |
|      (0.02s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |                    |      (0.00s)     |
|      2880404     ||        30        ||       50000      |                                        |       30985      |                    |       18832      |                    |       18000      ||       15635      |                    |       18832      |                    |       18000      |
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                    |     SEQ_SCAN     |                                                            |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |
                    |     date_dim     |                                                            |   catalog_sales  ||     d_moy = 9    || customer_address |                                        |     web_sales    ||     d_moy = 9    || customer_address |
                    |                  |                                                            |                  ||   d_year = 1998  ||                  |                                        |                  ||   d_year = 1998  ||                  |
                    |      (0.00s)     |                                                            |      (0.01s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                    |       73049      |                                                            |      1441548     ||        30        ||       50000      |                                        |      719384      ||        30        ||       50000      |
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                                                                                                                        --------------------                                                                                --------------------
                                                                                                                        |     SEQ_SCAN     |                                                                                |     SEQ_SCAN     |
                                                                                                                        |     date_dim     |                                                                                |     date_dim     |
                                                                                                                        |      (0.00s)     |                                                                                |      (0.00s)     |
                                                                                                                        |       73049      |                                                                                |       73049      |
                                                                                                                        --------------------                                                                                --------------------

<<Query Profiling Information>>
WITH ss AS (SELECT i_item_id, sum(ss_ext_sales_price) total_sales FROM store_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category ='Music') AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), cs AS (SELECT i_item_id, sum(cs_ext_sales_price) total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category ='Music') AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), ws AS (SELECT i_item_id, sum(ws_ext_sales_price) total_sales FROM web_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category = 'Music') AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id) SELECT i_item_id, sum(total_sales) total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100;
<<Timing>>
Total Time: 0.175836s
<<Operator Tree>>
--------------------
|       PRUNE      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.01s)     |
|       1024       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|       1729       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       3743       |
--------------------
--------------------                                                                                --------------------
|    PROJECTION    |                                                                                |       UNION      |
|      (0.00s)     |                                                                                |      (0.00s)     |
|       1631       |                                                                                |       2112       |
--------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                                                |    PROJECTION    |
|      (0.00s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       1631       |                                                                                |       1277       |                                                                                |        835       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                                                |   HASH_GROUP_BY  |
|       SEMI       |                                                                                |                  |                                                                                |                  |
|   i_item_id=#0   |                                                                                |                  |                                                                                |                  |
|      (0.02s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       4780       |                                                                                |       1277       |                                                                                |        835       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                            ----------------------------------------                                                                                --------------------
|     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                                                |     HASH_JOIN    |
|       INNER      |                                                            |                  ||       SEMI       |                                                                                |       SEMI       |
|    ss_item_sk    |                                                            |                  ||   i_item_id=#0   |                                                                                |   i_item_id=#0   |
|    =i_item_sk    |                                                            |                  ||                  |                                                                                |                  |
|      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.01s)     |
|       24499      |                                                            |       1863       ||       2286       |                                                                                |       1148       |
--------------------                                                            ----------------------------------------                                                                                --------------------
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                            |    PROJECTION    |
|       INNER      |                                        |       item       ||    i_category    ||       INNER      |                                                            |                  ||       INNER      |                                                            |                  |
|    ss_addr_sk    |                                        |                  ||      = Music     ||    cs_item_sk    |                                                            |                  ||    ws_item_sk    |                                                            |                  |
|  =ca_address_sk  |                                        |                  ||                  ||    =i_item_sk    |                                                            |                  ||    =i_item_sk    |                                                            |                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|       24499      |                                        |       18000      ||       1863       ||       11921      |                                                            |       1863       ||       6120       |                                                            |       1863       |
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
|     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      |
|       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                                        |       item       ||    i_category    ||       INNER      |                                        |       item       ||    i_category    |
|  ss_sold_date_sk |                    |    = -5.000000   |                    |                  ||  cs_bill_addr_sk |                                        |                  ||      = Music     ||  ws_bill_addr_sk |                                        |                  ||      = Music     |
|    =d_date_sk    |                    |                  |                    |                  ||  =ca_address_sk  |                                        |                  ||                  ||  =ca_address_sk  |                                        |                  ||                  |
|      (0.04s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |
|       65349      |                    |       18832      |                    |       18000      ||       11921      |                                        |       18000      ||       1863       ||       6120       |                                        |       18000      ||       1863       |
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
|     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     |
|    store_sales   ||     d_moy = 9    || customer_address |                                        |       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                    |   ca_gmt_offset  |                    |       item       |
|                  ||   d_year = 1998  ||                  |                                        |  cs_sold_date_sk |                    |    = -5.000000   |                    |                  ||  ws_sold_date_sk |                    |    = -5.000000   |                    |                  |
|                  ||                  ||                  |                                        |    =d_date_sk    |                    |                  |                    |                  ||    =d_date_sk    |                    |                  |                    |                  |
|      (0.02s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |                    |      (0.00s)     |
|      2880404     ||        30        ||       50000      |                                        |       30985      |                    |       18832      |                    |       18000      ||       15635      |                    |       18832      |                    |       18000      |
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                    |     SEQ_SCAN     |                                                            |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |
                    |     date_dim     |                                                            |   catalog_sales  ||     d_moy = 9    || customer_address |                                        |     web_sales    ||     d_moy = 9    || customer_address |
                    |                  |                                                            |                  ||   d_year = 1998  ||                  |                                        |                  ||   d_year = 1998  ||                  |
                    |      (0.00s)     |                                                            |      (0.01s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                    |       73049      |                                                            |      1441548     ||        30        ||       50000      |                                        |      719384      ||        30        ||       50000      |
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                                                                                                                        --------------------                                                                                --------------------
                                                                                                                        |     SEQ_SCAN     |                                                                                |     SEQ_SCAN     |
                                                                                                                        |     date_dim     |                                                                                |     date_dim     |
                                                                                                                        |      (0.00s)     |                                                                                |      (0.00s)     |
                                                                                                                        |       73049      |                                                                                |       73049      |
                                                                                                                        --------------------                                                                                --------------------

<<Query Profiling Information>>
WITH ss AS (SELECT i_item_id, sum(ss_ext_sales_price) total_sales FROM store_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category ='Music') AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), cs AS (SELECT i_item_id, sum(cs_ext_sales_price) total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category ='Music') AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), ws AS (SELECT i_item_id, sum(ws_ext_sales_price) total_sales FROM web_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category = 'Music') AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id) SELECT i_item_id, sum(total_sales) total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100;
<<Timing>>
Total Time: 0.175275s
<<Operator Tree>>
--------------------
|       PRUNE      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.01s)     |
|       1024       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|       1729       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       3743       |
--------------------
--------------------                                                                                --------------------
|    PROJECTION    |                                                                                |       UNION      |
|      (0.00s)     |                                                                                |      (0.00s)     |
|       1631       |                                                                                |       2112       |
--------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                                                |    PROJECTION    |
|      (0.00s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       1631       |                                                                                |       1277       |                                                                                |        835       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                                                |   HASH_GROUP_BY  |
|       SEMI       |                                                                                |                  |                                                                                |                  |
|   i_item_id=#0   |                                                                                |                  |                                                                                |                  |
|      (0.02s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       4780       |                                                                                |       1277       |                                                                                |        835       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                            ----------------------------------------                                                                                --------------------
|     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                                                |     HASH_JOIN    |
|       INNER      |                                                            |                  ||       SEMI       |                                                                                |       SEMI       |
|    ss_item_sk    |                                                            |                  ||   i_item_id=#0   |                                                                                |   i_item_id=#0   |
|    =i_item_sk    |                                                            |                  ||                  |                                                                                |                  |
|      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.01s)     |
|       24499      |                                                            |       1863       ||       2286       |                                                                                |       1148       |
--------------------                                                            ----------------------------------------                                                                                --------------------
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                            |    PROJECTION    |
|       INNER      |                                        |       item       ||    i_category    ||       INNER      |                                                            |                  ||       INNER      |                                                            |                  |
|    ss_addr_sk    |                                        |                  ||      = Music     ||    cs_item_sk    |                                                            |                  ||    ws_item_sk    |                                                            |                  |
|  =ca_address_sk  |                                        |                  ||                  ||    =i_item_sk    |                                                            |                  ||    =i_item_sk    |                                                            |                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|       24499      |                                        |       18000      ||       1863       ||       11921      |                                                            |       1863       ||       6120       |                                                            |       1863       |
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
|     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      |
|       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                                        |       item       ||    i_category    ||       INNER      |                                        |       item       ||    i_category    |
|  ss_sold_date_sk |                    |    = -5.000000   |                    |                  ||  cs_bill_addr_sk |                                        |                  ||      = Music     ||  ws_bill_addr_sk |                                        |                  ||      = Music     |
|    =d_date_sk    |                    |                  |                    |                  ||  =ca_address_sk  |                                        |                  ||                  ||  =ca_address_sk  |                                        |                  ||                  |
|      (0.04s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |
|       65349      |                    |       18832      |                    |       18000      ||       11921      |                                        |       18000      ||       1863       ||       6120       |                                        |       18000      ||       1863       |
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
|     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     |
|    store_sales   ||     d_moy = 9    || customer_address |                                        |       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                    |   ca_gmt_offset  |                    |       item       |
|                  ||   d_year = 1998  ||                  |                                        |  cs_sold_date_sk |                    |    = -5.000000   |                    |                  ||  ws_sold_date_sk |                    |    = -5.000000   |                    |                  |
|                  ||                  ||                  |                                        |    =d_date_sk    |                    |                  |                    |                  ||    =d_date_sk    |                    |                  |                    |                  |
|      (0.02s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |                    |      (0.00s)     |
|      2880404     ||        30        ||       50000      |                                        |       30985      |                    |       18832      |                    |       18000      ||       15635      |                    |       18832      |                    |       18000      |
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                    |     SEQ_SCAN     |                                                            |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |
                    |     date_dim     |                                                            |   catalog_sales  ||     d_moy = 9    || customer_address |                                        |     web_sales    ||     d_moy = 9    || customer_address |
                    |                  |                                                            |                  ||   d_year = 1998  ||                  |                                        |                  ||   d_year = 1998  ||                  |
                    |      (0.00s)     |                                                            |      (0.01s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                    |       73049      |                                                            |      1441548     ||        30        ||       50000      |                                        |      719384      ||        30        ||       50000      |
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                                                                                                                        --------------------                                                                                --------------------
                                                                                                                        |     SEQ_SCAN     |                                                                                |     SEQ_SCAN     |
                                                                                                                        |     date_dim     |                                                                                |     date_dim     |
                                                                                                                        |      (0.00s)     |                                                                                |      (0.00s)     |
                                                                                                                        |       73049      |                                                                                |       73049      |
                                                                                                                        --------------------                                                                                --------------------

<<Query Profiling Information>>
WITH ss AS (SELECT i_item_id, sum(ss_ext_sales_price) total_sales FROM store_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category ='Music') AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), cs AS (SELECT i_item_id, sum(cs_ext_sales_price) total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category ='Music') AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), ws AS (SELECT i_item_id, sum(ws_ext_sales_price) total_sales FROM web_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category = 'Music') AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id) SELECT i_item_id, sum(total_sales) total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100;
<<Timing>>
Total Time: 0.176888s
<<Operator Tree>>
--------------------
|       PRUNE      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.01s)     |
|       1024       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|       1729       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       3743       |
--------------------
--------------------                                                                                --------------------
|    PROJECTION    |                                                                                |       UNION      |
|      (0.00s)     |                                                                                |      (0.00s)     |
|       1631       |                                                                                |       2112       |
--------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                                                |    PROJECTION    |
|      (0.00s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       1631       |                                                                                |       1277       |                                                                                |        835       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                                                |   HASH_GROUP_BY  |
|       SEMI       |                                                                                |                  |                                                                                |                  |
|   i_item_id=#0   |                                                                                |                  |                                                                                |                  |
|      (0.02s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       4780       |                                                                                |       1277       |                                                                                |        835       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                            ----------------------------------------                                                                                --------------------
|     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                                                |     HASH_JOIN    |
|       INNER      |                                                            |                  ||       SEMI       |                                                                                |       SEMI       |
|    ss_item_sk    |                                                            |                  ||   i_item_id=#0   |                                                                                |   i_item_id=#0   |
|    =i_item_sk    |                                                            |                  ||                  |                                                                                |                  |
|      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.01s)     |
|       24499      |                                                            |       1863       ||       2286       |                                                                                |       1148       |
--------------------                                                            ----------------------------------------                                                                                --------------------
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                            |    PROJECTION    |
|       INNER      |                                        |       item       ||    i_category    ||       INNER      |                                                            |                  ||       INNER      |                                                            |                  |
|    ss_addr_sk    |                                        |                  ||      = Music     ||    cs_item_sk    |                                                            |                  ||    ws_item_sk    |                                                            |                  |
|  =ca_address_sk  |                                        |                  ||                  ||    =i_item_sk    |                                                            |                  ||    =i_item_sk    |                                                            |                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|       24499      |                                        |       18000      ||       1863       ||       11921      |                                                            |       1863       ||       6120       |                                                            |       1863       |
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
|     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      |
|       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                                        |       item       ||    i_category    ||       INNER      |                                        |       item       ||    i_category    |
|  ss_sold_date_sk |                    |    = -5.000000   |                    |                  ||  cs_bill_addr_sk |                                        |                  ||      = Music     ||  ws_bill_addr_sk |                                        |                  ||      = Music     |
|    =d_date_sk    |                    |                  |                    |                  ||  =ca_address_sk  |                                        |                  ||                  ||  =ca_address_sk  |                                        |                  ||                  |
|      (0.04s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |
|       65349      |                    |       18832      |                    |       18000      ||       11921      |                                        |       18000      ||       1863       ||       6120       |                                        |       18000      ||       1863       |
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
|     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     |
|    store_sales   ||     d_moy = 9    || customer_address |                                        |       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                    |   ca_gmt_offset  |                    |       item       |
|                  ||   d_year = 1998  ||                  |                                        |  cs_sold_date_sk |                    |    = -5.000000   |                    |                  ||  ws_sold_date_sk |                    |    = -5.000000   |                    |                  |
|                  ||                  ||                  |                                        |    =d_date_sk    |                    |                  |                    |                  ||    =d_date_sk    |                    |                  |                    |                  |
|      (0.02s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |                    |      (0.00s)     |
|      2880404     ||        30        ||       50000      |                                        |       30985      |                    |       18832      |                    |       18000      ||       15635      |                    |       18832      |                    |       18000      |
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                    |     SEQ_SCAN     |                                                            |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |
                    |     date_dim     |                                                            |   catalog_sales  ||     d_moy = 9    || customer_address |                                        |     web_sales    ||     d_moy = 9    || customer_address |
                    |                  |                                                            |                  ||   d_year = 1998  ||                  |                                        |                  ||   d_year = 1998  ||                  |
                    |      (0.00s)     |                                                            |      (0.01s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                    |       73049      |                                                            |      1441548     ||        30        ||       50000      |                                        |      719384      ||        30        ||       50000      |
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                                                                                                                        --------------------                                                                                --------------------
                                                                                                                        |     SEQ_SCAN     |                                                                                |     SEQ_SCAN     |
                                                                                                                        |     date_dim     |                                                                                |     date_dim     |
                                                                                                                        |      (0.00s)     |                                                                                |      (0.00s)     |
                                                                                                                        |       73049      |                                                                                |       73049      |
                                                                                                                        --------------------                                                                                --------------------

