<<Query Profiling Information>>
WITH wss AS (SELECT d_week_seq, ss_store_sk, sum(CASE WHEN (d_day_name='Sunday') THEN ss_sales_price ELSE NULL END) sun_sales, sum(CASE WHEN (d_day_name='Monday') THEN ss_sales_price ELSE NULL END) mon_sales, sum(CASE WHEN (d_day_name='Tuesday') THEN ss_sales_price ELSE NULL END) tue_sales, sum(CASE WHEN (d_day_name='Wednesday') THEN ss_sales_price ELSE NULL END) wed_sales, sum(CASE WHEN (d_day_name='Thursday') THEN ss_sales_price ELSE NULL END) thu_sales, sum(CASE WHEN (d_day_name='Friday') THEN ss_sales_price ELSE NULL END) fri_sales, sum(CASE WHEN (d_day_name='Saturday') THEN ss_sales_price ELSE NULL END) sat_sales FROM store_sales, date_dim WHERE d_date_sk = ss_sold_date_sk GROUP BY d_week_seq, ss_store_sk) SELECT s_store_name1, s_store_id1, d_week_seq1, sun_sales1/sun_sales2, mon_sales1/mon_sales2, tue_sales1/tue_sales2, wed_sales1/wed_sales2, thu_sales1/thu_sales2, fri_sales1/fri_sales2, sat_sales1/sat_sales2 FROM (SELECT s_store_name s_store_name1, wss.d_week_seq d_week_seq1, s_store_id s_store_id1, sun_sales sun_sales1, mon_sales mon_sales1, tue_sales tue_sales1, wed_sales wed_sales1, thu_sales thu_sales1, fri_sales fri_sales1, sat_sales sat_sales1 FROM wss, store, date_dim d WHERE d.d_week_seq = wss.d_week_seq AND ss_store_sk = s_store_sk AND d_month_seq BETWEEN 1212 AND 1212 + 11) y, (SELECT s_store_name s_store_name2, wss.d_week_seq d_week_seq2, s_store_id s_store_id2, sun_sales sun_sales2, mon_sales mon_sales2, tue_sales tue_sales2, wed_sales wed_sales2, thu_sales thu_sales2, fri_sales fri_sales2, sat_sales sat_sales2 FROM wss, store, date_dim d WHERE d.d_week_seq = wss.d_week_seq AND ss_store_sk = s_store_sk AND d_month_seq BETWEEN 1212 + 12 AND 1212 + 23) x WHERE s_store_id1=s_store_id2 AND d_week_seq1=d_week_seq2-52 ORDER BY s_store_name1, s_store_id1, d_week_seq1 LIMIT 100;
<<Timing>>
Total Time: 1.037948s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.12s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       13104      |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    d_week_seq    |
|   1=(d_week_seq  |
|      2 - 52      |
|    s_store_id    |
|   1=s_store_id2  |
|      (0.00s)     |
|       13104      |
--------------------
--------------------                                                            --------------------
|    PROJECTION    |                                                            |    PROJECTION    |
|      (0.00s)     |                                                            |      (0.00s)     |
|       2190       |                                                            |       2190       |
--------------------                                                            --------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|    d_week_seq    |                                                            |    d_week_seq    |
|    =d_week_seq   |                                                            |    =d_week_seq   |
|      (0.00s)     |                                                            |      (0.00s)     |
|       2190       |                                                            |       2190       |
--------------------                                                            --------------------
--------------------                                        ----------------------------------------                                        --------------------
|     HASH_JOIN    |                                        |      FILTER      ||     HASH_JOIN    |                                        |      FILTER      |
|       INNER      |                                        |    d_month_seq   ||       INNER      |                                        |    d_month_seq   |
|    ss_store_sk   |                                        |      <= 1223     ||    ss_store_sk   |                                        |      <= 1235     |
|    =s_store_sk   |                                        |    d_month_seq   ||    =s_store_sk   |                                        |    d_month_seq   |
|                  |                                        |      >= 1212     ||                  |                                        |      >= 1224     |
|      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     |
|       1572       |                                        |        365       ||       1572       |                                        |        365       |
--------------------                                        ----------------------------------------                                        --------------------
--------------------                    ------------------------------------------------------------                    ----------------------------------------
|   HASH_GROUP_BY  |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||   HASH_GROUP_BY  |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|                  |                    |       store      ||     date_dim     ||                  |                    |       store      ||     date_dim     |
|      (0.35s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.36s)     |                    |      (0.00s)     ||      (0.00s)     |
|       1572       |                    |        12        ||       73049      ||       1572       |                    |        12        ||       73049      |
--------------------                    ------------------------------------------------------------                    ----------------------------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|  ss_sold_date_sk |                                                            |  ss_sold_date_sk |
|    =d_date_sk    |                                                            |    =d_date_sk    |
|      (0.09s)     |                                                            |      (0.09s)     |
|      2880404     |                                                            |      2880404     |
--------------------                                                            --------------------
----------------------------------------                                        ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||     date_dim     |                                        |    store_sales   ||     date_dim     |
|      (0.01s)     ||      (0.00s)     |                                        |      (0.01s)     ||      (0.00s)     |
|      2880404     ||       73049      |                                        |      2880404     ||       73049      |
----------------------------------------                                        ----------------------------------------

<<Query Profiling Information>>
WITH wss AS (SELECT d_week_seq, ss_store_sk, sum(CASE WHEN (d_day_name='Sunday') THEN ss_sales_price ELSE NULL END) sun_sales, sum(CASE WHEN (d_day_name='Monday') THEN ss_sales_price ELSE NULL END) mon_sales, sum(CASE WHEN (d_day_name='Tuesday') THEN ss_sales_price ELSE NULL END) tue_sales, sum(CASE WHEN (d_day_name='Wednesday') THEN ss_sales_price ELSE NULL END) wed_sales, sum(CASE WHEN (d_day_name='Thursday') THEN ss_sales_price ELSE NULL END) thu_sales, sum(CASE WHEN (d_day_name='Friday') THEN ss_sales_price ELSE NULL END) fri_sales, sum(CASE WHEN (d_day_name='Saturday') THEN ss_sales_price ELSE NULL END) sat_sales FROM store_sales, date_dim WHERE d_date_sk = ss_sold_date_sk GROUP BY d_week_seq, ss_store_sk) SELECT s_store_name1, s_store_id1, d_week_seq1, sun_sales1/sun_sales2, mon_sales1/mon_sales2, tue_sales1/tue_sales2, wed_sales1/wed_sales2, thu_sales1/thu_sales2, fri_sales1/fri_sales2, sat_sales1/sat_sales2 FROM (SELECT s_store_name s_store_name1, wss.d_week_seq d_week_seq1, s_store_id s_store_id1, sun_sales sun_sales1, mon_sales mon_sales1, tue_sales tue_sales1, wed_sales wed_sales1, thu_sales thu_sales1, fri_sales fri_sales1, sat_sales sat_sales1 FROM wss, store, date_dim d WHERE d.d_week_seq = wss.d_week_seq AND ss_store_sk = s_store_sk AND d_month_seq BETWEEN 1212 AND 1212 + 11) y, (SELECT s_store_name s_store_name2, wss.d_week_seq d_week_seq2, s_store_id s_store_id2, sun_sales sun_sales2, mon_sales mon_sales2, tue_sales tue_sales2, wed_sales wed_sales2, thu_sales thu_sales2, fri_sales fri_sales2, sat_sales sat_sales2 FROM wss, store, date_dim d WHERE d.d_week_seq = wss.d_week_seq AND ss_store_sk = s_store_sk AND d_month_seq BETWEEN 1212 + 12 AND 1212 + 23) x WHERE s_store_id1=s_store_id2 AND d_week_seq1=d_week_seq2-52 ORDER BY s_store_name1, s_store_id1, d_week_seq1 LIMIT 100;
<<Timing>>
Total Time: 1.032339s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.12s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       13104      |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    d_week_seq    |
|   1=(d_week_seq  |
|      2 - 52      |
|    s_store_id    |
|   1=s_store_id2  |
|      (0.00s)     |
|       13104      |
--------------------
--------------------                                                            --------------------
|    PROJECTION    |                                                            |    PROJECTION    |
|      (0.00s)     |                                                            |      (0.00s)     |
|       2190       |                                                            |       2190       |
--------------------                                                            --------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|    d_week_seq    |                                                            |    d_week_seq    |
|    =d_week_seq   |                                                            |    =d_week_seq   |
|      (0.00s)     |                                                            |      (0.00s)     |
|       2190       |                                                            |       2190       |
--------------------                                                            --------------------
--------------------                                        ----------------------------------------                                        --------------------
|     HASH_JOIN    |                                        |      FILTER      ||     HASH_JOIN    |                                        |      FILTER      |
|       INNER      |                                        |    d_month_seq   ||       INNER      |                                        |    d_month_seq   |
|    ss_store_sk   |                                        |      <= 1223     ||    ss_store_sk   |                                        |      <= 1235     |
|    =s_store_sk   |                                        |    d_month_seq   ||    =s_store_sk   |                                        |    d_month_seq   |
|                  |                                        |      >= 1212     ||                  |                                        |      >= 1224     |
|      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     |
|       1572       |                                        |        365       ||       1572       |                                        |        365       |
--------------------                                        ----------------------------------------                                        --------------------
--------------------                    ------------------------------------------------------------                    ----------------------------------------
|   HASH_GROUP_BY  |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||   HASH_GROUP_BY  |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|                  |                    |       store      ||     date_dim     ||                  |                    |       store      ||     date_dim     |
|      (0.35s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.35s)     |                    |      (0.00s)     ||      (0.00s)     |
|       1572       |                    |        12        ||       73049      ||       1572       |                    |        12        ||       73049      |
--------------------                    ------------------------------------------------------------                    ----------------------------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|  ss_sold_date_sk |                                                            |  ss_sold_date_sk |
|    =d_date_sk    |                                                            |    =d_date_sk    |
|      (0.09s)     |                                                            |      (0.09s)     |
|      2880404     |                                                            |      2880404     |
--------------------                                                            --------------------
----------------------------------------                                        ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||     date_dim     |                                        |    store_sales   ||     date_dim     |
|      (0.01s)     ||      (0.00s)     |                                        |      (0.01s)     ||      (0.00s)     |
|      2880404     ||       73049      |                                        |      2880404     ||       73049      |
----------------------------------------                                        ----------------------------------------

<<Query Profiling Information>>
WITH wss AS (SELECT d_week_seq, ss_store_sk, sum(CASE WHEN (d_day_name='Sunday') THEN ss_sales_price ELSE NULL END) sun_sales, sum(CASE WHEN (d_day_name='Monday') THEN ss_sales_price ELSE NULL END) mon_sales, sum(CASE WHEN (d_day_name='Tuesday') THEN ss_sales_price ELSE NULL END) tue_sales, sum(CASE WHEN (d_day_name='Wednesday') THEN ss_sales_price ELSE NULL END) wed_sales, sum(CASE WHEN (d_day_name='Thursday') THEN ss_sales_price ELSE NULL END) thu_sales, sum(CASE WHEN (d_day_name='Friday') THEN ss_sales_price ELSE NULL END) fri_sales, sum(CASE WHEN (d_day_name='Saturday') THEN ss_sales_price ELSE NULL END) sat_sales FROM store_sales, date_dim WHERE d_date_sk = ss_sold_date_sk GROUP BY d_week_seq, ss_store_sk) SELECT s_store_name1, s_store_id1, d_week_seq1, sun_sales1/sun_sales2, mon_sales1/mon_sales2, tue_sales1/tue_sales2, wed_sales1/wed_sales2, thu_sales1/thu_sales2, fri_sales1/fri_sales2, sat_sales1/sat_sales2 FROM (SELECT s_store_name s_store_name1, wss.d_week_seq d_week_seq1, s_store_id s_store_id1, sun_sales sun_sales1, mon_sales mon_sales1, tue_sales tue_sales1, wed_sales wed_sales1, thu_sales thu_sales1, fri_sales fri_sales1, sat_sales sat_sales1 FROM wss, store, date_dim d WHERE d.d_week_seq = wss.d_week_seq AND ss_store_sk = s_store_sk AND d_month_seq BETWEEN 1212 AND 1212 + 11) y, (SELECT s_store_name s_store_name2, wss.d_week_seq d_week_seq2, s_store_id s_store_id2, sun_sales sun_sales2, mon_sales mon_sales2, tue_sales tue_sales2, wed_sales wed_sales2, thu_sales thu_sales2, fri_sales fri_sales2, sat_sales sat_sales2 FROM wss, store, date_dim d WHERE d.d_week_seq = wss.d_week_seq AND ss_store_sk = s_store_sk AND d_month_seq BETWEEN 1212 + 12 AND 1212 + 23) x WHERE s_store_id1=s_store_id2 AND d_week_seq1=d_week_seq2-52 ORDER BY s_store_name1, s_store_id1, d_week_seq1 LIMIT 100;
<<Timing>>
Total Time: 1.032002s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.12s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       13104      |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    d_week_seq    |
|   1=(d_week_seq  |
|      2 - 52      |
|    s_store_id    |
|   1=s_store_id2  |
|      (0.00s)     |
|       13104      |
--------------------
--------------------                                                            --------------------
|    PROJECTION    |                                                            |    PROJECTION    |
|      (0.00s)     |                                                            |      (0.00s)     |
|       2190       |                                                            |       2190       |
--------------------                                                            --------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|    d_week_seq    |                                                            |    d_week_seq    |
|    =d_week_seq   |                                                            |    =d_week_seq   |
|      (0.00s)     |                                                            |      (0.00s)     |
|       2190       |                                                            |       2190       |
--------------------                                                            --------------------
--------------------                                        ----------------------------------------                                        --------------------
|     HASH_JOIN    |                                        |      FILTER      ||     HASH_JOIN    |                                        |      FILTER      |
|       INNER      |                                        |    d_month_seq   ||       INNER      |                                        |    d_month_seq   |
|    ss_store_sk   |                                        |      <= 1223     ||    ss_store_sk   |                                        |      <= 1235     |
|    =s_store_sk   |                                        |    d_month_seq   ||    =s_store_sk   |                                        |    d_month_seq   |
|                  |                                        |      >= 1212     ||                  |                                        |      >= 1224     |
|      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     |
|       1572       |                                        |        365       ||       1572       |                                        |        365       |
--------------------                                        ----------------------------------------                                        --------------------
--------------------                    ------------------------------------------------------------                    ----------------------------------------
|   HASH_GROUP_BY  |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||   HASH_GROUP_BY  |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|                  |                    |       store      ||     date_dim     ||                  |                    |       store      ||     date_dim     |
|      (0.35s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.35s)     |                    |      (0.00s)     ||      (0.00s)     |
|       1572       |                    |        12        ||       73049      ||       1572       |                    |        12        ||       73049      |
--------------------                    ------------------------------------------------------------                    ----------------------------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|  ss_sold_date_sk |                                                            |  ss_sold_date_sk |
|    =d_date_sk    |                                                            |    =d_date_sk    |
|      (0.09s)     |                                                            |      (0.09s)     |
|      2880404     |                                                            |      2880404     |
--------------------                                                            --------------------
----------------------------------------                                        ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||     date_dim     |                                        |    store_sales   ||     date_dim     |
|      (0.01s)     ||      (0.00s)     |                                        |      (0.01s)     ||      (0.00s)     |
|      2880404     ||       73049      |                                        |      2880404     ||       73049      |
----------------------------------------                                        ----------------------------------------

<<Query Profiling Information>>
WITH wss AS (SELECT d_week_seq, ss_store_sk, sum(CASE WHEN (d_day_name='Sunday') THEN ss_sales_price ELSE NULL END) sun_sales, sum(CASE WHEN (d_day_name='Monday') THEN ss_sales_price ELSE NULL END) mon_sales, sum(CASE WHEN (d_day_name='Tuesday') THEN ss_sales_price ELSE NULL END) tue_sales, sum(CASE WHEN (d_day_name='Wednesday') THEN ss_sales_price ELSE NULL END) wed_sales, sum(CASE WHEN (d_day_name='Thursday') THEN ss_sales_price ELSE NULL END) thu_sales, sum(CASE WHEN (d_day_name='Friday') THEN ss_sales_price ELSE NULL END) fri_sales, sum(CASE WHEN (d_day_name='Saturday') THEN ss_sales_price ELSE NULL END) sat_sales FROM store_sales, date_dim WHERE d_date_sk = ss_sold_date_sk GROUP BY d_week_seq, ss_store_sk) SELECT s_store_name1, s_store_id1, d_week_seq1, sun_sales1/sun_sales2, mon_sales1/mon_sales2, tue_sales1/tue_sales2, wed_sales1/wed_sales2, thu_sales1/thu_sales2, fri_sales1/fri_sales2, sat_sales1/sat_sales2 FROM (SELECT s_store_name s_store_name1, wss.d_week_seq d_week_seq1, s_store_id s_store_id1, sun_sales sun_sales1, mon_sales mon_sales1, tue_sales tue_sales1, wed_sales wed_sales1, thu_sales thu_sales1, fri_sales fri_sales1, sat_sales sat_sales1 FROM wss, store, date_dim d WHERE d.d_week_seq = wss.d_week_seq AND ss_store_sk = s_store_sk AND d_month_seq BETWEEN 1212 AND 1212 + 11) y, (SELECT s_store_name s_store_name2, wss.d_week_seq d_week_seq2, s_store_id s_store_id2, sun_sales sun_sales2, mon_sales mon_sales2, tue_sales tue_sales2, wed_sales wed_sales2, thu_sales thu_sales2, fri_sales fri_sales2, sat_sales sat_sales2 FROM wss, store, date_dim d WHERE d.d_week_seq = wss.d_week_seq AND ss_store_sk = s_store_sk AND d_month_seq BETWEEN 1212 + 12 AND 1212 + 23) x WHERE s_store_id1=s_store_id2 AND d_week_seq1=d_week_seq2-52 ORDER BY s_store_name1, s_store_id1, d_week_seq1 LIMIT 100;
<<Timing>>
Total Time: 1.034126s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.12s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       13104      |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    d_week_seq    |
|   1=(d_week_seq  |
|      2 - 52      |
|    s_store_id    |
|   1=s_store_id2  |
|      (0.00s)     |
|       13104      |
--------------------
--------------------                                                            --------------------
|    PROJECTION    |                                                            |    PROJECTION    |
|      (0.00s)     |                                                            |      (0.00s)     |
|       2190       |                                                            |       2190       |
--------------------                                                            --------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|    d_week_seq    |                                                            |    d_week_seq    |
|    =d_week_seq   |                                                            |    =d_week_seq   |
|      (0.00s)     |                                                            |      (0.00s)     |
|       2190       |                                                            |       2190       |
--------------------                                                            --------------------
--------------------                                        ----------------------------------------                                        --------------------
|     HASH_JOIN    |                                        |      FILTER      ||     HASH_JOIN    |                                        |      FILTER      |
|       INNER      |                                        |    d_month_seq   ||       INNER      |                                        |    d_month_seq   |
|    ss_store_sk   |                                        |      <= 1223     ||    ss_store_sk   |                                        |      <= 1235     |
|    =s_store_sk   |                                        |    d_month_seq   ||    =s_store_sk   |                                        |    d_month_seq   |
|                  |                                        |      >= 1212     ||                  |                                        |      >= 1224     |
|      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     |
|       1572       |                                        |        365       ||       1572       |                                        |        365       |
--------------------                                        ----------------------------------------                                        --------------------
--------------------                    ------------------------------------------------------------                    ----------------------------------------
|   HASH_GROUP_BY  |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||   HASH_GROUP_BY  |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|                  |                    |       store      ||     date_dim     ||                  |                    |       store      ||     date_dim     |
|      (0.35s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.35s)     |                    |      (0.00s)     ||      (0.00s)     |
|       1572       |                    |        12        ||       73049      ||       1572       |                    |        12        ||       73049      |
--------------------                    ------------------------------------------------------------                    ----------------------------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|  ss_sold_date_sk |                                                            |  ss_sold_date_sk |
|    =d_date_sk    |                                                            |    =d_date_sk    |
|      (0.09s)     |                                                            |      (0.09s)     |
|      2880404     |                                                            |      2880404     |
--------------------                                                            --------------------
----------------------------------------                                        ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||     date_dim     |                                        |    store_sales   ||     date_dim     |
|      (0.01s)     ||      (0.00s)     |                                        |      (0.01s)     ||      (0.00s)     |
|      2880404     ||       73049      |                                        |      2880404     ||       73049      |
----------------------------------------                                        ----------------------------------------

<<Query Profiling Information>>
WITH wss AS (SELECT d_week_seq, ss_store_sk, sum(CASE WHEN (d_day_name='Sunday') THEN ss_sales_price ELSE NULL END) sun_sales, sum(CASE WHEN (d_day_name='Monday') THEN ss_sales_price ELSE NULL END) mon_sales, sum(CASE WHEN (d_day_name='Tuesday') THEN ss_sales_price ELSE NULL END) tue_sales, sum(CASE WHEN (d_day_name='Wednesday') THEN ss_sales_price ELSE NULL END) wed_sales, sum(CASE WHEN (d_day_name='Thursday') THEN ss_sales_price ELSE NULL END) thu_sales, sum(CASE WHEN (d_day_name='Friday') THEN ss_sales_price ELSE NULL END) fri_sales, sum(CASE WHEN (d_day_name='Saturday') THEN ss_sales_price ELSE NULL END) sat_sales FROM store_sales, date_dim WHERE d_date_sk = ss_sold_date_sk GROUP BY d_week_seq, ss_store_sk) SELECT s_store_name1, s_store_id1, d_week_seq1, sun_sales1/sun_sales2, mon_sales1/mon_sales2, tue_sales1/tue_sales2, wed_sales1/wed_sales2, thu_sales1/thu_sales2, fri_sales1/fri_sales2, sat_sales1/sat_sales2 FROM (SELECT s_store_name s_store_name1, wss.d_week_seq d_week_seq1, s_store_id s_store_id1, sun_sales sun_sales1, mon_sales mon_sales1, tue_sales tue_sales1, wed_sales wed_sales1, thu_sales thu_sales1, fri_sales fri_sales1, sat_sales sat_sales1 FROM wss, store, date_dim d WHERE d.d_week_seq = wss.d_week_seq AND ss_store_sk = s_store_sk AND d_month_seq BETWEEN 1212 AND 1212 + 11) y, (SELECT s_store_name s_store_name2, wss.d_week_seq d_week_seq2, s_store_id s_store_id2, sun_sales sun_sales2, mon_sales mon_sales2, tue_sales tue_sales2, wed_sales wed_sales2, thu_sales thu_sales2, fri_sales fri_sales2, sat_sales sat_sales2 FROM wss, store, date_dim d WHERE d.d_week_seq = wss.d_week_seq AND ss_store_sk = s_store_sk AND d_month_seq BETWEEN 1212 + 12 AND 1212 + 23) x WHERE s_store_id1=s_store_id2 AND d_week_seq1=d_week_seq2-52 ORDER BY s_store_name1, s_store_id1, d_week_seq1 LIMIT 100;
<<Timing>>
Total Time: 1.031017s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.12s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       13104      |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    d_week_seq    |
|   1=(d_week_seq  |
|      2 - 52      |
|    s_store_id    |
|   1=s_store_id2  |
|      (0.00s)     |
|       13104      |
--------------------
--------------------                                                            --------------------
|    PROJECTION    |                                                            |    PROJECTION    |
|      (0.00s)     |                                                            |      (0.00s)     |
|       2190       |                                                            |       2190       |
--------------------                                                            --------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|    d_week_seq    |                                                            |    d_week_seq    |
|    =d_week_seq   |                                                            |    =d_week_seq   |
|      (0.00s)     |                                                            |      (0.00s)     |
|       2190       |                                                            |       2190       |
--------------------                                                            --------------------
--------------------                                        ----------------------------------------                                        --------------------
|     HASH_JOIN    |                                        |      FILTER      ||     HASH_JOIN    |                                        |      FILTER      |
|       INNER      |                                        |    d_month_seq   ||       INNER      |                                        |    d_month_seq   |
|    ss_store_sk   |                                        |      <= 1223     ||    ss_store_sk   |                                        |      <= 1235     |
|    =s_store_sk   |                                        |    d_month_seq   ||    =s_store_sk   |                                        |    d_month_seq   |
|                  |                                        |      >= 1212     ||                  |                                        |      >= 1224     |
|      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     |
|       1572       |                                        |        365       ||       1572       |                                        |        365       |
--------------------                                        ----------------------------------------                                        --------------------
--------------------                    ------------------------------------------------------------                    ----------------------------------------
|   HASH_GROUP_BY  |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||   HASH_GROUP_BY  |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|                  |                    |       store      ||     date_dim     ||                  |                    |       store      ||     date_dim     |
|      (0.35s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.35s)     |                    |      (0.00s)     ||      (0.00s)     |
|       1572       |                    |        12        ||       73049      ||       1572       |                    |        12        ||       73049      |
--------------------                    ------------------------------------------------------------                    ----------------------------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|  ss_sold_date_sk |                                                            |  ss_sold_date_sk |
|    =d_date_sk    |                                                            |    =d_date_sk    |
|      (0.09s)     |                                                            |      (0.09s)     |
|      2880404     |                                                            |      2880404     |
--------------------                                                            --------------------
----------------------------------------                                        ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |
|    store_sales   ||     date_dim     |                                        |    store_sales   ||     date_dim     |
|      (0.01s)     ||      (0.00s)     |                                        |      (0.01s)     ||      (0.00s)     |
|      2880404     ||       73049      |                                        |      2880404     ||       73049      |
----------------------------------------                                        ----------------------------------------

