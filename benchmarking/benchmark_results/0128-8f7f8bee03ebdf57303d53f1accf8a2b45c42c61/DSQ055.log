<<Query Profiling Information>>
WITH web_v1 AS (SELECT ws_item_sk item_sk, d_date, sum(sum(ws_sales_price)) OVER (PARTITION BY ws_item_sk ORDER BY d_date ROWS BETWEEN unbounded preceding AND CURRENT ROW) cume_sales FROM web_sales, date_dim WHERE ws_sold_date_sk=d_date_sk AND d_month_seq BETWEEN 1200 AND 1200+11 AND ws_item_sk IS NOT NULL GROUP BY ws_item_sk, d_date), store_v1 AS (SELECT ss_item_sk item_sk, d_date, sum(sum(ss_sales_price)) OVER (PARTITION BY ss_item_sk ORDER BY d_date ROWS BETWEEN unbounded preceding AND CURRENT ROW) cume_sales FROM store_sales, date_dim WHERE ss_sold_date_sk=d_date_sk AND d_month_seq BETWEEN 1200 AND 1200+11 AND ss_item_sk IS NOT NULL GROUP BY ss_item_sk, d_date) SELECT * FROM (SELECT item_sk, d_date, web_sales, store_sales, max(web_sales) OVER (PARTITION BY item_sk ORDER BY d_date ROWS BETWEEN unbounded preceding AND CURRENT ROW) web_cumulative, max(store_sales) OVER (PARTITION BY item_sk ORDER BY d_date ROWS BETWEEN unbounded preceding AND CURRENT ROW) store_cumulative FROM (SELECT CASE WHEN web.item_sk IS NOT NULL THEN web.item_sk ELSE store.item_sk END item_sk, CASE WHEN web.d_date IS NOT NULL THEN web.d_date ELSE store.d_date END d_date, web.cume_sales web_sales, store.cume_sales store_sales FROM web_v1 web FULL OUTER JOIN store_v1 store ON (web.item_sk = store.item_sk AND web.d_date = store.d_date))x)y WHERE web_cumulative > store_cumulative ORDER BY item_sk, d_date LIMIT 100;
<<Timing>>
Total Time: 0.232772s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|      FILTER      |
|  web_cumulative  |
|  > store_cumulat |
|        ive       |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|     HASH_JOIN    |
|       OUTER      |
|  item_sk=item_sk |
|   d_date=d_date  |
|      (0.03s)     |
|         0        |
--------------------
--------------------                    --------------------
|   HASH_GROUP_BY  |                    |   HASH_GROUP_BY  |
|      (0.02s)     |                    |      (0.09s)     |
|       1024       |                    |      520232      |
--------------------                    --------------------
--------------------                    --------------------
|     HASH_JOIN    |                    |     HASH_JOIN    |
|       INNER      |                    |       INNER      |
|  ws_sold_date_sk |                    |  ss_sold_date_sk |
|    =d_date_sk    |                    |    =d_date_sk    |
|      (0.01s)     |                    |      (0.05s)     |
|      142217      |                    |      580161      |
--------------------                    --------------------
--------------------------------------------------------------------------------
|      FILTER      ||      FILTER      ||      FILTER      ||      FILTER      |
|    IS_NOT_NULL   ||    d_month_seq   ||    IS_NOT_NULL   ||    d_month_seq   |
|    (ws_item_sk   ||      <= 1211     ||    (ss_item_sk   ||      <= 1211     |
|                  ||    d_month_seq   ||                  ||    d_month_seq   |
|                  ||      >= 1200     ||                  ||      >= 1200     |
|      (0.00s)     ||      (0.00s)     ||      (0.01s)     ||      (0.00s)     |
|      719384      ||        366       ||      2880404     ||        366       |
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |
|     web_sales    ||     date_dim     ||    store_sales   ||     date_dim     |
|      (0.00s)     ||      (0.00s)     ||      (0.01s)     ||      (0.00s)     |
|      719384      ||       73049      ||      2880404     ||       73049      |
--------------------------------------------------------------------------------

INCORRECT RESULT: Not implemented: Unimplemented join type for hash join
