<<Query Profiling Information>>
WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk FROM web_sales) cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Women' AND i_class = 'maternity' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 12 AND d_year = 1998 ), my_revenue AS (SELECT c_customer_sk, sum(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq+1 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) AND (SELECT DISTINCT d_month_seq+3 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) GROUP BY c_customer_sk), segments AS (SELECT cast((revenue/50) AS int) AS SEGMENT FROM my_revenue) SELECT SEGMENT, count(*) AS num_customers, SEGMENT*50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT, num_customers LIMIT 100;
<<Timing>>
Total Time: 0.167222s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|  ss_customer_sk  |
|  =c_customer_sk  |
|      (0.01s)     |
|        384       |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|  ss_sold_date_sk |                                                            | c_current_addr_s |
|    =d_date_sk    |                                                            |  k=ca_address_sk |
|      (0.05s)     |                                                            |      (0.00s)     |
|       87139      |                                                            |        12        |
--------------------                                                            --------------------
----------------------------------------                                        --------------------                                                                                --------------------
|     SEQ_SCAN     ||PIECEWISE_MERGE_JO|                                        |   HASH_GROUP_BY  |                                                                                |     HASH_JOIN    |
|    store_sales   ||       INNER      |                                        |                  |                                                                                |       INNER      |
|                  ||  d_month_seq>=#0 |                                        |                  |                                                                                | ca_state=s_state |
|                  ||                  |                                        |                  |                                                                                |     ca_county    |
|                  ||                  |                                        |                  |                                                                                |     =s_county    |
|      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     |                                                                                |      (0.00s)     |
|      2880404     ||        90        |                                        |       1484       |                                                                                |        216       |
----------------------------------------                                        --------------------                                                                                --------------------
                    --------------------                    ----------------------------------------                                                                                ----------------------------------------
                    |PIECEWISE_MERGE_JO|                    |   HASH_GROUP_BY  ||    PROJECTION    |                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |
                    |       INNER      |                    |                  ||                  |                                                                                | customer_address ||       store      |
                    |  d_month_seq<=#0 |                    |                  ||                  |                                                                                |                  ||                  |
                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.00s)     ||      (0.00s)     |
                    |       36248      |                    |         1        ||       1641       |                                                                                |       50000      ||        12        |
                    --------------------                    ----------------------------------------                                                                                ----------------------------------------
                    --------------------------------------------------------------------------------
                    |     SEQ_SCAN     ||   HASH_GROUP_BY  ||    PROJECTION    ||     HASH_JOIN    |
                    |     date_dim     ||                  ||                  ||       INNER      |
                    |                  ||                  ||                  || item_sk=i_item_s |
                    |                  ||                  ||                  ||         k        |
                    |      (0.00s)     ||      (0.00s)     ||      (0.00s)     ||      (0.01s)     |
                    |       73049      ||         1        ||        31        ||       1641       |
                    --------------------------------------------------------------------------------
                                        ------------------------------------------------------------                                                            --------------------
                                        |    PROJECTION    ||      FILTER      ||     HASH_JOIN    |                                                            |      FILTER      |
                                        |                  ||    d_moy = 12    ||       INNER      |                                                            |     i_class      |
                                        |                  ||   d_year = 1998  ||    customer_sk   |                                                            |    = maternity   |
                                        |                  ||                  ||  =c_customer_sk  |                                                            |    i_category    |
                                        |                  ||                  ||                  |                                                            |      = Women     |
                                        |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |                                                            |      (0.00s)     |
                                        |        31        ||        31        ||       74090      |                                                            |        418       |
                                        ------------------------------------------------------------                                                            --------------------
                                        ------------------------------------------------------------                                        ----------------------------------------
                                        |      FILTER      ||     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |
                                        |    d_moy = 12    ||     date_dim     ||       INNER      |                                        |     customer     ||       item       |
                                        |   d_year = 1998  ||                  ||   sold_date_sk   |                                        |                  ||                  |
                                        |                  ||                  ||    =d_date_sk    |                                        |                  ||                  |
                                        |      (0.00s)     ||      (0.00s)     ||      (0.03s)     |                                        |      (0.00s)     ||      (0.00s)     |
                                        |        31        ||       73049      ||       74090      |                                        |      100000      ||       18000      |
                                        ------------------------------------------------------------                                        ----------------------------------------
                                        --------------------                    --------------------                    --------------------
                                        |     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |
                                        |     date_dim     |                    |                  |                    |   d_year = 1998  |
                                        |                  |                    |                  |                    |    d_moy = 12    |
                                        |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |
                                        |       73049      |                    |      2160932     |                    |        31        |
                                        --------------------                    --------------------                    --------------------
                                                                                ------------------------------------------------------------
                                                                                |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |
                                                                                |                  ||                  ||     date_dim     |
                                                                                |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      ||       73049      |
                                                                                ------------------------------------------------------------
                                                                                ----------------------------------------
                                                                                |    PROJECTION    ||    PROJECTION    |
                                                                                |      (0.00s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      |
                                                                                ----------------------------------------
                                                                                ----------------------------------------
                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |
                                                                                |   catalog_sales  ||     web_sales    |
                                                                                |      (0.01s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      |
                                                                                ----------------------------------------

<<Query Profiling Information>>
WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk FROM web_sales) cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Women' AND i_class = 'maternity' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 12 AND d_year = 1998 ), my_revenue AS (SELECT c_customer_sk, sum(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq+1 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) AND (SELECT DISTINCT d_month_seq+3 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) GROUP BY c_customer_sk), segments AS (SELECT cast((revenue/50) AS int) AS SEGMENT FROM my_revenue) SELECT SEGMENT, count(*) AS num_customers, SEGMENT*50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT, num_customers LIMIT 100;
<<Timing>>
Total Time: 0.166239s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|  ss_customer_sk  |
|  =c_customer_sk  |
|      (0.01s)     |
|        384       |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|  ss_sold_date_sk |                                                            | c_current_addr_s |
|    =d_date_sk    |                                                            |  k=ca_address_sk |
|      (0.05s)     |                                                            |      (0.00s)     |
|       87139      |                                                            |        12        |
--------------------                                                            --------------------
----------------------------------------                                        --------------------                                                                                --------------------
|     SEQ_SCAN     ||PIECEWISE_MERGE_JO|                                        |   HASH_GROUP_BY  |                                                                                |     HASH_JOIN    |
|    store_sales   ||       INNER      |                                        |                  |                                                                                |       INNER      |
|                  ||  d_month_seq>=#0 |                                        |                  |                                                                                | ca_state=s_state |
|                  ||                  |                                        |                  |                                                                                |     ca_county    |
|                  ||                  |                                        |                  |                                                                                |     =s_county    |
|      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     |                                                                                |      (0.00s)     |
|      2880404     ||        90        |                                        |       1484       |                                                                                |        216       |
----------------------------------------                                        --------------------                                                                                --------------------
                    --------------------                    ----------------------------------------                                                                                ----------------------------------------
                    |PIECEWISE_MERGE_JO|                    |   HASH_GROUP_BY  ||    PROJECTION    |                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |
                    |       INNER      |                    |                  ||                  |                                                                                | customer_address ||       store      |
                    |  d_month_seq<=#0 |                    |                  ||                  |                                                                                |                  ||                  |
                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.00s)     ||      (0.00s)     |
                    |       36248      |                    |         1        ||       1641       |                                                                                |       50000      ||        12        |
                    --------------------                    ----------------------------------------                                                                                ----------------------------------------
                    --------------------------------------------------------------------------------
                    |     SEQ_SCAN     ||   HASH_GROUP_BY  ||    PROJECTION    ||     HASH_JOIN    |
                    |     date_dim     ||                  ||                  ||       INNER      |
                    |                  ||                  ||                  || item_sk=i_item_s |
                    |                  ||                  ||                  ||         k        |
                    |      (0.00s)     ||      (0.00s)     ||      (0.00s)     ||      (0.01s)     |
                    |       73049      ||         1        ||        31        ||       1641       |
                    --------------------------------------------------------------------------------
                                        ------------------------------------------------------------                                                            --------------------
                                        |    PROJECTION    ||      FILTER      ||     HASH_JOIN    |                                                            |      FILTER      |
                                        |                  ||    d_moy = 12    ||       INNER      |                                                            |     i_class      |
                                        |                  ||   d_year = 1998  ||    customer_sk   |                                                            |    = maternity   |
                                        |                  ||                  ||  =c_customer_sk  |                                                            |    i_category    |
                                        |                  ||                  ||                  |                                                            |      = Women     |
                                        |      (0.00s)     ||      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     |
                                        |        31        ||        31        ||       74090      |                                                            |        418       |
                                        ------------------------------------------------------------                                                            --------------------
                                        ------------------------------------------------------------                                        ----------------------------------------
                                        |      FILTER      ||     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |
                                        |    d_moy = 12    ||     date_dim     ||       INNER      |                                        |     customer     ||       item       |
                                        |   d_year = 1998  ||                  ||   sold_date_sk   |                                        |                  ||                  |
                                        |                  ||                  ||    =d_date_sk    |                                        |                  ||                  |
                                        |      (0.00s)     ||      (0.00s)     ||      (0.03s)     |                                        |      (0.00s)     ||      (0.00s)     |
                                        |        31        ||       73049      ||       74090      |                                        |      100000      ||       18000      |
                                        ------------------------------------------------------------                                        ----------------------------------------
                                        --------------------                    --------------------                    --------------------
                                        |     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |
                                        |     date_dim     |                    |                  |                    |   d_year = 1998  |
                                        |                  |                    |                  |                    |    d_moy = 12    |
                                        |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |
                                        |       73049      |                    |      2160932     |                    |        31        |
                                        --------------------                    --------------------                    --------------------
                                                                                ------------------------------------------------------------
                                                                                |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |
                                                                                |                  ||                  ||     date_dim     |
                                                                                |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      ||       73049      |
                                                                                ------------------------------------------------------------
                                                                                ----------------------------------------
                                                                                |    PROJECTION    ||    PROJECTION    |
                                                                                |      (0.00s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      |
                                                                                ----------------------------------------
                                                                                ----------------------------------------
                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |
                                                                                |   catalog_sales  ||     web_sales    |
                                                                                |      (0.01s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      |
                                                                                ----------------------------------------

<<Query Profiling Information>>
WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk FROM web_sales) cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Women' AND i_class = 'maternity' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 12 AND d_year = 1998 ), my_revenue AS (SELECT c_customer_sk, sum(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq+1 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) AND (SELECT DISTINCT d_month_seq+3 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) GROUP BY c_customer_sk), segments AS (SELECT cast((revenue/50) AS int) AS SEGMENT FROM my_revenue) SELECT SEGMENT, count(*) AS num_customers, SEGMENT*50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT, num_customers LIMIT 100;
<<Timing>>
Total Time: 0.168102s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|  ss_customer_sk  |
|  =c_customer_sk  |
|      (0.01s)     |
|        384       |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|  ss_sold_date_sk |                                                            | c_current_addr_s |
|    =d_date_sk    |                                                            |  k=ca_address_sk |
|      (0.05s)     |                                                            |      (0.00s)     |
|       87139      |                                                            |        12        |
--------------------                                                            --------------------
----------------------------------------                                        --------------------                                                                                --------------------
|     SEQ_SCAN     ||PIECEWISE_MERGE_JO|                                        |   HASH_GROUP_BY  |                                                                                |     HASH_JOIN    |
|    store_sales   ||       INNER      |                                        |                  |                                                                                |       INNER      |
|                  ||  d_month_seq>=#0 |                                        |                  |                                                                                | ca_state=s_state |
|                  ||                  |                                        |                  |                                                                                |     ca_county    |
|                  ||                  |                                        |                  |                                                                                |     =s_county    |
|      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     |                                                                                |      (0.00s)     |
|      2880404     ||        90        |                                        |       1484       |                                                                                |        216       |
----------------------------------------                                        --------------------                                                                                --------------------
                    --------------------                    ----------------------------------------                                                                                ----------------------------------------
                    |PIECEWISE_MERGE_JO|                    |   HASH_GROUP_BY  ||    PROJECTION    |                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |
                    |       INNER      |                    |                  ||                  |                                                                                | customer_address ||       store      |
                    |  d_month_seq<=#0 |                    |                  ||                  |                                                                                |                  ||                  |
                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.00s)     ||      (0.00s)     |
                    |       36248      |                    |         1        ||       1641       |                                                                                |       50000      ||        12        |
                    --------------------                    ----------------------------------------                                                                                ----------------------------------------
                    --------------------------------------------------------------------------------
                    |     SEQ_SCAN     ||   HASH_GROUP_BY  ||    PROJECTION    ||     HASH_JOIN    |
                    |     date_dim     ||                  ||                  ||       INNER      |
                    |                  ||                  ||                  || item_sk=i_item_s |
                    |                  ||                  ||                  ||         k        |
                    |      (0.00s)     ||      (0.00s)     ||      (0.00s)     ||      (0.01s)     |
                    |       73049      ||         1        ||        31        ||       1641       |
                    --------------------------------------------------------------------------------
                                        ------------------------------------------------------------                                                            --------------------
                                        |    PROJECTION    ||      FILTER      ||     HASH_JOIN    |                                                            |      FILTER      |
                                        |                  ||    d_moy = 12    ||       INNER      |                                                            |     i_class      |
                                        |                  ||   d_year = 1998  ||    customer_sk   |                                                            |    = maternity   |
                                        |                  ||                  ||  =c_customer_sk  |                                                            |    i_category    |
                                        |                  ||                  ||                  |                                                            |      = Women     |
                                        |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |                                                            |      (0.00s)     |
                                        |        31        ||        31        ||       74090      |                                                            |        418       |
                                        ------------------------------------------------------------                                                            --------------------
                                        ------------------------------------------------------------                                        ----------------------------------------
                                        |      FILTER      ||     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |
                                        |    d_moy = 12    ||     date_dim     ||       INNER      |                                        |     customer     ||       item       |
                                        |   d_year = 1998  ||                  ||   sold_date_sk   |                                        |                  ||                  |
                                        |                  ||                  ||    =d_date_sk    |                                        |                  ||                  |
                                        |      (0.00s)     ||      (0.00s)     ||      (0.03s)     |                                        |      (0.00s)     ||      (0.00s)     |
                                        |        31        ||       73049      ||       74090      |                                        |      100000      ||       18000      |
                                        ------------------------------------------------------------                                        ----------------------------------------
                                        --------------------                    --------------------                    --------------------
                                        |     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |
                                        |     date_dim     |                    |                  |                    |   d_year = 1998  |
                                        |                  |                    |                  |                    |    d_moy = 12    |
                                        |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |
                                        |       73049      |                    |      2160932     |                    |        31        |
                                        --------------------                    --------------------                    --------------------
                                                                                ------------------------------------------------------------
                                                                                |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |
                                                                                |                  ||                  ||     date_dim     |
                                                                                |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      ||       73049      |
                                                                                ------------------------------------------------------------
                                                                                ----------------------------------------
                                                                                |    PROJECTION    ||    PROJECTION    |
                                                                                |      (0.00s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      |
                                                                                ----------------------------------------
                                                                                ----------------------------------------
                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |
                                                                                |   catalog_sales  ||     web_sales    |
                                                                                |      (0.01s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      |
                                                                                ----------------------------------------

<<Query Profiling Information>>
WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk FROM web_sales) cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Women' AND i_class = 'maternity' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 12 AND d_year = 1998 ), my_revenue AS (SELECT c_customer_sk, sum(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq+1 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) AND (SELECT DISTINCT d_month_seq+3 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) GROUP BY c_customer_sk), segments AS (SELECT cast((revenue/50) AS int) AS SEGMENT FROM my_revenue) SELECT SEGMENT, count(*) AS num_customers, SEGMENT*50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT, num_customers LIMIT 100;
<<Timing>>
Total Time: 0.165410s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|  ss_customer_sk  |
|  =c_customer_sk  |
|      (0.01s)     |
|        384       |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|  ss_sold_date_sk |                                                            | c_current_addr_s |
|    =d_date_sk    |                                                            |  k=ca_address_sk |
|      (0.05s)     |                                                            |      (0.00s)     |
|       87139      |                                                            |        12        |
--------------------                                                            --------------------
----------------------------------------                                        --------------------                                                                                --------------------
|     SEQ_SCAN     ||PIECEWISE_MERGE_JO|                                        |   HASH_GROUP_BY  |                                                                                |     HASH_JOIN    |
|    store_sales   ||       INNER      |                                        |                  |                                                                                |       INNER      |
|                  ||  d_month_seq>=#0 |                                        |                  |                                                                                | ca_state=s_state |
|                  ||                  |                                        |                  |                                                                                |     ca_county    |
|                  ||                  |                                        |                  |                                                                                |     =s_county    |
|      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     |                                                                                |      (0.00s)     |
|      2880404     ||        90        |                                        |       1484       |                                                                                |        216       |
----------------------------------------                                        --------------------                                                                                --------------------
                    --------------------                    ----------------------------------------                                                                                ----------------------------------------
                    |PIECEWISE_MERGE_JO|                    |   HASH_GROUP_BY  ||    PROJECTION    |                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |
                    |       INNER      |                    |                  ||                  |                                                                                | customer_address ||       store      |
                    |  d_month_seq<=#0 |                    |                  ||                  |                                                                                |                  ||                  |
                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.00s)     ||      (0.00s)     |
                    |       36248      |                    |         1        ||       1641       |                                                                                |       50000      ||        12        |
                    --------------------                    ----------------------------------------                                                                                ----------------------------------------
                    --------------------------------------------------------------------------------
                    |     SEQ_SCAN     ||   HASH_GROUP_BY  ||    PROJECTION    ||     HASH_JOIN    |
                    |     date_dim     ||                  ||                  ||       INNER      |
                    |                  ||                  ||                  || item_sk=i_item_s |
                    |                  ||                  ||                  ||         k        |
                    |      (0.00s)     ||      (0.00s)     ||      (0.00s)     ||      (0.01s)     |
                    |       73049      ||         1        ||        31        ||       1641       |
                    --------------------------------------------------------------------------------
                                        ------------------------------------------------------------                                                            --------------------
                                        |    PROJECTION    ||      FILTER      ||     HASH_JOIN    |                                                            |      FILTER      |
                                        |                  ||    d_moy = 12    ||       INNER      |                                                            |     i_class      |
                                        |                  ||   d_year = 1998  ||    customer_sk   |                                                            |    = maternity   |
                                        |                  ||                  ||  =c_customer_sk  |                                                            |    i_category    |
                                        |                  ||                  ||                  |                                                            |      = Women     |
                                        |      (0.00s)     ||      (0.00s)     ||      (0.01s)     |                                                            |      (0.00s)     |
                                        |        31        ||        31        ||       74090      |                                                            |        418       |
                                        ------------------------------------------------------------                                                            --------------------
                                        ------------------------------------------------------------                                        ----------------------------------------
                                        |      FILTER      ||     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |
                                        |    d_moy = 12    ||     date_dim     ||       INNER      |                                        |     customer     ||       item       |
                                        |   d_year = 1998  ||                  ||   sold_date_sk   |                                        |                  ||                  |
                                        |                  ||                  ||    =d_date_sk    |                                        |                  ||                  |
                                        |      (0.00s)     ||      (0.00s)     ||      (0.03s)     |                                        |      (0.00s)     ||      (0.00s)     |
                                        |        31        ||       73049      ||       74090      |                                        |      100000      ||       18000      |
                                        ------------------------------------------------------------                                        ----------------------------------------
                                        --------------------                    --------------------                    --------------------
                                        |     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |
                                        |     date_dim     |                    |                  |                    |   d_year = 1998  |
                                        |                  |                    |                  |                    |    d_moy = 12    |
                                        |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |
                                        |       73049      |                    |      2160932     |                    |        31        |
                                        --------------------                    --------------------                    --------------------
                                                                                ------------------------------------------------------------
                                                                                |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |
                                                                                |                  ||                  ||     date_dim     |
                                                                                |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      ||       73049      |
                                                                                ------------------------------------------------------------
                                                                                ----------------------------------------
                                                                                |    PROJECTION    ||    PROJECTION    |
                                                                                |      (0.00s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      |
                                                                                ----------------------------------------
                                                                                ----------------------------------------
                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |
                                                                                |   catalog_sales  ||     web_sales    |
                                                                                |      (0.01s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      |
                                                                                ----------------------------------------

<<Query Profiling Information>>
WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk FROM web_sales) cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Women' AND i_class = 'maternity' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 12 AND d_year = 1998 ), my_revenue AS (SELECT c_customer_sk, sum(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq+1 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) AND (SELECT DISTINCT d_month_seq+3 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) GROUP BY c_customer_sk), segments AS (SELECT cast((revenue/50) AS int) AS SEGMENT FROM my_revenue) SELECT SEGMENT, count(*) AS num_customers, SEGMENT*50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT, num_customers LIMIT 100;
<<Timing>>
Total Time: 0.167678s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|         1        |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|  ss_customer_sk  |
|  =c_customer_sk  |
|      (0.01s)     |
|        384       |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |     HASH_JOIN    |
|       INNER      |                                                            |       INNER      |
|  ss_sold_date_sk |                                                            | c_current_addr_s |
|    =d_date_sk    |                                                            |  k=ca_address_sk |
|      (0.05s)     |                                                            |      (0.00s)     |
|       87139      |                                                            |        12        |
--------------------                                                            --------------------
----------------------------------------                                        --------------------                                                                                --------------------
|     SEQ_SCAN     ||PIECEWISE_MERGE_JO|                                        |   HASH_GROUP_BY  |                                                                                |     HASH_JOIN    |
|    store_sales   ||       INNER      |                                        |                  |                                                                                |       INNER      |
|                  ||  d_month_seq>=#0 |                                        |                  |                                                                                | ca_state=s_state |
|                  ||                  |                                        |                  |                                                                                |     ca_county    |
|                  ||                  |                                        |                  |                                                                                |     =s_county    |
|      (0.02s)     ||      (0.00s)     |                                        |      (0.00s)     |                                                                                |      (0.00s)     |
|      2880404     ||        90        |                                        |       1484       |                                                                                |        216       |
----------------------------------------                                        --------------------                                                                                --------------------
                    --------------------                    ----------------------------------------                                                                                ----------------------------------------
                    |PIECEWISE_MERGE_JO|                    |   HASH_GROUP_BY  ||    PROJECTION    |                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |
                    |       INNER      |                    |                  ||                  |                                                                                | customer_address ||       store      |
                    |  d_month_seq<=#0 |                    |                  ||                  |                                                                                |                  ||                  |
                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.00s)     ||      (0.00s)     |
                    |       36248      |                    |         1        ||       1641       |                                                                                |       50000      ||        12        |
                    --------------------                    ----------------------------------------                                                                                ----------------------------------------
                    --------------------------------------------------------------------------------
                    |     SEQ_SCAN     ||   HASH_GROUP_BY  ||    PROJECTION    ||     HASH_JOIN    |
                    |     date_dim     ||                  ||                  ||       INNER      |
                    |                  ||                  ||                  || item_sk=i_item_s |
                    |                  ||                  ||                  ||         k        |
                    |      (0.00s)     ||      (0.00s)     ||      (0.00s)     ||      (0.01s)     |
                    |       73049      ||         1        ||        31        ||       1641       |
                    --------------------------------------------------------------------------------
                                        ------------------------------------------------------------                                                            --------------------
                                        |    PROJECTION    ||      FILTER      ||     HASH_JOIN    |                                                            |      FILTER      |
                                        |                  ||    d_moy = 12    ||       INNER      |                                                            |     i_class      |
                                        |                  ||   d_year = 1998  ||    customer_sk   |                                                            |    = maternity   |
                                        |                  ||                  ||  =c_customer_sk  |                                                            |    i_category    |
                                        |                  ||                  ||                  |                                                            |      = Women     |
                                        |      (0.00s)     ||      (0.00s)     ||      (0.02s)     |                                                            |      (0.00s)     |
                                        |        31        ||        31        ||       74090      |                                                            |        418       |
                                        ------------------------------------------------------------                                                            --------------------
                                        ------------------------------------------------------------                                        ----------------------------------------
                                        |      FILTER      ||     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||     SEQ_SCAN     |
                                        |    d_moy = 12    ||     date_dim     ||       INNER      |                                        |     customer     ||       item       |
                                        |   d_year = 1998  ||                  ||   sold_date_sk   |                                        |                  ||                  |
                                        |                  ||                  ||    =d_date_sk    |                                        |                  ||                  |
                                        |      (0.00s)     ||      (0.00s)     ||      (0.03s)     |                                        |      (0.00s)     ||      (0.00s)     |
                                        |        31        ||       73049      ||       74090      |                                        |      100000      ||       18000      |
                                        ------------------------------------------------------------                                        ----------------------------------------
                                        --------------------                    --------------------                    --------------------
                                        |     SEQ_SCAN     |                    |       UNION      |                    |      FILTER      |
                                        |     date_dim     |                    |                  |                    |   d_year = 1998  |
                                        |                  |                    |                  |                    |    d_moy = 12    |
                                        |      (0.00s)     |                    |      (0.00s)     |                    |      (0.00s)     |
                                        |       73049      |                    |      2160932     |                    |        31        |
                                        --------------------                    --------------------                    --------------------
                                                                                ------------------------------------------------------------
                                                                                |    PROJECTION    ||    PROJECTION    ||     SEQ_SCAN     |
                                                                                |                  ||                  ||     date_dim     |
                                                                                |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      ||       73049      |
                                                                                ------------------------------------------------------------
                                                                                ----------------------------------------
                                                                                |    PROJECTION    ||    PROJECTION    |
                                                                                |      (0.00s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      |
                                                                                ----------------------------------------
                                                                                ----------------------------------------
                                                                                |     SEQ_SCAN     ||     SEQ_SCAN     |
                                                                                |   catalog_sales  ||     web_sales    |
                                                                                |      (0.01s)     ||      (0.00s)     |
                                                                                |      1441548     ||      719384      |
                                                                                ----------------------------------------

