<<Query Profiling Information>>
WITH year_total AS (SELECT c_customer_id customer_id, c_first_name customer_first_name, c_last_name customer_last_name, d_year AS year_, sum(ss_net_paid) year_total, 's' sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year IN (2001, 2001+1) GROUP BY c_customer_id, c_first_name, c_last_name, d_year UNION ALL SELECT c_customer_id customer_id, c_first_name customer_first_name, c_last_name customer_last_name, d_year AS year_, sum(ws_net_paid) year_total, 'w' sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year IN (2001, 2001+1) GROUP BY c_customer_id, c_first_name, c_last_name, d_year) SELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name FROM year_total t_s_firstyear, year_total t_s_secyear, year_total t_w_firstyear, year_total t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.year_ = 2001 AND t_s_secyear.year_ = 2001+1 AND t_w_firstyear.year_ = 2001 AND t_w_secyear.year_ = 2001+1 AND t_s_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total ELSE NULL END > CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total ELSE NULL END ORDER BY 1 LIMIT 100;
<<Timing>>
Total Time: 30.340561s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|      FILTER      |
| CASE((year_total |
|      > 0.000     |
| 000), (year_tota |
|  l / year_total) |
|     , NULL)      |
| > CASE((year_tot |
|     al > 0.0     |
|     00000),      |
|    (year_total   |
|   / year_total)  |
|      (0.00s)     |
|         0        |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|    customer_id   |
|   =customer_id   |
|      (0.00s)     |
|         0        |
--------------------
--------------------                                                                                                                                                                                                                                                                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                                                                                                                                                    |      FILTER      |
|       INNER      |                                                                                                                                                                                                                                                                                                                                                    |   year_ = 2002   |
|    customer_id   |                                                                                                                                                                                                                                                                                                                                                    |   sale_type = w  |
|   =customer_id   |                                                                                                                                                                                                                                                                                                                                                    |                  |
|      (0.00s)     |                                                                                                                                                                                                                                                                                                                                                    |      (0.00s)     |
|         0        |                                                                                                                                                                                                                                                                                                                                                    |         0        |
--------------------                                                                                                                                                                                                                                                                                                                                                    --------------------
--------------------                                                                                                                                                                                                                            --------------------                                                                                                    --------------------
|     HASH_JOIN    |                                                                                                                                                                                                                            |      FILTER      |                                                                                                    |       UNION      |
|       INNER      |                                                                                                                                                                                                                            |    year_total    |                                                                                                    |                  |
|    customer_id   |                                                                                                                                                                                                                            |     > 0.000000   |                                                                                                    |                  |
|   =customer_id   |                                                                                                                                                                                                                            |   year_ = 2001   |                                                                                                    |                  |
|                  |                                                                                                                                                                                                                            |   sale_type = w  |                                                                                                    |                  |
|      (0.00s)     |                                                                                                                                                                                                                            |      (0.00s)     |                                                                                                    |      (0.00s)     |
|         0        |                                                                                                                                                                                                                            |         0        |                                                                                                    |         0        |
--------------------                                                                                                                                                                                                                            --------------------                                                                                                    --------------------
--------------------                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------
|      FILTER      |                                                                                                    |      FILTER      |                                                                                                    |       UNION      |                                                                                                    |    PROJECTION    |                                        |    PROJECTION    |
|    year_total    |                                                                                                    |   year_ = 2002   |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|     > 0.000000   |                                                                                                    |   sale_type = s  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|   year_ = 2001   |                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|   sale_type = s  |                                                                                                    |                  |                                                                                                    |                  |                                                                                                    |                  |                                        |                  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |
|         0        |                                                                                                    |         0        |                                                                                                    |         0        |                                                                                                    |         0        |                                        |         0        |
--------------------                                                                                                    --------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------
--------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------                                        --------------------                                        --------------------
|       UNION      |                                                                                                    |       UNION      |                                                                                                    |    PROJECTION    |                                        |    PROJECTION    |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |
|      (0.00s)     |                                                                                                    |      (0.00s)     |                                                                                                    |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |
|         0        |                                                                                                    |         0        |                                                                                                    |         0        |                                        |         0        |                                        |         0        |                                        |         0        |
--------------------                                                                                                    --------------------                                                                                                    --------------------                                        --------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
|    PROJECTION    |                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |    PROJECTION    |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |      FILTER      |                                        |      FILTER      |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |     IN(d_year    |                                        |     IN(d_year    |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |   , 2001, 2002   |                                        |   , 2001, 2002   |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |    = d_date_sk   |                                        |    = d_date_sk   |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |   c_customer_sk  |                                        |   c_customer_sk  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |  = ss_customer_s |                                        |  = ws_bill_custo |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                                        |         k        |                                        |      mer_sk      |
|      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |     (25.40s)     |                                        |      (0.00s)     |
|         0        |                                        |         0        |                                        |         0        |                                        |         0        |                                        |         0        |                                        |         0        |                                        |         0        |                                        |         0        |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
|   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |   HASH_GROUP_BY  |                                        |      FILTER      |                                        |      FILTER      |                                        |   CROSS_PRODUCT  |                                        |   CROSS_PRODUCT  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |     IN(d_year    |                                        |     IN(d_year    |                                        |                  |                                        |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |   , 2001, 2002   |                                        |   , 2001, 2002   |                                        |                  |                                        |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |                  |                                        |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |    = d_date_sk   |                                        |    = d_date_sk   |                                        |                  |                                        |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |   c_customer_sk  |                                        |   c_customer_sk  |                                        |                  |                                        |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |  = ss_customer_s |                                        |  = ws_bill_custo |                                        |                  |                                        |                  |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |         k        |                                        |      mer_sk      |                                        |                  |                                        |                  |
|      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (4.56s)     |                                        |      (0.00s)     |
|         0        |                                        |         0        |                                        |         0        |                                        |         0        |                                        |         0        |                                        |         0        |                                        |    2130198528    |                                        |         0        |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    --------------------
|      FILTER      |                                        |      FILTER      |                                        |      FILTER      |                                        |      FILTER      |                                        |   CROSS_PRODUCT  |                                        |   CROSS_PRODUCT  |                                        |   CROSS_PRODUCT  |                    |     SEQ_SCAN     ||   CROSS_PRODUCT  |                    |     SEQ_SCAN     |
|     IN(d_year    |                                        |     IN(d_year    |                                        |     IN(d_year    |                                        |     IN(d_year    |                                        |                  |                                        |                  |                                        |                  |                    |     date_dim     ||                  |                    |     date_dim     |
|   , 2001, 2002   |                                        |   , 2001, 2002   |                                        |   , 2001, 2002   |                                        |   , 2001, 2002   |                                        |                  |                                        |                  |                                        |                  |                    |                  ||                  |                    |                  |
|  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |  ss_sold_date_sk |                                        |  ws_sold_date_sk |                                        |                  |                                        |                  |                                        |                  |                    |                  ||                  |                    |                  |
|    = d_date_sk   |                                        |    = d_date_sk   |                                        |    = d_date_sk   |                                        |    = d_date_sk   |                                        |                  |                                        |                  |                                        |                  |                    |                  ||                  |                    |                  |
|   c_customer_sk  |                                        |   c_customer_sk  |                                        |   c_customer_sk  |                                        |   c_customer_sk  |                                        |                  |                                        |                  |                                        |                  |                    |                  ||                  |                    |                  |
|  = ss_customer_s |                                        |  = ws_bill_custo |                                        |  = ss_customer_s |                                        |  = ws_bill_custo |                                        |                  |                                        |                  |                                        |                  |                    |                  ||                  |                    |                  |
|         k        |                                        |      mer_sk      |                                        |         k        |                                        |      mer_sk      |                                        |                  |                                        |                  |                                        |                  |                    |                  ||                  |                    |                  |
|      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.03s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     |
|         0        |                                        |         0        |                                        |         0        |                                        |         0        |                                        |         0        |                                        |         0        |                                        |       29696      |                    |       73049      ||         0        |                    |         0        |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    --------------------
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
|   CROSS_PRODUCT  |                                        |   CROSS_PRODUCT  |                                        |   CROSS_PRODUCT  |                                        |   CROSS_PRODUCT  |                                        |   CROSS_PRODUCT  |                    |     SEQ_SCAN     ||   CROSS_PRODUCT  |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|                  |                                        |                  |                                        |                  |                                        |                  |                                        |                  |                    |     date_dim     ||                  |                    |     date_dim     ||     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                                        |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     ||      (0.00s)     |
|         0        |                                        |         0        |                                        |         0        |                                        |         0        |                                        |         0        |                    |         0        ||         0        |                    |         0        ||       1024       ||      2880404     |                    |         0        ||         0        |
--------------------                                        --------------------                                        --------------------                                        --------------------                                        --------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
--------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
|   CROSS_PRODUCT  |                    |     SEQ_SCAN     ||   CROSS_PRODUCT  |                    |     SEQ_SCAN     ||   CROSS_PRODUCT  |                    |     SEQ_SCAN     ||   CROSS_PRODUCT  |                    |     SEQ_SCAN     ||     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|                  |                    |     date_dim     ||                  |                    |     date_dim     ||                  |                    |     date_dim     ||                  |                    |     date_dim     ||     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|         0        |                    |         0        ||         0        |                    |         0        ||         0        |                    |         0        ||         0        |                    |         0        ||         0        ||         0        |                    |         0        ||         0        |
--------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ------------------------------------------------------------                    ----------------------------------------
----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|     customer     ||    store_sales   |                    |     customer     ||     web_sales    |                    |     customer     ||    store_sales   |                    |     customer     ||     web_sales    |
|      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|         0        ||         0        |                    |         0        ||         0        |                    |         0        ||         0        |                    |         0        ||         0        |
----------------------------------------                    ----------------------------------------                    ----------------------------------------                    ----------------------------------------

