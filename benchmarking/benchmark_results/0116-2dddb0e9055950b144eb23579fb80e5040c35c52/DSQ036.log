<<Query Profiling Information>>
WITH ss AS ( SELECT i_manufact_id, sum(ss_ext_sales_price) total_sales FROM store_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), cs AS ( SELECT i_manufact_id, sum(cs_ext_sales_price) total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), ws AS ( SELECT i_manufact_id, sum(ws_ext_sales_price) total_sales FROM web_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id) SELECT i_manufact_id, sum(total_sales) total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100;
<<Timing>>
Total Time: 0.136492s
<<Operator Tree>>
--------------------
|       PRUNE      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        717       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        717       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       2033       |
--------------------
--------------------                                                                                --------------------
|    PROJECTION    |                                                                                |       UNION      |
|      (0.00s)     |                                                                                |      (0.00s)     |
|        712       |                                                                                |       1321       |
--------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                                                |    PROJECTION    |
|      (0.00s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|        712       |                                                                                |        684       |                                                                                |        637       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                                                |   HASH_GROUP_BY  |
|       SEMI       |                                                                                |                  |                                                                                |                  |
| i_manufact_id=#0 |                                                                                |                  |                                                                                |                  |
|      (0.01s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       9815       |                                                                                |        684       |                                                                                |        637       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                            ----------------------------------------                                                                                --------------------
|     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                                                |     HASH_JOIN    |
|       INNER      |                                                            |                  ||       SEMI       |                                                                                |       SEMI       |
|    ss_item_sk    |                                                            |                  || i_manufact_id=#0 |                                                                                | i_manufact_id=#0 |
|    =i_item_sk    |                                                            |                  ||                  |                                                                                |                  |
|      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.00s)     |
|       11163      |                                                            |       1816       ||       4624       |                                                                                |       2499       |
--------------------                                                            ----------------------------------------                                                                                --------------------
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                            |    PROJECTION    |
|       INNER      |                                        |       item       ||   IN(i_category  ||       INNER      |                                                            |                  ||       INNER      |                                                            |                  |
|    ss_addr_sk    |                                        |                  ||   , Electronics  ||    cs_item_sk    |                                                            |                  ||    ws_item_sk    |                                                            |                  |
|  =ca_address_sk  |                                        |                  ||                  ||    =i_item_sk    |                                                            |                  ||    =i_item_sk    |                                                            |                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|       11163      |                                        |       18000      ||       1816       ||       5224       |                                                            |       1816       ||       2886       |                                                            |       1816       |
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
|     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      |
|       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                                        |       item       ||   IN(i_category  ||       INNER      |                                        |       item       ||   IN(i_category  |
|  ss_sold_date_sk |                    |    = -5.000000   |                    |                  ||  cs_bill_addr_sk |                                        |                  ||   , Electronics  ||  ws_bill_addr_sk |                                        |                  ||   , Electronics  |
|    =d_date_sk    |                    |                  |                    |                  ||  =ca_address_sk  |                                        |                  ||                  ||  =ca_address_sk  |                                        |                  ||                  |
|      (0.04s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |
|       28265      |                    |       18832      |                    |       18000      ||       5224       |                                        |       18000      ||       1816       ||       2886       |                                        |       18000      ||       1816       |
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
|     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     |
|    store_sales   ||     d_moy = 5    || customer_address |                                        |       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                    |   ca_gmt_offset  |                    |       item       |
|                  ||   d_year = 1998  ||                  |                                        |  cs_sold_date_sk |                    |    = -5.000000   |                    |                  ||  ws_sold_date_sk |                    |    = -5.000000   |                    |                  |
|                  ||                  ||                  |                                        |    =d_date_sk    |                    |                  |                    |                  ||    =d_date_sk    |                    |                  |                    |                  |
|      (0.02s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |                    |      (0.00s)     |
|      2880404     ||        31        ||       50000      |                                        |       14085      |                    |       18832      |                    |       18000      ||       7370       |                    |       18832      |                    |       18000      |
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                    |     SEQ_SCAN     |                                                            |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |
                    |     date_dim     |                                                            |   catalog_sales  ||     d_moy = 5    || customer_address |                                        |     web_sales    ||     d_moy = 5    || customer_address |
                    |                  |                                                            |                  ||   d_year = 1998  ||                  |                                        |                  ||   d_year = 1998  ||                  |
                    |      (0.00s)     |                                                            |      (0.01s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                    |       73049      |                                                            |      1441548     ||        31        ||       50000      |                                        |      719384      ||        31        ||       50000      |
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                                                                                                                        --------------------                                                                                --------------------
                                                                                                                        |     SEQ_SCAN     |                                                                                |     SEQ_SCAN     |
                                                                                                                        |     date_dim     |                                                                                |     date_dim     |
                                                                                                                        |      (0.00s)     |                                                                                |      (0.00s)     |
                                                                                                                        |       73049      |                                                                                |       73049      |
                                                                                                                        --------------------                                                                                --------------------

<<Query Profiling Information>>
WITH ss AS ( SELECT i_manufact_id, sum(ss_ext_sales_price) total_sales FROM store_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), cs AS ( SELECT i_manufact_id, sum(cs_ext_sales_price) total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), ws AS ( SELECT i_manufact_id, sum(ws_ext_sales_price) total_sales FROM web_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id) SELECT i_manufact_id, sum(total_sales) total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100;
<<Timing>>
Total Time: 0.138038s
<<Operator Tree>>
--------------------
|       PRUNE      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        717       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        717       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       2033       |
--------------------
--------------------                                                                                --------------------
|    PROJECTION    |                                                                                |       UNION      |
|      (0.00s)     |                                                                                |      (0.00s)     |
|        712       |                                                                                |       1321       |
--------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                                                |    PROJECTION    |
|      (0.00s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|        712       |                                                                                |        684       |                                                                                |        637       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                                                |   HASH_GROUP_BY  |
|       SEMI       |                                                                                |                  |                                                                                |                  |
| i_manufact_id=#0 |                                                                                |                  |                                                                                |                  |
|      (0.01s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       9815       |                                                                                |        684       |                                                                                |        637       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                            ----------------------------------------                                                                                --------------------
|     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                                                |     HASH_JOIN    |
|       INNER      |                                                            |                  ||       SEMI       |                                                                                |       SEMI       |
|    ss_item_sk    |                                                            |                  || i_manufact_id=#0 |                                                                                | i_manufact_id=#0 |
|    =i_item_sk    |                                                            |                  ||                  |                                                                                |                  |
|      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.00s)     |
|       11163      |                                                            |       1816       ||       4624       |                                                                                |       2499       |
--------------------                                                            ----------------------------------------                                                                                --------------------
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                            |    PROJECTION    |
|       INNER      |                                        |       item       ||   IN(i_category  ||       INNER      |                                                            |                  ||       INNER      |                                                            |                  |
|    ss_addr_sk    |                                        |                  ||   , Electronics  ||    cs_item_sk    |                                                            |                  ||    ws_item_sk    |                                                            |                  |
|  =ca_address_sk  |                                        |                  ||                  ||    =i_item_sk    |                                                            |                  ||    =i_item_sk    |                                                            |                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|       11163      |                                        |       18000      ||       1816       ||       5224       |                                                            |       1816       ||       2886       |                                                            |       1816       |
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
|     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      |
|       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                                        |       item       ||   IN(i_category  ||       INNER      |                                        |       item       ||   IN(i_category  |
|  ss_sold_date_sk |                    |    = -5.000000   |                    |                  ||  cs_bill_addr_sk |                                        |                  ||   , Electronics  ||  ws_bill_addr_sk |                                        |                  ||   , Electronics  |
|    =d_date_sk    |                    |                  |                    |                  ||  =ca_address_sk  |                                        |                  ||                  ||  =ca_address_sk  |                                        |                  ||                  |
|      (0.04s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |
|       28265      |                    |       18832      |                    |       18000      ||       5224       |                                        |       18000      ||       1816       ||       2886       |                                        |       18000      ||       1816       |
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
|     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     |
|    store_sales   ||     d_moy = 5    || customer_address |                                        |       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                    |   ca_gmt_offset  |                    |       item       |
|                  ||   d_year = 1998  ||                  |                                        |  cs_sold_date_sk |                    |    = -5.000000   |                    |                  ||  ws_sold_date_sk |                    |    = -5.000000   |                    |                  |
|                  ||                  ||                  |                                        |    =d_date_sk    |                    |                  |                    |                  ||    =d_date_sk    |                    |                  |                    |                  |
|      (0.02s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |                    |      (0.00s)     |
|      2880404     ||        31        ||       50000      |                                        |       14085      |                    |       18832      |                    |       18000      ||       7370       |                    |       18832      |                    |       18000      |
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                    |     SEQ_SCAN     |                                                            |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |
                    |     date_dim     |                                                            |   catalog_sales  ||     d_moy = 5    || customer_address |                                        |     web_sales    ||     d_moy = 5    || customer_address |
                    |                  |                                                            |                  ||   d_year = 1998  ||                  |                                        |                  ||   d_year = 1998  ||                  |
                    |      (0.00s)     |                                                            |      (0.01s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                    |       73049      |                                                            |      1441548     ||        31        ||       50000      |                                        |      719384      ||        31        ||       50000      |
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                                                                                                                        --------------------                                                                                --------------------
                                                                                                                        |     SEQ_SCAN     |                                                                                |     SEQ_SCAN     |
                                                                                                                        |     date_dim     |                                                                                |     date_dim     |
                                                                                                                        |      (0.00s)     |                                                                                |      (0.00s)     |
                                                                                                                        |       73049      |                                                                                |       73049      |
                                                                                                                        --------------------                                                                                --------------------

<<Query Profiling Information>>
WITH ss AS ( SELECT i_manufact_id, sum(ss_ext_sales_price) total_sales FROM store_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), cs AS ( SELECT i_manufact_id, sum(cs_ext_sales_price) total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), ws AS ( SELECT i_manufact_id, sum(ws_ext_sales_price) total_sales FROM web_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id) SELECT i_manufact_id, sum(total_sales) total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100;
<<Timing>>
Total Time: 0.137100s
<<Operator Tree>>
--------------------
|       PRUNE      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        717       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        717       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       2033       |
--------------------
--------------------                                                                                --------------------
|    PROJECTION    |                                                                                |       UNION      |
|      (0.00s)     |                                                                                |      (0.00s)     |
|        712       |                                                                                |       1321       |
--------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                                                |    PROJECTION    |
|      (0.00s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|        712       |                                                                                |        684       |                                                                                |        637       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                                                |   HASH_GROUP_BY  |
|       SEMI       |                                                                                |                  |                                                                                |                  |
| i_manufact_id=#0 |                                                                                |                  |                                                                                |                  |
|      (0.01s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       9815       |                                                                                |        684       |                                                                                |        637       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                            ----------------------------------------                                                                                --------------------
|     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                                                |     HASH_JOIN    |
|       INNER      |                                                            |                  ||       SEMI       |                                                                                |       SEMI       |
|    ss_item_sk    |                                                            |                  || i_manufact_id=#0 |                                                                                | i_manufact_id=#0 |
|    =i_item_sk    |                                                            |                  ||                  |                                                                                |                  |
|      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.00s)     |
|       11163      |                                                            |       1816       ||       4624       |                                                                                |       2499       |
--------------------                                                            ----------------------------------------                                                                                --------------------
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                            |    PROJECTION    |
|       INNER      |                                        |       item       ||   IN(i_category  ||       INNER      |                                                            |                  ||       INNER      |                                                            |                  |
|    ss_addr_sk    |                                        |                  ||   , Electronics  ||    cs_item_sk    |                                                            |                  ||    ws_item_sk    |                                                            |                  |
|  =ca_address_sk  |                                        |                  ||                  ||    =i_item_sk    |                                                            |                  ||    =i_item_sk    |                                                            |                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|       11163      |                                        |       18000      ||       1816       ||       5224       |                                                            |       1816       ||       2886       |                                                            |       1816       |
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
|     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      |
|       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                                        |       item       ||   IN(i_category  ||       INNER      |                                        |       item       ||   IN(i_category  |
|  ss_sold_date_sk |                    |    = -5.000000   |                    |                  ||  cs_bill_addr_sk |                                        |                  ||   , Electronics  ||  ws_bill_addr_sk |                                        |                  ||   , Electronics  |
|    =d_date_sk    |                    |                  |                    |                  ||  =ca_address_sk  |                                        |                  ||                  ||  =ca_address_sk  |                                        |                  ||                  |
|      (0.04s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |
|       28265      |                    |       18832      |                    |       18000      ||       5224       |                                        |       18000      ||       1816       ||       2886       |                                        |       18000      ||       1816       |
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
|     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     |
|    store_sales   ||     d_moy = 5    || customer_address |                                        |       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                    |   ca_gmt_offset  |                    |       item       |
|                  ||   d_year = 1998  ||                  |                                        |  cs_sold_date_sk |                    |    = -5.000000   |                    |                  ||  ws_sold_date_sk |                    |    = -5.000000   |                    |                  |
|                  ||                  ||                  |                                        |    =d_date_sk    |                    |                  |                    |                  ||    =d_date_sk    |                    |                  |                    |                  |
|      (0.02s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |                    |      (0.00s)     |
|      2880404     ||        31        ||       50000      |                                        |       14085      |                    |       18832      |                    |       18000      ||       7370       |                    |       18832      |                    |       18000      |
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                    |     SEQ_SCAN     |                                                            |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |
                    |     date_dim     |                                                            |   catalog_sales  ||     d_moy = 5    || customer_address |                                        |     web_sales    ||     d_moy = 5    || customer_address |
                    |                  |                                                            |                  ||   d_year = 1998  ||                  |                                        |                  ||   d_year = 1998  ||                  |
                    |      (0.00s)     |                                                            |      (0.01s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                    |       73049      |                                                            |      1441548     ||        31        ||       50000      |                                        |      719384      ||        31        ||       50000      |
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                                                                                                                        --------------------                                                                                --------------------
                                                                                                                        |     SEQ_SCAN     |                                                                                |     SEQ_SCAN     |
                                                                                                                        |     date_dim     |                                                                                |     date_dim     |
                                                                                                                        |      (0.00s)     |                                                                                |      (0.00s)     |
                                                                                                                        |       73049      |                                                                                |       73049      |
                                                                                                                        --------------------                                                                                --------------------

<<Query Profiling Information>>
WITH ss AS ( SELECT i_manufact_id, sum(ss_ext_sales_price) total_sales FROM store_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), cs AS ( SELECT i_manufact_id, sum(cs_ext_sales_price) total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), ws AS ( SELECT i_manufact_id, sum(ws_ext_sales_price) total_sales FROM web_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id) SELECT i_manufact_id, sum(total_sales) total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100;
<<Timing>>
Total Time: 0.137270s
<<Operator Tree>>
--------------------
|       PRUNE      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        717       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        717       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       2033       |
--------------------
--------------------                                                                                --------------------
|    PROJECTION    |                                                                                |       UNION      |
|      (0.00s)     |                                                                                |      (0.00s)     |
|        712       |                                                                                |       1321       |
--------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                                                |    PROJECTION    |
|      (0.00s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|        712       |                                                                                |        684       |                                                                                |        637       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                                                |   HASH_GROUP_BY  |
|       SEMI       |                                                                                |                  |                                                                                |                  |
| i_manufact_id=#0 |                                                                                |                  |                                                                                |                  |
|      (0.01s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       9815       |                                                                                |        684       |                                                                                |        637       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                            ----------------------------------------                                                                                --------------------
|     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                                                |     HASH_JOIN    |
|       INNER      |                                                            |                  ||       SEMI       |                                                                                |       SEMI       |
|    ss_item_sk    |                                                            |                  || i_manufact_id=#0 |                                                                                | i_manufact_id=#0 |
|    =i_item_sk    |                                                            |                  ||                  |                                                                                |                  |
|      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.00s)     |
|       11163      |                                                            |       1816       ||       4624       |                                                                                |       2499       |
--------------------                                                            ----------------------------------------                                                                                --------------------
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                            |    PROJECTION    |
|       INNER      |                                        |       item       ||   IN(i_category  ||       INNER      |                                                            |                  ||       INNER      |                                                            |                  |
|    ss_addr_sk    |                                        |                  ||   , Electronics  ||    cs_item_sk    |                                                            |                  ||    ws_item_sk    |                                                            |                  |
|  =ca_address_sk  |                                        |                  ||                  ||    =i_item_sk    |                                                            |                  ||    =i_item_sk    |                                                            |                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|       11163      |                                        |       18000      ||       1816       ||       5224       |                                                            |       1816       ||       2886       |                                                            |       1816       |
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
|     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      |
|       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                                        |       item       ||   IN(i_category  ||       INNER      |                                        |       item       ||   IN(i_category  |
|  ss_sold_date_sk |                    |    = -5.000000   |                    |                  ||  cs_bill_addr_sk |                                        |                  ||   , Electronics  ||  ws_bill_addr_sk |                                        |                  ||   , Electronics  |
|    =d_date_sk    |                    |                  |                    |                  ||  =ca_address_sk  |                                        |                  ||                  ||  =ca_address_sk  |                                        |                  ||                  |
|      (0.04s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |
|       28265      |                    |       18832      |                    |       18000      ||       5224       |                                        |       18000      ||       1816       ||       2886       |                                        |       18000      ||       1816       |
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
|     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     |
|    store_sales   ||     d_moy = 5    || customer_address |                                        |       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                    |   ca_gmt_offset  |                    |       item       |
|                  ||   d_year = 1998  ||                  |                                        |  cs_sold_date_sk |                    |    = -5.000000   |                    |                  ||  ws_sold_date_sk |                    |    = -5.000000   |                    |                  |
|                  ||                  ||                  |                                        |    =d_date_sk    |                    |                  |                    |                  ||    =d_date_sk    |                    |                  |                    |                  |
|      (0.02s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |                    |      (0.00s)     |
|      2880404     ||        31        ||       50000      |                                        |       14085      |                    |       18832      |                    |       18000      ||       7370       |                    |       18832      |                    |       18000      |
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                    |     SEQ_SCAN     |                                                            |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |
                    |     date_dim     |                                                            |   catalog_sales  ||     d_moy = 5    || customer_address |                                        |     web_sales    ||     d_moy = 5    || customer_address |
                    |                  |                                                            |                  ||   d_year = 1998  ||                  |                                        |                  ||   d_year = 1998  ||                  |
                    |      (0.00s)     |                                                            |      (0.01s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                    |       73049      |                                                            |      1441548     ||        31        ||       50000      |                                        |      719384      ||        31        ||       50000      |
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                                                                                                                        --------------------                                                                                --------------------
                                                                                                                        |     SEQ_SCAN     |                                                                                |     SEQ_SCAN     |
                                                                                                                        |     date_dim     |                                                                                |     date_dim     |
                                                                                                                        |      (0.00s)     |                                                                                |      (0.00s)     |
                                                                                                                        |       73049      |                                                                                |       73049      |
                                                                                                                        --------------------                                                                                --------------------

<<Query Profiling Information>>
WITH ss AS ( SELECT i_manufact_id, sum(ss_ext_sales_price) total_sales FROM store_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), cs AS ( SELECT i_manufact_id, sum(cs_ext_sales_price) total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), ws AS ( SELECT i_manufact_id, sum(ws_ext_sales_price) total_sales FROM web_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id) SELECT i_manufact_id, sum(total_sales) total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100;
<<Timing>>
Total Time: 0.137645s
<<Operator Tree>>
--------------------
|       PRUNE      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.00s)     |
|        717       |
--------------------
--------------------
|   HASH_GROUP_BY  |
|      (0.00s)     |
|        717       |
--------------------
--------------------
|       UNION      |
|      (0.00s)     |
|       2033       |
--------------------
--------------------                                                                                --------------------
|    PROJECTION    |                                                                                |       UNION      |
|      (0.00s)     |                                                                                |      (0.00s)     |
|        712       |                                                                                |       1321       |
--------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|   HASH_GROUP_BY  |                                                                                |    PROJECTION    |                                                                                |    PROJECTION    |
|      (0.00s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|        712       |                                                                                |        684       |                                                                                |        637       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                                                --------------------                                                                                --------------------
|     HASH_JOIN    |                                                                                |   HASH_GROUP_BY  |                                                                                |   HASH_GROUP_BY  |
|       SEMI       |                                                                                |                  |                                                                                |                  |
| i_manufact_id=#0 |                                                                                |                  |                                                                                |                  |
|      (0.01s)     |                                                                                |      (0.00s)     |                                                                                |      (0.00s)     |
|       9815       |                                                                                |        684       |                                                                                |        637       |
--------------------                                                                                --------------------                                                                                --------------------
--------------------                                                            ----------------------------------------                                                                                --------------------
|     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                                                |     HASH_JOIN    |
|       INNER      |                                                            |                  ||       SEMI       |                                                                                |       SEMI       |
|    ss_item_sk    |                                                            |                  || i_manufact_id=#0 |                                                                                | i_manufact_id=#0 |
|    =i_item_sk    |                                                            |                  ||                  |                                                                                |                  |
|      (0.01s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                                                |      (0.00s)     |
|       11163      |                                                            |       1816       ||       4624       |                                                                                |       2499       |
--------------------                                                            ----------------------------------------                                                                                --------------------
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                                            |    PROJECTION    ||     HASH_JOIN    |                                                            |    PROJECTION    |
|       INNER      |                                        |       item       ||   IN(i_category  ||       INNER      |                                                            |                  ||       INNER      |                                                            |                  |
|    ss_addr_sk    |                                        |                  ||   , Electronics  ||    cs_item_sk    |                                                            |                  ||    ws_item_sk    |                                                            |                  |
|  =ca_address_sk  |                                        |                  ||                  ||    =i_item_sk    |                                                            |                  ||    =i_item_sk    |                                                            |                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     ||      (0.00s)     |                                                            |      (0.00s)     |
|       11163      |                                        |       18000      ||       1816       ||       5224       |                                                            |       1816       ||       2886       |                                                            |       1816       |
--------------------                                        ------------------------------------------------------------                                                            ----------------------------------------                                                            --------------------
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
|     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      ||     HASH_JOIN    |                                        |     SEQ_SCAN     ||      FILTER      |
|       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                                        |       item       ||   IN(i_category  ||       INNER      |                                        |       item       ||   IN(i_category  |
|  ss_sold_date_sk |                    |    = -5.000000   |                    |                  ||  cs_bill_addr_sk |                                        |                  ||   , Electronics  ||  ws_bill_addr_sk |                                        |                  ||   , Electronics  |
|    =d_date_sk    |                    |                  |                    |                  ||  =ca_address_sk  |                                        |                  ||                  ||  =ca_address_sk  |                                        |                  ||                  |
|      (0.04s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     |
|       28265      |                    |       18832      |                    |       18000      ||       5224       |                                        |       18000      ||       1816       ||       2886       |                                        |       18000      ||       1816       |
--------------------                    --------------------                    ----------------------------------------                                        ------------------------------------------------------------                                        ----------------------------------------
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
|     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     ||     HASH_JOIN    |                    |      FILTER      |                    |     SEQ_SCAN     |
|    store_sales   ||     d_moy = 5    || customer_address |                                        |       INNER      |                    |   ca_gmt_offset  |                    |       item       ||       INNER      |                    |   ca_gmt_offset  |                    |       item       |
|                  ||   d_year = 1998  ||                  |                                        |  cs_sold_date_sk |                    |    = -5.000000   |                    |                  ||  ws_sold_date_sk |                    |    = -5.000000   |                    |                  |
|                  ||                  ||                  |                                        |    =d_date_sk    |                    |                  |                    |                  ||    =d_date_sk    |                    |                  |                    |                  |
|      (0.02s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.01s)     |                    |      (0.00s)     |                    |      (0.00s)     |
|      2880404     ||        31        ||       50000      |                                        |       14085      |                    |       18832      |                    |       18000      ||       7370       |                    |       18832      |                    |       18000      |
------------------------------------------------------------                                        --------------------                    --------------------                    ----------------------------------------                    --------------------                    --------------------
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                    |     SEQ_SCAN     |                                                            |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |                                        |     SEQ_SCAN     ||      FILTER      ||     SEQ_SCAN     |
                    |     date_dim     |                                                            |   catalog_sales  ||     d_moy = 5    || customer_address |                                        |     web_sales    ||     d_moy = 5    || customer_address |
                    |                  |                                                            |                  ||   d_year = 1998  ||                  |                                        |                  ||   d_year = 1998  ||                  |
                    |      (0.00s)     |                                                            |      (0.01s)     ||      (0.00s)     ||      (0.00s)     |                                        |      (0.00s)     ||      (0.00s)     ||      (0.00s)     |
                    |       73049      |                                                            |      1441548     ||        31        ||       50000      |                                        |      719384      ||        31        ||       50000      |
                    --------------------                                                            ------------------------------------------------------------                                        ------------------------------------------------------------
                                                                                                                        --------------------                                                                                --------------------
                                                                                                                        |     SEQ_SCAN     |                                                                                |     SEQ_SCAN     |
                                                                                                                        |     date_dim     |                                                                                |     date_dim     |
                                                                                                                        |      (0.00s)     |                                                                                |      (0.00s)     |
                                                                                                                        |       73049      |                                                                                |       73049      |
                                                                                                                        --------------------                                                                                --------------------

