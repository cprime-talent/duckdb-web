<<Query Profiling Information>>
WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sum(sr_return_amt) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2000 GROUP BY sr_customer_sk, sr_store_sk) SELECT c_customer_id FROM customer_total_return ctr1, store, customer WHERE ctr1.ctr_total_return > (SELECT avg(ctr_total_return)*1.2 FROM customer_total_return ctr2 WHERE ctr1.ctr_store_sk = ctr2.ctr_store_sk) AND s_store_sk = ctr1.ctr_store_sk AND s_state = 'TN' AND ctr1.ctr_customer_sk = c_customer_sk ORDER BY c_customer_id LIMIT 100;
<<Timing>>
Total Time: 0.627772s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.42s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       59438      |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|  ctr_store_sk=#1 |
| ctr_total_return |
|        >#0       |
|      (0.02s)     |
|       59438      |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |
|       INNER      |                                                            |                  |
|  ctr_customer_sk |                                                            |                  |
|  =c_customer_sk  |                                                            |                  |
|      (0.03s)     |                                                            |      (0.01s)     |
|      218358      |                                                            |         6        |
--------------------                                                            --------------------
--------------------                                        ----------------------------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||   HASH_GROUP_BY  |
|       INNER      |                                        |     customer     ||                  |
|   ctr_store_sk   |                                        |                  ||                  |
|    =s_store_sk   |                                        |                  ||                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.05s)     |
|      218358      |                                        |      100000      ||      218358      |
--------------------                                        ----------------------------------------
--------------------                    --------------------                    --------------------
|   HASH_GROUP_BY  |                    |      FILTER      |                    |     HASH_JOIN    |
|                  |                    |   s_state = TN   |                    |       INNER      |
|                  |                    |                  |                    | sr_returned_date |
|                  |                    |                  |                    |   _sk=d_date_sk  |
|      (0.05s)     |                    |      (0.00s)     |                    |      (0.02s)     |
|      218358      |                    |        12        |                    |      287867      |
--------------------                    --------------------                    --------------------
--------------------                    --------------------                    ----------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |       store      |                    |   store_returns  ||     date_dim     |
| sr_returned_date |                    |                  |                    |                  ||                  |
|   _sk=d_date_sk  |                    |                  |                    |                  ||                  |
|      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      287867      |                    |        12        |                    |      287867      ||       73049      |
--------------------                    --------------------                    ----------------------------------------
----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |
|   store_returns  ||     date_dim     |
|      (0.00s)     ||      (0.00s)     |
|      287867      ||       73049      |
----------------------------------------

<<Query Profiling Information>>
WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sum(sr_return_amt) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2000 GROUP BY sr_customer_sk, sr_store_sk) SELECT c_customer_id FROM customer_total_return ctr1, store, customer WHERE ctr1.ctr_total_return > (SELECT avg(ctr_total_return)*1.2 FROM customer_total_return ctr2 WHERE ctr1.ctr_store_sk = ctr2.ctr_store_sk) AND s_store_sk = ctr1.ctr_store_sk AND s_state = 'TN' AND ctr1.ctr_customer_sk = c_customer_sk ORDER BY c_customer_id LIMIT 100;
<<Timing>>
Total Time: 0.635440s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.42s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       59438      |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|  ctr_store_sk=#1 |
| ctr_total_return |
|        >#0       |
|      (0.02s)     |
|       59438      |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |
|       INNER      |                                                            |                  |
|  ctr_customer_sk |                                                            |                  |
|  =c_customer_sk  |                                                            |                  |
|      (0.03s)     |                                                            |      (0.01s)     |
|      218358      |                                                            |         6        |
--------------------                                                            --------------------
--------------------                                        ----------------------------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||   HASH_GROUP_BY  |
|       INNER      |                                        |     customer     ||                  |
|   ctr_store_sk   |                                        |                  ||                  |
|    =s_store_sk   |                                        |                  ||                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.05s)     |
|      218358      |                                        |      100000      ||      218358      |
--------------------                                        ----------------------------------------
--------------------                    --------------------                    --------------------
|   HASH_GROUP_BY  |                    |      FILTER      |                    |     HASH_JOIN    |
|                  |                    |   s_state = TN   |                    |       INNER      |
|                  |                    |                  |                    | sr_returned_date |
|                  |                    |                  |                    |   _sk=d_date_sk  |
|      (0.05s)     |                    |      (0.00s)     |                    |      (0.02s)     |
|      218358      |                    |        12        |                    |      287867      |
--------------------                    --------------------                    --------------------
--------------------                    --------------------                    ----------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |       store      |                    |   store_returns  ||     date_dim     |
| sr_returned_date |                    |                  |                    |                  ||                  |
|   _sk=d_date_sk  |                    |                  |                    |                  ||                  |
|      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      287867      |                    |        12        |                    |      287867      ||       73049      |
--------------------                    --------------------                    ----------------------------------------
----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |
|   store_returns  ||     date_dim     |
|      (0.00s)     ||      (0.00s)     |
|      287867      ||       73049      |
----------------------------------------

<<Query Profiling Information>>
WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sum(sr_return_amt) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2000 GROUP BY sr_customer_sk, sr_store_sk) SELECT c_customer_id FROM customer_total_return ctr1, store, customer WHERE ctr1.ctr_total_return > (SELECT avg(ctr_total_return)*1.2 FROM customer_total_return ctr2 WHERE ctr1.ctr_store_sk = ctr2.ctr_store_sk) AND s_store_sk = ctr1.ctr_store_sk AND s_state = 'TN' AND ctr1.ctr_customer_sk = c_customer_sk ORDER BY c_customer_id LIMIT 100;
<<Timing>>
Total Time: 0.640101s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.42s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       59438      |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|  ctr_store_sk=#1 |
| ctr_total_return |
|        >#0       |
|      (0.03s)     |
|       59438      |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |
|       INNER      |                                                            |                  |
|  ctr_customer_sk |                                                            |                  |
|  =c_customer_sk  |                                                            |                  |
|      (0.03s)     |                                                            |      (0.01s)     |
|      218358      |                                                            |         6        |
--------------------                                                            --------------------
--------------------                                        ----------------------------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||   HASH_GROUP_BY  |
|       INNER      |                                        |     customer     ||                  |
|   ctr_store_sk   |                                        |                  ||                  |
|    =s_store_sk   |                                        |                  ||                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.05s)     |
|      218358      |                                        |      100000      ||      218358      |
--------------------                                        ----------------------------------------
--------------------                    --------------------                    --------------------
|   HASH_GROUP_BY  |                    |      FILTER      |                    |     HASH_JOIN    |
|                  |                    |   s_state = TN   |                    |       INNER      |
|                  |                    |                  |                    | sr_returned_date |
|                  |                    |                  |                    |   _sk=d_date_sk  |
|      (0.05s)     |                    |      (0.00s)     |                    |      (0.02s)     |
|      218358      |                    |        12        |                    |      287867      |
--------------------                    --------------------                    --------------------
--------------------                    --------------------                    ----------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |       store      |                    |   store_returns  ||     date_dim     |
| sr_returned_date |                    |                  |                    |                  ||                  |
|   _sk=d_date_sk  |                    |                  |                    |                  ||                  |
|      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      287867      |                    |        12        |                    |      287867      ||       73049      |
--------------------                    --------------------                    ----------------------------------------
----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |
|   store_returns  ||     date_dim     |
|      (0.00s)     ||      (0.00s)     |
|      287867      ||       73049      |
----------------------------------------

<<Query Profiling Information>>
WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sum(sr_return_amt) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2000 GROUP BY sr_customer_sk, sr_store_sk) SELECT c_customer_id FROM customer_total_return ctr1, store, customer WHERE ctr1.ctr_total_return > (SELECT avg(ctr_total_return)*1.2 FROM customer_total_return ctr2 WHERE ctr1.ctr_store_sk = ctr2.ctr_store_sk) AND s_store_sk = ctr1.ctr_store_sk AND s_state = 'TN' AND ctr1.ctr_customer_sk = c_customer_sk ORDER BY c_customer_id LIMIT 100;
<<Timing>>
Total Time: 0.639956s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.43s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       59438      |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|  ctr_store_sk=#1 |
| ctr_total_return |
|        >#0       |
|      (0.03s)     |
|       59438      |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |
|       INNER      |                                                            |                  |
|  ctr_customer_sk |                                                            |                  |
|  =c_customer_sk  |                                                            |                  |
|      (0.03s)     |                                                            |      (0.01s)     |
|      218358      |                                                            |         6        |
--------------------                                                            --------------------
--------------------                                        ----------------------------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||   HASH_GROUP_BY  |
|       INNER      |                                        |     customer     ||                  |
|   ctr_store_sk   |                                        |                  ||                  |
|    =s_store_sk   |                                        |                  ||                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.05s)     |
|      218358      |                                        |      100000      ||      218358      |
--------------------                                        ----------------------------------------
--------------------                    --------------------                    --------------------
|   HASH_GROUP_BY  |                    |      FILTER      |                    |     HASH_JOIN    |
|                  |                    |   s_state = TN   |                    |       INNER      |
|                  |                    |                  |                    | sr_returned_date |
|                  |                    |                  |                    |   _sk=d_date_sk  |
|      (0.05s)     |                    |      (0.00s)     |                    |      (0.02s)     |
|      218358      |                    |        12        |                    |      287867      |
--------------------                    --------------------                    --------------------
--------------------                    --------------------                    ----------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |       store      |                    |   store_returns  ||     date_dim     |
| sr_returned_date |                    |                  |                    |                  ||                  |
|   _sk=d_date_sk  |                    |                  |                    |                  ||                  |
|      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      287867      |                    |        12        |                    |      287867      ||       73049      |
--------------------                    --------------------                    ----------------------------------------
----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |
|   store_returns  ||     date_dim     |
|      (0.00s)     ||      (0.00s)     |
|      287867      ||       73049      |
----------------------------------------

<<Query Profiling Information>>
WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sum(sr_return_amt) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2000 GROUP BY sr_customer_sk, sr_store_sk) SELECT c_customer_id FROM customer_total_return ctr1, store, customer WHERE ctr1.ctr_total_return > (SELECT avg(ctr_total_return)*1.2 FROM customer_total_return ctr2 WHERE ctr1.ctr_store_sk = ctr2.ctr_store_sk) AND s_store_sk = ctr1.ctr_store_sk AND s_state = 'TN' AND ctr1.ctr_customer_sk = c_customer_sk ORDER BY c_customer_id LIMIT 100;
<<Timing>>
Total Time: 0.629291s
<<Operator Tree>>
--------------------
|       LIMIT      |
|      (0.00s)     |
|        100       |
--------------------
--------------------
|     ORDER_BY     |
|      (0.42s)     |
|       1024       |
--------------------
--------------------
|    PROJECTION    |
|      (0.00s)     |
|       59438      |
--------------------
--------------------
|     HASH_JOIN    |
|       INNER      |
|  ctr_store_sk=#1 |
| ctr_total_return |
|        >#0       |
|      (0.03s)     |
|       59438      |
--------------------
--------------------                                                            --------------------
|     HASH_JOIN    |                                                            |   HASH_GROUP_BY  |
|       INNER      |                                                            |                  |
|  ctr_customer_sk |                                                            |                  |
|  =c_customer_sk  |                                                            |                  |
|      (0.03s)     |                                                            |      (0.01s)     |
|      218358      |                                                            |         6        |
--------------------                                                            --------------------
--------------------                                        ----------------------------------------
|     HASH_JOIN    |                                        |     SEQ_SCAN     ||   HASH_GROUP_BY  |
|       INNER      |                                        |     customer     ||                  |
|   ctr_store_sk   |                                        |                  ||                  |
|    =s_store_sk   |                                        |                  ||                  |
|      (0.01s)     |                                        |      (0.00s)     ||      (0.05s)     |
|      218358      |                                        |      100000      ||      218358      |
--------------------                                        ----------------------------------------
--------------------                    --------------------                    --------------------
|   HASH_GROUP_BY  |                    |      FILTER      |                    |     HASH_JOIN    |
|                  |                    |   s_state = TN   |                    |       INNER      |
|                  |                    |                  |                    | sr_returned_date |
|                  |                    |                  |                    |   _sk=d_date_sk  |
|      (0.05s)     |                    |      (0.00s)     |                    |      (0.02s)     |
|      218358      |                    |        12        |                    |      287867      |
--------------------                    --------------------                    --------------------
--------------------                    --------------------                    ----------------------------------------
|     HASH_JOIN    |                    |     SEQ_SCAN     |                    |     SEQ_SCAN     ||     SEQ_SCAN     |
|       INNER      |                    |       store      |                    |   store_returns  ||     date_dim     |
| sr_returned_date |                    |                  |                    |                  ||                  |
|   _sk=d_date_sk  |                    |                  |                    |                  ||                  |
|      (0.02s)     |                    |      (0.00s)     |                    |      (0.00s)     ||      (0.00s)     |
|      287867      |                    |        12        |                    |      287867      ||       73049      |
--------------------                    --------------------                    ----------------------------------------
----------------------------------------
|     SEQ_SCAN     ||     SEQ_SCAN     |
|   store_returns  ||     date_dim     |
|      (0.00s)     ||      (0.00s)     |
|      287867      ||       73049      |
----------------------------------------

