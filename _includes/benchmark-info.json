{"Append100KIntegersINSERT": "<h1>Description</h1><p>Append100KIntegersINSERT - [append]\nAppend 100K 4-byte integers to a table using a series of INSERT INTO statements</p>", "Append100KIntegersINSERTDisk": "<h1>Description</h1><p>Append100KIntegersINSERTDisk - [append]\nAppend 100K 4-byte integers to a table using a series of INSERT INTO statements</p>", "Append100KIntegersINSERTPrimary": "<h1>Description</h1><p>Append100KIntegersINSERTPrimary - [append]\nAppend 100K 4-byte integers to a table using a series of INSERT INTO statements</p>", "Append100KIntegersINSERTAutoCommit": "<h1>Description</h1><p>Append100KIntegersINSERTAutoCommit - [append]\nAppend 100K 4-byte integers to a table using a series of INSERT INTO statements</p>", "Append100KIntegersPREPARED": "<h1>Description</h1><p>Append100KIntegersPREPARED - [append]\nAppend 100K 4-byte integers to a table using a series of prepared INSERT INTO statements</p>", "Append100KIntegersPREPAREDDisk": "<h1>Description</h1><p>Append100KIntegersPREPAREDDisk - [append]\nAppend 100K 4-byte integers to a table using a series of prepared INSERT INTO statements</p>", "Append100KIntegersPREPAREDPrimary": "<h1>Description</h1><p>Append100KIntegersPREPAREDPrimary - [append]\nAppend 100K 4-byte integers to a table using a series of prepared INSERT INTO statements</p>", "Append100KIntegersAPPENDER": "<h1>Description</h1><p>Append100KIntegersAPPENDER - [append]\nAppend 100K 4-byte integers to a table using an Appender</p>", "Append100KIntegersAPPENDERDisk": "<h1>Description</h1><p>Append100KIntegersAPPENDERDisk - [append]\nAppend 100K 4-byte integers to a table using an Appender</p>", "Append100KIntegersAPPENDERPrimary": "<h1>Description</h1><p>Append100KIntegersAPPENDERPrimary - [append]\nAppend 100K 4-byte integers to a table using an Appender</p>", "Append100KIntegersCOPY": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">COPY</span> integers\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    <span style=\"color:firebrick;\">'integers.csv'</span> <span style=\"color:black;font-weight:bold;\">DELIMITER</span> <span style=\"color:firebrick;\">'|'</span>\n</pre>\n\t\t", "Append100KIntegersCOPYDisk": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">COPY</span> integers\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    <span style=\"color:firebrick;\">'integers.csv'</span> <span style=\"color:black;font-weight:bold;\">DELIMITER</span> <span style=\"color:firebrick;\">'|'</span>\n</pre>\n\t\t", "Append100KIntegersCOPYPrimary": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">COPY</span> integers\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    <span style=\"color:firebrick;\">'integers.csv'</span> <span style=\"color:black;font-weight:bold;\">DELIMITER</span> <span style=\"color:firebrick;\">'|'</span>\n</pre>\n\t\t", "Write100KIntegers": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">COPY</span> integers TO <span style=\"color:firebrick;\">'integers.csv'</span> <span style=\"color:black;font-weight:bold;\">DELIMITER</span> <span style=\"color:firebrick;\">'|'</span> <span style=\"color:black;font-weight:bold;\">HEADER</span>\n</pre>\n\t\t", "SimpleAggregate": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">SUM</span>(i)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    integers\n</pre>\n\t\t", "SimpleGroupByAggregate": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i,\n    <span style=\"color:black;font-weight:bold;\">SUM</span>(j)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    integers\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i\n</pre>\n\t\t", "InList0001Entry": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    strings\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s <span style=\"color:black;font-weight:bold;\">IN</span> ()\n</pre>\n\t\t", "InList0002Entry": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    strings\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s <span style=\"color:black;font-weight:bold;\">IN</span> ()\n</pre>\n\t\t", "InList0004Entry": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    strings\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s <span style=\"color:black;font-weight:bold;\">IN</span> ()\n</pre>\n\t\t", "InList0008Entry": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    strings\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s <span style=\"color:black;font-weight:bold;\">IN</span> ()\n</pre>\n\t\t", "InList0016Entry": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    strings\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s <span style=\"color:black;font-weight:bold;\">IN</span> ()\n</pre>\n\t\t", "InList0032Entry": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    strings\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s <span style=\"color:black;font-weight:bold;\">IN</span> ()\n</pre>\n\t\t", "InList0064Entry": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    strings\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s <span style=\"color:black;font-weight:bold;\">IN</span> ()\n</pre>\n\t\t", "InList0128Entry": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    strings\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s <span style=\"color:black;font-weight:bold;\">IN</span> ()\n</pre>\n\t\t", "InList0256Entry": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    strings\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s <span style=\"color:black;font-weight:bold;\">IN</span> ()\n</pre>\n\t\t", "InList0512Entry": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    strings\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s <span style=\"color:black;font-weight:bold;\">IN</span> ()\n</pre>\n\t\t", "InList1024Entry": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    strings\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s <span style=\"color:black;font-weight:bold;\">IN</span> ()\n</pre>\n\t\t", "InList2048Entry": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    strings\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s <span style=\"color:black;font-weight:bold;\">IN</span> ()\n</pre>\n\t\t", "Multiplication": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    (i * j) + (i * j) + (i * j) + (i * j)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    integers\n</pre>\n\t\t", "OrderBySingleColumn": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    integers\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i\n</pre>\n\t\t", "PointQueryWithoutIndex": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    j\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    integers\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    i = 50000\n</pre>\n\t\t", "PointQueryWithIndexART": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    j\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    integers\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    i = 50000\n</pre>\n\t\t", "IndexCreationART": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">CREATE <span style=\"color:black;font-weight:bold;\">INDEX</span> i_index <span style=\"color:black;font-weight:bold;\">ON</span> integers\n<span style=\"color:black;font-weight:bold;\">USING</span> art (i)\n</pre>\n\t\t", "RangeJoin": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    integers a,\n    integers b\n<span style=\"color:black;font-weight:bold;\">WHERE</span> (a.i / 1000) > b.j;\n\n</pre>\n\t\t", "RangeQueryWithoutIndex": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(j)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    integers\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    i >= 15000100\n    <span style=\"color:black;font-weight:bold;\">AND</span> i <= 15000200\n</pre>\n\t\t", "RangeQueryWithIndexART": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(j)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    integers\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    i >= 15000100\n    <span style=\"color:black;font-weight:bold;\">AND</span> i <= 15000200\n</pre>\n\t\t", "Window": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">SUM</span>(i) OVER (<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> i <span style=\"color:black;font-weight:bold;\">ROWS</span> <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1000 <span style=\"color:black;font-weight:bold;\">PRECEDING</span> <span style=\"color:black;font-weight:bold;\">AND</span> 1000 <span style=\"color:black;font-weight:bold;\">FOLLOWING</span>)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    integers\n</pre>\n\t\t", "SELECT1Memory": "<h1>Description</h1><p>SELECT1Memory - [storage]\nRun the query \"SELECT 1\" 50K times in in-memory mode</p>", "SELECT1Disk": "<h1>Description</h1><p>SELECT1Disk - [storage]\nRun the query \"SELECT 1\" 50K times in in-memory mode</p>", "LineitemSimpleAggregate": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">SUM</span>(l_quantity)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n</pre>\n\t\t", "LineitemGroupAggregate": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    l_quantity,\n    <span style=\"color:black;font-weight:bold;\">SUM</span>(l_quantity)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    l_quantity\n</pre>\n\t\t", "LineitemGroupStringAggregate": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">SUM</span>(l_quantity)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    l_returnflag\n</pre>\n\t\t", "Q01": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    l_returnflag,\n    l_linestatus,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(l_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> sum_qty,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(l_extendedprice) <span style=\"color:black;font-weight:bold;\">AS</span> sum_base_price,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(l_extendedprice * (1 - l_discount)) <span style=\"color:black;font-weight:bold;\">AS</span> sum_disc_price,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(l_extendedprice * (1 - l_discount) * (1 + l_tax)) <span style=\"color:black;font-weight:bold;\">AS</span> sum_charge,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(l_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> avg_qty,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(l_extendedprice) <span style=\"color:black;font-weight:bold;\">AS</span> avg_price,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(l_discount) <span style=\"color:black;font-weight:bold;\">AS</span> avg_disc,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) <span style=\"color:black;font-weight:bold;\">AS</span> count_order\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_shipdate <= <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1998-09-02'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    l_returnflag,\n    l_linestatus\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    l_returnflag,\n    l_linestatus;\n\n</pre>\n\t\t", "Q02": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    s_acctbal,\n    s_name,\n    n_name,\n    p_partkey,\n    p_mfgr,\n    s_address,\n    s_phone,\n    s_comment\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    part,\n    supplier,\n    partsupp,\n    nation,\n    region\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    p_partkey = ps_partkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> s_suppkey = ps_suppkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> p_size = 15\n    <span style=\"color:black;font-weight:bold;\">AND</span> p_type <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%BRASS'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> s_nationkey = n_nationkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> n_regionkey = r_regionkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> r_name = <span style=\"color:firebrick;\">'EUROPE'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ps_supplycost = (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            min(ps_supplycost)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            partsupp,\n            supplier,\n            nation,\n            region\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            p_partkey = ps_partkey\n            <span style=\"color:black;font-weight:bold;\">AND</span> s_suppkey = ps_suppkey\n            <span style=\"color:black;font-weight:bold;\">AND</span> s_nationkey = n_nationkey\n            <span style=\"color:black;font-weight:bold;\">AND</span> n_regionkey = r_regionkey\n            <span style=\"color:black;font-weight:bold;\">AND</span> r_name = <span style=\"color:firebrick;\">'EUROPE'</span>)\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    s_acctbal <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    n_name,\n    s_name,\n    p_partkey\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "Q03": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    l_orderkey,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(l_extendedprice * (1 - l_discount)) <span style=\"color:black;font-weight:bold;\">AS</span> revenue,\n    o_orderdate,\n    o_shippriority\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    customer,\n    orders,\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    c_mktsegment = <span style=\"color:firebrick;\">'BUILDING'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> c_custkey = o_custkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_orderkey = o_orderkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> o_orderdate < <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1995-03-15'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_shipdate > <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1995-03-15'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    l_orderkey,\n    o_orderdate,\n    o_shippriority\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    revenue <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    o_orderdate\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 10;\n\n</pre>\n\t\t", "Q04": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    o_orderpriority,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) <span style=\"color:black;font-weight:bold;\">AS</span> order_count\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    orders\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    o_orderdate >= <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1993-07-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> o_orderdate < <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1993-10-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            *\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            lineitem\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            l_orderkey = o_orderkey\n            <span style=\"color:black;font-weight:bold;\">AND</span> l_commitdate < l_receiptdate)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    o_orderpriority\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    o_orderpriority;\n\n</pre>\n\t\t", "Q05": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    n_name,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(l_extendedprice * (1 - l_discount)) <span style=\"color:black;font-weight:bold;\">AS</span> revenue\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    customer,\n    orders,\n    lineitem,\n    supplier,\n    nation,\n    region\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    c_custkey = o_custkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_orderkey = o_orderkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_suppkey = s_suppkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> c_nationkey = s_nationkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> s_nationkey = n_nationkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> n_regionkey = r_regionkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> r_name = <span style=\"color:firebrick;\">'ASIA'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> o_orderdate >= <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1994-01-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> o_orderdate < <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1995-01-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    n_name\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    revenue <span style=\"color:black;font-weight:bold;\">DESC</span>;\n\n</pre>\n\t\t", "Q06": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(l_extendedprice * l_discount) <span style=\"color:black;font-weight:bold;\">AS</span> revenue\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_shipdate >= <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1994-01-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_shipdate < <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1995-01-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_discount <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 0.05\n    <span style=\"color:black;font-weight:bold;\">AND</span> 0.07\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_quantity < 24;\n\n</pre>\n\t\t", "Q07": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    supp_nation,\n    cust_nation,\n    l_year,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(volume) <span style=\"color:black;font-weight:bold;\">AS</span> revenue\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        n1.n_name <span style=\"color:black;font-weight:bold;\">AS</span> supp_nation,\n        n2.n_name <span style=\"color:black;font-weight:bold;\">AS</span> cust_nation,\n        <span style=\"color:black;font-weight:bold;\">extract</span>(year <span style=\"color:black;font-weight:bold;\">FROM</span> l_shipdate) <span style=\"color:black;font-weight:bold;\">AS</span> l_year,\n        l_extendedprice * (1 - l_discount) <span style=\"color:black;font-weight:bold;\">AS</span> volume\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        supplier,\n        lineitem,\n        orders,\n        customer,\n        nation n1,\n        nation n2\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        s_suppkey = l_suppkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> o_orderkey = l_orderkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_custkey = o_custkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_nationkey = n1.n_nationkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_nationkey = n2.n_nationkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> ((n1.n_name = <span style=\"color:firebrick;\">'FRANCE'</span>\n                <span style=\"color:black;font-weight:bold;\">AND</span> n2.n_name = <span style=\"color:firebrick;\">'GERMANY'</span>)\n            <span style=\"color:black;font-weight:bold;\">OR</span> (n1.n_name = <span style=\"color:firebrick;\">'GERMANY'</span>\n                <span style=\"color:black;font-weight:bold;\">AND</span> n2.n_name = <span style=\"color:firebrick;\">'FRANCE'</span>))\n        <span style=\"color:black;font-weight:bold;\">AND</span> l_shipdate <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1995-01-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1996-12-31'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)) <span style=\"color:black;font-weight:bold;\">AS</span> shipping\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    supp_nation,\n    cust_nation,\n    l_year\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    supp_nation,\n    cust_nation,\n    l_year;\n\n</pre>\n\t\t", "Q08": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    o_year,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> nation = <span style=\"color:firebrick;\">'BRAZIL'</span> <span style=\"color:black;font-weight:bold;\">THEN</span>\n            volume\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) / <span style=\"color:black;font-weight:bold;\">sum</span>(volume) <span style=\"color:black;font-weight:bold;\">AS</span> mkt_share\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">extract</span>(year <span style=\"color:black;font-weight:bold;\">FROM</span> o_orderdate) <span style=\"color:black;font-weight:bold;\">AS</span> o_year,\n        l_extendedprice * (1 - l_discount) <span style=\"color:black;font-weight:bold;\">AS</span> volume,\n        n2.n_name <span style=\"color:black;font-weight:bold;\">AS</span> nation\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        part,\n        supplier,\n        lineitem,\n        orders,\n        customer,\n        nation n1,\n        nation n2,\n        region\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        p_partkey = l_partkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_suppkey = l_suppkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> l_orderkey = o_orderkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> o_custkey = c_custkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_nationkey = n1.n_nationkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> n1.n_regionkey = r_regionkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> r_name = <span style=\"color:firebrick;\">'AMERICA'</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_nationkey = n2.n_nationkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> o_orderdate <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1995-01-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1996-12-31'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> p_type = <span style=\"color:firebrick;\">'ECONOMY ANODIZED STEEL'</span>) <span style=\"color:black;font-weight:bold;\">AS</span> all_nations\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    o_year\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    o_year;\n\n</pre>\n\t\t", "Q09": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    nation,\n    o_year,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(amount) <span style=\"color:black;font-weight:bold;\">AS</span> sum_profit\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        n_name <span style=\"color:black;font-weight:bold;\">AS</span> nation,\n        <span style=\"color:black;font-weight:bold;\">extract</span>(year <span style=\"color:black;font-weight:bold;\">FROM</span> o_orderdate) <span style=\"color:black;font-weight:bold;\">AS</span> o_year,\n        l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity <span style=\"color:black;font-weight:bold;\">AS</span> amount\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        part,\n        supplier,\n        lineitem,\n        partsupp,\n        orders,\n        nation\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        s_suppkey = l_suppkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> ps_suppkey = l_suppkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> ps_partkey = l_partkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> p_partkey = l_partkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> o_orderkey = l_orderkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_nationkey = n_nationkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> p_name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%green%'</span>) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    nation,\n    o_year\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    nation,\n    o_year <span style=\"color:black;font-weight:bold;\">DESC</span>;\n\n</pre>\n\t\t", "Q10": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_custkey,\n    c_name,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(l_extendedprice * (1 - l_discount)) <span style=\"color:black;font-weight:bold;\">AS</span> revenue,\n    c_acctbal,\n    n_name,\n    c_address,\n    c_phone,\n    c_comment\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    customer,\n    orders,\n    lineitem,\n    nation\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    c_custkey = o_custkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_orderkey = o_orderkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> o_orderdate >= <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1993-10-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> o_orderdate < <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1994-01-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_returnflag = <span style=\"color:firebrick;\">'R'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> c_nationkey = n_nationkey\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_custkey,\n    c_name,\n    c_acctbal,\n    c_phone,\n    n_name,\n    c_address,\n    c_comment\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    revenue <span style=\"color:black;font-weight:bold;\">DESC</span>\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 20;\n\n</pre>\n\t\t", "Q11": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    ps_partkey,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ps_supplycost * ps_availqty) <span style=\"color:black;font-weight:bold;\">AS</span> value\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    partsupp,\n    supplier,\n    nation\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ps_suppkey = s_suppkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> s_nationkey = n_nationkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> n_name = <span style=\"color:firebrick;\">'GERMANY'</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ps_partkey\n<span style=\"color:black;font-weight:bold;\">HAVING</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ps_supplycost * ps_availqty) > (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">sum</span>(ps_supplycost * ps_availqty) * 0.0001000000\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            partsupp,\n            supplier,\n            nation\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ps_suppkey = s_suppkey\n            <span style=\"color:black;font-weight:bold;\">AND</span> s_nationkey = n_nationkey\n            <span style=\"color:black;font-weight:bold;\">AND</span> n_name = <span style=\"color:firebrick;\">'GERMANY'</span>)\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    value <span style=\"color:black;font-weight:bold;\">DESC</span>;\n\n</pre>\n\t\t", "Q12": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    l_shipmode,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> o_orderpriority = <span style=\"color:firebrick;\">'1-URGENT'</span>\n            <span style=\"color:black;font-weight:bold;\">OR</span> o_orderpriority = <span style=\"color:firebrick;\">'2-HIGH'</span> <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> high_line_count,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> o_orderpriority <> <span style=\"color:firebrick;\">'1-URGENT'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> o_orderpriority <> <span style=\"color:firebrick;\">'2-HIGH'</span> <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> low_line_count\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    orders,\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    o_orderkey = l_orderkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_shipmode <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'MAIL'</span>, <span style=\"color:firebrick;\">'SHIP'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_commitdate < l_receiptdate\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_shipdate < l_commitdate\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_receiptdate >= <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1994-01-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_receiptdate < <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1995-01-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    l_shipmode\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    l_shipmode;\n\n</pre>\n\t\t", "Q13": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_count,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) <span style=\"color:black;font-weight:bold;\">AS</span> custdist\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_custkey,\n        <span style=\"color:black;font-weight:bold;\">count</span>(o_orderkey)\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        customer\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> orders <span style=\"color:black;font-weight:bold;\">ON</span> c_custkey = o_custkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> o_comment <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%special%requests%'</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_custkey) <span style=\"color:black;font-weight:bold;\">AS</span> c_orders (c_custkey,\n        c_count)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_count\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    custdist <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    c_count <span style=\"color:black;font-weight:bold;\">DESC</span>;\n\n</pre>\n\t\t", "Q14": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    100.00 * <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> p_type <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'PROMO%'</span> <span style=\"color:black;font-weight:bold;\">THEN</span>\n            l_extendedprice * (1 - l_discount)\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) / <span style=\"color:black;font-weight:bold;\">sum</span>(l_extendedprice * (1 - l_discount)) <span style=\"color:black;font-weight:bold;\">AS</span> promo_revenue\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem,\n    part\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_partkey = p_partkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_shipdate >= date <span style=\"color:firebrick;\">'1995-09-01'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_shipdate < <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1995-10-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date);\n\n</pre>\n\t\t", "Q15": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    s_suppkey,\n    s_name,\n    s_address,\n    s_phone,\n    total_revenue\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    supplier,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            l_suppkey <span style=\"color:black;font-weight:bold;\">AS</span> supplier_no,\n            <span style=\"color:black;font-weight:bold;\">sum</span>(l_extendedprice * (1 - l_discount)) <span style=\"color:black;font-weight:bold;\">AS</span> total_revenue\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            lineitem\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            l_shipdate >= <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1996-01-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n            <span style=\"color:black;font-weight:bold;\">AND</span> l_shipdate < <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1996-04-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            supplier_no) revenue0\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s_suppkey = supplier_no\n    <span style=\"color:black;font-weight:bold;\">AND</span> total_revenue = (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            max(total_revenue)\n        <span style=\"color:black;font-weight:bold;\">FROM</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                l_suppkey <span style=\"color:black;font-weight:bold;\">AS</span> supplier_no,\n                <span style=\"color:black;font-weight:bold;\">sum</span>(l_extendedprice * (1 - l_discount)) <span style=\"color:black;font-weight:bold;\">AS</span> total_revenue\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                lineitem\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                l_shipdate >= <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1996-01-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n                <span style=\"color:black;font-weight:bold;\">AND</span> l_shipdate < <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1996-04-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n            <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                supplier_no) revenue1)\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    s_suppkey;\n\n</pre>\n\t\t", "Q16": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    p_brand,\n    p_type,\n    p_size,\n    <span style=\"color:black;font-weight:bold;\">count</span>(<span style=\"color:black;font-weight:bold;\">DISTINCT</span> ps_suppkey) <span style=\"color:black;font-weight:bold;\">AS</span> supplier_cnt\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    partsupp,\n    part\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    p_partkey = ps_partkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> p_brand <> <span style=\"color:firebrick;\">'Brand#45'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> p_type <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'MEDIUM POLISHED%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> p_size <span style=\"color:black;font-weight:bold;\">IN</span> (49, 14, 23, 45, 19, 3, 36, 9)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ps_suppkey <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">IN</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            s_suppkey\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            supplier\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            s_comment <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Customer%Complaints%'</span>)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    p_brand,\n    p_type,\n    p_size\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    supplier_cnt <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    p_brand,\n    p_type,\n    p_size;\n\n</pre>\n\t\t", "Q17": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(l_extendedprice) / 7.0 <span style=\"color:black;font-weight:bold;\">AS</span> avg_yearly\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem,\n    part\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    p_partkey = l_partkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> p_brand = <span style=\"color:firebrick;\">'Brand#23'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> p_container = <span style=\"color:firebrick;\">'MED BOX'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_quantity < (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            0.2 * <span style=\"color:black;font-weight:bold;\">avg</span>(l_quantity)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            lineitem\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            l_partkey = p_partkey);\n\n</pre>\n\t\t", "Q18": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_name,\n    c_custkey,\n    o_orderkey,\n    o_orderdate,\n    o_totalprice,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(l_quantity)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    customer,\n    orders,\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    o_orderkey <span style=\"color:black;font-weight:bold;\">IN</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            l_orderkey\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            lineitem\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            l_orderkey\n        <span style=\"color:black;font-weight:bold;\">HAVING</span>\n            <span style=\"color:black;font-weight:bold;\">sum</span>(l_quantity) > 300)\n    <span style=\"color:black;font-weight:bold;\">AND</span> c_custkey = o_custkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> o_orderkey = l_orderkey\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_name,\n    c_custkey,\n    o_orderkey,\n    o_orderdate,\n    o_totalprice\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    o_totalprice <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    o_orderdate\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "Q19": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(l_extendedprice * (1 - l_discount)) <span style=\"color:black;font-weight:bold;\">AS</span> revenue\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem,\n    part\n<span style=\"color:black;font-weight:bold;\">WHERE</span> (p_partkey = l_partkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> p_brand = <span style=\"color:firebrick;\">'Brand#12'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> p_container <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'SM CASE'</span>, <span style=\"color:firebrick;\">'SM BOX'</span>, <span style=\"color:firebrick;\">'SM PACK'</span>, <span style=\"color:firebrick;\">'SM PKG'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_quantity >= 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_quantity <= 1 + 10\n    <span style=\"color:black;font-weight:bold;\">AND</span> p_size <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1 <span style=\"color:black;font-weight:bold;\">AND</span> 5\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_shipmode <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'AIR'</span>, <span style=\"color:firebrick;\">'AIR REG'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_shipinstruct = <span style=\"color:firebrick;\">'DELIVER IN PERSON'</span>)\n    <span style=\"color:black;font-weight:bold;\">OR</span> (p_partkey = l_partkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> p_brand = <span style=\"color:firebrick;\">'Brand#23'</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> p_container <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'MED BAG'</span>,\n            <span style=\"color:firebrick;\">'MED BOX'</span>,\n            <span style=\"color:firebrick;\">'MED PKG'</span>,\n            <span style=\"color:firebrick;\">'MED PACK'</span>)\n        <span style=\"color:black;font-weight:bold;\">AND</span> l_quantity >= 10\n        <span style=\"color:black;font-weight:bold;\">AND</span> l_quantity <= 10 + 10\n        <span style=\"color:black;font-weight:bold;\">AND</span> p_size <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1 <span style=\"color:black;font-weight:bold;\">AND</span> 10\n        <span style=\"color:black;font-weight:bold;\">AND</span> l_shipmode <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'AIR'</span>,\n            <span style=\"color:firebrick;\">'AIR REG'</span>)\n        <span style=\"color:black;font-weight:bold;\">AND</span> l_shipinstruct = <span style=\"color:firebrick;\">'DELIVER IN PERSON'</span>)\n    <span style=\"color:black;font-weight:bold;\">OR</span> (p_partkey = l_partkey\n        <span style=\"color:black;font-weight:bold;\">AND</span> p_brand = <span style=\"color:firebrick;\">'Brand#34'</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> p_container <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'LG CASE'</span>,\n            <span style=\"color:firebrick;\">'LG BOX'</span>,\n            <span style=\"color:firebrick;\">'LG PACK'</span>,\n            <span style=\"color:firebrick;\">'LG PKG'</span>)\n        <span style=\"color:black;font-weight:bold;\">AND</span> l_quantity >= 20\n        <span style=\"color:black;font-weight:bold;\">AND</span> l_quantity <= 20 + 10\n        <span style=\"color:black;font-weight:bold;\">AND</span> p_size <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1 <span style=\"color:black;font-weight:bold;\">AND</span> 15\n        <span style=\"color:black;font-weight:bold;\">AND</span> l_shipmode <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'AIR'</span>,\n            <span style=\"color:firebrick;\">'AIR REG'</span>)\n        <span style=\"color:black;font-weight:bold;\">AND</span> l_shipinstruct = <span style=\"color:firebrick;\">'DELIVER IN PERSON'</span>);\n\n</pre>\n\t\t", "Q20": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    s_name,\n    s_address\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    supplier,\n    nation\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s_suppkey <span style=\"color:black;font-weight:bold;\">IN</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ps_suppkey\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            partsupp\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ps_partkey <span style=\"color:black;font-weight:bold;\">IN</span> (\n                <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                    p_partkey\n                <span style=\"color:black;font-weight:bold;\">FROM</span>\n                    part\n                <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                    p_name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'forest%'</span>)\n                <span style=\"color:black;font-weight:bold;\">AND</span> ps_availqty > (\n                    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                        0.5 * <span style=\"color:black;font-weight:bold;\">sum</span>(l_quantity)\n                    <span style=\"color:black;font-weight:bold;\">FROM</span>\n                        lineitem\n                    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                        l_partkey = ps_partkey\n                        <span style=\"color:black;font-weight:bold;\">AND</span> l_suppkey = ps_suppkey\n                        <span style=\"color:black;font-weight:bold;\">AND</span> l_shipdate >= <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1994-01-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n                        <span style=\"color:black;font-weight:bold;\">AND</span> l_shipdate < <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1995-01-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)))\n            <span style=\"color:black;font-weight:bold;\">AND</span> s_nationkey = n_nationkey\n            <span style=\"color:black;font-weight:bold;\">AND</span> n_name = <span style=\"color:firebrick;\">'CANADA'</span>\n        <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            s_name;\n\n</pre>\n\t\t", "Q21": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    s_name,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) <span style=\"color:black;font-weight:bold;\">AS</span> numwait\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    supplier,\n    lineitem l1,\n    orders,\n    nation\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s_suppkey = l1.l_suppkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> o_orderkey = l1.l_orderkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> o_orderstatus = <span style=\"color:firebrick;\">'F'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> l1.l_receiptdate > l1.l_commitdate\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            *\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            lineitem l2\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            l2.l_orderkey = l1.l_orderkey\n            <span style=\"color:black;font-weight:bold;\">AND</span> l2.l_suppkey <> l1.l_suppkey)\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            *\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            lineitem l3\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            l3.l_orderkey = l1.l_orderkey\n            <span style=\"color:black;font-weight:bold;\">AND</span> l3.l_suppkey <> l1.l_suppkey\n            <span style=\"color:black;font-weight:bold;\">AND</span> l3.l_receiptdate > l3.l_commitdate)\n    <span style=\"color:black;font-weight:bold;\">AND</span> s_nationkey = n_nationkey\n    <span style=\"color:black;font-weight:bold;\">AND</span> n_name = <span style=\"color:firebrick;\">'SAUDI ARABIA'</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    s_name\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    numwait <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    s_name\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "Q22": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    cntrycode,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) <span style=\"color:black;font-weight:bold;\">AS</span> numcust,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(c_acctbal) <span style=\"color:black;font-weight:bold;\">AS</span> totacctbal\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        substring(c_phone <span style=\"color:black;font-weight:bold;\">FROM</span> 1 FOR 2) <span style=\"color:black;font-weight:bold;\">AS</span> cntrycode,\n        c_acctbal\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        customer\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        substring(c_phone <span style=\"color:black;font-weight:bold;\">FROM</span> 1 FOR 2)\n        <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'13'</span>, <span style=\"color:firebrick;\">'31'</span>, <span style=\"color:firebrick;\">'23'</span>, <span style=\"color:firebrick;\">'29'</span>, <span style=\"color:firebrick;\">'30'</span>, <span style=\"color:firebrick;\">'18'</span>, <span style=\"color:firebrick;\">'17'</span>)\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_acctbal > (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                <span style=\"color:black;font-weight:bold;\">avg</span>(c_acctbal)\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                customer\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                c_acctbal > 0.00\n                <span style=\"color:black;font-weight:bold;\">AND</span> substring(c_phone <span style=\"color:black;font-weight:bold;\">FROM</span> 1 FOR 2)\n                <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'13'</span>, <span style=\"color:firebrick;\">'31'</span>, <span style=\"color:firebrick;\">'23'</span>, <span style=\"color:firebrick;\">'29'</span>, <span style=\"color:firebrick;\">'30'</span>, <span style=\"color:firebrick;\">'18'</span>, <span style=\"color:firebrick;\">'17'</span>))\n            <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n                <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                    *\n                <span style=\"color:black;font-weight:bold;\">FROM</span>\n                    orders\n                <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                    o_custkey = c_custkey)) <span style=\"color:black;font-weight:bold;\">AS</span> custsale\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    cntrycode\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    cntrycode;\n\n</pre>\n\t\t", "ReadLineitemCSV": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">COPY</span> lineitem\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    <span style=\"color:firebrick;\">'lineitem.csv'</span> <span style=\"color:black;font-weight:bold;\">DELIMITER</span> <span style=\"color:firebrick;\">'|'</span> <span style=\"color:black;font-weight:bold;\">HEADER</span>\n</pre>\n\t\t", "WriteLineitemCSV": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">COPY</span> lineitem TO <span style=\"color:firebrick;\">'lineitem.csv'</span> <span style=\"color:black;font-weight:bold;\">DELIMITER</span> <span style=\"color:firebrick;\">'|'</span> <span style=\"color:black;font-weight:bold;\">HEADER</span>\n</pre>\n\t\t", "TPCHEmptyStartup": "<h1>Description</h1><p>TPCHEmptyStartup - [startup]\nStart a TPC-H SF1 database and run SELECT * FROM lineitem WHERE 1=0 in the database</p>", "TPCHCount": "<h1>Description</h1><p>TPCHCount - [startup]\nStart a TPC-H SF1 database and run SELECT COUNT(*) FROM lineitem in the database</p>", "TPCHSimpleAggr": "<h1>Description</h1><p>TPCHSimpleAggr - [startup]\nStart a TPC-H SF1 database and run SELECT SUM(l_extendedprice) FROM lineitem in the database</p>", "TPCHQ1": "<h1>Description</h1><p>TPCHQ1 - [startup]\nStart a TPC-H SF1 database and run select\n l_returnflag,\n l_linestatus,\n sum(l_quantity) as sum_qty,\n sum(l_extendedprice) as sum_base_price,\n sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,\n sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,\n avg(l_quantity) as avg_qty,\n avg(l_extendedprice) as avg_price,\n avg(l_discount) as avg_disc,\n count(*) as count_order\nfrom\n lineitem\nwhere\n l_shipdate <= cast('1998-09-02' as date)\ngroup by\n l_returnflag,\n l_linestatus\norder by\n l_returnflag,\n l_linestatus;\n in the database</p>", "TPCHEmptyStartupDirectIO": "<h1>Description</h1><p>TPCHEmptyStartupDirectIO - [startup]\nStart a TPC-H SF1 database and run SELECT * FROM lineitem WHERE 1=0 in the database</p>", "TPCHCountDirectIO": "<h1>Description</h1><p>TPCHCountDirectIO - [startup]\nStart a TPC-H SF1 database and run SELECT COUNT(*) FROM lineitem in the database</p>", "TPCHSimpleAggrDirectIO": "<h1>Description</h1><p>TPCHSimpleAggrDirectIO - [startup]\nStart a TPC-H SF1 database and run SELECT SUM(l_extendedprice) FROM lineitem in the database</p>", "TPCHQ1DirectIO": "<h1>Description</h1><p>TPCHQ1DirectIO - [startup]\nStart a TPC-H SF1 database and run select\n l_returnflag,\n l_linestatus,\n sum(l_quantity) as sum_qty,\n sum(l_extendedprice) as sum_base_price,\n sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,\n sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,\n avg(l_quantity) as avg_qty,\n avg(l_extendedprice) as avg_price,\n avg(l_discount) as avg_disc,\n count(*) as count_order\nfrom\n lineitem\nwhere\n l_shipdate <= cast('1998-09-02' as date)\ngroup by\n l_returnflag,\n l_linestatus\norder by\n l_returnflag,\n l_linestatus;\n in the database</p>", "DSQ001": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> customer_total_return <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        sr_customer_sk <span style=\"color:black;font-weight:bold;\">AS</span> ctr_customer_sk,\n        sr_store_sk <span style=\"color:black;font-weight:bold;\">AS</span> ctr_store_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sr_return_amt) <span style=\"color:black;font-weight:bold;\">AS</span> ctr_total_return\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_returns,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        sr_returned_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2000\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        sr_customer_sk,\n        sr_store_sk\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_customer_id\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    customer_total_return ctr1,\n    store,\n    customer\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ctr1.ctr_total_return > (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ctr_total_return) * 1.2\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            customer_total_return ctr2\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n    <span style=\"color:black;font-weight:bold;\">AND</span> s_store_sk = ctr1.ctr_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> s_state = <span style=\"color:firebrick;\">'TN'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ctr1.ctr_customer_sk = c_customer_sk\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_customer_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ002": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> wscs <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        sold_date_sk,\n        sales_price\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ws_sold_date_sk sold_date_sk,\n            ws_ext_sales_price sales_price\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_sales\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            cs_sold_date_sk sold_date_sk,\n            cs_ext_sales_price sales_price\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            catalog_sales) sq1\n),\nwswscs <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        d_week_seq,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Sunday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) sun_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Monday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) mon_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Tuesday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) tue_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Wednesday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) wed_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Thursday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) thu_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Friday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) fri_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Saturday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) sat_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        wscs,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        d_date_sk = sold_date_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        d_week_seq\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    d_week_seq1,\n    round(sun_sales1 / sun_sales2, 2),\n    round(mon_sales1 / mon_sales2, 2),\n    round(tue_sales1 / tue_sales2, 2),\n    round(wed_sales1 / wed_sales2, 2),\n    round(thu_sales1 / thu_sales2, 2),\n    round(fri_sales1 / fri_sales2, 2),\n    round(sat_sales1 / sat_sales2, 2)\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        wswscs.d_week_seq d_week_seq1,\n        sun_sales sun_sales1,\n        mon_sales mon_sales1,\n        tue_sales tue_sales1,\n        wed_sales wed_sales1,\n        thu_sales thu_sales1,\n        fri_sales fri_sales1,\n        sat_sales sat_sales1\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        wswscs,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        date_dim.d_week_seq = wswscs.d_week_seq\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001) y,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            wswscs.d_week_seq d_week_seq2,\n            sun_sales sun_sales2,\n            mon_sales mon_sales2,\n            tue_sales tue_sales2,\n            wed_sales wed_sales2,\n            thu_sales thu_sales2,\n            fri_sales fri_sales2,\n            sat_sales sat_sales2\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            wswscs,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            date_dim.d_week_seq = wswscs.d_week_seq\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001 + 1) z\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d_week_seq1 = d_week_seq2 - 53\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    d_week_seq1;\n\n</pre>\n\t\t", "DSQ003": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    dt.d_year,\n    item.i_brand_id brand_id,\n    item.i_brand brand,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) sum_agg\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    date_dim dt,\n    store_sales,\n    item\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    dt.d_date_sk = store_sales.ss_sold_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_item_sk = item.i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> item.i_manufact_id = 128\n    <span style=\"color:black;font-weight:bold;\">AND</span> dt.d_moy = 11\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    dt.d_year,\n    item.i_brand,\n    item.i_brand_id\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    dt.d_year,\n    sum_agg <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    brand_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ004": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> year_total <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_customer_id customer_id,\n        c_first_name customer_first_name,\n        c_last_name customer_last_name,\n        c_preferred_cust_flag customer_preferred_cust_flag,\n        c_birth_country customer_birth_country,\n        c_login customer_login,\n        c_email_address customer_email_address,\n        d_year dyear,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) year_total,\n        <span style=\"color:firebrick;\">'s'</span> sale_type\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        customer,\n        store_sales,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        c_customer_sk = ss_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_customer_id customer_id,\n        c_first_name customer_first_name,\n        c_last_name customer_last_name,\n        c_preferred_cust_flag customer_preferred_cust_flag,\n        c_birth_country customer_birth_country,\n        c_login customer_login,\n        c_email_address customer_email_address,\n        d_year dyear,\n        <span style=\"color:black;font-weight:bold;\">sum</span>((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) year_total,\n        <span style=\"color:firebrick;\">'c'</span> sale_type\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        customer,\n        catalog_sales,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        c_customer_sk = cs_bill_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_customer_id customer_id,\n        c_first_name customer_first_name,\n        c_last_name customer_last_name,\n        c_preferred_cust_flag customer_preferred_cust_flag,\n        c_birth_country customer_birth_country,\n        c_login customer_login,\n        c_email_address customer_email_address,\n        d_year dyear,\n        <span style=\"color:black;font-weight:bold;\">sum</span>((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) year_total,\n        <span style=\"color:firebrick;\">'w'</span> sale_type\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        customer,\n        web_sales,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        c_customer_sk = ws_bill_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    t_s_secyear.customer_id,\n    t_s_secyear.customer_first_name,\n    t_s_secyear.customer_last_name,\n    t_s_secyear.customer_preferred_cust_flag\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    year_total t_s_firstyear,\n    year_total t_s_secyear,\n    year_total t_c_firstyear,\n    year_total t_c_secyear,\n    year_total t_w_firstyear,\n    year_total t_w_secyear\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    t_s_secyear.customer_id = t_s_firstyear.customer_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.customer_id = t_c_secyear.customer_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.customer_id = t_c_firstyear.customer_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.customer_id = t_w_firstyear.customer_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.customer_id = t_w_secyear.customer_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.sale_type = <span style=\"color:firebrick;\">'s'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_c_firstyear.sale_type = <span style=\"color:firebrick;\">'c'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_firstyear.sale_type = <span style=\"color:firebrick;\">'w'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_secyear.sale_type = <span style=\"color:firebrick;\">'s'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_c_secyear.sale_type = <span style=\"color:firebrick;\">'c'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_secyear.sale_type = <span style=\"color:firebrick;\">'w'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.dyear = 2001\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_secyear.dyear = 2001 + 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_c_firstyear.dyear = 2001\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_c_secyear.dyear = 2001 + 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_firstyear.dyear = 2001\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_secyear.dyear = 2001 + 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.year_total > 0\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_c_firstyear.year_total > 0\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_firstyear.year_total > 0\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> t_c_firstyear.year_total > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n        t_c_secyear.year_total / t_c_firstyear.year_total\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span> > <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> t_s_firstyear.year_total > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n        t_s_secyear.year_total / t_s_firstyear.year_total\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> t_c_firstyear.year_total > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n        t_c_secyear.year_total / t_c_firstyear.year_total\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span> > <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> t_w_firstyear.year_total > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n        t_w_secyear.year_total / t_w_firstyear.year_total\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span>\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    t_s_secyear.customer_id,\n    t_s_secyear.customer_first_name,\n    t_s_secyear.customer_last_name,\n    t_s_secyear.customer_preferred_cust_flag\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ005": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> ssr <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        s_store_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(profit) <span style=\"color:black;font-weight:bold;\">AS</span> profit,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(return_amt) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(net_loss) <span style=\"color:black;font-weight:bold;\">AS</span> profit_loss\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ss_store_sk <span style=\"color:black;font-weight:bold;\">AS</span> store_sk,\n            ss_sold_date_sk <span style=\"color:black;font-weight:bold;\">AS</span> date_sk,\n            ss_ext_sales_price <span style=\"color:black;font-weight:bold;\">AS</span> sales_price,\n            ss_net_profit <span style=\"color:black;font-weight:bold;\">AS</span> profit,\n            <span style=\"color:black;font-weight:bold;\">cast</span>(0 <span style=\"color:black;font-weight:bold;\">AS</span> decimal(7,\n                    2)) <span style=\"color:black;font-weight:bold;\">AS</span> return_amt,\n            <span style=\"color:black;font-weight:bold;\">cast</span>(0 <span style=\"color:black;font-weight:bold;\">AS</span> decimal(7,\n                    2)) <span style=\"color:black;font-weight:bold;\">AS</span> net_loss\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            sr_store_sk <span style=\"color:black;font-weight:bold;\">AS</span> store_sk,\n            sr_returned_date_sk <span style=\"color:black;font-weight:bold;\">AS</span> date_sk,\n            <span style=\"color:black;font-weight:bold;\">cast</span>(0 <span style=\"color:black;font-weight:bold;\">AS</span> decimal(7,\n                    2)) <span style=\"color:black;font-weight:bold;\">AS</span> sales_price,\n            <span style=\"color:black;font-weight:bold;\">cast</span>(0 <span style=\"color:black;font-weight:bold;\">AS</span> decimal(7,\n                    2)) <span style=\"color:black;font-weight:bold;\">AS</span> profit,\n            sr_return_amt <span style=\"color:black;font-weight:bold;\">AS</span> return_amt,\n            sr_net_loss <span style=\"color:black;font-weight:bold;\">AS</span> net_loss\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_returns) salesreturns,\n        date_dim,\n        store\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-08-23'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-09-06'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sk = s_store_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        s_store_id\n),\ncsr <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        cp_catalog_page_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(profit) <span style=\"color:black;font-weight:bold;\">AS</span> profit,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(return_amt) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(net_loss) <span style=\"color:black;font-weight:bold;\">AS</span> profit_loss\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            cs_catalog_page_sk <span style=\"color:black;font-weight:bold;\">AS</span> page_sk,\n            cs_sold_date_sk <span style=\"color:black;font-weight:bold;\">AS</span> date_sk,\n            cs_ext_sales_price <span style=\"color:black;font-weight:bold;\">AS</span> sales_price,\n            cs_net_profit <span style=\"color:black;font-weight:bold;\">AS</span> profit,\n            <span style=\"color:black;font-weight:bold;\">cast</span>(0 <span style=\"color:black;font-weight:bold;\">AS</span> decimal(7,\n                    2)) <span style=\"color:black;font-weight:bold;\">AS</span> return_amt,\n            <span style=\"color:black;font-weight:bold;\">cast</span>(0 <span style=\"color:black;font-weight:bold;\">AS</span> decimal(7,\n                    2)) <span style=\"color:black;font-weight:bold;\">AS</span> net_loss\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            catalog_sales\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            cr_catalog_page_sk <span style=\"color:black;font-weight:bold;\">AS</span> page_sk,\n            cr_returned_date_sk <span style=\"color:black;font-weight:bold;\">AS</span> date_sk,\n            <span style=\"color:black;font-weight:bold;\">cast</span>(0 <span style=\"color:black;font-weight:bold;\">AS</span> decimal(7,\n                    2)) <span style=\"color:black;font-weight:bold;\">AS</span> sales_price,\n            <span style=\"color:black;font-weight:bold;\">cast</span>(0 <span style=\"color:black;font-weight:bold;\">AS</span> decimal(7,\n                    2)) <span style=\"color:black;font-weight:bold;\">AS</span> profit,\n            cr_return_amount <span style=\"color:black;font-weight:bold;\">AS</span> return_amt,\n            cr_net_loss <span style=\"color:black;font-weight:bold;\">AS</span> net_loss\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            catalog_returns) salesreturns,\n        date_dim,\n        catalog_page\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-08-23'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-09-06'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> page_sk = cp_catalog_page_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        cp_catalog_page_id\n),\nwsr <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        web_site_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(profit) <span style=\"color:black;font-weight:bold;\">AS</span> profit,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(return_amt) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(net_loss) <span style=\"color:black;font-weight:bold;\">AS</span> profit_loss\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ws_web_site_sk <span style=\"color:black;font-weight:bold;\">AS</span> wsr_web_site_sk,\n            ws_sold_date_sk <span style=\"color:black;font-weight:bold;\">AS</span> date_sk,\n            ws_ext_sales_price <span style=\"color:black;font-weight:bold;\">AS</span> sales_price,\n            ws_net_profit <span style=\"color:black;font-weight:bold;\">AS</span> profit,\n            <span style=\"color:black;font-weight:bold;\">cast</span>(0 <span style=\"color:black;font-weight:bold;\">AS</span> decimal(7,\n                    2)) <span style=\"color:black;font-weight:bold;\">AS</span> return_amt,\n            <span style=\"color:black;font-weight:bold;\">cast</span>(0 <span style=\"color:black;font-weight:bold;\">AS</span> decimal(7,\n                    2)) <span style=\"color:black;font-weight:bold;\">AS</span> net_loss\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_sales\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ws_web_site_sk <span style=\"color:black;font-weight:bold;\">AS</span> wsr_web_site_sk,\n            wr_returned_date_sk <span style=\"color:black;font-weight:bold;\">AS</span> date_sk,\n            <span style=\"color:black;font-weight:bold;\">cast</span>(0 <span style=\"color:black;font-weight:bold;\">AS</span> decimal(7,\n                    2)) <span style=\"color:black;font-weight:bold;\">AS</span> sales_price,\n            <span style=\"color:black;font-weight:bold;\">cast</span>(0 <span style=\"color:black;font-weight:bold;\">AS</span> decimal(7,\n                    2)) <span style=\"color:black;font-weight:bold;\">AS</span> profit,\n            wr_return_amt <span style=\"color:black;font-weight:bold;\">AS</span> return_amt,\n            wr_net_loss <span style=\"color:black;font-weight:bold;\">AS</span> net_loss\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_returns\n        <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> web_sales <span style=\"color:black;font-weight:bold;\">ON</span> (wr_item_sk = ws_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> wr_order_number = ws_order_number)) salesreturns,\n    date_dim,\n    web_site\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-08-23'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-09-06'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> wsr_web_site_sk = web_site_sk\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    web_site_id\n),\nresults <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sales) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(returns_) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(profit) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:firebrick;\">'store channel'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n            concat(<span style=\"color:firebrick;\">'store'</span>,\n                s_store_id) <span style=\"color:black;font-weight:bold;\">AS</span> id,\n            sales,\n            returns_,\n            (profit - profit_loss) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            ssr\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:firebrick;\">'catalog channel'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n            concat(<span style=\"color:firebrick;\">'catalog_page'</span>,\n                cp_catalog_page_id) <span style=\"color:black;font-weight:bold;\">AS</span> id,\n            sales,\n            returns_,\n            (profit - profit_loss) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            csr\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:firebrick;\">'web channel'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n            concat(<span style=\"color:firebrick;\">'web_site'</span>,\n                web_site_id) <span style=\"color:black;font-weight:bold;\">AS</span> id,\n            sales,\n            returns_,\n            (profit - profit_loss) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            wsr) x\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        channel,\n        id\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    channel,\n    id,\n    sales,\n    returns_,\n    profit\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        id,\n        sales,\n        returns_,\n        profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sales),\n        <span style=\"color:black;font-weight:bold;\">sum</span>(returns_),\n        <span style=\"color:black;font-weight:bold;\">sum</span>(profit)\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        channel\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sales),\n        <span style=\"color:black;font-weight:bold;\">sum</span>(returns_),\n        <span style=\"color:black;font-weight:bold;\">sum</span>(profit)\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results) foo\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    channel,\n    id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ006": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    a.ca_state state,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    customer_address a,\n    customer c,\n    store_sales s,\n    date_dim d,\n    item i\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    a.ca_address_sk = c.c_current_addr_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> c.c_customer_sk = s.ss_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> s.ss_sold_date_sk = d.d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> s.ss_item_sk = i.i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d.d_month_seq = ( <span style=\"color:black;font-weight:bold;\">SELECT</span> <span style=\"color:black;font-weight:bold;\">DISTINCT</span>\n            (d_month_seq)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            d_year = 2001\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 1)\n    <span style=\"color:black;font-weight:bold;\">AND</span> i.i_current_price > 1.2 * (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(j.i_current_price)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            item j\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            j.i_category = i.i_category)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    a.ca_state\n<span style=\"color:black;font-weight:bold;\">HAVING</span>\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) >= 10\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    cnt,\n    a.ca_state\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ007": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(ss_quantity) agg1,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(ss_list_price) agg2,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(ss_coupon_amt) agg3,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(ss_sales_price) agg4\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    store_sales,\n    customer_demographics,\n    date_dim,\n    item,\n    promotion\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ss_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_cdemo_sk = cd_demo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_promo_sk = p_promo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd_gender = <span style=\"color:firebrick;\">'M'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd_marital_status = <span style=\"color:firebrick;\">'S'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd_education_status = <span style=\"color:firebrick;\">'College'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (p_channel_email = <span style=\"color:firebrick;\">'N'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> p_channel_event = <span style=\"color:firebrick;\">'N'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2000\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ008": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    s_store_name,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_profit)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    store_sales,\n    date_dim,\n    store,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ca_zip\n        <span style=\"color:black;font-weight:bold;\">FROM</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(ca_zip, 1, 5) ca_zip\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                customer_address\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(ca_zip, 1, 5)\n                <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'24128'</span>, <span style=\"color:firebrick;\">'76232'</span>, <span style=\"color:firebrick;\">'65084'</span>, <span style=\"color:firebrick;\">'87816'</span>, <span style=\"color:firebrick;\">'83926'</span>, <span style=\"color:firebrick;\">'77556'</span>, <span style=\"color:firebrick;\">'20548'</span>, <span style=\"color:firebrick;\">'26231'</span>, <span style=\"color:firebrick;\">'43848'</span>, <span style=\"color:firebrick;\">'15126'</span>, <span style=\"color:firebrick;\">'91137'</span>, <span style=\"color:firebrick;\">'61265'</span>, <span style=\"color:firebrick;\">'98294'</span>, <span style=\"color:firebrick;\">'25782'</span>, <span style=\"color:firebrick;\">'17920'</span>, <span style=\"color:firebrick;\">'18426'</span>, <span style=\"color:firebrick;\">'98235'</span>, <span style=\"color:firebrick;\">'40081'</span>, <span style=\"color:firebrick;\">'84093'</span>, <span style=\"color:firebrick;\">'28577'</span>, <span style=\"color:firebrick;\">'55565'</span>, <span style=\"color:firebrick;\">'17183'</span>, <span style=\"color:firebrick;\">'54601'</span>, <span style=\"color:firebrick;\">'67897'</span>, <span style=\"color:firebrick;\">'22752'</span>, <span style=\"color:firebrick;\">'86284'</span>, <span style=\"color:firebrick;\">'18376'</span>, <span style=\"color:firebrick;\">'38607'</span>, <span style=\"color:firebrick;\">'45200'</span>, <span style=\"color:firebrick;\">'21756'</span>, <span style=\"color:firebrick;\">'29741'</span>, <span style=\"color:firebrick;\">'96765'</span>, <span style=\"color:firebrick;\">'23932'</span>, <span style=\"color:firebrick;\">'89360'</span>, <span style=\"color:firebrick;\">'29839'</span>, <span style=\"color:firebrick;\">'25989'</span>, <span style=\"color:firebrick;\">'28898'</span>, <span style=\"color:firebrick;\">'91068'</span>, <span style=\"color:firebrick;\">'72550'</span>, <span style=\"color:firebrick;\">'10390'</span>, <span style=\"color:firebrick;\">'18845'</span>, <span style=\"color:firebrick;\">'47770'</span>, <span style=\"color:firebrick;\">'82636'</span>, <span style=\"color:firebrick;\">'41367'</span>, <span style=\"color:firebrick;\">'76638'</span>, <span style=\"color:firebrick;\">'86198'</span>, <span style=\"color:firebrick;\">'81312'</span>, <span style=\"color:firebrick;\">'37126'</span>, <span style=\"color:firebrick;\">'39192'</span>, <span style=\"color:firebrick;\">'88424'</span>, <span style=\"color:firebrick;\">'72175'</span>, <span style=\"color:firebrick;\">'81426'</span>, <span style=\"color:firebrick;\">'53672'</span>, <span style=\"color:firebrick;\">'10445'</span>, <span style=\"color:firebrick;\">'42666'</span>, <span style=\"color:firebrick;\">'66864'</span>, <span style=\"color:firebrick;\">'66708'</span>, <span style=\"color:firebrick;\">'41248'</span>, <span style=\"color:firebrick;\">'48583'</span>, <span style=\"color:firebrick;\">'82276'</span>, <span style=\"color:firebrick;\">'18842'</span>, <span style=\"color:firebrick;\">'78890'</span>, <span style=\"color:firebrick;\">'49448'</span>, <span style=\"color:firebrick;\">'14089'</span>, <span style=\"color:firebrick;\">'38122'</span>, <span style=\"color:firebrick;\">'34425'</span>, <span style=\"color:firebrick;\">'79077'</span>, <span style=\"color:firebrick;\">'19849'</span>, <span style=\"color:firebrick;\">'43285'</span>, <span style=\"color:firebrick;\">'39861'</span>, <span style=\"color:firebrick;\">'66162'</span>, <span style=\"color:firebrick;\">'77610'</span>, <span style=\"color:firebrick;\">'13695'</span>, <span style=\"color:firebrick;\">'99543'</span>, <span style=\"color:firebrick;\">'83444'</span>, <span style=\"color:firebrick;\">'83041'</span>, <span style=\"color:firebrick;\">'12305'</span>, <span style=\"color:firebrick;\">'57665'</span>, <span style=\"color:firebrick;\">'68341'</span>, <span style=\"color:firebrick;\">'25003'</span>, <span style=\"color:firebrick;\">'57834'</span>, <span style=\"color:firebrick;\">'62878'</span>, <span style=\"color:firebrick;\">'49130'</span>, <span style=\"color:firebrick;\">'81096'</span>, <span style=\"color:firebrick;\">'18840'</span>, <span style=\"color:firebrick;\">'27700'</span>, <span style=\"color:firebrick;\">'23470'</span>, <span style=\"color:firebrick;\">'50412'</span>, <span style=\"color:firebrick;\">'21195'</span>, <span style=\"color:firebrick;\">'16021'</span>, <span style=\"color:firebrick;\">'76107'</span>, <span style=\"color:firebrick;\">'71954'</span>, <span style=\"color:firebrick;\">'68309'</span>, <span style=\"color:firebrick;\">'18119'</span>, <span style=\"color:firebrick;\">'98359'</span>, <span style=\"color:firebrick;\">'64544'</span>, <span style=\"color:firebrick;\">'10336'</span>, <span style=\"color:firebrick;\">'86379'</span>, <span style=\"color:firebrick;\">'27068'</span>, <span style=\"color:firebrick;\">'39736'</span>, <span style=\"color:firebrick;\">'98569'</span>, <span style=\"color:firebrick;\">'28915'</span>, <span style=\"color:firebrick;\">'24206'</span>, <span style=\"color:firebrick;\">'56529'</span>, <span style=\"color:firebrick;\">'57647'</span>, <span style=\"color:firebrick;\">'54917'</span>, <span style=\"color:firebrick;\">'42961'</span>, <span style=\"color:firebrick;\">'91110'</span>, <span style=\"color:firebrick;\">'63981'</span>, <span style=\"color:firebrick;\">'14922'</span>, <span style=\"color:firebrick;\">'36420'</span>, <span style=\"color:firebrick;\">'23006'</span>, <span style=\"color:firebrick;\">'67467'</span>, <span style=\"color:firebrick;\">'32754'</span>, <span style=\"color:firebrick;\">'30903'</span>, <span style=\"color:firebrick;\">'20260'</span>, <span style=\"color:firebrick;\">'31671'</span>, <span style=\"color:firebrick;\">'51798'</span>, <span style=\"color:firebrick;\">'72325'</span>, <span style=\"color:firebrick;\">'85816'</span>, <span style=\"color:firebrick;\">'68621'</span>, <span style=\"color:firebrick;\">'13955'</span>, <span style=\"color:firebrick;\">'36446'</span>, <span style=\"color:firebrick;\">'41766'</span>, <span style=\"color:firebrick;\">'68806'</span>, <span style=\"color:firebrick;\">'16725'</span>, <span style=\"color:firebrick;\">'15146'</span>, <span style=\"color:firebrick;\">'22744'</span>, <span style=\"color:firebrick;\">'35850'</span>, <span style=\"color:firebrick;\">'88086'</span>, <span style=\"color:firebrick;\">'51649'</span>, <span style=\"color:firebrick;\">'18270'</span>, <span style=\"color:firebrick;\">'52867'</span>, <span style=\"color:firebrick;\">'39972'</span>, <span style=\"color:firebrick;\">'96976'</span>, <span style=\"color:firebrick;\">'63792'</span>, <span style=\"color:firebrick;\">'11376'</span>, <span style=\"color:firebrick;\">'94898'</span>, <span style=\"color:firebrick;\">'13595'</span>, <span style=\"color:firebrick;\">'10516'</span>, <span style=\"color:firebrick;\">'90225'</span>, <span style=\"color:firebrick;\">'58943'</span>, <span style=\"color:firebrick;\">'39371'</span>, <span style=\"color:firebrick;\">'94945'</span>, <span style=\"color:firebrick;\">'28587'</span>, <span style=\"color:firebrick;\">'96576'</span>, <span style=\"color:firebrick;\">'57855'</span>, <span style=\"color:firebrick;\">'28488'</span>, <span style=\"color:firebrick;\">'26105'</span>, <span style=\"color:firebrick;\">'83933'</span>, <span style=\"color:firebrick;\">'25858'</span>, <span style=\"color:firebrick;\">'34322'</span>, <span style=\"color:firebrick;\">'44438'</span>, <span style=\"color:firebrick;\">'73171'</span>, <span style=\"color:firebrick;\">'30122'</span>, <span style=\"color:firebrick;\">'34102'</span>, <span style=\"color:firebrick;\">'22685'</span>, <span style=\"color:firebrick;\">'71256'</span>, <span style=\"color:firebrick;\">'78451'</span>, <span style=\"color:firebrick;\">'54364'</span>, <span style=\"color:firebrick;\">'13354'</span>, <span style=\"color:firebrick;\">'45375'</span>, <span style=\"color:firebrick;\">'40558'</span>, <span style=\"color:firebrick;\">'56458'</span>, <span style=\"color:firebrick;\">'28286'</span>, <span style=\"color:firebrick;\">'45266'</span>, <span style=\"color:firebrick;\">'47305'</span>, <span style=\"color:firebrick;\">'69399'</span>, <span style=\"color:firebrick;\">'83921'</span>, <span style=\"color:firebrick;\">'26233'</span>, <span style=\"color:firebrick;\">'11101'</span>, <span style=\"color:firebrick;\">'15371'</span>, <span style=\"color:firebrick;\">'69913'</span>, <span style=\"color:firebrick;\">'35942'</span>, <span style=\"color:firebrick;\">'15882'</span>, <span style=\"color:firebrick;\">'25631'</span>, <span style=\"color:firebrick;\">'24610'</span>, <span style=\"color:firebrick;\">'44165'</span>, <span style=\"color:firebrick;\">'99076'</span>, <span style=\"color:firebrick;\">'33786'</span>, <span style=\"color:firebrick;\">'70738'</span>, <span style=\"color:firebrick;\">'26653'</span>, <span style=\"color:firebrick;\">'14328'</span>, <span style=\"color:firebrick;\">'72305'</span>, <span style=\"color:firebrick;\">'62496'</span>, <span style=\"color:firebrick;\">'22152'</span>, <span style=\"color:firebrick;\">'10144'</span>, <span style=\"color:firebrick;\">'64147'</span>, <span style=\"color:firebrick;\">'48425'</span>, <span style=\"color:firebrick;\">'14663'</span>, <span style=\"color:firebrick;\">'21076'</span>, <span style=\"color:firebrick;\">'18799'</span>, <span style=\"color:firebrick;\">'30450'</span>, <span style=\"color:firebrick;\">'63089'</span>, <span style=\"color:firebrick;\">'81019'</span>, <span style=\"color:firebrick;\">'68893'</span>, <span style=\"color:firebrick;\">'24996'</span>, <span style=\"color:firebrick;\">'51200'</span>, <span style=\"color:firebrick;\">'51211'</span>, <span style=\"color:firebrick;\">'45692'</span>, <span style=\"color:firebrick;\">'92712'</span>, <span style=\"color:firebrick;\">'70466'</span>, <span style=\"color:firebrick;\">'79994'</span>, <span style=\"color:firebrick;\">'22437'</span>, <span style=\"color:firebrick;\">'25280'</span>, <span style=\"color:firebrick;\">'38935'</span>, <span style=\"color:firebrick;\">'71791'</span>, <span style=\"color:firebrick;\">'73134'</span>, <span style=\"color:firebrick;\">'56571'</span>, <span style=\"color:firebrick;\">'14060'</span>, <span style=\"color:firebrick;\">'19505'</span>, <span style=\"color:firebrick;\">'72425'</span>, <span style=\"color:firebrick;\">'56575'</span>, <span style=\"color:firebrick;\">'74351'</span>, <span style=\"color:firebrick;\">'68786'</span>, <span style=\"color:firebrick;\">'51650'</span>, <span style=\"color:firebrick;\">'20004'</span>, <span style=\"color:firebrick;\">'18383'</span>, <span style=\"color:firebrick;\">'76614'</span>, <span style=\"color:firebrick;\">'11634'</span>, <span style=\"color:firebrick;\">'18906'</span>, <span style=\"color:firebrick;\">'15765'</span>, <span style=\"color:firebrick;\">'41368'</span>, <span style=\"color:firebrick;\">'73241'</span>, <span style=\"color:firebrick;\">'76698'</span>, <span style=\"color:firebrick;\">'78567'</span>, <span style=\"color:firebrick;\">'97189'</span>, <span style=\"color:firebrick;\">'28545'</span>, <span style=\"color:firebrick;\">'76231'</span>, <span style=\"color:firebrick;\">'75691'</span>, <span style=\"color:firebrick;\">'22246'</span>, <span style=\"color:firebrick;\">'51061'</span>, <span style=\"color:firebrick;\">'90578'</span>, <span style=\"color:firebrick;\">'56691'</span>, <span style=\"color:firebrick;\">'68014'</span>, <span style=\"color:firebrick;\">'51103'</span>, <span style=\"color:firebrick;\">'94167'</span>, <span style=\"color:firebrick;\">'57047'</span>, <span style=\"color:firebrick;\">'14867'</span>, <span style=\"color:firebrick;\">'73520'</span>, <span style=\"color:firebrick;\">'15734'</span>, <span style=\"color:firebrick;\">'63435'</span>, <span style=\"color:firebrick;\">'25733'</span>, <span style=\"color:firebrick;\">'35474'</span>, <span style=\"color:firebrick;\">'24676'</span>, <span style=\"color:firebrick;\">'94627'</span>, <span style=\"color:firebrick;\">'53535'</span>, <span style=\"color:firebrick;\">'17879'</span>, <span style=\"color:firebrick;\">'15559'</span>, <span style=\"color:firebrick;\">'53268'</span>, <span style=\"color:firebrick;\">'59166'</span>, <span style=\"color:firebrick;\">'11928'</span>, <span style=\"color:firebrick;\">'59402'</span>, <span style=\"color:firebrick;\">'33282'</span>, <span style=\"color:firebrick;\">'45721'</span>, <span style=\"color:firebrick;\">'43933'</span>, <span style=\"color:firebrick;\">'68101'</span>, <span style=\"color:firebrick;\">'33515'</span>, <span style=\"color:firebrick;\">'36634'</span>, <span style=\"color:firebrick;\">'71286'</span>, <span style=\"color:firebrick;\">'19736'</span>, <span style=\"color:firebrick;\">'58058'</span>, <span style=\"color:firebrick;\">'55253'</span>, <span style=\"color:firebrick;\">'67473'</span>, <span style=\"color:firebrick;\">'41918'</span>, <span style=\"color:firebrick;\">'19515'</span>, <span style=\"color:firebrick;\">'36495'</span>, <span style=\"color:firebrick;\">'19430'</span>, <span style=\"color:firebrick;\">'22351'</span>, <span style=\"color:firebrick;\">'77191'</span>, <span style=\"color:firebrick;\">'91393'</span>, <span style=\"color:firebrick;\">'49156'</span>, <span style=\"color:firebrick;\">'50298'</span>, <span style=\"color:firebrick;\">'87501'</span>, <span style=\"color:firebrick;\">'18652'</span>, <span style=\"color:firebrick;\">'53179'</span>, <span style=\"color:firebrick;\">'18767'</span>, <span style=\"color:firebrick;\">'63193'</span>, <span style=\"color:firebrick;\">'23968'</span>, <span style=\"color:firebrick;\">'65164'</span>, <span style=\"color:firebrick;\">'68880'</span>, <span style=\"color:firebrick;\">'21286'</span>, <span style=\"color:firebrick;\">'72823'</span>, <span style=\"color:firebrick;\">'58470'</span>, <span style=\"color:firebrick;\">'67301'</span>, <span style=\"color:firebrick;\">'13394'</span>, <span style=\"color:firebrick;\">'31016'</span>, <span style=\"color:firebrick;\">'70372'</span>, <span style=\"color:firebrick;\">'67030'</span>, <span style=\"color:firebrick;\">'40604'</span>, <span style=\"color:firebrick;\">'24317'</span>, <span style=\"color:firebrick;\">'45748'</span>, <span style=\"color:firebrick;\">'39127'</span>, <span style=\"color:firebrick;\">'26065'</span>, <span style=\"color:firebrick;\">'77721'</span>, <span style=\"color:firebrick;\">'31029'</span>, <span style=\"color:firebrick;\">'31880'</span>, <span style=\"color:firebrick;\">'60576'</span>, <span style=\"color:firebrick;\">'24671'</span>, <span style=\"color:firebrick;\">'45549'</span>, <span style=\"color:firebrick;\">'13376'</span>, <span style=\"color:firebrick;\">'50016'</span>, <span style=\"color:firebrick;\">'33123'</span>, <span style=\"color:firebrick;\">'19769'</span>, <span style=\"color:firebrick;\">'22927'</span>, <span style=\"color:firebrick;\">'97789'</span>, <span style=\"color:firebrick;\">'46081'</span>, <span style=\"color:firebrick;\">'72151'</span>, <span style=\"color:firebrick;\">'15723'</span>, <span style=\"color:firebrick;\">'46136'</span>, <span style=\"color:firebrick;\">'51949'</span>, <span style=\"color:firebrick;\">'68100'</span>, <span style=\"color:firebrick;\">'96888'</span>, <span style=\"color:firebrick;\">'64528'</span>, <span style=\"color:firebrick;\">'14171'</span>, <span style=\"color:firebrick;\">'79777'</span>, <span style=\"color:firebrick;\">'28709'</span>, <span style=\"color:firebrick;\">'11489'</span>, <span style=\"color:firebrick;\">'25103'</span>, <span style=\"color:firebrick;\">'32213'</span>, <span style=\"color:firebrick;\">'78668'</span>, <span style=\"color:firebrick;\">'22245'</span>, <span style=\"color:firebrick;\">'15798'</span>, <span style=\"color:firebrick;\">'27156'</span>, <span style=\"color:firebrick;\">'37930'</span>, <span style=\"color:firebrick;\">'62971'</span>, <span style=\"color:firebrick;\">'21337'</span>, <span style=\"color:firebrick;\">'51622'</span>, <span style=\"color:firebrick;\">'67853'</span>, <span style=\"color:firebrick;\">'10567'</span>, <span style=\"color:firebrick;\">'38415'</span>, <span style=\"color:firebrick;\">'15455'</span>, <span style=\"color:firebrick;\">'58263'</span>, <span style=\"color:firebrick;\">'42029'</span>, <span style=\"color:firebrick;\">'60279'</span>, <span style=\"color:firebrick;\">'37125'</span>, <span style=\"color:firebrick;\">'56240'</span>, <span style=\"color:firebrick;\">'88190'</span>, <span style=\"color:firebrick;\">'50308'</span>, <span style=\"color:firebrick;\">'26859'</span>, <span style=\"color:firebrick;\">'64457'</span>, <span style=\"color:firebrick;\">'89091'</span>, <span style=\"color:firebrick;\">'82136'</span>, <span style=\"color:firebrick;\">'62377'</span>, <span style=\"color:firebrick;\">'36233'</span>, <span style=\"color:firebrick;\">'63837'</span>, <span style=\"color:firebrick;\">'58078'</span>, <span style=\"color:firebrick;\">'17043'</span>, <span style=\"color:firebrick;\">'30010'</span>, <span style=\"color:firebrick;\">'60099'</span>, <span style=\"color:firebrick;\">'28810'</span>, <span style=\"color:firebrick;\">'98025'</span>, <span style=\"color:firebrick;\">'29178'</span>, <span style=\"color:firebrick;\">'87343'</span>, <span style=\"color:firebrick;\">'73273'</span>, <span style=\"color:firebrick;\">'30469'</span>, <span style=\"color:firebrick;\">'64034'</span>, <span style=\"color:firebrick;\">'39516'</span>, <span style=\"color:firebrick;\">'86057'</span>, <span style=\"color:firebrick;\">'21309'</span>, <span style=\"color:firebrick;\">'90257'</span>, <span style=\"color:firebrick;\">'67875'</span>, <span style=\"color:firebrick;\">'40162'</span>, <span style=\"color:firebrick;\">'11356'</span>, <span style=\"color:firebrick;\">'73650'</span>, <span style=\"color:firebrick;\">'61810'</span>, <span style=\"color:firebrick;\">'72013'</span>, <span style=\"color:firebrick;\">'30431'</span>, <span style=\"color:firebrick;\">'22461'</span>, <span style=\"color:firebrick;\">'19512'</span>, <span style=\"color:firebrick;\">'13375'</span>, <span style=\"color:firebrick;\">'55307'</span>, <span style=\"color:firebrick;\">'30625'</span>, <span style=\"color:firebrick;\">'83849'</span>, <span style=\"color:firebrick;\">'68908'</span>, <span style=\"color:firebrick;\">'26689'</span>, <span style=\"color:firebrick;\">'96451'</span>, <span style=\"color:firebrick;\">'38193'</span>, <span style=\"color:firebrick;\">'46820'</span>, <span style=\"color:firebrick;\">'88885'</span>, <span style=\"color:firebrick;\">'84935'</span>, <span style=\"color:firebrick;\">'69035'</span>, <span style=\"color:firebrick;\">'83144'</span>, <span style=\"color:firebrick;\">'47537'</span>, <span style=\"color:firebrick;\">'56616'</span>, <span style=\"color:firebrick;\">'94983'</span>, <span style=\"color:firebrick;\">'48033'</span>, <span style=\"color:firebrick;\">'69952'</span>, <span style=\"color:firebrick;\">'25486'</span>, <span style=\"color:firebrick;\">'61547'</span>, <span style=\"color:firebrick;\">'27385'</span>, <span style=\"color:firebrick;\">'61860'</span>, <span style=\"color:firebrick;\">'58048'</span>, <span style=\"color:firebrick;\">'56910'</span>, <span style=\"color:firebrick;\">'16807'</span>, <span style=\"color:firebrick;\">'17871'</span>, <span style=\"color:firebrick;\">'35258'</span>, <span style=\"color:firebrick;\">'31387'</span>, <span style=\"color:firebrick;\">'35458'</span>, <span style=\"color:firebrick;\">'35576'</span>)\n            <span style=\"color:black;font-weight:bold;\">INTERSECT</span>\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                ca_zip\n            <span style=\"color:black;font-weight:bold;\">FROM</span> (\n                <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                    <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(ca_zip, 1, 5) ca_zip,\n                    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt\n                <span style=\"color:black;font-weight:bold;\">FROM</span>\n                    customer_address,\n                    customer\n                <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                    ca_address_sk = c_current_addr_sk\n                    <span style=\"color:black;font-weight:bold;\">AND</span> c_preferred_cust_flag = <span style=\"color:firebrick;\">'Y'</span>\n                <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                    ca_zip\n                <span style=\"color:black;font-weight:bold;\">HAVING</span>\n                    <span style=\"color:black;font-weight:bold;\">count</span>(*) > 10) A1) A2) V1\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ss_store_sk = s_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_qoy = 2\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1998\n    <span style=\"color:black;font-weight:bold;\">AND</span> (<span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(s_zip, 1, 2) = <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(V1.ca_zip, 1, 2))\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    s_store_name\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    s_store_name\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ009": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1 <span style=\"color:black;font-weight:bold;\">AND</span> 20) > 74129 <span style=\"color:black;font-weight:bold;\">THEN</span>\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_ext_discount_amt)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1 <span style=\"color:black;font-weight:bold;\">AND</span> 20)\n<span style=\"color:black;font-weight:bold;\">ELSE</span>\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_net_paid)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1 <span style=\"color:black;font-weight:bold;\">AND</span> 20)\n    <span style=\"color:black;font-weight:bold;\">END</span> bucket1,\n    <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 21 <span style=\"color:black;font-weight:bold;\">AND</span> 40) > 122840 <span style=\"color:black;font-weight:bold;\">THEN</span>\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_ext_discount_amt)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 21 <span style=\"color:black;font-weight:bold;\">AND</span> 40)\n<span style=\"color:black;font-weight:bold;\">ELSE</span>\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_net_paid)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 21 <span style=\"color:black;font-weight:bold;\">AND</span> 40)\n    <span style=\"color:black;font-weight:bold;\">END</span> bucket2,\n    <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 41 <span style=\"color:black;font-weight:bold;\">AND</span> 60) > 56580 <span style=\"color:black;font-weight:bold;\">THEN</span>\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_ext_discount_amt)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 41 <span style=\"color:black;font-weight:bold;\">AND</span> 60)\n<span style=\"color:black;font-weight:bold;\">ELSE</span>\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_net_paid)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 41 <span style=\"color:black;font-weight:bold;\">AND</span> 60)\n    <span style=\"color:black;font-weight:bold;\">END</span> bucket3,\n    <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 61 <span style=\"color:black;font-weight:bold;\">AND</span> 80) > 10097 <span style=\"color:black;font-weight:bold;\">THEN</span>\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_ext_discount_amt)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 61 <span style=\"color:black;font-weight:bold;\">AND</span> 80)\n<span style=\"color:black;font-weight:bold;\">ELSE</span>\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_net_paid)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 61 <span style=\"color:black;font-weight:bold;\">AND</span> 80)\n    <span style=\"color:black;font-weight:bold;\">END</span> bucket4,\n    <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 81 <span style=\"color:black;font-weight:bold;\">AND</span> 100) > 165306 <span style=\"color:black;font-weight:bold;\">THEN</span>\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_ext_discount_amt)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 81 <span style=\"color:black;font-weight:bold;\">AND</span> 100)\n<span style=\"color:black;font-weight:bold;\">ELSE</span>\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_net_paid)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 81 <span style=\"color:black;font-weight:bold;\">AND</span> 100)\n    <span style=\"color:black;font-weight:bold;\">END</span> bucket5\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    reason\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    r_reason_sk = 1;\n\n</pre>\n\t\t", "DSQ010": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt1,\n    cd_purchase_estimate,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt2,\n    cd_credit_rating,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt3,\n    cd_dep_count,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt4,\n    cd_dep_employed_count,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt5,\n    cd_dep_college_count,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt6\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    customer c,\n    customer_address ca,\n    customer_demographics\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    c.c_current_addr_sk = ca.ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ca_county <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Rush County'</span>, <span style=\"color:firebrick;\">'Toole County'</span>, <span style=\"color:firebrick;\">'Jefferson County'</span>, <span style=\"color:firebrick;\">'Dona Ana County'</span>, <span style=\"color:firebrick;\">'La Porte County'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd_demo_sk = c.c_current_cdemo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            *\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            c.c_customer_sk = ss_customer_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2002\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1 <span style=\"color:black;font-weight:bold;\">AND</span> 1 + 3)\n    <span style=\"color:black;font-weight:bold;\">AND</span> (<span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                *\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                web_sales,\n                date_dim\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                c.c_customer_sk = ws_bill_customer_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2002\n                <span style=\"color:black;font-weight:bold;\">AND</span> d_moy <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1 <span style=\"color:black;font-weight:bold;\">AND</span> 1 + 3)\n            <span style=\"color:black;font-weight:bold;\">OR</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n                <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                    *\n                <span style=\"color:black;font-weight:bold;\">FROM</span>\n                    catalog_sales,\n                    date_dim\n                <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                    c.c_customer_sk = cs_ship_customer_sk\n                    <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n                    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2002\n                    <span style=\"color:black;font-weight:bold;\">AND</span> d_moy <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1 <span style=\"color:black;font-weight:bold;\">AND</span> 1 + 3))\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_purchase_estimate,\n        cd_credit_rating,\n        cd_dep_count,\n        cd_dep_employed_count,\n        cd_dep_college_count\n    <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_purchase_estimate,\n        cd_credit_rating,\n        cd_dep_count,\n        cd_dep_employed_count,\n        cd_dep_college_count\n    <span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ011": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> year_total <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_customer_id customer_id,\n        c_first_name customer_first_name,\n        c_last_name customer_last_name,\n        c_preferred_cust_flag customer_preferred_cust_flag,\n        c_birth_country customer_birth_country,\n        c_login customer_login,\n        c_email_address customer_email_address,\n        d_year dyear,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_list_price - ss_ext_discount_amt) year_total,\n        <span style=\"color:firebrick;\">'s'</span> sale_type\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        customer,\n        store_sales,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        c_customer_sk = ss_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_customer_id customer_id,\n        c_first_name customer_first_name,\n        c_last_name customer_last_name,\n        c_preferred_cust_flag customer_preferred_cust_flag,\n        c_birth_country customer_birth_country,\n        c_login customer_login,\n        c_email_address customer_email_address,\n        d_year dyear,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_list_price - ws_ext_discount_amt) year_total,\n        <span style=\"color:firebrick;\">'w'</span> sale_type\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        customer,\n        web_sales,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        c_customer_sk = ws_bill_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    t_s_secyear.customer_id,\n    t_s_secyear.customer_first_name,\n    t_s_secyear.customer_last_name,\n    t_s_secyear.customer_preferred_cust_flag\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    year_total t_s_firstyear,\n    year_total t_s_secyear,\n    year_total t_w_firstyear,\n    year_total t_w_secyear\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    t_s_secyear.customer_id = t_s_firstyear.customer_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.customer_id = t_w_secyear.customer_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.customer_id = t_w_firstyear.customer_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.sale_type = <span style=\"color:firebrick;\">'s'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_firstyear.sale_type = <span style=\"color:firebrick;\">'w'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_secyear.sale_type = <span style=\"color:firebrick;\">'s'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_secyear.sale_type = <span style=\"color:firebrick;\">'w'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.dyear = 2001\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_secyear.dyear = 2001 + 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_firstyear.dyear = 2001\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_secyear.dyear = 2001 + 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.year_total > 0\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_firstyear.year_total > 0\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> t_w_firstyear.year_total > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n    (t_w_secyear.year_total * 1.0000) / t_w_firstyear.year_total\n<span style=\"color:black;font-weight:bold;\">ELSE</span>\n    0.0\n    <span style=\"color:black;font-weight:bold;\">END</span> > <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> t_s_firstyear.year_total > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n    (t_s_secyear.year_total * 1.0000) / t_s_firstyear.year_total\n<span style=\"color:black;font-weight:bold;\">ELSE</span>\n    0.0\n    <span style=\"color:black;font-weight:bold;\">END</span>\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    t_s_secyear.customer_id,\n    t_s_secyear.customer_first_name,\n    t_s_secyear.customer_last_name,\n    t_s_secyear.customer_preferred_cust_flag\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ012": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> itemrevenue,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_sales_price) * 100.0000 / <span style=\"color:black;font-weight:bold;\">sum</span>(sum(ws_ext_sales_price)) OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> i_class) <span style=\"color:black;font-weight:bold;\">AS</span> revenueratio\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    web_sales,\n    item,\n    date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ws_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_category <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sports'</span>, <span style=\"color:firebrick;\">'Books'</span>, <span style=\"color:firebrick;\">'Home'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1999-02-22'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1999-03-24'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_category,\n    i_class,\n    i_item_id,\n    i_item_desc,\n    revenueratio\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ013": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">avg</span>(ss_quantity),\n    <span style=\"color:black;font-weight:bold;\">avg</span>(ss_ext_sales_price),\n    <span style=\"color:black;font-weight:bold;\">avg</span>(ss_ext_wholesale_cost),\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_wholesale_cost)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    store_sales,\n    store,\n    customer_demographics,\n    household_demographics,\n    customer_address,\n    date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s_store_sk = ss_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n    <span style=\"color:black;font-weight:bold;\">AND</span> ((ss_hdemo_sk = hd_demo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_demo_sk = ss_cdemo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_marital_status = <span style=\"color:firebrick;\">'M'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_education_status = <span style=\"color:firebrick;\">'Advanced Degree'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sales_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 100.00\n            <span style=\"color:black;font-weight:bold;\">AND</span> 150.00\n            <span style=\"color:black;font-weight:bold;\">AND</span> hd_dep_count = 3)\n        <span style=\"color:black;font-weight:bold;\">OR</span> (ss_hdemo_sk = hd_demo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_demo_sk = ss_cdemo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_marital_status = <span style=\"color:firebrick;\">'S'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_education_status = <span style=\"color:firebrick;\">'College'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sales_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 50.00\n            <span style=\"color:black;font-weight:bold;\">AND</span> 100.00\n            <span style=\"color:black;font-weight:bold;\">AND</span> hd_dep_count = 1)\n        <span style=\"color:black;font-weight:bold;\">OR</span> (ss_hdemo_sk = hd_demo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_demo_sk = ss_cdemo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_marital_status = <span style=\"color:firebrick;\">'W'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_education_status = <span style=\"color:firebrick;\">'2 yr Degree'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sales_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 150.00\n            <span style=\"color:black;font-weight:bold;\">AND</span> 200.00\n            <span style=\"color:black;font-weight:bold;\">AND</span> hd_dep_count = 1))\n    <span style=\"color:black;font-weight:bold;\">AND</span> ((ss_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_country = <span style=\"color:firebrick;\">'United States'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_state <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'TX'</span>,\n                <span style=\"color:firebrick;\">'OH'</span>,\n                <span style=\"color:firebrick;\">'TX'</span>)\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_net_profit <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 100 <span style=\"color:black;font-weight:bold;\">AND</span> 200)\n        <span style=\"color:black;font-weight:bold;\">OR</span> (ss_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_country = <span style=\"color:firebrick;\">'United States'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_state <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'OR'</span>,\n                <span style=\"color:firebrick;\">'NM'</span>,\n                <span style=\"color:firebrick;\">'KY'</span>)\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_net_profit <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 150 <span style=\"color:black;font-weight:bold;\">AND</span> 300)\n        <span style=\"color:black;font-weight:bold;\">OR</span> (ss_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_country = <span style=\"color:firebrick;\">'United States'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_state <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'VA'</span>,\n                <span style=\"color:firebrick;\">'TX'</span>,\n                <span style=\"color:firebrick;\">'MS'</span>)\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_net_profit <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 50 <span style=\"color:black;font-weight:bold;\">AND</span> 250));\n\n</pre>\n\t\t", "DSQ014": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> cross_items <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_sk ss_item_sk\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        item,\n        (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                iss.i_brand_id brand_id,\n                iss.i_class_id class_id,\n                iss.i_category_id category_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                store_sales,\n                item iss,\n                date_dim d1\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                ss_item_sk = iss.i_item_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d1.d_date_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> d1.d_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1999 <span style=\"color:black;font-weight:bold;\">AND</span> 1999 + 2\n            <span style=\"color:black;font-weight:bold;\">INTERSECT</span>\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                ics.i_brand_id,\n                ics.i_class_id,\n                ics.i_category_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                catalog_sales,\n                item ics,\n                date_dim d2\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                cs_item_sk = ics.i_item_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d2.d_date_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> d2.d_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1999 <span style=\"color:black;font-weight:bold;\">AND</span> 1999 + 2\n            <span style=\"color:black;font-weight:bold;\">INTERSECT</span>\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                iws.i_brand_id,\n                iws.i_class_id,\n                iws.i_category_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                web_sales,\n                item iws,\n                date_dim d3\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                ws_item_sk = iws.i_item_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d3.d_date_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> d3.d_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1999 <span style=\"color:black;font-weight:bold;\">AND</span> 1999 + 2) x\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            i_brand_id = brand_id\n            <span style=\"color:black;font-weight:bold;\">AND</span> i_class_id = class_id\n            <span style=\"color:black;font-weight:bold;\">AND</span> i_category_id = category_id\n),\navg_sales <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">avg</span>(quantity * list_price) average_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ss_quantity quantity,\n            ss_list_price list_price\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1999 <span style=\"color:black;font-weight:bold;\">AND</span> 2001\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            cs_quantity quantity,\n            cs_list_price list_price\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            catalog_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            cs_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1999 <span style=\"color:black;font-weight:bold;\">AND</span> 1999 + 2\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ws_quantity quantity,\n            ws_list_price list_price\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ws_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1999 <span style=\"color:black;font-weight:bold;\">AND</span> 1999 + 2) x\n),\nresults <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        i_brand_id,\n        i_class_id,\n        i_category_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sales) sum_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(number_sales) number_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:firebrick;\">'store'</span> channel,\n            i_brand_id,\n            i_class_id,\n            i_category_id,\n            <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity * ss_list_price) sales,\n            <span style=\"color:black;font-weight:bold;\">count</span>(*) number_sales\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            item,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_item_sk <span style=\"color:black;font-weight:bold;\">IN</span> (\n                <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                    ss_item_sk\n                <span style=\"color:black;font-weight:bold;\">FROM</span>\n                    cross_items)\n                <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1999 + 2\n                <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 11\n            <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                i_brand_id,\n                i_class_id,\n                i_category_id\n            <span style=\"color:black;font-weight:bold;\">HAVING</span>\n                <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity * ss_list_price) > (\n                    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                        average_sales\n                    <span style=\"color:black;font-weight:bold;\">FROM</span>\n                        avg_sales)\n                <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n                <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                    <span style=\"color:firebrick;\">'catalog'</span> channel,\n                    i_brand_id,\n                    i_class_id,\n                    i_category_id,\n                    <span style=\"color:black;font-weight:bold;\">sum</span>(cs_quantity * cs_list_price) sales,\n                    <span style=\"color:black;font-weight:bold;\">count</span>(*) number_sales\n                <span style=\"color:black;font-weight:bold;\">FROM</span>\n                    catalog_sales,\n                    item,\n                    date_dim\n                <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                    cs_item_sk <span style=\"color:black;font-weight:bold;\">IN</span> (\n                        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                            ss_item_sk\n                        <span style=\"color:black;font-weight:bold;\">FROM</span>\n                            cross_items)\n                        <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = i_item_sk\n                        <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n                        <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1999 + 2\n                        <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 11\n                    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                        i_brand_id,\n                        i_class_id,\n                        i_category_id\n                    <span style=\"color:black;font-weight:bold;\">HAVING</span>\n                        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_quantity * cs_list_price) > (\n                            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                                average_sales\n                            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                                avg_sales)\n                        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n                        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                            <span style=\"color:firebrick;\">'web'</span> channel,\n                            i_brand_id,\n                            i_class_id,\n                            i_category_id,\n                            <span style=\"color:black;font-weight:bold;\">sum</span>(ws_quantity * ws_list_price) sales,\n                            <span style=\"color:black;font-weight:bold;\">count</span>(*) number_sales\n                        <span style=\"color:black;font-weight:bold;\">FROM</span>\n                            web_sales,\n                            item,\n                            date_dim\n                        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                            ws_item_sk <span style=\"color:black;font-weight:bold;\">IN</span> (\n                                <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                                    ss_item_sk\n                                <span style=\"color:black;font-weight:bold;\">FROM</span>\n                                    cross_items)\n                                <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk = i_item_sk\n                                <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n                                <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1999 + 2\n                                <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 11\n                            <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                                i_brand_id,\n                                i_class_id,\n                                i_category_id\n                            <span style=\"color:black;font-weight:bold;\">HAVING</span>\n                                <span style=\"color:black;font-weight:bold;\">sum</span>(ws_quantity * ws_list_price) > (\n                                    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                                        average_sales\n                                    <span style=\"color:black;font-weight:bold;\">FROM</span>\n                                        avg_sales)) y\n                            <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                                channel,\n                                i_brand_id,\n                                i_class_id,\n                                i_category_id\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    channel,\n    i_brand_id,\n    i_class_id,\n    i_category_id,\n    sum_sales,\n    number_sales\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        i_brand_id,\n        i_class_id,\n        i_category_id,\n        sum_sales,\n        number_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        i_brand_id,\n        i_class_id,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_category_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sum_sales),\n        <span style=\"color:black;font-weight:bold;\">sum</span>(number_sales)\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        channel,\n        i_brand_id,\n        i_class_id\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        i_brand_id,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_class_id,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_category_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sum_sales),\n        <span style=\"color:black;font-weight:bold;\">sum</span>(number_sales)\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        channel,\n        i_brand_id\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_brand_id,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_class_id,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_category_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sum_sales),\n        <span style=\"color:black;font-weight:bold;\">sum</span>(number_sales)\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        channel\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_brand_id,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_class_id,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_category_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sum_sales),\n        <span style=\"color:black;font-weight:bold;\">sum</span>(number_sales)\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results) z\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    channel,\n    i_brand_id,\n    i_class_id,\n    i_category_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ015": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> cross_items <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_sk ss_item_sk\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        item,\n        (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                iss.i_brand_id brand_id,\n                iss.i_class_id class_id,\n                iss.i_category_id category_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                store_sales,\n                item iss,\n                date_dim d1\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                ss_item_sk = iss.i_item_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d1.d_date_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> d1.d_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1999 <span style=\"color:black;font-weight:bold;\">AND</span> 1999 + 2\n            <span style=\"color:black;font-weight:bold;\">INTERSECT</span>\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                ics.i_brand_id,\n                ics.i_class_id,\n                ics.i_category_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                catalog_sales,\n                item ics,\n                date_dim d2\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                cs_item_sk = ics.i_item_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d2.d_date_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> d2.d_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1999 <span style=\"color:black;font-weight:bold;\">AND</span> 1999 + 2\n            <span style=\"color:black;font-weight:bold;\">INTERSECT</span>\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                iws.i_brand_id,\n                iws.i_class_id,\n                iws.i_category_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                web_sales,\n                item iws,\n                date_dim d3\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                ws_item_sk = iws.i_item_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d3.d_date_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> d3.d_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1999 <span style=\"color:black;font-weight:bold;\">AND</span> 1999 + 2) x\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            i_brand_id = brand_id\n            <span style=\"color:black;font-weight:bold;\">AND</span> i_class_id = class_id\n            <span style=\"color:black;font-weight:bold;\">AND</span> i_category_id = category_id\n),\navg_sales <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">avg</span>(quantity * list_price) average_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ss_quantity quantity,\n            ss_list_price list_price\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1999 <span style=\"color:black;font-weight:bold;\">AND</span> 1999 + 2\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            cs_quantity quantity,\n            cs_list_price list_price\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            catalog_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            cs_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1999 <span style=\"color:black;font-weight:bold;\">AND</span> 1999 + 2\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ws_quantity quantity,\n            ws_list_price list_price\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ws_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1999 <span style=\"color:black;font-weight:bold;\">AND</span> 1999 + 2) x\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    this_year.channel ty_channel, this_year.i_brand_id ty_brand, this_year.i_class_id ty_class, this_year.i_category_id ty_category, this_year.sales ty_sales, this_year.number_sales ty_number_sales, last_year.channel ly_channel, last_year.i_brand_id ly_brand, last_year.i_class_id ly_class, last_year.i_category_id ly_category, last_year.sales ly_sales, last_year.number_sales ly_number_sales\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:firebrick;\">'store'</span> channel,\n        i_brand_id,\n        i_class_id,\n        i_category_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity * ss_list_price) sales,\n        <span style=\"color:black;font-weight:bold;\">count</span>(*) number_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        item,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_item_sk <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                ss_item_sk\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                cross_items)\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_week_seq = (\n                <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                    d_week_seq\n                <span style=\"color:black;font-weight:bold;\">FROM</span>\n                    date_dim\n                <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                    d_year = 1999 + 1\n                    <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 12\n                    <span style=\"color:black;font-weight:bold;\">AND</span> d_dom = 11)\n            <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                i_brand_id,\n                i_class_id,\n                i_category_id\n            <span style=\"color:black;font-weight:bold;\">HAVING</span>\n                <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity * ss_list_price) > (\n                    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                        average_sales\n                    <span style=\"color:black;font-weight:bold;\">FROM</span>\n                        avg_sales)) this_year,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:firebrick;\">'store'</span> channel,\n            i_brand_id,\n            i_class_id,\n            i_category_id,\n            <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity * ss_list_price) sales,\n            <span style=\"color:black;font-weight:bold;\">count</span>(*) number_sales\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            item,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_item_sk <span style=\"color:black;font-weight:bold;\">IN</span> (\n                <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                    ss_item_sk\n                <span style=\"color:black;font-weight:bold;\">FROM</span>\n                    cross_items)\n                <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> d_week_seq = (\n                    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                        d_week_seq\n                    <span style=\"color:black;font-weight:bold;\">FROM</span>\n                        date_dim\n                    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                        d_year = 1999\n                        <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 12\n                        <span style=\"color:black;font-weight:bold;\">AND</span> d_dom = 11)\n                <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                    i_brand_id,\n                    i_class_id,\n                    i_category_id\n                <span style=\"color:black;font-weight:bold;\">HAVING</span>\n                    <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity * ss_list_price) > (\n                        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                            average_sales\n                        <span style=\"color:black;font-weight:bold;\">FROM</span>\n                            avg_sales)) last_year\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    this_year.i_brand_id = last_year.i_brand_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> this_year.i_class_id = last_year.i_class_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> this_year.i_category_id = last_year.i_category_id\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    this_year.channel,\n    this_year.i_brand_id,\n    this_year.i_class_id,\n    this_year.i_category_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ016": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    ca_zip,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(cs_sales_price)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    catalog_sales,\n    customer,\n    customer_address,\n    date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cs_bill_customer_sk = c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> c_current_addr_sk = ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> (<span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(ca_zip, 1, 5)\n        <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'85669'</span>, <span style=\"color:firebrick;\">'86197'</span>, <span style=\"color:firebrick;\">'88274'</span>, <span style=\"color:firebrick;\">'83405'</span>, <span style=\"color:firebrick;\">'86475'</span>, <span style=\"color:firebrick;\">'85392'</span>, <span style=\"color:firebrick;\">'85460'</span>, <span style=\"color:firebrick;\">'80348'</span>, <span style=\"color:firebrick;\">'81792'</span>)\n        <span style=\"color:black;font-weight:bold;\">OR</span> ca_state <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'CA'</span>, <span style=\"color:firebrick;\">'WA'</span>, <span style=\"color:firebrick;\">'GA'</span>)\n        <span style=\"color:black;font-weight:bold;\">OR</span> cs_sales_price > 500)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_qoy = 2\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ca_zip\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ca_zip\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ017": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">count</span>(<span style=\"color:black;font-weight:bold;\">DISTINCT</span> cs_order_number) <span style=\"color:black;font-weight:bold;\">AS</span> \"order <span style=\"color:black;font-weight:bold;\">count</span>\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(cs_ext_ship_cost) <span style=\"color:black;font-weight:bold;\">AS</span> \"total shipping cost\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(cs_net_profit) <span style=\"color:black;font-weight:bold;\">AS</span> \"total net profit\"\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    catalog_sales cs1,\n    date_dim,\n    customer_address,\n    call_center\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:firebrick;\">'2002-02-01'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2002-04-02'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs1.cs_ship_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs1.cs_ship_addr_sk = ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ca_state = <span style=\"color:firebrick;\">'GA'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs1.cs_call_center_sk = cc_call_center_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cc_county = <span style=\"color:firebrick;\">'Williamson County'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            *\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            catalog_sales cs2\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            cs1.cs_order_number = cs2.cs_order_number\n            <span style=\"color:black;font-weight:bold;\">AND</span> cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            *\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            catalog_returns cr1\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            cs1.cs_order_number = cr1.cr_order_number)\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    <span style=\"color:black;font-weight:bold;\">count</span>(<span style=\"color:black;font-weight:bold;\">DISTINCT</span> cs_order_number)\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ018": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id,\n    i_item_desc,\n    s_state,\n    <span style=\"color:black;font-weight:bold;\">count</span>(ss_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> store_sales_quantitycount,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(ss_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> store_sales_quantityave,\n    stddev_samp(ss_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> store_sales_quantitystdev,\n    stddev_samp(ss_quantity) / <span style=\"color:black;font-weight:bold;\">avg</span>(ss_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> store_sales_quantitycov,\n    <span style=\"color:black;font-weight:bold;\">count</span>(sr_return_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> store_returns_quantitycount,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(sr_return_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> store_returns_quantityave,\n    stddev_samp(sr_return_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> store_returns_quantitystdev,\n    stddev_samp(sr_return_quantity) / <span style=\"color:black;font-weight:bold;\">avg</span>(sr_return_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> store_returns_quantitycov,\n    <span style=\"color:black;font-weight:bold;\">count</span>(cs_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> catalog_sales_quantitycount,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(cs_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> catalog_sales_quantityave,\n    stddev_samp(cs_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> catalog_sales_quantitystdev,\n    stddev_samp(cs_quantity) / <span style=\"color:black;font-weight:bold;\">avg</span>(cs_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> catalog_sales_quantitycov\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    store_sales,\n    store_returns,\n    catalog_sales,\n    date_dim d1,\n    date_dim d2,\n    date_dim d3,\n    store,\n    item\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d1.d_quarter_name = <span style=\"color:firebrick;\">'2001Q1'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> d1.d_date_sk = ss_sold_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_item_sk = ss_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> s_store_sk = ss_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_customer_sk = sr_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = sr_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_ticket_number = sr_ticket_number\n    <span style=\"color:black;font-weight:bold;\">AND</span> sr_returned_date_sk = d2.d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d2.d_quarter_name <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'2001Q1'</span>, <span style=\"color:firebrick;\">'2001Q2'</span>, <span style=\"color:firebrick;\">'2001Q3'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> sr_customer_sk = cs_bill_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> sr_item_sk = cs_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d3.d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d3.d_quarter_name <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'2001Q1'</span>,\n        <span style=\"color:firebrick;\">'2001Q2'</span>,\n        <span style=\"color:firebrick;\">'2001Q3'</span>)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id,\n    i_item_desc,\n    s_state\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id,\n    i_item_desc,\n    s_state\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ019": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> results <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        ca_country,\n        ca_state,\n        ca_county,\n        <span style=\"color:black;font-weight:bold;\">cast</span>(cs_quantity <span style=\"color:black;font-weight:bold;\">AS</span> decimal(12,\n                2)) agg1,\n        <span style=\"color:black;font-weight:bold;\">cast</span>(cs_list_price <span style=\"color:black;font-weight:bold;\">AS</span> decimal(12,\n                2)) agg2,\n        <span style=\"color:black;font-weight:bold;\">cast</span>(cs_coupon_amt <span style=\"color:black;font-weight:bold;\">AS</span> decimal(12,\n                2)) agg3,\n        <span style=\"color:black;font-weight:bold;\">cast</span>(cs_sales_price <span style=\"color:black;font-weight:bold;\">AS</span> decimal(12,\n                2)) agg4,\n        <span style=\"color:black;font-weight:bold;\">cast</span>(cs_net_profit <span style=\"color:black;font-weight:bold;\">AS</span> decimal(12,\n                2)) agg5,\n        <span style=\"color:black;font-weight:bold;\">cast</span>(c_birth_year <span style=\"color:black;font-weight:bold;\">AS</span> decimal(12,\n                2)) agg6,\n        <span style=\"color:black;font-weight:bold;\">cast</span>(cd1.cd_dep_count <span style=\"color:black;font-weight:bold;\">AS</span> decimal(12,\n                2)) agg7\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales,\n        customer_demographics cd1,\n        customer_demographics cd2,\n        customer,\n        customer_address,\n        date_dim,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        cs_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_bill_cdemo_sk = cd1.cd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_bill_customer_sk = c_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cd1.cd_gender = <span style=\"color:firebrick;\">'F'</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> cd1.cd_education_status = <span style=\"color:firebrick;\">'Unknown'</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_current_cdemo_sk = cd2.cd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_current_addr_sk = ca_address_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_birth_month <span style=\"color:black;font-weight:bold;\">IN</span> (1,\n            6,\n            8,\n            9,\n            12,\n            2)\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1998\n        <span style=\"color:black;font-weight:bold;\">AND</span> ca_state <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'MS'</span>,\n            <span style=\"color:firebrick;\">'IN'</span>,\n            <span style=\"color:firebrick;\">'ND'</span>,\n            <span style=\"color:firebrick;\">'OK'</span>,\n            <span style=\"color:firebrick;\">'NM'</span>,\n            <span style=\"color:firebrick;\">'VA'</span>,\n            <span style=\"color:firebrick;\">'MS'</span>)\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        ca_country,\n        ca_state,\n        ca_county,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg1) agg1,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg2) agg2,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg3) agg3,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg4) agg4,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg5) agg5,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg6) agg6,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg7) agg7\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_item_id,\n        ca_country,\n        ca_state,\n        ca_county\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        ca_country,\n        ca_state,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> county,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg1) agg1,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg2) agg2,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg3) agg3,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg4) agg4,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg5) agg5,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg6) agg6,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg7) agg7\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_item_id,\n        ca_country,\n        ca_state\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        ca_country,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> ca_state,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> county,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg1) agg1,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg2) agg2,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg3) agg3,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg4) agg4,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg5) agg5,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg6) agg6,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg7) agg7\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_item_id,\n        ca_country\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> ca_country,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> ca_state,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> county,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg1) agg1,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg2) agg2,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg3) agg3,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg4) agg4,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg5) agg5,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg6) agg6,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg7) agg7\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_item_id\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_item_id,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> ca_country,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> ca_state,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> county,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg1) agg1,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg2) agg2,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg3) agg3,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg4) agg4,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg5) agg5,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg6) agg6,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg7) agg7\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results) foo\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ca_country,\n    ca_state,\n    ca_county,\n    i_item_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ020": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_brand_id brand_id,\n    i_brand brand,\n    i_manufact_id,\n    i_manufact,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) ext_price\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    date_dim,\n    store_sales,\n    item,\n    customer,\n    customer_address,\n    store\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d_date_sk = ss_sold_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_manager_id = 8\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 11\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1998\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_customer_sk = c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> c_current_addr_sk = ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(ca_zip, 1, 5) <> <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(s_zip, 1, 5)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_brand,\n    i_brand_id,\n    i_manufact_id,\n    i_manufact\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ext_price <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    i_brand,\n    i_brand_id,\n    i_manufact_id,\n    i_manufact\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ021": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(cs_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> itemrevenue,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(cs_ext_sales_price) * 100.0000 / <span style=\"color:black;font-weight:bold;\">sum</span>(sum(cs_ext_sales_price)) OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> i_class) <span style=\"color:black;font-weight:bold;\">AS</span> revenueratio\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    catalog_sales,\n    item,\n    date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cs_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_category <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sports'</span>, <span style=\"color:firebrick;\">'Books'</span>, <span style=\"color:firebrick;\">'Home'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1999-02-22'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1999-03-24'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_category,\n    i_class,\n    i_item_id,\n    i_item_desc,\n    revenueratio\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ022": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        w_warehouse_name,\n        i_item_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (<span style=\"color:black;font-weight:bold;\">cast</span>(d_date <span style=\"color:black;font-weight:bold;\">AS</span> date) < CAST(<span style=\"color:firebrick;\">'2000-03-11'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                inv_quantity_on_hand\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> inv_before,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (<span style=\"color:black;font-weight:bold;\">cast</span>(d_date <span style=\"color:black;font-weight:bold;\">AS</span> date) >= CAST(<span style=\"color:firebrick;\">'2000-03-11'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                inv_quantity_on_hand\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> inv_after\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        inventory,\n        warehouse,\n        item,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        i_current_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 0.99\n        <span style=\"color:black;font-weight:bold;\">AND</span> 1.49\n        <span style=\"color:black;font-weight:bold;\">AND</span> i_item_sk = inv_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> inv_warehouse_sk = w_warehouse_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> inv_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> CAST(<span style=\"color:firebrick;\">'2000-02-10'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> CAST(<span style=\"color:firebrick;\">'2000-04-10'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        w_warehouse_name,\n        i_item_id) x\n<span style=\"color:black;font-weight:bold;\">WHERE</span> (\n    <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> inv_before > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n        inv_after / inv_before\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2.0 / 3.0\n<span style=\"color:black;font-weight:bold;\">AND</span> 3.0 / 2.0\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    w_warehouse_name,\n    i_item_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ023": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> results <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_product_name,\n        i_brand,\n        i_class,\n        i_category,\n        inv_quantity_on_hand qoh\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        inventory,\n        date_dim,\n        item,\n        warehouse\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        inv_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> inv_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> inv_warehouse_sk = w_warehouse_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11\n),\nresults_rollup <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_product_name,\n        i_brand,\n        i_class,\n        i_category,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(qoh) qoh\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_product_name,\n        i_brand,\n        i_class,\n        i_category\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_product_name,\n        i_brand,\n        i_class,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_category,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(qoh) qoh\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_product_name,\n        i_brand,\n        i_class\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_product_name,\n        i_brand,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_class,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_category,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(qoh) qoh\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_product_name,\n        i_brand\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_product_name,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_brand,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_class,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_category,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(qoh) qoh\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_product_name\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_product_name,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_brand,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_class,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_category,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(qoh) qoh\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_product_name,\n    i_brand,\n    i_class,\n    i_category,\n    qoh\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    results_rollup\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    qoh,\n    i_product_name,\n    i_brand,\n    i_class,\n    i_category\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ024": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> frequent_ss_items <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        itemdesc,\n        i_item_sk item_sk,\n        d_date solddate,\n        <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(i_item_desc,\n                    1,\n                    30) itemdesc,\n                *\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                item) sq1\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year <span style=\"color:black;font-weight:bold;\">IN</span> (2000,\n                2000 + 1,\n                2000 + 2,\n                2000 + 3)\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            itemdesc,\n            i_item_sk,\n            d_date\n        <span style=\"color:black;font-weight:bold;\">HAVING</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*) > 4\n),\nmax_store_sales <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        max(csales) tpcds_cmax\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            c_customer_sk,\n            <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity * ss_sales_price) csales\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            customer,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_customer_sk = c_customer_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year <span style=\"color:black;font-weight:bold;\">IN</span> (2000,\n                2000 + 1,\n                2000 + 2,\n                2000 + 3)\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            c_customer_sk) sq2\n),\nbest_ss_customer <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_customer_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity * ss_sales_price) ssales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        customer,\n        max_store_sales\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_customer_sk = c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">HAVING</span>\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity * ss_sales_price) > (50 / 100.0) * max(tpcds_cmax)\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(sales)\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        cs_quantity * cs_list_price sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales,\n        date_dim,\n        frequent_ss_items,\n        best_ss_customer\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        d_year = 2000\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 2\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_bill_customer_sk = c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        ws_quantity * ws_list_price sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales,\n        date_dim,\n        frequent_ss_items,\n        best_ss_customer\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        d_year = 2000\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 2\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk = item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_bill_customer_sk = c_customer_sk) sq3\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ025": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> frequent_ss_items <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        itemdesc,\n        i_item_sk item_sk,\n        d_date solddate,\n        <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(i_item_desc,\n                    1,\n                    30) itemdesc,\n                *\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                item) sq1\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year <span style=\"color:black;font-weight:bold;\">IN</span> (2000,\n                2000 + 1,\n                2000 + 2,\n                2000 + 3)\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            itemdesc,\n            i_item_sk,\n            d_date\n        <span style=\"color:black;font-weight:bold;\">HAVING</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*) > 4\n),\nmax_store_sales <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        max(csales) tpcds_cmax\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            c_customer_sk,\n            <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity * ss_sales_price) csales\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            customer,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_customer_sk = c_customer_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year <span style=\"color:black;font-weight:bold;\">IN</span> (2000,\n                2000 + 1,\n                2000 + 2,\n                2000 + 3)\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            c_customer_sk) sq2\n),\nbest_ss_customer <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_customer_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity * ss_sales_price) ssales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        customer,\n        max_store_sales\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_customer_sk = c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">HAVING</span>\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity * ss_sales_price) > (50 / 100.0) * max(tpcds_cmax)\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_last_name,\n    c_first_name,\n    sales\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_last_name,\n        c_first_name,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_quantity * cs_list_price) sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales,\n        customer,\n        date_dim,\n        frequent_ss_items,\n        best_ss_customer\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        d_year = 2000\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 2\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_bill_customer_sk = best_ss_customer.c_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_bill_customer_sk = customer.c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        c_last_name,\n        c_first_name\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_last_name,\n        c_first_name,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_quantity * ws_list_price) sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales,\n        customer,\n        date_dim,\n        frequent_ss_items,\n        best_ss_customer\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        d_year = 2000\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 2\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk = item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_bill_customer_sk = best_ss_customer.c_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_bill_customer_sk = customer.c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        c_last_name,\n        c_first_name) sq3\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_last_name,\n    c_first_name,\n    sales\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ026": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> ssales <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_last_name,\n        c_first_name,\n        s_store_name,\n        ca_state,\n        s_state,\n        i_color,\n        i_current_price,\n        i_manager_id,\n        i_units,\n        i_size,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_paid) netpaid\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        store_returns,\n        store,\n        item,\n        customer,\n        customer_address\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_ticket_number = sr_ticket_number\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = sr_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_customer_sk = c_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_current_addr_sk = ca_address_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_birth_country <> upper(ca_country)\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_zip = ca_zip\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_market_id = 8\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        c_last_name,\n        c_first_name,\n        s_store_name,\n        ca_state,\n        s_state,\n        i_color,\n        i_current_price,\n        i_manager_id,\n        i_units,\n        i_size\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_last_name,\n    c_first_name,\n    s_store_name,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(netpaid) paid\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    ssales\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    i_color = <span style=\"color:firebrick;\">'peach'</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_last_name,\n    c_first_name,\n    s_store_name\n<span style=\"color:black;font-weight:bold;\">HAVING</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(netpaid) > (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            0.05 * <span style=\"color:black;font-weight:bold;\">avg</span>(netpaid)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            ssales)\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_last_name,\n    c_first_name,\n    s_store_name;\n\n</pre>\n\t\t", "DSQ027": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> ssales <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_last_name,\n        c_first_name,\n        s_store_name,\n        ca_state,\n        s_state,\n        i_color,\n        i_current_price,\n        i_manager_id,\n        i_units,\n        i_size,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_paid) netpaid\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        store_returns,\n        store,\n        item,\n        customer,\n        customer_address\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_ticket_number = sr_ticket_number\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = sr_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_customer_sk = c_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_current_addr_sk = ca_address_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_birth_country <> upper(ca_country)\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_zip = ca_zip\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_market_id = 8\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        c_last_name,\n        c_first_name,\n        s_store_name,\n        ca_state,\n        s_state,\n        i_color,\n        i_current_price,\n        i_manager_id,\n        i_units,\n        i_size\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_last_name,\n    c_first_name,\n    s_store_name,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(netpaid) paid\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    ssales\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    i_color = <span style=\"color:firebrick;\">'saddle'</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_last_name,\n    c_first_name,\n    s_store_name\n<span style=\"color:black;font-weight:bold;\">HAVING</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(netpaid) > (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            0.05 * <span style=\"color:black;font-weight:bold;\">avg</span>(netpaid)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            ssales)\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_last_name,\n    c_first_name,\n    s_store_name;\n\n</pre>\n\t\t", "DSQ028": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id,\n    i_item_desc,\n    s_store_id,\n    s_store_name,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_profit) <span style=\"color:black;font-weight:bold;\">AS</span> store_sales_profit,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(sr_net_loss) <span style=\"color:black;font-weight:bold;\">AS</span> store_returns_loss,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(cs_net_profit) <span style=\"color:black;font-weight:bold;\">AS</span> catalog_sales_profit\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    store_sales,\n    store_returns,\n    catalog_sales,\n    date_dim d1,\n    date_dim d2,\n    date_dim d3,\n    store,\n    item\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d1.d_moy = 4\n    <span style=\"color:black;font-weight:bold;\">AND</span> d1.d_year = 2001\n    <span style=\"color:black;font-weight:bold;\">AND</span> d1.d_date_sk = ss_sold_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_item_sk = ss_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> s_store_sk = ss_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_customer_sk = sr_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = sr_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_ticket_number = sr_ticket_number\n    <span style=\"color:black;font-weight:bold;\">AND</span> sr_returned_date_sk = d2.d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d2.d_moy <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 4 <span style=\"color:black;font-weight:bold;\">AND</span> 10\n    <span style=\"color:black;font-weight:bold;\">AND</span> d2.d_year = 2001\n    <span style=\"color:black;font-weight:bold;\">AND</span> sr_customer_sk = cs_bill_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> sr_item_sk = cs_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d3.d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d3.d_moy <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 4 <span style=\"color:black;font-weight:bold;\">AND</span> 10\n    <span style=\"color:black;font-weight:bold;\">AND</span> d3.d_year = 2001\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id,\n    i_item_desc,\n    s_store_id,\n    s_store_name\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id,\n    i_item_desc,\n    s_store_id,\n    s_store_name\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ029": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(cs_quantity) agg1,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(cs_list_price) agg2,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(cs_coupon_amt) agg3,\n    <span style=\"color:black;font-weight:bold;\">avg</span>(cs_sales_price) agg4\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    catalog_sales,\n    customer_demographics,\n    date_dim,\n    item,\n    promotion\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cs_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_bill_cdemo_sk = cd_demo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_promo_sk = p_promo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd_gender = <span style=\"color:firebrick;\">'M'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd_marital_status = <span style=\"color:firebrick;\">'S'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd_education_status = <span style=\"color:firebrick;\">'College'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (p_channel_email = <span style=\"color:firebrick;\">'N'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> p_channel_event = <span style=\"color:firebrick;\">'N'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2000\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ030": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> results <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        s_state,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        customer_demographics,\n        date_dim,\n        store,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_cdemo_sk = cd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cd_gender = <span style=\"color:firebrick;\">'M'</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> cd_marital_status = <span style=\"color:firebrick;\">'S'</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> cd_education_status = <span style=\"color:firebrick;\">'College'</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2002\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_state = <span style=\"color:firebrick;\">'TN'</span>\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id, s_state, g_state, agg1, agg2, agg3, agg4\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        s_state,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> g_state,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg1) agg1,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg2) agg2,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg3) agg3,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg4) agg4\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_item_id,\n        s_state\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> s_state,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> g_state,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg1) agg1,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg2) agg2,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg3) agg3,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg4) agg4\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_item_id\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_item_id,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> s_state,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> g_state,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg1) agg1,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg2) agg2,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg3) agg3,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(agg4) agg4\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results) foo\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id,\n    s_state\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ031": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">avg</span>(ss_list_price) B1_LP,\n        <span style=\"color:black;font-weight:bold;\">count</span>(ss_list_price) B1_CNT,\n        <span style=\"color:black;font-weight:bold;\">count</span>(<span style=\"color:black;font-weight:bold;\">DISTINCT</span> ss_list_price) B1_CNTD\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 0 <span style=\"color:black;font-weight:bold;\">AND</span> 5\n        <span style=\"color:black;font-weight:bold;\">AND</span> (ss_list_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 8 <span style=\"color:black;font-weight:bold;\">AND</span> 8 + 10\n            <span style=\"color:black;font-weight:bold;\">OR</span> ss_coupon_amt <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 459 <span style=\"color:black;font-weight:bold;\">AND</span> 459 + 1000\n            <span style=\"color:black;font-weight:bold;\">OR</span> ss_wholesale_cost <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 57 <span style=\"color:black;font-weight:bold;\">AND</span> 57 + 20)) B1,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_list_price) B2_LP,\n            <span style=\"color:black;font-weight:bold;\">count</span>(ss_list_price) B2_CNT,\n            <span style=\"color:black;font-weight:bold;\">count</span>(<span style=\"color:black;font-weight:bold;\">DISTINCT</span> ss_list_price) B2_CNTD\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 6 <span style=\"color:black;font-weight:bold;\">AND</span> 10\n            <span style=\"color:black;font-weight:bold;\">AND</span> (ss_list_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 90 <span style=\"color:black;font-weight:bold;\">AND</span> 90 + 10\n                <span style=\"color:black;font-weight:bold;\">OR</span> ss_coupon_amt <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2323 <span style=\"color:black;font-weight:bold;\">AND</span> 2323 + 1000\n                <span style=\"color:black;font-weight:bold;\">OR</span> ss_wholesale_cost <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 31 <span style=\"color:black;font-weight:bold;\">AND</span> 31 + 20)) B2,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_list_price) B3_LP,\n            <span style=\"color:black;font-weight:bold;\">count</span>(ss_list_price) B3_CNT,\n            <span style=\"color:black;font-weight:bold;\">count</span>(<span style=\"color:black;font-weight:bold;\">DISTINCT</span> ss_list_price) B3_CNTD\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 11 <span style=\"color:black;font-weight:bold;\">AND</span> 15\n            <span style=\"color:black;font-weight:bold;\">AND</span> (ss_list_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 142 <span style=\"color:black;font-weight:bold;\">AND</span> 142 + 10\n                <span style=\"color:black;font-weight:bold;\">OR</span> ss_coupon_amt <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 12214 <span style=\"color:black;font-weight:bold;\">AND</span> 12214 + 1000\n                <span style=\"color:black;font-weight:bold;\">OR</span> ss_wholesale_cost <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 79 <span style=\"color:black;font-weight:bold;\">AND</span> 79 + 20)) B3,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_list_price) B4_LP,\n            <span style=\"color:black;font-weight:bold;\">count</span>(ss_list_price) B4_CNT,\n            <span style=\"color:black;font-weight:bold;\">count</span>(<span style=\"color:black;font-weight:bold;\">DISTINCT</span> ss_list_price) B4_CNTD\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 16 <span style=\"color:black;font-weight:bold;\">AND</span> 20\n            <span style=\"color:black;font-weight:bold;\">AND</span> (ss_list_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 135 <span style=\"color:black;font-weight:bold;\">AND</span> 135 + 10\n                <span style=\"color:black;font-weight:bold;\">OR</span> ss_coupon_amt <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 6071 <span style=\"color:black;font-weight:bold;\">AND</span> 6071 + 1000\n                <span style=\"color:black;font-weight:bold;\">OR</span> ss_wholesale_cost <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 38 <span style=\"color:black;font-weight:bold;\">AND</span> 38 + 20)) B4,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_list_price) B5_LP,\n            <span style=\"color:black;font-weight:bold;\">count</span>(ss_list_price) B5_CNT,\n            <span style=\"color:black;font-weight:bold;\">count</span>(<span style=\"color:black;font-weight:bold;\">DISTINCT</span> ss_list_price) B5_CNTD\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 21 <span style=\"color:black;font-weight:bold;\">AND</span> 25\n            <span style=\"color:black;font-weight:bold;\">AND</span> (ss_list_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 122 <span style=\"color:black;font-weight:bold;\">AND</span> 122 + 10\n                <span style=\"color:black;font-weight:bold;\">OR</span> ss_coupon_amt <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 836 <span style=\"color:black;font-weight:bold;\">AND</span> 836 + 1000\n                <span style=\"color:black;font-weight:bold;\">OR</span> ss_wholesale_cost <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 17 <span style=\"color:black;font-weight:bold;\">AND</span> 17 + 20)) B5,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_list_price) B6_LP,\n            <span style=\"color:black;font-weight:bold;\">count</span>(ss_list_price) B6_CNT,\n            <span style=\"color:black;font-weight:bold;\">count</span>(<span style=\"color:black;font-weight:bold;\">DISTINCT</span> ss_list_price) B6_CNTD\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_quantity <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 26 <span style=\"color:black;font-weight:bold;\">AND</span> 30\n            <span style=\"color:black;font-weight:bold;\">AND</span> (ss_list_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 154 <span style=\"color:black;font-weight:bold;\">AND</span> 154 + 10\n                <span style=\"color:black;font-weight:bold;\">OR</span> ss_coupon_amt <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 7326 <span style=\"color:black;font-weight:bold;\">AND</span> 7326 + 1000\n                <span style=\"color:black;font-weight:bold;\">OR</span> ss_wholesale_cost <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 7 <span style=\"color:black;font-weight:bold;\">AND</span> 7 + 20)) B6\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ032": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id,\n    i_item_desc,\n    s_store_id,\n    s_store_name,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> store_sales_quantity,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(sr_return_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> store_returns_quantity,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(cs_quantity) <span style=\"color:black;font-weight:bold;\">AS</span> catalog_sales_quantity\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    store_sales,\n    store_returns,\n    catalog_sales,\n    date_dim d1,\n    date_dim d2,\n    date_dim d3,\n    store,\n    item\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d1.d_moy = 9\n    <span style=\"color:black;font-weight:bold;\">AND</span> d1.d_year = 1999\n    <span style=\"color:black;font-weight:bold;\">AND</span> d1.d_date_sk = ss_sold_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_item_sk = ss_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> s_store_sk = ss_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_customer_sk = sr_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = sr_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_ticket_number = sr_ticket_number\n    <span style=\"color:black;font-weight:bold;\">AND</span> sr_returned_date_sk = d2.d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d2.d_moy <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 9 <span style=\"color:black;font-weight:bold;\">AND</span> 9 + 3\n    <span style=\"color:black;font-weight:bold;\">AND</span> d2.d_year = 1999\n    <span style=\"color:black;font-weight:bold;\">AND</span> sr_customer_sk = cs_bill_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> sr_item_sk = cs_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d3.d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d3.d_year <span style=\"color:black;font-weight:bold;\">IN</span> (1999, 1999 + 1, 1999 + 2)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id,\n    i_item_desc,\n    s_store_id,\n    s_store_name\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id,\n    i_item_desc,\n    s_store_id,\n    s_store_name\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ033": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> customer_total_return <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        wr_returning_customer_sk <span style=\"color:black;font-weight:bold;\">AS</span> ctr_customer_sk,\n        ca_state <span style=\"color:black;font-weight:bold;\">AS</span> ctr_state,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(wr_return_amt) <span style=\"color:black;font-weight:bold;\">AS</span> ctr_total_return\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_returns,\n        date_dim,\n        customer_address\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        wr_returned_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2002\n        <span style=\"color:black;font-weight:bold;\">AND</span> wr_returning_addr_sk = ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        wr_returning_customer_sk,\n        ca_state\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_customer_id,\n    c_salutation,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_day,\n    c_birth_month,\n    c_birth_year,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    c_last_review_date_sk,\n    ctr_total_return\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    customer_total_return ctr1,\n    customer_address,\n    customer\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ctr1.ctr_total_return > (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ctr_total_return) * 1.2\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            customer_total_return ctr2\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ctr1.ctr_state = ctr2.ctr_state)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ca_address_sk = c_current_addr_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ca_state = <span style=\"color:firebrick;\">'GA'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ctr1.ctr_customer_sk = c_customer_sk\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_customer_id,\n    c_salutation,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_day,\n    c_birth_month,\n    c_birth_year,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    c_last_review_date_sk,\n    ctr_total_return\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ034": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> ss <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        ca_county,\n        d_qoy,\n        d_year,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> store_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        customer_address\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_addr_sk = ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        ca_county,\n        d_qoy,\n        d_year\n),\nws <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        ca_county,\n        d_qoy,\n        d_year,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> web_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales,\n        date_dim,\n        customer_address\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ws_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_bill_addr_sk = ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        ca_county,\n        d_qoy,\n        d_year\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    ss1.ca_county,\n    ss1.d_year,\n    (ws2.web_sales * 1.0000) / ws1.web_sales web_q1_q2_increase,\n    (ss2.store_sales * 1.0000) / ss1.store_sales store_q1_q2_increase,\n    (ws3.web_sales * 1.0000) / ws2.web_sales web_q2_q3_increase,\n    (ss3.store_sales * 1.0000) / ss2.store_sales store_q2_q3_increase\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    ss ss1,\n    ss ss2,\n    ss ss3,\n    ws ws1,\n    ws ws2,\n    ws ws3\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ss1.d_qoy = 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss1.d_year = 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss1.ca_county = ss2.ca_county\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss2.d_qoy = 2\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss2.d_year = 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss2.ca_county = ss3.ca_county\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss3.d_qoy = 3\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss3.d_year = 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss1.ca_county = ws1.ca_county\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws1.d_qoy = 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws1.d_year = 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws1.ca_county = ws2.ca_county\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws2.d_qoy = 2\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws2.d_year = 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws1.ca_county = ws3.ca_county\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws3.d_qoy = 3\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws3.d_year = 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> ws1.web_sales > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n    (ws2.web_sales * 1.0000) / ws1.web_sales\n<span style=\"color:black;font-weight:bold;\">ELSE</span>\n    <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span> > <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> ss1.store_sales > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n    (ss2.store_sales * 1.0000) / ss1.store_sales\n<span style=\"color:black;font-weight:bold;\">ELSE</span>\n    <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> ws2.web_sales > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n    (ws3.web_sales * 1.0000) / ws2.web_sales\n<span style=\"color:black;font-weight:bold;\">ELSE</span>\n    <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span> > <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> ss2.store_sales > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n    (ss3.store_sales * 1.0000) / ss2.store_sales\n<span style=\"color:black;font-weight:bold;\">ELSE</span>\n    <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span>\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ss1.ca_county;\n\n</pre>\n\t\t", "DSQ035": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(cs_ext_discount_amt) <span style=\"color:black;font-weight:bold;\">AS</span> \"excess discount amount\"\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    catalog_sales,\n    item,\n    date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    i_manufact_id = 977\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_item_sk = cs_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:firebrick;\">'2000-01-27'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-04-26'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date_sk = cs_sold_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_ext_discount_amt > (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            1.3 * <span style=\"color:black;font-weight:bold;\">avg</span>(cs_ext_discount_amt)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            catalog_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            cs_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:firebrick;\">'2000-01-27'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-04-26'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_date_sk = cs_sold_date_sk)\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ036": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> ss <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_manufact_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) total_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        customer_address,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        i_manufact_id <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                i_manufact_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                item\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                i_category <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Electronics'</span>))\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1998\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 5\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_gmt_offset = - 5\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            i_manufact_id\n),\ncs <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_manufact_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_ext_sales_price) total_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales,\n        date_dim,\n        customer_address,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        i_manufact_id <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                i_manufact_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                item\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                i_category <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Electronics'</span>))\n            <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1998\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 5\n            <span style=\"color:black;font-weight:bold;\">AND</span> cs_bill_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_gmt_offset = - 5\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            i_manufact_id\n),\nws <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_manufact_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_sales_price) total_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales,\n        date_dim,\n        customer_address,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        i_manufact_id <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                i_manufact_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                item\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                i_category <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Electronics'</span>))\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1998\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 5\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_bill_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_gmt_offset = - 5\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            i_manufact_id\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_manufact_id,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(total_sales) total_sales\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        *\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        ss\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        *\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        cs\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        *\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        ws) tmp1\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_manufact_id\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    total_sales\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ037": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_last_name,\n    c_first_name,\n    c_salutation,\n    c_preferred_cust_flag,\n    ss_ticket_number,\n    cnt\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        ss_ticket_number,\n        ss_customer_sk,\n        <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        store,\n        household_demographics\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        store_sales.ss_sold_date_sk = date_dim.d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_store_sk = store.s_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> (date_dim.d_dom <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1 <span style=\"color:black;font-weight:bold;\">AND</span> 3\n            <span style=\"color:black;font-weight:bold;\">OR</span> date_dim.d_dom <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 25 <span style=\"color:black;font-weight:bold;\">AND</span> 28)\n        <span style=\"color:black;font-weight:bold;\">AND</span> (household_demographics.hd_buy_potential = <span style=\"color:firebrick;\">'>10000'</span>\n            <span style=\"color:black;font-weight:bold;\">OR</span> household_demographics.hd_buy_potential = <span style=\"color:firebrick;\">'Unknown'</span>)\n        <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count > 0\n        <span style=\"color:black;font-weight:bold;\">AND</span> (\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> household_demographics.hd_vehicle_count > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) > 1.2\n        <span style=\"color:black;font-weight:bold;\">AND</span> date_dim.d_year <span style=\"color:black;font-weight:bold;\">IN</span> (1999, 1999 + 1, 1999 + 2)\n        <span style=\"color:black;font-weight:bold;\">AND</span> store.s_county = <span style=\"color:firebrick;\">'Williamson County'</span>\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        ss_ticket_number,\n        ss_customer_sk) dn,\n    customer\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ss_customer_sk = c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cnt <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 15 <span style=\"color:black;font-weight:bold;\">AND</span> 20\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_last_name,\n    c_first_name,\n    c_salutation,\n    c_preferred_cust_flag <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    ss_ticket_number;\n\n</pre>\n\t\t", "DSQ038": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    ca_state,\n    cd_gender,\n    cd_marital_status,\n    cd_dep_count,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt1,\n    min(cd_dep_count),\n    max(cd_dep_count),\n    <span style=\"color:black;font-weight:bold;\">avg</span>(cd_dep_count),\n    cd_dep_employed_count,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt2,\n    min(cd_dep_employed_count),\n    max(cd_dep_employed_count),\n    <span style=\"color:black;font-weight:bold;\">avg</span>(cd_dep_employed_count),\n    cd_dep_college_count,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt3,\n    min(cd_dep_college_count),\n    max(cd_dep_college_count),\n    <span style=\"color:black;font-weight:bold;\">avg</span>(cd_dep_college_count)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    customer c,\n    customer_address ca,\n    customer_demographics\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    c.c_current_addr_sk = ca.ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd_demo_sk = c.c_current_cdemo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            *\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            c.c_customer_sk = ss_customer_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2002\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_qoy < 4)\n    <span style=\"color:black;font-weight:bold;\">AND</span> (<span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                *\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                web_sales,\n                date_dim\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                c.c_customer_sk = ws_bill_customer_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2002\n                <span style=\"color:black;font-weight:bold;\">AND</span> d_qoy < 4)\n            <span style=\"color:black;font-weight:bold;\">OR</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n                <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                    *\n                <span style=\"color:black;font-weight:bold;\">FROM</span>\n                    catalog_sales,\n                    date_dim\n                <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                    c.c_customer_sk = cs_ship_customer_sk\n                    <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n                    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2002\n                    <span style=\"color:black;font-weight:bold;\">AND</span> d_qoy < 4))\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        ca_state,\n        cd_gender,\n        cd_marital_status,\n        cd_dep_count,\n        cd_dep_employed_count,\n        cd_dep_college_count\n    <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        ca_state,\n        cd_gender,\n        cd_marital_status,\n        cd_dep_count,\n        cd_dep_employed_count,\n        cd_dep_college_count\n    <span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ039": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> results <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_profit) <span style=\"color:black;font-weight:bold;\">AS</span> ss_net_profit,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> ss_ext_sales_price,\n        (<span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_profit) * 1.0000) / <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> gross_margin,\n        i_category,\n        i_class,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> g_category,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> g_class\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim d1,\n        item,\n        store\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        d1.d_year = 2001\n        <span style=\"color:black;font-weight:bold;\">AND</span> d1.d_date_sk = ss_sold_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> i_item_sk = ss_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_store_sk = ss_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_state = <span style=\"color:firebrick;\">'TN'</span>\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_category,\n        i_class\n),\nresults_rollup <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        gross_margin,\n        i_category,\n        i_class,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> t_category,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> t_class,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> lochierarchy\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        (<span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_profit) * 1.0000) / <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> gross_margin,\n        i_category,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_class,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> t_category,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> t_class,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> lochierarchy\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_category\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        (<span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_profit) * 1.0000) / <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> gross_margin,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_category,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_class,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> t_category,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> t_class,\n        2 <span style=\"color:black;font-weight:bold;\">AS</span> lochierarchy\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    gross_margin,\n    i_category,\n    i_class,\n    lochierarchy,\n    rank() OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> lochierarchy, <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> t_class = 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n            i_category\n        <span style=\"color:black;font-weight:bold;\">END</span> <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> gross_margin <span style=\"color:black;font-weight:bold;\">ASC</span>) <span style=\"color:black;font-weight:bold;\">AS</span> rank_within_parent\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results_rollup\n    <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        lochierarchy <span style=\"color:black;font-weight:bold;\">DESC</span>,\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> lochierarchy = 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n            i_category\n        <span style=\"color:black;font-weight:bold;\">END</span>,\n        rank_within_parent\n    <span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ040": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id,\n    i_item_desc,\n    i_current_price\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    item,\n    inventory,\n    date_dim,\n    catalog_sales\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    i_current_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 68 <span style=\"color:black;font-weight:bold;\">AND</span> 68 + 30\n    <span style=\"color:black;font-weight:bold;\">AND</span> inv_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date_sk = inv_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-02-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-04-01'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_manufact_id <span style=\"color:black;font-weight:bold;\">IN</span> (677,\n        940,\n        694,\n        808)\n    <span style=\"color:black;font-weight:bold;\">AND</span> inv_quantity_on_hand <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 100 <span style=\"color:black;font-weight:bold;\">AND</span> 500\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = i_item_sk\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id,\n    i_item_desc,\n    i_current_price\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ041": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">count</span>(*)\n<span style=\"color:black;font-weight:bold;\">FROM</span> ( <span style=\"color:black;font-weight:bold;\">SELECT</span> <span style=\"color:black;font-weight:bold;\">DISTINCT</span>\n        c_last_name,\n        c_first_name,\n        d_date\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        customer\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        store_sales.ss_sold_date_sk = date_dim.d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_customer_sk = customer.c_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11\n    <span style=\"color:black;font-weight:bold;\">INTERSECT</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span> <span style=\"color:black;font-weight:bold;\">DISTINCT</span>\n        c_last_name,\n        c_first_name,\n        d_date\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales,\n        date_dim,\n        customer\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11\n    <span style=\"color:black;font-weight:bold;\">INTERSECT</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span> <span style=\"color:black;font-weight:bold;\">DISTINCT</span>\n        c_last_name,\n        c_first_name,\n        d_date\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales,\n        date_dim,\n        customer\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        web_sales.ws_sold_date_sk = date_dim.d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> web_sales.ws_bill_customer_sk = customer.c_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11) hot_cust\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ042": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> inv <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        w_warehouse_name,\n        w_warehouse_sk,\n        i_item_sk,\n        d_moy,\n        stdev,\n        mean,\n        <span style=\"color:black;font-weight:bold;\">CASE</span> mean\n        <span style=\"color:black;font-weight:bold;\">WHEN</span> 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n            <span style=\"color:black;font-weight:bold;\">NULL</span>\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            stdev / mean\n        <span style=\"color:black;font-weight:bold;\">END</span> cov\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            w_warehouse_name,\n            w_warehouse_sk,\n            i_item_sk,\n            d_moy,\n            stddev_samp(inv_quantity_on_hand) stdev,\n            <span style=\"color:black;font-weight:bold;\">avg</span>(inv_quantity_on_hand) mean\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            inventory,\n            item,\n            warehouse,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            inv_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> inv_warehouse_sk = w_warehouse_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> inv_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            w_warehouse_name,\n            w_warehouse_sk,\n            i_item_sk,\n            d_moy) foo\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        <span style=\"color:black;font-weight:bold;\">CASE</span> mean\n        <span style=\"color:black;font-weight:bold;\">WHEN</span> 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            stdev / mean\n        <span style=\"color:black;font-weight:bold;\">END</span> > 1\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    inv inv1,\n    inv inv2\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    inv1.i_item_sk = inv2.i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> inv1.w_warehouse_sk = inv2.w_warehouse_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> inv1.d_moy = 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> inv2.d_moy = 1 + 1\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    inv1.w_warehouse_sk,\n    inv1.i_item_sk,\n    inv1.d_moy,\n    inv1.mean,\n    inv1.cov,\n    inv2.d_moy,\n    inv2.mean,\n    inv2.cov;\n\n</pre>\n\t\t", "DSQ043": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> inv <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        w_warehouse_name,\n        w_warehouse_sk,\n        i_item_sk,\n        d_moy,\n        stdev,\n        mean,\n        <span style=\"color:black;font-weight:bold;\">CASE</span> mean\n        <span style=\"color:black;font-weight:bold;\">WHEN</span> 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n            <span style=\"color:black;font-weight:bold;\">NULL</span>\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            stdev / mean\n        <span style=\"color:black;font-weight:bold;\">END</span> cov\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            w_warehouse_name,\n            w_warehouse_sk,\n            i_item_sk,\n            d_moy,\n            stddev_samp(inv_quantity_on_hand) stdev,\n            <span style=\"color:black;font-weight:bold;\">avg</span>(inv_quantity_on_hand) mean\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            inventory,\n            item,\n            warehouse,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            inv_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> inv_warehouse_sk = w_warehouse_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> inv_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            w_warehouse_name,\n            w_warehouse_sk,\n            i_item_sk,\n            d_moy) foo\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        <span style=\"color:black;font-weight:bold;\">CASE</span> mean\n        <span style=\"color:black;font-weight:bold;\">WHEN</span> 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            stdev / mean\n        <span style=\"color:black;font-weight:bold;\">END</span> > 1\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    inv inv1,\n    inv inv2\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    inv1.i_item_sk = inv2.i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> inv1.w_warehouse_sk = inv2.w_warehouse_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> inv1.d_moy = 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> inv2.d_moy = 1 + 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> inv1.cov > 1.5\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    inv1.w_warehouse_sk,\n    inv1.i_item_sk,\n    inv1.d_moy,\n    inv1.mean,\n    inv1.cov,\n    inv2.d_moy,\n    inv2.mean,\n    inv2.cov;\n\n</pre>\n\t\t", "DSQ044": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    w_state,\n    i_item_id,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (<span style=\"color:black;font-weight:bold;\">cast</span>(d_date <span style=\"color:black;font-weight:bold;\">AS</span> date) < CAST(<span style=\"color:firebrick;\">'2000-03-11'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            cs_sales_price - coalesce(cr_refunded_cash, 0)\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> sales_before,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (<span style=\"color:black;font-weight:bold;\">cast</span>(d_date <span style=\"color:black;font-weight:bold;\">AS</span> date) >= CAST(<span style=\"color:firebrick;\">'2000-03-11'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            cs_sales_price - coalesce(cr_refunded_cash, 0)\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> sales_after\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    catalog_sales\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> catalog_returns <span style=\"color:black;font-weight:bold;\">ON</span> (cs_order_number = cr_order_number\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = cr_item_sk),\n    warehouse,\n    item,\n    date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    i_current_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 0.99\n    <span style=\"color:black;font-weight:bold;\">AND</span> 1.49\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_item_sk = cs_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_warehouse_sk = w_warehouse_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> CAST(<span style=\"color:firebrick;\">'2000-02-10'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> CAST(<span style=\"color:firebrick;\">'2000-04-10'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    w_state,\n    i_item_id\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    w_state,\n    i_item_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ045": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span> <span style=\"color:black;font-weight:bold;\">DISTINCT</span>\n    (i_product_name)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    item i1\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    i_manufact_id <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 738 <span style=\"color:black;font-weight:bold;\">AND</span> 738 + 40\n    <span style=\"color:black;font-weight:bold;\">AND</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*) <span style=\"color:black;font-weight:bold;\">AS</span> item_cnt\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            item\n        <span style=\"color:black;font-weight:bold;\">WHERE</span> (i_manufact = i1.i_manufact\n            <span style=\"color:black;font-weight:bold;\">AND</span> ((i_category = <span style=\"color:firebrick;\">'Women'</span>\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_color = <span style=\"color:firebrick;\">'powder'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_color = <span style=\"color:firebrick;\">'khaki'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_units = <span style=\"color:firebrick;\">'Ounce'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_units = <span style=\"color:firebrick;\">'Oz'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_size = <span style=\"color:firebrick;\">'medium'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_size = <span style=\"color:firebrick;\">'extra large'</span>))\n                <span style=\"color:black;font-weight:bold;\">OR</span> (i_category = <span style=\"color:firebrick;\">'Women'</span>\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_color = <span style=\"color:firebrick;\">'brown'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_color = <span style=\"color:firebrick;\">'honeydew'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_units = <span style=\"color:firebrick;\">'Bunch'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_units = <span style=\"color:firebrick;\">'Ton'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_size = <span style=\"color:firebrick;\">'N/A'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_size = <span style=\"color:firebrick;\">'small'</span>))\n                <span style=\"color:black;font-weight:bold;\">OR</span> (i_category = <span style=\"color:firebrick;\">'Men'</span>\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_color = <span style=\"color:firebrick;\">'floral'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_color = <span style=\"color:firebrick;\">'deep'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_units = <span style=\"color:firebrick;\">'N/A'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_units = <span style=\"color:firebrick;\">'Dozen'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_size = <span style=\"color:firebrick;\">'petite'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_size = <span style=\"color:firebrick;\">'petite'</span>))\n                <span style=\"color:black;font-weight:bold;\">OR</span> (i_category = <span style=\"color:firebrick;\">'Men'</span>\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_color = <span style=\"color:firebrick;\">'light'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_color = <span style=\"color:firebrick;\">'cornflower'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_units = <span style=\"color:firebrick;\">'Box'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_units = <span style=\"color:firebrick;\">'Pound'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_size = <span style=\"color:firebrick;\">'medium'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_size = <span style=\"color:firebrick;\">'extra large'</span>))))\n        <span style=\"color:black;font-weight:bold;\">OR</span> (i_manufact = i1.i_manufact\n            <span style=\"color:black;font-weight:bold;\">AND</span> ((i_category = <span style=\"color:firebrick;\">'Women'</span>\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_color = <span style=\"color:firebrick;\">'midnight'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_color = <span style=\"color:firebrick;\">'snow'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_units = <span style=\"color:firebrick;\">'Pallet'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_units = <span style=\"color:firebrick;\">'Gross'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_size = <span style=\"color:firebrick;\">'medium'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_size = <span style=\"color:firebrick;\">'extra large'</span>))\n                <span style=\"color:black;font-weight:bold;\">OR</span> (i_category = <span style=\"color:firebrick;\">'Women'</span>\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_color = <span style=\"color:firebrick;\">'cyan'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_color = <span style=\"color:firebrick;\">'papaya'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_units = <span style=\"color:firebrick;\">'Cup'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_units = <span style=\"color:firebrick;\">'Dram'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_size = <span style=\"color:firebrick;\">'N/A'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_size = <span style=\"color:firebrick;\">'small'</span>))\n                <span style=\"color:black;font-weight:bold;\">OR</span> (i_category = <span style=\"color:firebrick;\">'Men'</span>\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_color = <span style=\"color:firebrick;\">'orange'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_color = <span style=\"color:firebrick;\">'frosted'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_units = <span style=\"color:firebrick;\">'Each'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_units = <span style=\"color:firebrick;\">'Tbl'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_size = <span style=\"color:firebrick;\">'petite'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_size = <span style=\"color:firebrick;\">'petite'</span>))\n                <span style=\"color:black;font-weight:bold;\">OR</span> (i_category = <span style=\"color:firebrick;\">'Men'</span>\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_color = <span style=\"color:firebrick;\">'forest'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_color = <span style=\"color:firebrick;\">'ghost'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_units = <span style=\"color:firebrick;\">'Lb'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_units = <span style=\"color:firebrick;\">'Bundle'</span>)\n                    <span style=\"color:black;font-weight:bold;\">AND</span> (i_size = <span style=\"color:firebrick;\">'medium'</span>\n                        <span style=\"color:black;font-weight:bold;\">OR</span> i_size = <span style=\"color:firebrick;\">'extra large'</span>))))) > 0\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_product_name\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ046": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    dt.d_year,\n    item.i_category_id,\n    item.i_category,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    date_dim dt,\n    store_sales,\n    item\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    dt.d_date_sk = store_sales.ss_sold_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_item_sk = item.i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> item.i_manager_id = 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> dt.d_moy = 11\n    <span style=\"color:black;font-weight:bold;\">AND</span> dt.d_year = 2000\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    dt.d_year,\n    item.i_category_id,\n    item.i_category\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price)\n    <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    dt.d_year,\n    item.i_category_id,\n    item.i_category\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ047": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    s_store_name,\n    s_store_id,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Sunday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            ss_sales_price\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            <span style=\"color:black;font-weight:bold;\">NULL</span>\n        <span style=\"color:black;font-weight:bold;\">END</span>) sun_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Monday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            ss_sales_price\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            <span style=\"color:black;font-weight:bold;\">NULL</span>\n        <span style=\"color:black;font-weight:bold;\">END</span>) mon_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Tuesday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            ss_sales_price\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            <span style=\"color:black;font-weight:bold;\">NULL</span>\n        <span style=\"color:black;font-weight:bold;\">END</span>) tue_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Wednesday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            ss_sales_price\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            <span style=\"color:black;font-weight:bold;\">NULL</span>\n        <span style=\"color:black;font-weight:bold;\">END</span>) wed_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Thursday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            ss_sales_price\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            <span style=\"color:black;font-weight:bold;\">NULL</span>\n        <span style=\"color:black;font-weight:bold;\">END</span>) thu_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Friday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            ss_sales_price\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            <span style=\"color:black;font-weight:bold;\">NULL</span>\n        <span style=\"color:black;font-weight:bold;\">END</span>) fri_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Saturday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            ss_sales_price\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            <span style=\"color:black;font-weight:bold;\">NULL</span>\n        <span style=\"color:black;font-weight:bold;\">END</span>) sat_sales\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    date_dim,\n    store_sales,\n    store\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d_date_sk = ss_sold_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> s_store_sk = ss_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> s_gmt_offset = - 5\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2000\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    s_store_name,\n    s_store_id\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    s_store_name,\n    s_store_id,\n    sun_sales,\n    mon_sales,\n    tue_sales,\n    wed_sales,\n    thu_sales,\n    fri_sales,\n    sat_sales\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ048": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    asceding.rnk,\n    i1.i_product_name best_performing,\n    i2.i_product_name worst_performing\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        *\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            item_sk,\n            rank() OVER (<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> rank_col <span style=\"color:black;font-weight:bold;\">ASC</span>) rnk\n        <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ss_item_sk item_sk,\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ss_net_profit) rank_col\n        <span style=\"color:black;font-weight:bold;\">FROM</span> store_sales ss1\n    <span style=\"color:black;font-weight:bold;\">WHERE</span> ss_store_sk = 4\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ss_item_sk\n<span style=\"color:black;font-weight:bold;\">HAVING</span> <span style=\"color:black;font-weight:bold;\">avg</span>(ss_net_profit) > 0.9 * (\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">avg</span>(ss_net_profit) rank_col\n<span style=\"color:black;font-weight:bold;\">FROM</span> store_sales\n<span style=\"color:black;font-weight:bold;\">WHERE</span> ss_store_sk = 4\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_addr_sk IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ss_store_sk)) V1) V11\n<span style=\"color:black;font-weight:bold;\">WHERE</span> rnk < 11) asceding,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            *\n        <span style=\"color:black;font-weight:bold;\">FROM</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                item_sk,\n                rank() OVER (<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> rank_col <span style=\"color:black;font-weight:bold;\">DESC</span>) rnk\n            <span style=\"color:black;font-weight:bold;\">FROM</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                ss_item_sk item_sk,\n                <span style=\"color:black;font-weight:bold;\">avg</span>(ss_net_profit) rank_col\n            <span style=\"color:black;font-weight:bold;\">FROM</span> store_sales ss1\n        <span style=\"color:black;font-weight:bold;\">WHERE</span> ss_store_sk = 4\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        ss_item_sk\n    <span style=\"color:black;font-weight:bold;\">HAVING</span> <span style=\"color:black;font-weight:bold;\">avg</span>(ss_net_profit) > 0.9 * (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">avg</span>(ss_net_profit) rank_col\n    <span style=\"color:black;font-weight:bold;\">FROM</span> store_sales\n<span style=\"color:black;font-weight:bold;\">WHERE</span> ss_store_sk = 4\n<span style=\"color:black;font-weight:bold;\">AND</span> ss_addr_sk IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ss_store_sk)) V2) V21\n<span style=\"color:black;font-weight:bold;\">WHERE</span> rnk < 11) descending,\n    item i1,\n    item i2\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    asceding.rnk = descending.rnk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i1.i_item_sk = asceding.item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i2.i_item_sk = descending.item_sk\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    asceding.rnk\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ049": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    ca_zip,\n    ca_city,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ws_sales_price)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    web_sales,\n    customer,\n    customer_address,\n    date_dim,\n    item\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ws_bill_customer_sk = c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> c_current_addr_sk = ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> (<span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(ca_zip, 1, 5)\n        <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'85669'</span>, <span style=\"color:firebrick;\">'86197'</span>, <span style=\"color:firebrick;\">'88274'</span>, <span style=\"color:firebrick;\">'83405'</span>, <span style=\"color:firebrick;\">'86475'</span>, <span style=\"color:firebrick;\">'85392'</span>, <span style=\"color:firebrick;\">'85460'</span>, <span style=\"color:firebrick;\">'80348'</span>, <span style=\"color:firebrick;\">'81792'</span>)\n        <span style=\"color:black;font-weight:bold;\">OR</span> i_item_id <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                i_item_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                item\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                i_item_sk <span style=\"color:black;font-weight:bold;\">IN</span> (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)))\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_qoy = 2\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ca_zip,\n    ca_city\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ca_zip,\n    ca_city\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ050": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_last_name,\n    c_first_name,\n    ca_city,\n    bought_city,\n    ss_ticket_number,\n    amt,\n    profit\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        ss_ticket_number,\n        ss_customer_sk,\n        ca_city bought_city,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_coupon_amt) amt,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_profit) profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        store,\n        household_demographics,\n        customer_address\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        store_sales.ss_sold_date_sk = date_dim.d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_store_sk = store.s_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_addr_sk = customer_address.ca_address_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> (household_demographics.hd_dep_count = 4\n            <span style=\"color:black;font-weight:bold;\">OR</span> household_demographics.hd_vehicle_count = 3)\n        <span style=\"color:black;font-weight:bold;\">AND</span> date_dim.d_dow <span style=\"color:black;font-weight:bold;\">IN</span> (6, 0)\n        <span style=\"color:black;font-weight:bold;\">AND</span> date_dim.d_year <span style=\"color:black;font-weight:bold;\">IN</span> (1999, 1999 + 1, 1999 + 2)\n        <span style=\"color:black;font-weight:bold;\">AND</span> store.s_city <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Fairview'</span>, <span style=\"color:firebrick;\">'Midway'</span>)\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        ss_ticket_number,\n        ss_customer_sk,\n        ss_addr_sk,\n        ca_city) dn,\n    customer,\n    customer_address current_addr\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ss_customer_sk = c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> customer.c_current_addr_sk = current_addr.ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> current_addr.ca_city <> bought_city\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_last_name,\n    c_first_name,\n    ca_city,\n    bought_city,\n    ss_ticket_number\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ051": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> v1 <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_category,\n        i_brand,\n        s_store_name,\n        s_company_name,\n        d_year,\n        d_moy,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_sales_price) sum_sales,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(ss_sales_price)) OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> i_category,\n            i_brand,\n            s_store_name,\n            s_company_name,\n            d_year) avg_monthly_sales,\n        rank() OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> i_category,\n            i_brand,\n            s_store_name,\n            s_company_name <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> d_year,\n            d_moy) rn\n    <span style=\"color:black;font-weight:bold;\">FROM</span> item,\n    store_sales,\n    date_dim,\n    store\n<span style=\"color:black;font-weight:bold;\">WHERE</span> ss_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> (d_year = 1999\n    <span style=\"color:black;font-weight:bold;\">OR</span> (d_year = 1999 - 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 12)\n    <span style=\"color:black;font-weight:bold;\">OR</span> (d_year = 1999 + 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 1))\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_category,\n    i_brand,\n    s_store_name,\n    s_company_name,\n    d_year,\n    d_moy\n),\nv2 <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        v1.i_category,\n        v1.i_brand,\n        v1.s_store_name,\n        v1.s_company_name,\n        v1.d_year,\n        v1.d_moy,\n        v1.avg_monthly_sales,\n        v1.sum_sales,\n        v1_lag.sum_sales psum,\n        v1_lead.sum_sales nsum\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        v1,\n        v1 v1_lag,\n        v1 v1_lead\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        v1.i_category = v1_lag.i_category\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.i_category = v1_lead.i_category\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.i_brand = v1_lag.i_brand\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.i_brand = v1_lead.i_brand\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.s_store_name = v1_lag.s_store_name\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.s_store_name = v1_lead.s_store_name\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.s_company_name = v1_lag.s_company_name\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.s_company_name = v1_lead.s_company_name\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.rn = v1_lag.rn + 1\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.rn = v1_lead.rn - 1\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    v2\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d_year = 1999\n    <span style=\"color:black;font-weight:bold;\">AND</span> avg_monthly_sales > 0\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> avg_monthly_sales > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n        abs(sum_sales - avg_monthly_sales) / avg_monthly_sales\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span> > 0.1\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    sum_sales - avg_monthly_sales\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ052": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">SUM</span>(ss_quantity)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    store_sales,\n    store,\n    customer_demographics,\n    customer_address,\n    date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s_store_sk = ss_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> ((cd_demo_sk = ss_cdemo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_marital_status = <span style=\"color:firebrick;\">'M'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_education_status = <span style=\"color:firebrick;\">'4 yr Degree'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sales_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 100.00\n            <span style=\"color:black;font-weight:bold;\">AND</span> 150.00)\n        <span style=\"color:black;font-weight:bold;\">OR</span> (cd_demo_sk = ss_cdemo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_marital_status = <span style=\"color:firebrick;\">'D'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_education_status = <span style=\"color:firebrick;\">'2 yr Degree'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sales_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 50.00\n            <span style=\"color:black;font-weight:bold;\">AND</span> 100.00)\n        <span style=\"color:black;font-weight:bold;\">OR</span> (cd_demo_sk = ss_cdemo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_marital_status = <span style=\"color:firebrick;\">'S'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_education_status = <span style=\"color:firebrick;\">'College'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sales_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 150.00\n            <span style=\"color:black;font-weight:bold;\">AND</span> 200.00))\n    <span style=\"color:black;font-weight:bold;\">AND</span> ((ss_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_country = <span style=\"color:firebrick;\">'United States'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_state <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'CO'</span>,\n                <span style=\"color:firebrick;\">'OH'</span>,\n                <span style=\"color:firebrick;\">'TX'</span>)\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_net_profit <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 0 <span style=\"color:black;font-weight:bold;\">AND</span> 2000)\n        <span style=\"color:black;font-weight:bold;\">OR</span> (ss_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_country = <span style=\"color:firebrick;\">'United States'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_state <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'OR'</span>,\n                <span style=\"color:firebrick;\">'MN'</span>,\n                <span style=\"color:firebrick;\">'KY'</span>)\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_net_profit <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 150 <span style=\"color:black;font-weight:bold;\">AND</span> 3000)\n        <span style=\"color:black;font-weight:bold;\">OR</span> (ss_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_country = <span style=\"color:firebrick;\">'United States'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_state <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'VA'</span>,\n                <span style=\"color:firebrick;\">'CA'</span>,\n                <span style=\"color:firebrick;\">'MS'</span>)\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_net_profit <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 50 <span style=\"color:black;font-weight:bold;\">AND</span> 25000));\n\n</pre>\n\t\t", "DSQ053": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    channel,\n    item,\n    return_ratio,\n    return_rank,\n    currency_rank\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:firebrick;\">'web'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n        web.item,\n        web.return_ratio,\n        web.return_rank,\n        web.currency_rank\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            item,\n            return_ratio,\n            currency_ratio,\n            rank() OVER (<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> return_ratio) <span style=\"color:black;font-weight:bold;\">AS</span> return_rank,\n            rank() OVER (<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> currency_ratio) <span style=\"color:black;font-weight:bold;\">AS</span> currency_rank\n        <span style=\"color:black;font-weight:bold;\">FROM</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                ws.ws_item_sk <span style=\"color:black;font-weight:bold;\">AS</span> item,\n                (<span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(wr.wr_return_quantity, 0)) <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4)) / <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(ws.ws_quantity, 0)) <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4))) <span style=\"color:black;font-weight:bold;\">AS</span> return_ratio,\n                (<span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(wr.wr_return_amt, 0)) <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4)) / <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(ws.ws_net_paid, 0)) <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4))) <span style=\"color:black;font-weight:bold;\">AS</span> currency_ratio\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                web_sales ws\n            <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> web_returns wr <span style=\"color:black;font-weight:bold;\">ON</span> (ws.ws_order_number = wr.wr_order_number\n                <span style=\"color:black;font-weight:bold;\">AND</span> ws.ws_item_sk = wr.wr_item_sk),\n            date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        wr.wr_return_amt > 10000\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws.ws_net_profit > 1\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws.ws_net_paid > 0\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws.ws_quantity > 0\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 12\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        ws.ws_item_sk) in_web) web\n<span style=\"color:black;font-weight:bold;\">WHERE</span> (web.return_rank <= 10\n    <span style=\"color:black;font-weight:bold;\">OR</span> web.currency_rank <= 10)\n<span style=\"color:black;font-weight:bold;\">UNION</span>\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:firebrick;\">'catalog'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n    catalog.item,\n    catalog.return_ratio,\n    catalog.return_rank,\n    catalog.currency_rank\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        item,\n        return_ratio,\n        currency_ratio,\n        rank() OVER (<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> return_ratio) <span style=\"color:black;font-weight:bold;\">AS</span> return_rank,\n        rank() OVER (<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> currency_ratio) <span style=\"color:black;font-weight:bold;\">AS</span> currency_rank\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            cs.cs_item_sk <span style=\"color:black;font-weight:bold;\">AS</span> item,\n            (<span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(cr.cr_return_quantity, 0)) <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4)) / <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(cs.cs_quantity, 0)) <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4))) <span style=\"color:black;font-weight:bold;\">AS</span> return_ratio,\n            (<span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(cr.cr_return_amount, 0)) <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4)) / <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(cs.cs_net_paid, 0)) <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4))) <span style=\"color:black;font-weight:bold;\">AS</span> currency_ratio\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            catalog_sales cs\n        <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> catalog_returns cr <span style=\"color:black;font-weight:bold;\">ON</span> (cs.cs_order_number = cr.cr_order_number\n            <span style=\"color:black;font-weight:bold;\">AND</span> cs.cs_item_sk = cr.cr_item_sk),\n        date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cr.cr_return_amount > 10000\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs.cs_net_profit > 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs.cs_net_paid > 0\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs.cs_quantity > 0\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 12\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    cs.cs_item_sk) in_cat) CATALOG\n<span style=\"color:black;font-weight:bold;\">WHERE</span> (catalog.return_rank <= 10\n    <span style=\"color:black;font-weight:bold;\">OR</span> catalog.currency_rank <= 10)\n<span style=\"color:black;font-weight:bold;\">UNION</span>\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:firebrick;\">'store'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n    store.item,\n    store.return_ratio,\n    store.return_rank,\n    store.currency_rank\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        item,\n        return_ratio,\n        currency_ratio,\n        rank() OVER (<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> return_ratio) <span style=\"color:black;font-weight:bold;\">AS</span> return_rank,\n        rank() OVER (<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> currency_ratio) <span style=\"color:black;font-weight:bold;\">AS</span> currency_rank\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            sts.ss_item_sk <span style=\"color:black;font-weight:bold;\">AS</span> item,\n            (<span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(sr.sr_return_quantity, 0)) <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4)) / <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(sts.ss_quantity, 0)) <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4))) <span style=\"color:black;font-weight:bold;\">AS</span> return_ratio,\n            (<span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(sr.sr_return_amt, 0)) <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4)) / <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(sts.ss_net_paid, 0)) <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4))) <span style=\"color:black;font-weight:bold;\">AS</span> currency_ratio\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales sts\n        <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> store_returns sr <span style=\"color:black;font-weight:bold;\">ON</span> (sts.ss_ticket_number = sr.sr_ticket_number\n            <span style=\"color:black;font-weight:bold;\">AND</span> sts.ss_item_sk = sr.sr_item_sk),\n        date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    sr.sr_return_amt > 10000\n    <span style=\"color:black;font-weight:bold;\">AND</span> sts.ss_net_profit > 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> sts.ss_net_paid > 0\n    <span style=\"color:black;font-weight:bold;\">AND</span> sts.ss_quantity > 0\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 12\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    sts.ss_item_sk) in_store) store\n<span style=\"color:black;font-weight:bold;\">WHERE</span> (store.return_rank <= 10\n    <span style=\"color:black;font-weight:bold;\">OR</span> store.currency_rank <= 10)) sq1\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    1,\n    4,\n    5,\n    2\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ054": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    s_store_name,\n    s_company_id,\n    s_street_number,\n    s_street_name,\n    s_street_type,\n    s_suite_number,\n    s_city,\n    s_county,\n    s_state,\n    s_zip,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (sr_returned_date_sk - ss_sold_date_sk <= 30) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \"30 days\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (sr_returned_date_sk - ss_sold_date_sk > 30)\n            <span style=\"color:black;font-weight:bold;\">AND</span> (sr_returned_date_sk - ss_sold_date_sk <= 60) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \"31-60 days\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (sr_returned_date_sk - ss_sold_date_sk > 60)\n            <span style=\"color:black;font-weight:bold;\">AND</span> (sr_returned_date_sk - ss_sold_date_sk <= 90) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \"61-90 days\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (sr_returned_date_sk - ss_sold_date_sk > 90)\n            <span style=\"color:black;font-weight:bold;\">AND</span> (sr_returned_date_sk - ss_sold_date_sk <= 120) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \"91-120 days\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (sr_returned_date_sk - ss_sold_date_sk > 120) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \">120 days\"\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    store_sales,\n    store_returns,\n    store,\n    date_dim d1,\n    date_dim d2\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d2.d_year = 2001\n    <span style=\"color:black;font-weight:bold;\">AND</span> d2.d_moy = 8\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_ticket_number = sr_ticket_number\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = sr_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d1.d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> sr_returned_date_sk = d2.d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_customer_sk = sr_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    s_store_name,\n    s_company_id,\n    s_street_number,\n    s_street_name,\n    s_street_type,\n    s_suite_number,\n    s_city,\n    s_county,\n    s_state,\n    s_zip\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    s_store_name,\n    s_company_id,\n    s_street_number,\n    s_street_name,\n    s_street_type,\n    s_suite_number,\n    s_city,\n    s_county,\n    s_state,\n    s_zip\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ055": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> web_v1 <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        ws_item_sk item_sk,\n        d_date,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sum(ws_sales_price)) OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> ws_item_sk <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> d_date <span style=\"color:black;font-weight:bold;\">ROWS</span> <span style=\"color:black;font-weight:bold;\">BETWEEN</span> UNBOUNDED <span style=\"color:black;font-weight:bold;\">PRECEDING</span> <span style=\"color:black;font-weight:bold;\">AND</span> CURRENT ROW) cume_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span> web_sales,\n    date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span> ws_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ws_item_sk,\n    d_date\n),\nstore_v1 <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        ss_item_sk item_sk,\n        d_date,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sum(ss_sales_price)) OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> ss_item_sk <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> d_date <span style=\"color:black;font-weight:bold;\">ROWS</span> <span style=\"color:black;font-weight:bold;\">BETWEEN</span> UNBOUNDED <span style=\"color:black;font-weight:bold;\">PRECEDING</span> <span style=\"color:black;font-weight:bold;\">AND</span> CURRENT ROW) cume_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span> store_sales,\n    date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span> ss_sold_date_sk = d_date_sk\n<span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11\n<span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ss_item_sk,\n    d_date\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    item_sk,\n    d_date,\n    web_sales,\n    store_sales,\n    max(web_sales) OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> item_sk <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> d_date <span style=\"color:black;font-weight:bold;\">ROWS</span> <span style=\"color:black;font-weight:bold;\">BETWEEN</span> UNBOUNDED <span style=\"color:black;font-weight:bold;\">PRECEDING</span> <span style=\"color:black;font-weight:bold;\">AND</span> CURRENT ROW) web_cumulative,\n    max(store_sales) OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> item_sk <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> d_date <span style=\"color:black;font-weight:bold;\">ROWS</span> <span style=\"color:black;font-weight:bold;\">BETWEEN</span> UNBOUNDED <span style=\"color:black;font-weight:bold;\">PRECEDING</span> <span style=\"color:black;font-weight:bold;\">AND</span> CURRENT ROW) store_cumulative\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> web.item_sk IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">THEN</span>\n        web.item_sk\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        store.item_sk\n    <span style=\"color:black;font-weight:bold;\">END</span> item_sk,\n    <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> web.d_date IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">THEN</span>\n        web.d_date\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        store.d_date\n    <span style=\"color:black;font-weight:bold;\">END</span> d_date,\n    web.cume_sales web_sales,\n    store.cume_sales store_sales\n<span style=\"color:black;font-weight:bold;\">FROM</span> web_v1 web\n    <span style=\"color:black;font-weight:bold;\">FULL</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> store_v1 store <span style=\"color:black;font-weight:bold;\">ON</span> (web.item_sk = store.item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> web.d_date = store.d_date)) x) y\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    web_cumulative > store_cumulative\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    item_sk,\n    d_date\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ056": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    dt.d_year,\n    item.i_brand_id brand_id,\n    item.i_brand brand,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) ext_price\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    date_dim dt,\n    store_sales,\n    item\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    dt.d_date_sk = store_sales.ss_sold_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_item_sk = item.i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> item.i_manager_id = 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> dt.d_moy = 11\n    <span style=\"color:black;font-weight:bold;\">AND</span> dt.d_year = 2000\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    dt.d_year,\n    item.i_brand,\n    item.i_brand_id\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    dt.d_year,\n    ext_price <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    brand_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ057": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_manufact_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_sales_price) sum_sales,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(ss_sales_price)) OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> i_manufact_id) avg_quarterly_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span> item,\n    store_sales,\n    date_dim,\n    store\n<span style=\"color:black;font-weight:bold;\">WHERE</span> ss_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">IN</span> (1200, 1200 + 1, 1200 + 2, 1200 + 3, 1200 + 4, 1200 + 5, 1200 + 6, 1200 + 7, 1200 + 8, 1200 + 9, 1200 + 10, 1200 + 11)\n<span style=\"color:black;font-weight:bold;\">AND</span> ((i_category <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Books'</span>, <span style=\"color:firebrick;\">'Children'</span>, <span style=\"color:firebrick;\">'Electronics'</span>)\n<span style=\"color:black;font-weight:bold;\">AND</span> i_class <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'personal'</span>, <span style=\"color:firebrick;\">'portable'</span>, <span style=\"color:firebrick;\">'reference'</span>, <span style=\"color:firebrick;\">'self-help'</span>)\n<span style=\"color:black;font-weight:bold;\">AND</span> i_brand <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'scholaramalgamalg #14'</span>, <span style=\"color:firebrick;\">'scholaramalgamalg #7'</span>, <span style=\"color:firebrick;\">'exportiunivamalg #9'</span>, <span style=\"color:firebrick;\">'scholaramalgamalg #9'</span>))\n    <span style=\"color:black;font-weight:bold;\">OR</span> (i_category <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Women'</span>, <span style=\"color:firebrick;\">'Music'</span>, <span style=\"color:firebrick;\">'Men'</span>)\n<span style=\"color:black;font-weight:bold;\">AND</span> i_class <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'accessories'</span>, <span style=\"color:firebrick;\">'classical'</span>, <span style=\"color:firebrick;\">'fragrances'</span>, <span style=\"color:firebrick;\">'pants'</span>)\n<span style=\"color:black;font-weight:bold;\">AND</span> i_brand <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'amalgimporto #1'</span>, <span style=\"color:firebrick;\">'edu packscholar #1'</span>, <span style=\"color:firebrick;\">'exportiimporto #1'</span>, <span style=\"color:firebrick;\">'importoamalg #1'</span>)))\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_manufact_id,\n    d_qoy) tmp1\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> avg_quarterly_sales > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n        ABS(sum_sales - avg_quarterly_sales) / avg_quarterly_sales\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span> > 0.1\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    avg_quarterly_sales,\n    sum_sales,\n    i_manufact_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ058": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> my_customers <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span> <span style=\"color:black;font-weight:bold;\">DISTINCT</span>\n        c_customer_sk,\n        c_current_addr_sk\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            cs_sold_date_sk sold_date_sk,\n            cs_bill_customer_sk customer_sk,\n            cs_item_sk item_sk\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            catalog_sales\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ws_sold_date_sk sold_date_sk,\n            ws_bill_customer_sk customer_sk,\n            ws_item_sk item_sk\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_sales) cs_or_ws_sales,\n        item,\n        date_dim,\n        customer\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> i_category = <span style=\"color:firebrick;\">'Women'</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> i_class = <span style=\"color:firebrick;\">'maternity'</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_customer_sk = cs_or_ws_sales.customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 12\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1998\n),\nmy_revenue <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_customer_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> revenue\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        my_customers,\n        store_sales,\n        customer_address,\n        store,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        c_current_addr_sk = ca_address_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ca_county = s_county\n        <span style=\"color:black;font-weight:bold;\">AND</span> ca_state = s_state\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_customer_sk = ss_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> ( <span style=\"color:black;font-weight:bold;\">SELECT</span> <span style=\"color:black;font-weight:bold;\">DISTINCT</span>\n                d_month_seq + 1\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                date_dim\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                d_year = 1998\n                <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 12)\n            <span style=\"color:black;font-weight:bold;\">AND</span> ( <span style=\"color:black;font-weight:bold;\">SELECT</span> <span style=\"color:black;font-weight:bold;\">DISTINCT</span>\n                    d_month_seq + 3\n                <span style=\"color:black;font-weight:bold;\">FROM</span>\n                    date_dim\n                <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                    d_year = 1998\n                    <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 12)\n            <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                c_customer_sk\n),\nsegments <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">cast</span>((revenue / 50) <span style=\"color:black;font-weight:bold;\">AS</span> int) <span style=\"color:black;font-weight:bold;\">AS</span> SEGMENT\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        my_revenue\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    SEGMENT,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) <span style=\"color:black;font-weight:bold;\">AS</span> num_customers,\n    SEGMENT * 50 <span style=\"color:black;font-weight:bold;\">AS</span> segment_base\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    segments\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    SEGMENT\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    SEGMENT,\n    num_customers\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ059": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_brand_id brand_id,\n    i_brand brand,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) ext_price\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    date_dim,\n    store_sales,\n    item\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d_date_sk = ss_sold_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_manager_id = 28\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 11\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1999\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_brand,\n    i_brand_id\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ext_price <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    i_brand_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ060": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> ss <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) total_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        customer_address,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        i_item_id <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                i_item_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                item\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                i_color <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'slate'</span>,\n                    <span style=\"color:firebrick;\">'blanched'</span>,\n                    <span style=\"color:firebrick;\">'burnished'</span>))\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 2\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_gmt_offset = - 5\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            i_item_id\n),\ncs <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_ext_sales_price) total_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales,\n        date_dim,\n        customer_address,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        i_item_id <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                i_item_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                item\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                i_color <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'slate'</span>,\n                    <span style=\"color:firebrick;\">'blanched'</span>,\n                    <span style=\"color:firebrick;\">'burnished'</span>))\n            <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 2\n            <span style=\"color:black;font-weight:bold;\">AND</span> cs_bill_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_gmt_offset = - 5\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            i_item_id\n),\nws <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_sales_price) total_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales,\n        date_dim,\n        customer_address,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        i_item_id <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                i_item_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                item\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                i_color <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'slate'</span>,\n                    <span style=\"color:firebrick;\">'blanched'</span>,\n                    <span style=\"color:firebrick;\">'burnished'</span>))\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 2\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_bill_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_gmt_offset = - 5\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            i_item_id\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(total_sales) total_sales\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        *\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        ss\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        *\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        cs\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        *\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        ws) tmp1\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    total_sales,\n    i_item_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ061": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> v1 <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_category,\n        i_brand,\n        cc_name,\n        d_year,\n        d_moy,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_sales_price) sum_sales,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(cs_sales_price)) OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> i_category,\n            i_brand,\n            cc_name,\n            d_year) avg_monthly_sales,\n        rank() OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> i_category,\n            i_brand,\n            cc_name <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> d_year,\n            d_moy) rn\n    <span style=\"color:black;font-weight:bold;\">FROM</span> item,\n    catalog_sales,\n    date_dim,\n    call_center\n<span style=\"color:black;font-weight:bold;\">WHERE</span> cs_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cc_call_center_sk = cs_call_center_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> (d_year = 1999\n    <span style=\"color:black;font-weight:bold;\">OR</span> (d_year = 1999 - 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 12)\n    <span style=\"color:black;font-weight:bold;\">OR</span> (d_year = 1999 + 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 1))\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_category,\n    i_brand,\n    cc_name,\n    d_year,\n    d_moy\n),\nv2 <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        v1.i_category,\n        v1.i_brand,\n        v1.cc_name,\n        v1.d_year,\n        v1.d_moy,\n        v1.avg_monthly_sales,\n        v1.sum_sales,\n        v1_lag.sum_sales psum,\n        v1_lead.sum_sales nsum\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        v1,\n        v1 v1_lag,\n        v1 v1_lead\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        v1.i_category = v1_lag.i_category\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.i_category = v1_lead.i_category\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.i_brand = v1_lag.i_brand\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.i_brand = v1_lead.i_brand\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1. cc_name = v1_lag. cc_name\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1. cc_name = v1_lead. cc_name\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.rn = v1_lag.rn + 1\n        <span style=\"color:black;font-weight:bold;\">AND</span> v1.rn = v1_lead.rn - 1\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    v2\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d_year = 1999\n    <span style=\"color:black;font-weight:bold;\">AND</span> avg_monthly_sales > 0\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> avg_monthly_sales > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n        abs(sum_sales - avg_monthly_sales) / avg_monthly_sales\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span> > 0.1\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    sum_sales - avg_monthly_sales\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ062": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> ss_items <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id item_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) ss_item_rev\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        item,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                d_date\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                date_dim\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                d_week_seq = (\n                    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                        d_week_seq\n                    <span style=\"color:black;font-weight:bold;\">FROM</span>\n                        date_dim\n                    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                        d_date = <span style=\"color:firebrick;\">'2000-01-03'</span>))\n                <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                i_item_id\n),\ncs_items <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id item_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_ext_sales_price) cs_item_rev\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales,\n        item,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        cs_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                d_date\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                date_dim\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                d_week_seq = (\n                    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                        d_week_seq\n                    <span style=\"color:black;font-weight:bold;\">FROM</span>\n                        date_dim\n                    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                        d_date = <span style=\"color:firebrick;\">'2000-01-03'</span>))\n                <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                i_item_id\n),\nws_items <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id item_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_sales_price) ws_item_rev\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales,\n        item,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ws_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                d_date\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                date_dim\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                d_week_seq = (\n                    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                        d_week_seq\n                    <span style=\"color:black;font-weight:bold;\">FROM</span>\n                        date_dim\n                    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                        d_date = <span style=\"color:firebrick;\">'2000-01-03'</span>))\n                <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                i_item_id\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    ss_items.item_id,\n    ss_item_rev,\n    ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 ss_dev,\ncs_item_rev,\ncs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 cs_dev,\nws_item_rev,\nws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 ws_dev,\n(ss_item_rev + cs_item_rev + ws_item_rev) / 3 average\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    ss_items,\n    cs_items,\n    ws_items\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ss_items.item_id = cs_items.item_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_items.item_id = ws_items.item_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_rev <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 0.9 * cs_item_rev\n    <span style=\"color:black;font-weight:bold;\">AND</span> 1.1 * cs_item_rev\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_rev <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 0.9 * ws_item_rev\n    <span style=\"color:black;font-weight:bold;\">AND</span> 1.1 * ws_item_rev\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_rev <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 0.9 * ss_item_rev\n    <span style=\"color:black;font-weight:bold;\">AND</span> 1.1 * ss_item_rev\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_rev <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 0.9 * ws_item_rev\n    <span style=\"color:black;font-weight:bold;\">AND</span> 1.1 * ws_item_rev\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_rev <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 0.9 * ss_item_rev\n    <span style=\"color:black;font-weight:bold;\">AND</span> 1.1 * ss_item_rev\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_rev <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 0.9 * cs_item_rev\n    <span style=\"color:black;font-weight:bold;\">AND</span> 1.1 * cs_item_rev\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ss_items.item_id,\n    ss_item_rev\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ063": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> wss <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        d_week_seq,\n        ss_store_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Sunday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ss_sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) sun_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Monday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ss_sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) mon_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Tuesday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ss_sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) tue_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Wednesday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ss_sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) wed_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Thursday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ss_sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) thu_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Friday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ss_sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) fri_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (d_day_name = <span style=\"color:firebrick;\">'Saturday'</span>) <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ss_sales_price\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">END</span>) sat_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        d_date_sk = ss_sold_date_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        d_week_seq,\n        ss_store_sk\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    s_store_name1,\n    s_store_id1,\n    d_week_seq1,\n    sun_sales1 / sun_sales2,\n    mon_sales1 / mon_sales2,\n    tue_sales1 / tue_sales2,\n    wed_sales1 / wed_sales2,\n    thu_sales1 / thu_sales2,\n    fri_sales1 / fri_sales2,\n    sat_sales1 / sat_sales2\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        s_store_name s_store_name1,\n        wss.d_week_seq d_week_seq1,\n        s_store_id s_store_id1,\n        sun_sales sun_sales1,\n        mon_sales mon_sales1,\n        tue_sales tue_sales1,\n        wed_sales wed_sales1,\n        thu_sales thu_sales1,\n        fri_sales fri_sales1,\n        sat_sales sat_sales1\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        wss,\n        store,\n        date_dim d\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        d.d_week_seq = wss.d_week_seq\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1212 <span style=\"color:black;font-weight:bold;\">AND</span> 1212 + 11) y,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            s_store_name s_store_name2,\n            wss.d_week_seq d_week_seq2,\n            s_store_id s_store_id2,\n            sun_sales sun_sales2,\n            mon_sales mon_sales2,\n            tue_sales tue_sales2,\n            wed_sales wed_sales2,\n            thu_sales thu_sales2,\n            fri_sales fri_sales2,\n            sat_sales sat_sales2\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            wss,\n            store,\n            date_dim d\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            d.d_week_seq = wss.d_week_seq\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1212 + 12 <span style=\"color:black;font-weight:bold;\">AND</span> 1212 + 23) x\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    s_store_id1 = s_store_id2\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_week_seq1 = d_week_seq2 - 52\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    s_store_name1,\n    s_store_id1,\n    d_week_seq1\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ064": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> ss <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) total_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        customer_address,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        i_item_id <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                i_item_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                item\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                i_category = <span style=\"color:firebrick;\">'Music'</span>)\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1998\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 9\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_gmt_offset = - 5\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            i_item_id\n),\ncs <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_ext_sales_price) total_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales,\n        date_dim,\n        customer_address,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        i_item_id <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                i_item_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                item\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                i_category = <span style=\"color:firebrick;\">'Music'</span>)\n            <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1998\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 9\n            <span style=\"color:black;font-weight:bold;\">AND</span> cs_bill_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_gmt_offset = - 5\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            i_item_id\n),\nws <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_sales_price) total_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales,\n        date_dim,\n        customer_address,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        i_item_id <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                i_item_id\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                item\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                i_category = <span style=\"color:firebrick;\">'Music'</span>)\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1998\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 9\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_bill_addr_sk = ca_address_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_gmt_offset = - 5\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            i_item_id\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(total_sales) total_sales\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        *\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        ss\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        *\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        cs\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        *\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        ws) tmp1\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id,\n    total_sales\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ065": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    promotions,\n    total,\n    <span style=\"color:black;font-weight:bold;\">cast</span>(promotions <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4)) / <span style=\"color:black;font-weight:bold;\">cast</span>(total <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4)) * 100\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) promotions\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        store,\n        promotion,\n        date_dim,\n        customer,\n        customer_address,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_promo_sk = p_promo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_customer_sk = c_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ca_address_sk = c_current_addr_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ca_gmt_offset = - 5\n        <span style=\"color:black;font-weight:bold;\">AND</span> i_category = <span style=\"color:firebrick;\">'Jewelry'</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> (p_channel_dmail = <span style=\"color:firebrick;\">'Y'</span>\n            <span style=\"color:black;font-weight:bold;\">OR</span> p_channel_email = <span style=\"color:firebrick;\">'Y'</span>\n            <span style=\"color:black;font-weight:bold;\">OR</span> p_channel_tv = <span style=\"color:firebrick;\">'Y'</span>)\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_gmt_offset = - 5\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1998\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 11) promotional_sales,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) total\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            store,\n            date_dim,\n            customer,\n            customer_address,\n            item\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_customer_sk = c_customer_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_address_sk = c_current_addr_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_gmt_offset = - 5\n            <span style=\"color:black;font-weight:bold;\">AND</span> i_category = <span style=\"color:firebrick;\">'Jewelry'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> s_gmt_offset = - 5\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1998\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 11) all_sales\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    promotions,\n    total\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ066": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    w_substr,\n    sm_type,\n    web_name,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (ws_ship_date_sk - ws_sold_date_sk <= 30) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \"30 days\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (ws_ship_date_sk - ws_sold_date_sk > 30)\n            <span style=\"color:black;font-weight:bold;\">AND</span> (ws_ship_date_sk - ws_sold_date_sk <= 60) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \"31-60 days\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (ws_ship_date_sk - ws_sold_date_sk > 60)\n            <span style=\"color:black;font-weight:bold;\">AND</span> (ws_ship_date_sk - ws_sold_date_sk <= 90) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \"61-90 days\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (ws_ship_date_sk - ws_sold_date_sk > 90)\n            <span style=\"color:black;font-weight:bold;\">AND</span> (ws_ship_date_sk - ws_sold_date_sk <= 120) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \"91-120 days\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (ws_ship_date_sk - ws_sold_date_sk > 120) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \">120 days\"\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    web_sales,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(w_warehouse_name, 1, 20) w_substr,\n            *\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            warehouse) sq1,\n    ship_mode,\n    web_site,\n    date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_ship_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_warehouse_sk = w_warehouse_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_ship_mode_sk = sm_ship_mode_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_web_site_sk = web_site_sk\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    w_substr,\n    sm_type,\n    web_name\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    1,\n    2,\n    3\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ067": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_manager_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_sales_price) sum_sales,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(ss_sales_price)) OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> i_manager_id) avg_monthly_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span> item,\n    store_sales,\n    date_dim,\n    store\n<span style=\"color:black;font-weight:bold;\">WHERE</span> ss_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">IN</span> (1200, 1200 + 1, 1200 + 2, 1200 + 3, 1200 + 4, 1200 + 5, 1200 + 6, 1200 + 7, 1200 + 8, 1200 + 9, 1200 + 10, 1200 + 11)\n<span style=\"color:black;font-weight:bold;\">AND</span> ((i_category <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Books'</span>, <span style=\"color:firebrick;\">'Children'</span>, <span style=\"color:firebrick;\">'Electronics'</span>)\n<span style=\"color:black;font-weight:bold;\">AND</span> i_class <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'personal'</span>, <span style=\"color:firebrick;\">'portable'</span>, <span style=\"color:firebrick;\">'reference'</span>, <span style=\"color:firebrick;\">'self-help'</span>)\n<span style=\"color:black;font-weight:bold;\">AND</span> i_brand <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'scholaramalgamalg #14'</span>, <span style=\"color:firebrick;\">'scholaramalgamalg #7'</span>, <span style=\"color:firebrick;\">'exportiunivamalg #9'</span>, <span style=\"color:firebrick;\">'scholaramalgamalg #9'</span>))\n    <span style=\"color:black;font-weight:bold;\">OR</span> (i_category <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Women'</span>, <span style=\"color:firebrick;\">'Music'</span>, <span style=\"color:firebrick;\">'Men'</span>)\n<span style=\"color:black;font-weight:bold;\">AND</span> i_class <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'accessories'</span>, <span style=\"color:firebrick;\">'classical'</span>, <span style=\"color:firebrick;\">'fragrances'</span>, <span style=\"color:firebrick;\">'pants'</span>)\n<span style=\"color:black;font-weight:bold;\">AND</span> i_brand <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'amalgimporto #1'</span>, <span style=\"color:firebrick;\">'edu packscholar #1'</span>, <span style=\"color:firebrick;\">'exportiimporto #1'</span>, <span style=\"color:firebrick;\">'importoamalg #1'</span>)))\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_manager_id,\n    d_moy) tmp1\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> avg_monthly_sales > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n        ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span> > 0.1\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_manager_id,\n    avg_monthly_sales,\n    sum_sales\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ068": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> cs_ui <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        cs_item_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_ext_list_price) <span style=\"color:black;font-weight:bold;\">AS</span> sale,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cr_refunded_cash + cr_reversed_charge + cr_store_credit) <span style=\"color:black;font-weight:bold;\">AS</span> refund\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales,\n        catalog_returns\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        cs_item_sk = cr_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_order_number = cr_order_number\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        cs_item_sk\n    <span style=\"color:black;font-weight:bold;\">HAVING</span>\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_ext_list_price) > 2 * <span style=\"color:black;font-weight:bold;\">sum</span>(cr_refunded_cash + cr_reversed_charge + cr_store_credit)\n),\ncross_sales <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_product_name product_name,\n        i_item_sk item_sk,\n        s_store_name store_name,\n        s_zip store_zip,\n        ad1.ca_street_number b_street_number,\n        ad1.ca_street_name b_street_name,\n        ad1.ca_city b_city,\n        ad1.ca_zip b_zip,\n        ad2.ca_street_number c_street_number,\n        ad2.ca_street_name c_street_name,\n        ad2.ca_city c_city,\n        ad2.ca_zip c_zip,\n        d1.d_year <span style=\"color:black;font-weight:bold;\">AS</span> syear,\n        d2.d_year <span style=\"color:black;font-weight:bold;\">AS</span> fsyear,\n        d3.d_year s2year,\n        <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_wholesale_cost) s1,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_list_price) s2,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_coupon_amt) s3\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        store_returns,\n        cs_ui,\n        date_dim d1,\n        date_dim d2,\n        date_dim d3,\n        store,\n        customer,\n        customer_demographics cd1,\n        customer_demographics cd2,\n        promotion,\n        household_demographics hd1,\n        household_demographics hd2,\n        customer_address ad1,\n        customer_address ad2,\n        income_band ib1,\n        income_band ib2,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_store_sk = s_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d1.d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_customer_sk = c_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_cdemo_sk = cd1.cd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_hdemo_sk = hd1.hd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_addr_sk = ad1.ca_address_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = sr_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_ticket_number = sr_ticket_number\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = cs_ui.cs_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_current_cdemo_sk = cd2.cd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_current_hdemo_sk = hd2.hd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_current_addr_sk = ad2.ca_address_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_first_sales_date_sk = d2.d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> c_first_shipto_date_sk = d3.d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_promo_sk = p_promo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> hd1.hd_income_band_sk = ib1.ib_income_band_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> hd2.hd_income_band_sk = ib2.ib_income_band_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cd1.cd_marital_status <> cd2.cd_marital_status\n        <span style=\"color:black;font-weight:bold;\">AND</span> i_color <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'purple'</span>,\n            <span style=\"color:firebrick;\">'burlywood'</span>,\n            <span style=\"color:firebrick;\">'indian'</span>,\n            <span style=\"color:firebrick;\">'spring'</span>,\n            <span style=\"color:firebrick;\">'floral'</span>,\n            <span style=\"color:firebrick;\">'medium'</span>)\n        <span style=\"color:black;font-weight:bold;\">AND</span> i_current_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 64 <span style=\"color:black;font-weight:bold;\">AND</span> 64 + 10\n        <span style=\"color:black;font-weight:bold;\">AND</span> i_current_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 64 + 1 <span style=\"color:black;font-weight:bold;\">AND</span> 64 + 15\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_product_name,\n        i_item_sk,\n        s_store_name,\n        s_zip,\n        ad1.ca_street_number,\n        ad1.ca_street_name,\n        ad1.ca_city,\n        ad1.ca_zip,\n        ad2.ca_street_number,\n        ad2.ca_street_name,\n        ad2.ca_city,\n        ad2.ca_zip,\n        d1.d_year,\n        d2.d_year,\n        d3.d_year\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    cs1.product_name,\n    cs1.store_name,\n    cs1.store_zip,\n    cs1.b_street_number,\n    cs1.b_street_name,\n    cs1.b_city,\n    cs1.b_zip,\n    cs1.c_street_number,\n    cs1.c_street_name,\n    cs1.c_city,\n    cs1.c_zip,\n    cs1.syear,\n    cs1.cnt,\n    cs1.s1 <span style=\"color:black;font-weight:bold;\">AS</span> s11,\n    cs1.s2 <span style=\"color:black;font-weight:bold;\">AS</span> s21,\n    cs1.s3 <span style=\"color:black;font-weight:bold;\">AS</span> s31,\n    cs2.s1 <span style=\"color:black;font-weight:bold;\">AS</span> s12,\n    cs2.s2 <span style=\"color:black;font-weight:bold;\">AS</span> s22,\n    cs2.s3 <span style=\"color:black;font-weight:bold;\">AS</span> s32,\n    cs2.syear,\n    cs2.cnt\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cross_sales cs1,\n    cross_sales cs2\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cs1.item_sk = cs2.item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs1.syear = 1999\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs2.syear = 1999 + 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs2.cnt <= cs1.cnt\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs1.store_name = cs2.store_name\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs1.store_zip = cs2.store_zip\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    cs1.product_name,\n    cs1.store_name,\n    cs2.cnt,\n    cs1.s1,\n    cs2.s1;\n\n</pre>\n\t\t", "DSQ069": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    s_store_name,\n    i_item_desc,\n    sc.revenue,\n    i_current_price,\n    i_wholesale_cost,\n    i_brand\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    store,\n    item,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ss_store_sk,\n            <span style=\"color:black;font-weight:bold;\">avg</span>(revenue) <span style=\"color:black;font-weight:bold;\">AS</span> ave\n        <span style=\"color:black;font-weight:bold;\">FROM</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                ss_store_sk,\n                ss_item_sk,\n                <span style=\"color:black;font-weight:bold;\">sum</span>(ss_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> revenue\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                store_sales,\n                date_dim\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                ss_sold_date_sk = d_date_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1176 <span style=\"color:black;font-weight:bold;\">AND</span> 1176 + 11\n            <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                ss_store_sk,\n                ss_item_sk) sa\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            ss_store_sk) sb,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ss_store_sk,\n            ss_item_sk,\n            <span style=\"color:black;font-weight:bold;\">sum</span>(ss_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> revenue\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1176 <span style=\"color:black;font-weight:bold;\">AND</span> 1176 + 11\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            ss_store_sk,\n            ss_item_sk) sc\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    sb.ss_store_sk = sc.ss_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> sc.revenue <= 0.1 * sb.ave\n    <span style=\"color:black;font-weight:bold;\">AND</span> s_store_sk = sc.ss_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_item_sk = sc.ss_item_sk\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    s_store_name,\n    i_item_desc\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ070": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    w_warehouse_name,\n    w_warehouse_sq_ft,\n    w_city,\n    w_county,\n    w_state,\n    w_country,\n    ship_carriers,\n    year_,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(jan_sales) <span style=\"color:black;font-weight:bold;\">AS</span> jan_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(feb_sales) <span style=\"color:black;font-weight:bold;\">AS</span> feb_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(mar_sales) <span style=\"color:black;font-weight:bold;\">AS</span> mar_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(apr_sales) <span style=\"color:black;font-weight:bold;\">AS</span> apr_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(may_sales) <span style=\"color:black;font-weight:bold;\">AS</span> may_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(jun_sales) <span style=\"color:black;font-weight:bold;\">AS</span> jun_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(jul_sales) <span style=\"color:black;font-weight:bold;\">AS</span> jul_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(aug_sales) <span style=\"color:black;font-weight:bold;\">AS</span> aug_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(sep_sales) <span style=\"color:black;font-weight:bold;\">AS</span> sep_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(oct_sales) <span style=\"color:black;font-weight:bold;\">AS</span> oct_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(nov_sales) <span style=\"color:black;font-weight:bold;\">AS</span> nov_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(dec_sales) <span style=\"color:black;font-weight:bold;\">AS</span> dec_sales,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(jan_sales / w_warehouse_sq_ft) <span style=\"color:black;font-weight:bold;\">AS</span> jan_sales_per_sq_foot,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(feb_sales / w_warehouse_sq_ft) <span style=\"color:black;font-weight:bold;\">AS</span> feb_sales_per_sq_foot,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(mar_sales / w_warehouse_sq_ft) <span style=\"color:black;font-weight:bold;\">AS</span> mar_sales_per_sq_foot,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(apr_sales / w_warehouse_sq_ft) <span style=\"color:black;font-weight:bold;\">AS</span> apr_sales_per_sq_foot,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(may_sales / w_warehouse_sq_ft) <span style=\"color:black;font-weight:bold;\">AS</span> may_sales_per_sq_foot,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(jun_sales / w_warehouse_sq_ft) <span style=\"color:black;font-weight:bold;\">AS</span> jun_sales_per_sq_foot,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(jul_sales / w_warehouse_sq_ft) <span style=\"color:black;font-weight:bold;\">AS</span> jul_sales_per_sq_foot,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(aug_sales / w_warehouse_sq_ft) <span style=\"color:black;font-weight:bold;\">AS</span> aug_sales_per_sq_foot,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(sep_sales / w_warehouse_sq_ft) <span style=\"color:black;font-weight:bold;\">AS</span> sep_sales_per_sq_foot,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(oct_sales / w_warehouse_sq_ft) <span style=\"color:black;font-weight:bold;\">AS</span> oct_sales_per_sq_foot,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(nov_sales / w_warehouse_sq_ft) <span style=\"color:black;font-weight:bold;\">AS</span> nov_sales_per_sq_foot,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(dec_sales / w_warehouse_sq_ft) <span style=\"color:black;font-weight:bold;\">AS</span> dec_sales_per_sq_foot,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(jan_net) <span style=\"color:black;font-weight:bold;\">AS</span> jan_net,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(feb_net) <span style=\"color:black;font-weight:bold;\">AS</span> feb_net,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(mar_net) <span style=\"color:black;font-weight:bold;\">AS</span> mar_net,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(apr_net) <span style=\"color:black;font-weight:bold;\">AS</span> apr_net,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(may_net) <span style=\"color:black;font-weight:bold;\">AS</span> may_net,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(jun_net) <span style=\"color:black;font-weight:bold;\">AS</span> jun_net,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(jul_net) <span style=\"color:black;font-weight:bold;\">AS</span> jul_net,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(aug_net) <span style=\"color:black;font-weight:bold;\">AS</span> aug_net,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(sep_net) <span style=\"color:black;font-weight:bold;\">AS</span> sep_net,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(oct_net) <span style=\"color:black;font-weight:bold;\">AS</span> oct_net,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(nov_net) <span style=\"color:black;font-weight:bold;\">AS</span> nov_net,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(dec_net) <span style=\"color:black;font-weight:bold;\">AS</span> dec_net\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        w_warehouse_name,\n        w_warehouse_sq_ft,\n        w_city,\n        w_county,\n        w_state,\n        w_country,\n        <span style=\"color:firebrick;\">'DHL,BARIAN'</span> <span style=\"color:black;font-weight:bold;\">AS</span> ship_carriers,\n        d_year <span style=\"color:black;font-weight:bold;\">AS</span> year_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 1 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_ext_sales_price * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> jan_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 2 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_ext_sales_price * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> feb_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 3 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_ext_sales_price * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> mar_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 4 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_ext_sales_price * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> apr_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 5 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_ext_sales_price * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> may_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 6 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_ext_sales_price * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> jun_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 7 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_ext_sales_price * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> jul_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 8 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_ext_sales_price * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> aug_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 9 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_ext_sales_price * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> sep_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 10 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_ext_sales_price * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> oct_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 11 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_ext_sales_price * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> nov_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 12 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_ext_sales_price * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> dec_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 1 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_net_paid * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> jan_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 2 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_net_paid * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> feb_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 3 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_net_paid * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> mar_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 4 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_net_paid * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> apr_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 5 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_net_paid * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> may_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 6 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_net_paid * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> jun_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 7 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_net_paid * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> jul_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 8 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_net_paid * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> aug_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 9 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_net_paid * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> sep_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 10 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_net_paid * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> oct_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 11 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_net_paid * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> nov_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 12 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                ws_net_paid * ws_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> dec_net\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales,\n        warehouse,\n        date_dim,\n        time_dim,\n        ship_mode\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ws_warehouse_sk = w_warehouse_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_time_sk = t_time_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_ship_mode_sk = sm_ship_mode_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n        <span style=\"color:black;font-weight:bold;\">AND</span> t_time <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 30838 <span style=\"color:black;font-weight:bold;\">AND</span> 30838 + 28800\n        <span style=\"color:black;font-weight:bold;\">AND</span> sm_carrier <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'DHL'</span>, <span style=\"color:firebrick;\">'BARIAN'</span>)\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        w_warehouse_name,\n        w_warehouse_sq_ft,\n        w_city,\n        w_county,\n        w_state,\n        w_country,\n        d_year\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        w_warehouse_name,\n        w_warehouse_sq_ft,\n        w_city,\n        w_county,\n        w_state,\n        w_country,\n        <span style=\"color:firebrick;\">'DHL,BARIAN'</span> <span style=\"color:black;font-weight:bold;\">AS</span> ship_carriers,\n        d_year <span style=\"color:black;font-weight:bold;\">AS</span> year_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 1 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_sales_price * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> jan_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 2 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_sales_price * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> feb_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 3 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_sales_price * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> mar_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 4 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_sales_price * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> apr_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 5 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_sales_price * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> may_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 6 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_sales_price * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> jun_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 7 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_sales_price * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> jul_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 8 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_sales_price * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> aug_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 9 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_sales_price * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> sep_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 10 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_sales_price * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> oct_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 11 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_sales_price * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> nov_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 12 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_sales_price * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> dec_sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 1 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_net_paid_inc_tax * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> jan_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 2 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_net_paid_inc_tax * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> feb_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 3 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_net_paid_inc_tax * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> mar_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 4 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_net_paid_inc_tax * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> apr_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 5 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_net_paid_inc_tax * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> may_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 6 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_net_paid_inc_tax * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> jun_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 7 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_net_paid_inc_tax * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> jul_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 8 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_net_paid_inc_tax * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> aug_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 9 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_net_paid_inc_tax * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> sep_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 10 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_net_paid_inc_tax * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> oct_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 11 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_net_paid_inc_tax * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> nov_net,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(\n            <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> d_moy = 12 <span style=\"color:black;font-weight:bold;\">THEN</span>\n                cs_net_paid_inc_tax * cs_quantity\n            <span style=\"color:black;font-weight:bold;\">ELSE</span>\n                0\n            <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> dec_net\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales,\n        warehouse,\n        date_dim,\n        time_dim,\n        ship_mode\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        cs_warehouse_sk = w_warehouse_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_time_sk = t_time_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_ship_mode_sk = sm_ship_mode_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n        <span style=\"color:black;font-weight:bold;\">AND</span> t_time <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 30838 <span style=\"color:black;font-weight:bold;\">AND</span> 30838 + 28800\n        <span style=\"color:black;font-weight:bold;\">AND</span> sm_carrier <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'DHL'</span>, <span style=\"color:firebrick;\">'BARIAN'</span>)\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        w_warehouse_name,\n        w_warehouse_sq_ft,\n        w_city,\n        w_county,\n        w_state,\n        w_country,\n        d_year) x\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    w_warehouse_name,\n    w_warehouse_sq_ft,\n    w_city,\n    w_county,\n    w_state,\n    w_country,\n    ship_carriers,\n    year_\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    w_warehouse_name\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ071": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> results <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        d_moy,\n        s_store_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(ss_sales_price * ss_quantity,\n                0)) sumsales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        store,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        d_moy,\n        s_store_id\n),\nresults_rollup <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        d_moy,\n        s_store_id,\n        sumsales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        d_moy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> s_store_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sumsales) sumsales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        d_moy\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_moy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> s_store_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sumsales) sumsales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_qoy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_moy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> s_store_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sumsales) sumsales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_year,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_qoy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_moy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> s_store_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sumsales) sumsales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_category,\n        i_class,\n        i_brand,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_product_name,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_year,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_qoy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_moy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> s_store_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sumsales) sumsales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_category,\n        i_class,\n        i_brand\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_category,\n        i_class,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_brand,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_product_name,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_year,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_qoy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_moy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> s_store_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sumsales) sumsales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_category,\n        i_class\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_category,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_class,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_brand,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_product_name,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_year,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_qoy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_moy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> s_store_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sumsales) sumsales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_category\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_category,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_class,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_brand,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> i_product_name,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_year,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_qoy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> d_moy,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> s_store_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sumsales) sumsales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        d_moy,\n        s_store_id,\n        sumsales,\n        rank() OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> i_category <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> sumsales <span style=\"color:black;font-weight:bold;\">DESC</span>) rk\n    <span style=\"color:black;font-weight:bold;\">FROM</span> results_rollup) dw2\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    rk <= 100\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    sumsales,\n    rk\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ072": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_last_name,\n    c_first_name,\n    ca_city,\n    bought_city,\n    ss_ticket_number,\n    extended_price,\n    extended_tax,\n    list_price\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        ss_ticket_number,\n        ss_customer_sk,\n        ca_city bought_city,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) extended_price,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_list_price) list_price,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_tax) extended_tax\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        store,\n        household_demographics,\n        customer_address\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        store_sales.ss_sold_date_sk = date_dim.d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_store_sk = store.s_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_addr_sk = customer_address.ca_address_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> date_dim.d_dom <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1 <span style=\"color:black;font-weight:bold;\">AND</span> 2\n        <span style=\"color:black;font-weight:bold;\">AND</span> (household_demographics.hd_dep_count = 4\n            <span style=\"color:black;font-weight:bold;\">OR</span> household_demographics.hd_vehicle_count = 3)\n        <span style=\"color:black;font-weight:bold;\">AND</span> date_dim.d_year <span style=\"color:black;font-weight:bold;\">IN</span> (1999, 1999 + 1, 1999 + 2)\n        <span style=\"color:black;font-weight:bold;\">AND</span> store.s_city <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Fairview'</span>, <span style=\"color:firebrick;\">'Midway'</span>)\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        ss_ticket_number,\n        ss_customer_sk,\n        ss_addr_sk,\n        ca_city) dn,\n    customer,\n    customer_address current_addr\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ss_customer_sk = c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> customer.c_current_addr_sk = current_addr.ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> current_addr.ca_city <> bought_city\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_last_name,\n    ss_ticket_number\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ073": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt1,\n    cd_purchase_estimate,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt2,\n    cd_credit_rating,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt3\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    customer c,\n    customer_address ca,\n    customer_demographics\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    c.c_current_addr_sk = ca.ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ca_state <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'KY'</span>, <span style=\"color:firebrick;\">'GA'</span>, <span style=\"color:firebrick;\">'NM'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd_demo_sk = c.c_current_cdemo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            *\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            c.c_customer_sk = ss_customer_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 4 <span style=\"color:black;font-weight:bold;\">AND</span> 4 + 2)\n    <span style=\"color:black;font-weight:bold;\">AND</span> (<span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                *\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                web_sales,\n                date_dim\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                c.c_customer_sk = ws_bill_customer_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n                <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n                <span style=\"color:black;font-weight:bold;\">AND</span> d_moy <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 4 <span style=\"color:black;font-weight:bold;\">AND</span> 4 + 2)\n            <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n                <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                    *\n                <span style=\"color:black;font-weight:bold;\">FROM</span>\n                    catalog_sales,\n                    date_dim\n                <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                    c.c_customer_sk = cs_ship_customer_sk\n                    <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n                    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2001\n                    <span style=\"color:black;font-weight:bold;\">AND</span> d_moy <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 4 <span style=\"color:black;font-weight:bold;\">AND</span> 4 + 2))\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_purchase_estimate,\n        cd_credit_rating\n    <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_purchase_estimate,\n        cd_credit_rating\n    <span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ074": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> results <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_profit) <span style=\"color:black;font-weight:bold;\">AS</span> total_sum,\n        s_state,\n        s_county,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> gstate,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> g_county\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim d1,\n        store\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        d1.d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11\n        <span style=\"color:black;font-weight:bold;\">AND</span> d1.d_date_sk = ss_sold_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_store_sk = ss_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> s_state <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                s_state\n            <span style=\"color:black;font-weight:bold;\">FROM</span> (\n                <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                    s_state <span style=\"color:black;font-weight:bold;\">AS</span> s_state,\n                    rank() OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> s_state <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> <span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_profit)\n                        <span style=\"color:black;font-weight:bold;\">DESC</span>) <span style=\"color:black;font-weight:bold;\">AS</span> ranking\n                <span style=\"color:black;font-weight:bold;\">FROM</span>\n                    store_sales,\n                    store,\n                    date_dim\n                <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                    d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11\n                    <span style=\"color:black;font-weight:bold;\">AND</span> d_date_sk = ss_sold_date_sk\n                    <span style=\"color:black;font-weight:bold;\">AND</span> s_store_sk = ss_store_sk\n                <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                    s_state) tmp1\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                ranking <= 5)\n        <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n            s_state,\n            s_county\n),\nresults_rollup <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        total_sum,\n        s_state,\n        s_county,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> g_state,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> g_county,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> lochierarchy\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">sum</span>(total_sum) <span style=\"color:black;font-weight:bold;\">AS</span> total_sum,\n        s_state,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> s_county,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> g_state,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> g_county,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> lochierarchy\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        s_state\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">sum</span>(total_sum) <span style=\"color:black;font-weight:bold;\">AS</span> total_sum,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> s_state,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> s_county,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> g_state,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> g_county,\n        2 <span style=\"color:black;font-weight:bold;\">AS</span> lochierarchy\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    total_sum,\n    s_state,\n    s_county,\n    lochierarchy,\n    rank() OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> lochierarchy, <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> g_county = 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n            s_state\n        <span style=\"color:black;font-weight:bold;\">END</span> <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> total_sum <span style=\"color:black;font-weight:bold;\">DESC</span>) <span style=\"color:black;font-weight:bold;\">AS</span> rank_within_parent\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results_rollup\n    <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        lochierarchy <span style=\"color:black;font-weight:bold;\">DESC</span>,\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> lochierarchy = 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n            s_state\n        <span style=\"color:black;font-weight:bold;\">END</span>,\n        rank_within_parent\n    <span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ075": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_brand_id brand_id,\n    i_brand brand,\n    t_hour,\n    t_minute,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ext_price) ext_price\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    item,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ws_ext_sales_price <span style=\"color:black;font-weight:bold;\">AS</span> ext_price,\n            ws_sold_date_sk <span style=\"color:black;font-weight:bold;\">AS</span> sold_date_sk,\n            ws_item_sk <span style=\"color:black;font-weight:bold;\">AS</span> sold_item_sk,\n            ws_sold_time_sk <span style=\"color:black;font-weight:bold;\">AS</span> time_sk\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            d_date_sk = ws_sold_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 11\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1999\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            cs_ext_sales_price <span style=\"color:black;font-weight:bold;\">AS</span> ext_price,\n            cs_sold_date_sk <span style=\"color:black;font-weight:bold;\">AS</span> sold_date_sk,\n            cs_item_sk <span style=\"color:black;font-weight:bold;\">AS</span> sold_item_sk,\n            cs_sold_time_sk <span style=\"color:black;font-weight:bold;\">AS</span> time_sk\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            catalog_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            d_date_sk = cs_sold_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 11\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1999\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ss_ext_sales_price <span style=\"color:black;font-weight:bold;\">AS</span> ext_price,\n            ss_sold_date_sk <span style=\"color:black;font-weight:bold;\">AS</span> sold_date_sk,\n            ss_item_sk <span style=\"color:black;font-weight:bold;\">AS</span> sold_item_sk,\n            ss_sold_time_sk <span style=\"color:black;font-weight:bold;\">AS</span> time_sk\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            d_date_sk = ss_sold_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 11\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1999) tmp,\n    time_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    sold_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_manager_id = 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> time_sk = t_time_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> (t_meal_time = <span style=\"color:firebrick;\">'breakfast'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> t_meal_time = <span style=\"color:firebrick;\">'dinner'</span>)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_brand,\n    i_brand_id,\n    t_hour,\n    t_minute\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ext_price <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    i_brand_id;\n\n</pre>\n\t\t", "DSQ076": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_desc,\n    w_warehouse_name,\n    d1.d_week_seq,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> p_promo_sk IS <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) no_promo,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> p_promo_sk IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) promo,\n    <span style=\"color:black;font-weight:bold;\">count</span>(*) total_cnt\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    catalog_sales\n    <span style=\"color:black;font-weight:bold;\">JOIN</span> inventory <span style=\"color:black;font-weight:bold;\">ON</span> (cs_item_sk = inv_item_sk)\n    <span style=\"color:black;font-weight:bold;\">JOIN</span> warehouse <span style=\"color:black;font-weight:bold;\">ON</span> (w_warehouse_sk = inv_warehouse_sk)\n    <span style=\"color:black;font-weight:bold;\">JOIN</span> item <span style=\"color:black;font-weight:bold;\">ON</span> (i_item_sk = cs_item_sk)\n    <span style=\"color:black;font-weight:bold;\">JOIN</span> customer_demographics <span style=\"color:black;font-weight:bold;\">ON</span> (cs_bill_cdemo_sk = cd_demo_sk)\n    <span style=\"color:black;font-weight:bold;\">JOIN</span> household_demographics <span style=\"color:black;font-weight:bold;\">ON</span> (cs_bill_hdemo_sk = hd_demo_sk)\n    <span style=\"color:black;font-weight:bold;\">JOIN</span> date_dim d1 <span style=\"color:black;font-weight:bold;\">ON</span> (cs_sold_date_sk = d1.d_date_sk)\n    <span style=\"color:black;font-weight:bold;\">JOIN</span> date_dim d2 <span style=\"color:black;font-weight:bold;\">ON</span> (inv_date_sk = d2.d_date_sk)\n    <span style=\"color:black;font-weight:bold;\">JOIN</span> date_dim d3 <span style=\"color:black;font-weight:bold;\">ON</span> (cs_ship_date_sk = d3.d_date_sk)\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> promotion <span style=\"color:black;font-weight:bold;\">ON</span> (cs_promo_sk = p_promo_sk)\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> catalog_returns <span style=\"color:black;font-weight:bold;\">ON</span> (cr_item_sk = cs_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cr_order_number = cs_order_number)\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d1.d_week_seq = d2.d_week_seq\n    <span style=\"color:black;font-weight:bold;\">AND</span> inv_quantity_on_hand < cs_quantity\n    <span style=\"color:black;font-weight:bold;\">AND</span> d3.d_date > d1.d_date + 5\n    <span style=\"color:black;font-weight:bold;\">AND</span> hd_buy_potential = <span style=\"color:firebrick;\">'>10000'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> d1.d_year = 1999\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd_marital_status = <span style=\"color:firebrick;\">'D'</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_desc,\n    w_warehouse_name,\n    d1.d_week_seq\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    total_cnt <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    i_item_desc,\n    w_warehouse_name,\n    d1.d_week_seq\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ077": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_last_name,\n    c_first_name,\n    c_salutation,\n    c_preferred_cust_flag,\n    ss_ticket_number,\n    cnt\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        ss_ticket_number,\n        ss_customer_sk,\n        <span style=\"color:black;font-weight:bold;\">count</span>(*) cnt\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        store,\n        household_demographics\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        store_sales.ss_sold_date_sk = date_dim.d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_store_sk = store.s_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> date_dim.d_dom <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1 <span style=\"color:black;font-weight:bold;\">AND</span> 2\n        <span style=\"color:black;font-weight:bold;\">AND</span> (household_demographics.hd_buy_potential = <span style=\"color:firebrick;\">'Unknown'</span>\n            <span style=\"color:black;font-weight:bold;\">OR</span> household_demographics.hd_buy_potential = <span style=\"color:firebrick;\">'>10000'</span>)\n        <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count > 0\n        <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> household_demographics.hd_vehicle_count > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n            household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            <span style=\"color:black;font-weight:bold;\">NULL</span>\n        <span style=\"color:black;font-weight:bold;\">END</span> > 1\n        <span style=\"color:black;font-weight:bold;\">AND</span> date_dim.d_year <span style=\"color:black;font-weight:bold;\">IN</span> (1999, 1999 + 1, 1999 + 2)\n        <span style=\"color:black;font-weight:bold;\">AND</span> store.s_county <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Orange County'</span>, <span style=\"color:firebrick;\">'Bronx County'</span>, <span style=\"color:firebrick;\">'Franklin Parish'</span>, <span style=\"color:firebrick;\">'Williamson County'</span>)\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        ss_ticket_number,\n        ss_customer_sk) dj,\n    customer\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ss_customer_sk = c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cnt <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1 <span style=\"color:black;font-weight:bold;\">AND</span> 5\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    cnt <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    c_last_name <span style=\"color:black;font-weight:bold;\">ASC</span>;\n\n</pre>\n\t\t", "DSQ078": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> year_total <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_customer_id customer_id,\n        c_first_name customer_first_name,\n        c_last_name customer_last_name,\n        d_year <span style=\"color:black;font-weight:bold;\">AS</span> year_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_paid) year_total,\n        <span style=\"color:firebrick;\">'s'</span> sale_type\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        customer,\n        store_sales,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        c_customer_sk = ss_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_year <span style=\"color:black;font-weight:bold;\">IN</span> (2001,\n            2001 + 1)\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        d_year\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        c_customer_id customer_id,\n        c_first_name customer_first_name,\n        c_last_name customer_last_name,\n        d_year <span style=\"color:black;font-weight:bold;\">AS</span> year_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_net_paid) year_total,\n        <span style=\"color:firebrick;\">'w'</span> sale_type\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        customer,\n        web_sales,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        c_customer_sk = ws_bill_customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_year <span style=\"color:black;font-weight:bold;\">IN</span> (2001,\n            2001 + 1)\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        d_year\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    t_s_secyear.customer_id,\n    t_s_secyear.customer_first_name,\n    t_s_secyear.customer_last_name\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    year_total t_s_firstyear,\n    year_total t_s_secyear,\n    year_total t_w_firstyear,\n    year_total t_w_secyear\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    t_s_secyear.customer_id = t_s_firstyear.customer_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.customer_id = t_w_secyear.customer_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.customer_id = t_w_firstyear.customer_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.sale_type = <span style=\"color:firebrick;\">'s'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_firstyear.sale_type = <span style=\"color:firebrick;\">'w'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_secyear.sale_type = <span style=\"color:firebrick;\">'s'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_secyear.sale_type = <span style=\"color:firebrick;\">'w'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.year_ = 2001\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_secyear.year_ = 2001 + 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_firstyear.year_ = 2001\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_secyear.year_ = 2001 + 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_s_firstyear.year_total > 0\n    <span style=\"color:black;font-weight:bold;\">AND</span> t_w_firstyear.year_total > 0\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> t_w_firstyear.year_total > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n        t_w_secyear.year_total / t_w_firstyear.year_total\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span> > <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> t_s_firstyear.year_total > 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n        t_s_secyear.year_total / t_s_firstyear.year_total\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span>\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    1\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ079": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> all_sales <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        d_year,\n        i_brand_id,\n        i_class_id,\n        i_category_id,\n        i_manufact_id,\n        <span style=\"color:black;font-weight:bold;\">SUM</span>(sales_cnt) <span style=\"color:black;font-weight:bold;\">AS</span> sales_cnt,\n        <span style=\"color:black;font-weight:bold;\">SUM</span>(sales_amt) <span style=\"color:black;font-weight:bold;\">AS</span> sales_amt\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            d_year,\n            i_brand_id,\n            i_class_id,\n            i_category_id,\n            i_manufact_id,\n            cs_quantity - COALESCE(cr_return_quantity,\n                0) <span style=\"color:black;font-weight:bold;\">AS</span> sales_cnt,\n            cs_ext_sales_price - COALESCE(cr_return_amount,\n                0.0) <span style=\"color:black;font-weight:bold;\">AS</span> sales_amt\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            catalog_sales\n            <span style=\"color:black;font-weight:bold;\">JOIN</span> item <span style=\"color:black;font-weight:bold;\">ON</span> i_item_sk = cs_item_sk\n            <span style=\"color:black;font-weight:bold;\">JOIN</span> date_dim <span style=\"color:black;font-weight:bold;\">ON</span> d_date_sk = cs_sold_date_sk\n            <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> catalog_returns <span style=\"color:black;font-weight:bold;\">ON</span> (cs_order_number = cr_order_number\n                    <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = cr_item_sk)\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            i_category = <span style=\"color:firebrick;\">'Books'</span>\n        <span style=\"color:black;font-weight:bold;\">UNION</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            d_year,\n            i_brand_id,\n            i_class_id,\n            i_category_id,\n            i_manufact_id,\n            ss_quantity - COALESCE(sr_return_quantity,\n                0) <span style=\"color:black;font-weight:bold;\">AS</span> sales_cnt,\n            ss_ext_sales_price - COALESCE(sr_return_amt,\n                0.0) <span style=\"color:black;font-weight:bold;\">AS</span> sales_amt\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales\n            <span style=\"color:black;font-weight:bold;\">JOIN</span> item <span style=\"color:black;font-weight:bold;\">ON</span> i_item_sk = ss_item_sk\n            <span style=\"color:black;font-weight:bold;\">JOIN</span> date_dim <span style=\"color:black;font-weight:bold;\">ON</span> d_date_sk = ss_sold_date_sk\n            <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> store_returns <span style=\"color:black;font-weight:bold;\">ON</span> (ss_ticket_number = sr_ticket_number\n                    <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = sr_item_sk)\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            i_category = <span style=\"color:firebrick;\">'Books'</span>\n        <span style=\"color:black;font-weight:bold;\">UNION</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            d_year,\n            i_brand_id,\n            i_class_id,\n            i_category_id,\n            i_manufact_id,\n            ws_quantity - COALESCE(wr_return_quantity,\n                0) <span style=\"color:black;font-weight:bold;\">AS</span> sales_cnt,\n            ws_ext_sales_price - COALESCE(wr_return_amt,\n                0.0) <span style=\"color:black;font-weight:bold;\">AS</span> sales_amt\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_sales\n            <span style=\"color:black;font-weight:bold;\">JOIN</span> item <span style=\"color:black;font-weight:bold;\">ON</span> i_item_sk = ws_item_sk\n            <span style=\"color:black;font-weight:bold;\">JOIN</span> date_dim <span style=\"color:black;font-weight:bold;\">ON</span> d_date_sk = ws_sold_date_sk\n            <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> web_returns <span style=\"color:black;font-weight:bold;\">ON</span> (ws_order_number = wr_order_number\n                    <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk = wr_item_sk)\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            i_category = <span style=\"color:firebrick;\">'Books'</span>) sales_detail\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        d_year,\n        i_brand_id,\n        i_class_id,\n        i_category_id,\n        i_manufact_id\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    prev_yr.d_year <span style=\"color:black;font-weight:bold;\">AS</span> prev_year,\n    curr_yr.d_year <span style=\"color:black;font-weight:bold;\">AS</span> year_,\n    curr_yr.i_brand_id,\n    curr_yr.i_class_id,\n    curr_yr.i_category_id,\n    curr_yr.i_manufact_id,\n    prev_yr.sales_cnt <span style=\"color:black;font-weight:bold;\">AS</span> prev_yr_cnt,\n    curr_yr.sales_cnt <span style=\"color:black;font-weight:bold;\">AS</span> curr_yr_cnt,\n    curr_yr.sales_cnt - prev_yr.sales_cnt <span style=\"color:black;font-weight:bold;\">AS</span> sales_cnt_diff,\n    curr_yr.sales_amt - prev_yr.sales_amt <span style=\"color:black;font-weight:bold;\">AS</span> sales_amt_diff\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    all_sales curr_yr,\n    all_sales prev_yr\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    curr_yr.i_brand_id = prev_yr.i_brand_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> curr_yr.i_class_id = prev_yr.i_class_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> curr_yr.i_category_id = prev_yr.i_category_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> curr_yr.i_manufact_id = prev_yr.i_manufact_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> curr_yr.d_year = 2002\n    <span style=\"color:black;font-weight:bold;\">AND</span> prev_yr.d_year = 2002 - 1\n    <span style=\"color:black;font-weight:bold;\">AND</span> CAST(curr_yr.sales_cnt <span style=\"color:black;font-weight:bold;\">AS</span> DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt <span style=\"color:black;font-weight:bold;\">AS</span> DECIMAL(17, 2)) < 0.9\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    sales_cnt_diff,\n    sales_amt_diff\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ080": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    channel,\n    col_name,\n    d_year,\n    d_qoy,\n    i_category,\n    COUNT(*) sales_cnt,\n    <span style=\"color:black;font-weight:bold;\">SUM</span>(ext_sales_price) sales_amt\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:firebrick;\">'store'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n        <span style=\"color:firebrick;\">'ss_store_sk'</span> col_name,\n        d_year,\n        d_qoy,\n        i_category,\n        ss_ext_sales_price ext_sales_price\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        item,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_store_sk IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:firebrick;\">'web'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n        <span style=\"color:firebrick;\">'ws_ship_customer_sk'</span> col_name,\n        d_year,\n        d_qoy,\n        i_category,\n        ws_ext_sales_price ext_sales_price\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales,\n        item,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ws_ship_customer_sk IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:firebrick;\">'catalog'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n        <span style=\"color:firebrick;\">'cs_ship_addr_sk'</span> col_name,\n        d_year,\n        d_qoy,\n        i_category,\n        cs_ext_sales_price ext_sales_price\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales,\n        item,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        cs_ship_addr_sk IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = i_item_sk) foo\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    channel,\n    col_name,\n    d_year,\n    d_qoy,\n    i_category\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    channel,\n    col_name,\n    d_year,\n    d_qoy,\n    i_category\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ081": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> ss <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        s_store_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_profit) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        store\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-08-23'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-09-22'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        s_store_sk\n),\nsr <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        s_store_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sr_return_amt) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sr_net_loss) <span style=\"color:black;font-weight:bold;\">AS</span> profit_loss\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_returns,\n        date_dim,\n        store\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        sr_returned_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-08-23'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-09-22'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> sr_store_sk = s_store_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        s_store_sk\n),\ncs <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        cs_call_center_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_net_profit) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        cs_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-08-23'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-09-22'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        cs_call_center_sk\n),\ncr <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        cr_call_center_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cr_return_amount) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cr_net_loss) <span style=\"color:black;font-weight:bold;\">AS</span> profit_loss\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_returns,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        cr_returned_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-08-23'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-09-22'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        cr_call_center_sk\n),\nws <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        wp_web_page_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_net_profit) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales,\n        date_dim,\n        web_page\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ws_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-08-23'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-09-22'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_web_page_sk = wp_web_page_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        wp_web_page_sk\n),\nwr <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        wp_web_page_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(wr_return_amt) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(wr_net_loss) <span style=\"color:black;font-weight:bold;\">AS</span> profit_loss\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_returns,\n        date_dim,\n        web_page\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        wr_returned_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-08-23'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-09-22'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n        <span style=\"color:black;font-weight:bold;\">AND</span> wr_web_page_sk = wp_web_page_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        wp_web_page_sk\n),\nresults <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sales) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(returns_) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(profit) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:firebrick;\">'store channel'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n            ss.s_store_sk <span style=\"color:black;font-weight:bold;\">AS</span> id,\n            sales,\n            coalesce(returns_,\n                0) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n            (profit - coalesce(profit_loss,\n                    0)) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            ss\n        <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> sr <span style=\"color:black;font-weight:bold;\">ON</span> ss.s_store_sk = sr.s_store_sk\n<span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:firebrick;\">'catalog channel'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n    cs_call_center_sk <span style=\"color:black;font-weight:bold;\">AS</span> id,\n    sales,\n    returns_,\n    (profit - profit_loss) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cs,\n    cr\n<span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:firebrick;\">'web channel'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n    ws.wp_web_page_sk <span style=\"color:black;font-weight:bold;\">AS</span> id,\n    sales,\n    coalesce(returns_,\n        0) returns_,\n    (profit - coalesce(profit_loss,\n            0)) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    ws\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> wr <span style=\"color:black;font-weight:bold;\">ON</span> ws.wp_web_page_sk = wr.wp_web_page_sk) x\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    channel,\n    id\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        id,\n        sales,\n        returns_,\n        profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sales) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(returns_) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(profit) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        channel\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sales) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(returns_) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(profit) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results) foo\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    channel,\n    id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ082": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> ws <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        d_year <span style=\"color:black;font-weight:bold;\">AS</span> ws_sold_year,\n        ws_item_sk,\n        ws_bill_customer_sk ws_customer_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_quantity) ws_qty,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_wholesale_cost) ws_wc,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_sales_price) ws_sp\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> web_returns <span style=\"color:black;font-weight:bold;\">ON</span> wr_order_number = ws_order_number\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk = wr_item_sk\n    <span style=\"color:black;font-weight:bold;\">JOIN</span> date_dim <span style=\"color:black;font-weight:bold;\">ON</span> ws_sold_date_sk = d_date_sk\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    wr_order_number IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    d_year,\n    ws_item_sk,\n    ws_bill_customer_sk\n),\ncs <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        d_year <span style=\"color:black;font-weight:bold;\">AS</span> cs_sold_year,\n        cs_item_sk,\n        cs_bill_customer_sk cs_customer_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_quantity) cs_qty,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_wholesale_cost) cs_wc,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_sales_price) cs_sp\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> catalog_returns <span style=\"color:black;font-weight:bold;\">ON</span> cr_order_number = cs_order_number\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = cr_item_sk\n    <span style=\"color:black;font-weight:bold;\">JOIN</span> date_dim <span style=\"color:black;font-weight:bold;\">ON</span> cs_sold_date_sk = d_date_sk\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cr_order_number IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    d_year,\n    cs_item_sk,\n    cs_bill_customer_sk\n),\nss <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        d_year <span style=\"color:black;font-weight:bold;\">AS</span> ss_sold_year,\n        ss_item_sk,\n        ss_customer_sk,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_quantity) ss_qty,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_wholesale_cost) ss_wc,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_sales_price) ss_sp\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> store_returns <span style=\"color:black;font-weight:bold;\">ON</span> sr_ticket_number = ss_ticket_number\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = sr_item_sk\n    <span style=\"color:black;font-weight:bold;\">JOIN</span> date_dim <span style=\"color:black;font-weight:bold;\">ON</span> ss_sold_date_sk = d_date_sk\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    sr_ticket_number IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    d_year,\n    ss_item_sk,\n    ss_customer_sk\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    ss_sold_year,\n    ss_item_sk,\n    ss_customer_sk,\n    round((ss_qty * 1.00) / (coalesce(ws_qty, 0) + coalesce(cs_qty, 0)), 2) ratio,\n    ss_qty store_qty,\n    ss_wc store_wholesale_cost,\n    ss_sp store_sales_price,\n    coalesce(ws_qty, 0) + coalesce(cs_qty, 0) other_chan_qty,\n    coalesce(ws_wc, 0) + coalesce(cs_wc, 0) other_chan_wholesale_cost,\n    coalesce(ws_sp, 0) + coalesce(cs_sp, 0) other_chan_sales_price\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    ss\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> ws <span style=\"color:black;font-weight:bold;\">ON</span> (ws_sold_year = ss_sold_year\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk = ss_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_customer_sk = ss_customer_sk)\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> cs <span style=\"color:black;font-weight:bold;\">ON</span> (cs_sold_year = ss_sold_year\n            <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = ss_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> cs_customer_sk = ss_customer_sk)\n<span style=\"color:black;font-weight:bold;\">WHERE</span> (coalesce(ws_qty, 0) > 0\n    <span style=\"color:black;font-weight:bold;\">OR</span> coalesce(cs_qty, 0) > 0)\n<span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_year = 2000\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ss_sold_year,\n    ss_item_sk,\n    ss_customer_sk,\n    ss_qty <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    ss_wc <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    ss_sp <span style=\"color:black;font-weight:bold;\">DESC</span>,\n    other_chan_qty,\n    other_chan_wholesale_cost,\n    other_chan_sales_price,\n    ratio\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ083": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_last_name,\n    c_first_name,\n    <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(s_city, 1, 30),\n    ss_ticket_number,\n    amt,\n    profit\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        ss_ticket_number,\n        ss_customer_sk,\n        store.s_city,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_coupon_amt) amt,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_profit) profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim,\n        store,\n        household_demographics\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        store_sales.ss_sold_date_sk = date_dim.d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_store_sk = store.s_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> (household_demographics.hd_dep_count = 6\n            <span style=\"color:black;font-weight:bold;\">OR</span> household_demographics.hd_vehicle_count > 2)\n        <span style=\"color:black;font-weight:bold;\">AND</span> date_dim.d_dow = 1\n        <span style=\"color:black;font-weight:bold;\">AND</span> date_dim.d_year <span style=\"color:black;font-weight:bold;\">IN</span> (1999, 1999 + 1, 1999 + 2)\n        <span style=\"color:black;font-weight:bold;\">AND</span> store.s_number_employees <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 200 <span style=\"color:black;font-weight:bold;\">AND</span> 295\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        ss_ticket_number,\n        ss_customer_sk,\n        ss_addr_sk,\n        store.s_city) ms,\n    customer\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ss_customer_sk = c_customer_sk\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_last_name,\n    c_first_name,\n    <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(s_city, 1, 30),\n    profit\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ084": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> ssr <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        s_store_id <span style=\"color:black;font-weight:bold;\">AS</span> store_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(sr_return_amt,\n                0)) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_net_profit - coalesce(sr_net_loss,\n                0)) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> store_returns <span style=\"color:black;font-weight:bold;\">ON</span> (ss_item_sk = sr_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_ticket_number = sr_ticket_number),\n    date_dim,\n    store,\n    item,\n    promotion\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ss_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-08-23'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-09-22'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_current_price > 50\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_promo_sk = p_promo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> p_channel_tv = <span style=\"color:firebrick;\">'N'</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    s_store_id\n),\ncsr <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        cp_catalog_page_id <span style=\"color:black;font-weight:bold;\">AS</span> catalog_page_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(cr_return_amount,\n                0)) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cs_net_profit - coalesce(cr_net_loss,\n                0)) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> catalog_returns <span style=\"color:black;font-weight:bold;\">ON</span> (cs_item_sk = cr_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> cs_order_number = cr_order_number),\n    date_dim,\n    catalog_page,\n    item,\n    promotion\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cs_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-08-23'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-09-22'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_catalog_page_sk = cp_catalog_page_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_current_price > 50\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_promo_sk = p_promo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> p_channel_tv = <span style=\"color:firebrick;\">'N'</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    cp_catalog_page_id\n),\nwsr <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        web_site_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(coalesce(wr_return_amt,\n                0)) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_net_profit - coalesce(wr_net_loss,\n                0)) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> web_returns <span style=\"color:black;font-weight:bold;\">ON</span> (ws_item_sk = wr_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_order_number = wr_order_number),\n    date_dim,\n    web_site,\n    item,\n    promotion\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ws_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-08-23'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-09-22'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_web_site_sk = web_site_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_current_price > 50\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_promo_sk = p_promo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> p_channel_tv = <span style=\"color:firebrick;\">'N'</span>\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    web_site_id\n),\nresults <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sales) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(returns_) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(profit) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:firebrick;\">'store channel'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n            concat(<span style=\"color:firebrick;\">'store'</span>,\n                store_id) <span style=\"color:black;font-weight:bold;\">AS</span> id,\n            sales,\n            returns_,\n            profit\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            ssr\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:firebrick;\">'catalog channel'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n            concat(<span style=\"color:firebrick;\">'catalog_page'</span>,\n                catalog_page_id) <span style=\"color:black;font-weight:bold;\">AS</span> id,\n            sales,\n            returns_,\n            profit\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            csr\n        <span style=\"color:black;font-weight:bold;\">UNION</span> <span style=\"color:black;font-weight:bold;\">ALL</span>\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:firebrick;\">'web channel'</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n            concat(<span style=\"color:firebrick;\">'web_site'</span>,\n                web_site_id) <span style=\"color:black;font-weight:bold;\">AS</span> id,\n            sales,\n            returns_,\n            profit\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            wsr) x\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        channel,\n        id\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    channel,\n    id,\n    sales,\n    returns_,\n    profit\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        id,\n        sales,\n        returns_,\n        profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        channel,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sales) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(returns_) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(profit) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        channel\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> channel,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sales) <span style=\"color:black;font-weight:bold;\">AS</span> sales,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(returns_) <span style=\"color:black;font-weight:bold;\">AS</span> returns_,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(profit) <span style=\"color:black;font-weight:bold;\">AS</span> profit\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results) foo\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    channel,\n    id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ085": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> customer_total_return <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        cr_returning_customer_sk <span style=\"color:black;font-weight:bold;\">AS</span> ctr_customer_sk,\n        ca_state <span style=\"color:black;font-weight:bold;\">AS</span> ctr_state,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cr_return_amt_inc_tax) <span style=\"color:black;font-weight:bold;\">AS</span> ctr_total_return\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_returns,\n        date_dim,\n        customer_address\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        cr_returned_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2000\n        <span style=\"color:black;font-weight:bold;\">AND</span> cr_returning_addr_sk = ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        cr_returning_customer_sk,\n        ca_state\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_customer_id,\n    c_salutation,\n    c_first_name,\n    c_last_name,\n    ca_street_number,\n    ca_street_name,\n    ca_street_type,\n    ca_suite_number,\n    ca_city,\n    ca_county,\n    ca_state,\n    ca_zip,\n    ca_country,\n    ca_gmt_offset,\n    ca_location_type,\n    ctr_total_return\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    customer_total_return ctr1,\n    customer_address,\n    customer\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ctr1.ctr_total_return > (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">avg</span>(ctr_total_return) * 1.2\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            customer_total_return ctr2\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ctr1.ctr_state = ctr2.ctr_state)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ca_address_sk = c_current_addr_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ca_state = <span style=\"color:firebrick;\">'GA'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ctr1.ctr_customer_sk = c_customer_sk\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_customer_id,\n    c_salutation,\n    c_first_name,\n    c_last_name,\n    ca_street_number,\n    ca_street_name,\n    ca_street_type,\n    ca_suite_number,\n    ca_city,\n    ca_county,\n    ca_state,\n    ca_zip,\n    ca_country,\n    ca_gmt_offset,\n    ca_location_type,\n    ctr_total_return\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ086": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id,\n    i_item_desc,\n    i_current_price\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    item,\n    inventory,\n    date_dim,\n    store_sales\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    i_current_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 62 <span style=\"color:black;font-weight:bold;\">AND</span> 62 + 30\n    <span style=\"color:black;font-weight:bold;\">AND</span> inv_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date_sk = inv_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-05-25'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-07-24'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_manufact_id <span style=\"color:black;font-weight:bold;\">IN</span> (129,\n        270,\n        821,\n        423)\n    <span style=\"color:black;font-weight:bold;\">AND</span> inv_quantity_on_hand <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 100 <span style=\"color:black;font-weight:bold;\">AND</span> 500\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_item_sk = i_item_sk\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id,\n    i_item_desc,\n    i_current_price\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ087": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> sr_items <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id item_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(sr_return_quantity) sr_item_qty\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_returns,\n        item,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        sr_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                d_date\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                date_dim\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                d_week_seq <span style=\"color:black;font-weight:bold;\">IN</span> (\n                    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                        d_week_seq\n                    <span style=\"color:black;font-weight:bold;\">FROM</span>\n                        date_dim\n                    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                        d_date <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'2000-06-30'</span>,\n                            <span style=\"color:firebrick;\">'2000-09-27'</span>,\n                            <span style=\"color:firebrick;\">'2000-11-17'</span>)))\n                <span style=\"color:black;font-weight:bold;\">AND</span> sr_returned_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                i_item_id\n),\ncr_items <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id item_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(cr_return_quantity) cr_item_qty\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_returns,\n        item,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        cr_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                d_date\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                date_dim\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                d_week_seq <span style=\"color:black;font-weight:bold;\">IN</span> (\n                    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                        d_week_seq\n                    <span style=\"color:black;font-weight:bold;\">FROM</span>\n                        date_dim\n                    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                        d_date <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'2000-06-30'</span>,\n                            <span style=\"color:firebrick;\">'2000-09-27'</span>,\n                            <span style=\"color:firebrick;\">'2000-11-17'</span>)))\n                <span style=\"color:black;font-weight:bold;\">AND</span> cr_returned_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                i_item_id\n),\nwr_items <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_item_id item_id,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(wr_return_quantity) wr_item_qty\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_returns,\n        item,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        wr_item_sk = i_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">IN</span> (\n            <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                d_date\n            <span style=\"color:black;font-weight:bold;\">FROM</span>\n                date_dim\n            <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                d_week_seq <span style=\"color:black;font-weight:bold;\">IN</span> (\n                    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n                        d_week_seq\n                    <span style=\"color:black;font-weight:bold;\">FROM</span>\n                        date_dim\n                    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n                        d_date <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'2000-06-30'</span>,\n                            <span style=\"color:firebrick;\">'2000-09-27'</span>,\n                            <span style=\"color:firebrick;\">'2000-11-17'</span>)))\n                <span style=\"color:black;font-weight:bold;\">AND</span> wr_returned_date_sk = d_date_sk\n            <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n                i_item_id\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    sr_items.item_id,\n    sr_item_qty,\n    (sr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 sr_dev,\ncr_item_qty,\n(cr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 cr_dev,\nwr_item_qty,\n(wr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 wr_dev,\n(sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 average\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    sr_items,\n    cr_items,\n    wr_items\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    sr_items.item_id = cr_items.item_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> sr_items.item_id = wr_items.item_id\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    sr_items.item_id,\n    sr_item_qty\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ088": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    c_customer_id <span style=\"color:black;font-weight:bold;\">AS</span> customer_id,\n    concat(concat(coalesce(c_last_name, '<span style=\"color:firebrick;\">'), '</span>, <span style=\"color:firebrick;\">'), coalesce(c_first_name, '</span><span style=\"color:firebrick;\">')) AS customername\nFROM\n    customer,\n    customer_address,\n    customer_demographics,\n    household_demographics,\n    income_band,\n    store_returns\nWHERE\n    ca_city = '</span>Edgewood'\n    <span style=\"color:black;font-weight:bold;\">AND</span> c_current_addr_sk = ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ib_lower_bound >= 38128\n    <span style=\"color:black;font-weight:bold;\">AND</span> ib_upper_bound <= 38128 + 50000\n    <span style=\"color:black;font-weight:bold;\">AND</span> ib_income_band_sk = hd_income_band_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd_demo_sk = c_current_cdemo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> hd_demo_sk = c_current_hdemo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> sr_cdemo_sk = cd_demo_sk\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    c_customer_id\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ089": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(r_reason_desc, 1, 20),\n    <span style=\"color:black;font-weight:bold;\">avg</span>(ws_quantity),\n    <span style=\"color:black;font-weight:bold;\">avg</span>(wr_refunded_cash),\n    <span style=\"color:black;font-weight:bold;\">avg</span>(wr_fee)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    web_sales,\n    web_returns,\n    web_page,\n    customer_demographics cd1,\n    customer_demographics cd2,\n    customer_address,\n    date_dim,\n    reason\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ws_web_page_sk = wp_web_page_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_item_sk = wr_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_order_number = wr_order_number\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd1.cd_demo_sk = wr_refunded_cdemo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd2.cd_demo_sk = wr_returning_cdemo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ca_address_sk = wr_refunded_addr_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> r_reason_sk = wr_reason_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ((cd1.cd_marital_status = <span style=\"color:firebrick;\">'M'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd1.cd_marital_status = cd2.cd_marital_status\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd1.cd_education_status = <span style=\"color:firebrick;\">'Advanced Degree'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd1.cd_education_status = cd2.cd_education_status\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_sales_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 100.00\n            <span style=\"color:black;font-weight:bold;\">AND</span> 150.00)\n        <span style=\"color:black;font-weight:bold;\">OR</span> (cd1.cd_marital_status = <span style=\"color:firebrick;\">'S'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd1.cd_marital_status = cd2.cd_marital_status\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd1.cd_education_status = <span style=\"color:firebrick;\">'College'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd1.cd_education_status = cd2.cd_education_status\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_sales_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 50.00\n            <span style=\"color:black;font-weight:bold;\">AND</span> 100.00)\n        <span style=\"color:black;font-weight:bold;\">OR</span> (cd1.cd_marital_status = <span style=\"color:firebrick;\">'W'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd1.cd_marital_status = cd2.cd_marital_status\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd1.cd_education_status = <span style=\"color:firebrick;\">'2 yr Degree'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd1.cd_education_status = cd2.cd_education_status\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_sales_price <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 150.00\n            <span style=\"color:black;font-weight:bold;\">AND</span> 200.00))\n    <span style=\"color:black;font-weight:bold;\">AND</span> ((ca_country = <span style=\"color:firebrick;\">'United States'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_state <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'IN'</span>,\n                <span style=\"color:firebrick;\">'OH'</span>,\n                <span style=\"color:firebrick;\">'NJ'</span>)\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_net_profit <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 100 <span style=\"color:black;font-weight:bold;\">AND</span> 200)\n        <span style=\"color:black;font-weight:bold;\">OR</span> (ca_country = <span style=\"color:firebrick;\">'United States'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_state <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'WI'</span>,\n                <span style=\"color:firebrick;\">'CT'</span>,\n                <span style=\"color:firebrick;\">'KY'</span>)\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_net_profit <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 150 <span style=\"color:black;font-weight:bold;\">AND</span> 300)\n        <span style=\"color:black;font-weight:bold;\">OR</span> (ca_country = <span style=\"color:firebrick;\">'United States'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> ca_state <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'LA'</span>,\n                <span style=\"color:firebrick;\">'IA'</span>,\n                <span style=\"color:firebrick;\">'AR'</span>)\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_net_profit <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 50 <span style=\"color:black;font-weight:bold;\">AND</span> 250))\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    r_reason_desc\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(r_reason_desc, 1, 20),\n    <span style=\"color:black;font-weight:bold;\">avg</span>(ws_quantity),\n    <span style=\"color:black;font-weight:bold;\">avg</span>(wr_refunded_cash),\n    <span style=\"color:black;font-weight:bold;\">avg</span>(wr_fee)\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ090": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> results <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ws_net_paid) <span style=\"color:black;font-weight:bold;\">AS</span> total_sum,\n        i_category,\n        i_class,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> g_category,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> g_class\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales,\n        date_dim d1,\n        item\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        d1.d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11\n        <span style=\"color:black;font-weight:bold;\">AND</span> d1.d_date_sk = ws_sold_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> i_item_sk = ws_item_sk\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_category,\n        i_class\n),\nresults_rollup <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        total_sum,\n        i_category,\n        i_class,\n        g_category,\n        g_class,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> lochierarchy\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">sum</span>(total_sum) <span style=\"color:black;font-weight:bold;\">AS</span> total_sum,\n        i_category,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_class,\n        0 <span style=\"color:black;font-weight:bold;\">AS</span> g_category,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> g_class,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> lochierarchy\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        i_category\n    <span style=\"color:black;font-weight:bold;\">UNION</span>\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">sum</span>(total_sum) <span style=\"color:black;font-weight:bold;\">AS</span> total_sum,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_category,\n        <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">AS</span> i_class,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> g_category,\n        1 <span style=\"color:black;font-weight:bold;\">AS</span> g_class,\n        2 <span style=\"color:black;font-weight:bold;\">AS</span> lochierarchy\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    total_sum,\n    i_category,\n    i_class,\n    lochierarchy,\n    rank() OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> lochierarchy, <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> g_class = 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n            i_category\n        <span style=\"color:black;font-weight:bold;\">END</span> <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span> total_sum <span style=\"color:black;font-weight:bold;\">DESC</span>) <span style=\"color:black;font-weight:bold;\">AS</span> rank_within_parent\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        results_rollup\n    <span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        lochierarchy <span style=\"color:black;font-weight:bold;\">DESC</span>,\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> lochierarchy = 0 <span style=\"color:black;font-weight:bold;\">THEN</span>\n            i_category\n        <span style=\"color:black;font-weight:bold;\">END</span>,\n        rank_within_parent\n    <span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ091": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">count</span>(*)\n<span style=\"color:black;font-weight:bold;\">FROM</span> (( <span style=\"color:black;font-weight:bold;\">SELECT</span> <span style=\"color:black;font-weight:bold;\">DISTINCT</span>\n            c_last_name,\n            c_first_name,\n            d_date\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            date_dim,\n            customer\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            store_sales.ss_sold_date_sk = date_dim.d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> store_sales.ss_customer_sk = customer.c_customer_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11)\n    <span style=\"color:black;font-weight:bold;\">EXCEPT</span> ( <span style=\"color:black;font-weight:bold;\">SELECT</span> <span style=\"color:black;font-weight:bold;\">DISTINCT</span>\n            c_last_name,\n            c_first_name,\n            d_date\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            catalog_sales,\n            date_dim,\n            customer\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11)\n    <span style=\"color:black;font-weight:bold;\">EXCEPT</span> ( <span style=\"color:black;font-weight:bold;\">SELECT</span> <span style=\"color:black;font-weight:bold;\">DISTINCT</span>\n            c_last_name,\n            c_first_name,\n            d_date\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_sales,\n            date_dim,\n            customer\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            web_sales.ws_sold_date_sk = date_dim.d_date_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> web_sales.ws_bill_customer_sk = customer.c_customer_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11)) cool_cust;\n\n</pre>\n\t\t", "DSQ092": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">count</span>(*) h8_30_to_9\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        household_demographics,\n        time_dim,\n        store\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_sold_time_sk = time_dim.t_time_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_hdemo_sk = household_demographics.hd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_hour = 8\n        <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_minute >= 30\n        <span style=\"color:black;font-weight:bold;\">AND</span> ((household_demographics.hd_dep_count = 4\n                <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 4 + 2)\n            <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 2\n                <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 2 + 2)\n            <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 0\n                <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 0 + 2))\n        <span style=\"color:black;font-weight:bold;\">AND</span> store.s_store_name = <span style=\"color:firebrick;\">'ese'</span>) s1,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*) h9_to_9_30\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            household_demographics,\n            time_dim,\n            store\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_sold_time_sk = time_dim.t_time_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_hdemo_sk = household_demographics.hd_demo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_hour = 9\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_minute < 30\n            <span style=\"color:black;font-weight:bold;\">AND</span> ((household_demographics.hd_dep_count = 4\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 4 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 2\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 2 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 0\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 0 + 2))\n            <span style=\"color:black;font-weight:bold;\">AND</span> store.s_store_name = <span style=\"color:firebrick;\">'ese'</span>) s2,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*) h9_30_to_10\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            household_demographics,\n            time_dim,\n            store\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_sold_time_sk = time_dim.t_time_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_hdemo_sk = household_demographics.hd_demo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_hour = 9\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_minute >= 30\n            <span style=\"color:black;font-weight:bold;\">AND</span> ((household_demographics.hd_dep_count = 4\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 4 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 2\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 2 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 0\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 0 + 2))\n            <span style=\"color:black;font-weight:bold;\">AND</span> store.s_store_name = <span style=\"color:firebrick;\">'ese'</span>) s3,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*) h10_to_10_30\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            household_demographics,\n            time_dim,\n            store\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_sold_time_sk = time_dim.t_time_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_hdemo_sk = household_demographics.hd_demo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_hour = 10\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_minute < 30\n            <span style=\"color:black;font-weight:bold;\">AND</span> ((household_demographics.hd_dep_count = 4\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 4 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 2\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 2 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 0\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 0 + 2))\n            <span style=\"color:black;font-weight:bold;\">AND</span> store.s_store_name = <span style=\"color:firebrick;\">'ese'</span>) s4,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*) h10_30_to_11\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            household_demographics,\n            time_dim,\n            store\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_sold_time_sk = time_dim.t_time_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_hdemo_sk = household_demographics.hd_demo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_hour = 10\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_minute >= 30\n            <span style=\"color:black;font-weight:bold;\">AND</span> ((household_demographics.hd_dep_count = 4\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 4 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 2\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 2 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 0\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 0 + 2))\n            <span style=\"color:black;font-weight:bold;\">AND</span> store.s_store_name = <span style=\"color:firebrick;\">'ese'</span>) s5,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*) h11_to_11_30\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            household_demographics,\n            time_dim,\n            store\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_sold_time_sk = time_dim.t_time_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_hdemo_sk = household_demographics.hd_demo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_hour = 11\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_minute < 30\n            <span style=\"color:black;font-weight:bold;\">AND</span> ((household_demographics.hd_dep_count = 4\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 4 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 2\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 2 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 0\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 0 + 2))\n            <span style=\"color:black;font-weight:bold;\">AND</span> store.s_store_name = <span style=\"color:firebrick;\">'ese'</span>) s6,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*) h11_30_to_12\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            household_demographics,\n            time_dim,\n            store\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_sold_time_sk = time_dim.t_time_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_hdemo_sk = household_demographics.hd_demo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_hour = 11\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_minute >= 30\n            <span style=\"color:black;font-weight:bold;\">AND</span> ((household_demographics.hd_dep_count = 4\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 4 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 2\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 2 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 0\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 0 + 2))\n            <span style=\"color:black;font-weight:bold;\">AND</span> store.s_store_name = <span style=\"color:firebrick;\">'ese'</span>) s7,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*) h12_to_12_30\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            store_sales,\n            household_demographics,\n            time_dim,\n            store\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ss_sold_time_sk = time_dim.t_time_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_hdemo_sk = household_demographics.hd_demo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_hour = 12\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_minute < 30\n            <span style=\"color:black;font-weight:bold;\">AND</span> ((household_demographics.hd_dep_count = 4\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 4 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 2\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 2 + 2)\n                <span style=\"color:black;font-weight:bold;\">OR</span> (household_demographics.hd_dep_count = 0\n                    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_vehicle_count <= 0 + 2))\n            <span style=\"color:black;font-weight:bold;\">AND</span> store.s_store_name = <span style=\"color:firebrick;\">'ese'</span>) s8;\n\n</pre>\n\t\t", "DSQ093": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        i_category,\n        i_class,\n        i_brand,\n        s_store_name,\n        s_company_name,\n        d_moy,\n        <span style=\"color:black;font-weight:bold;\">sum</span>(ss_sales_price) sum_sales,\n        <span style=\"color:black;font-weight:bold;\">avg</span>(<span style=\"color:black;font-weight:bold;\">sum</span>(ss_sales_price)) OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span> item,\n    store_sales,\n    date_dim,\n    store\n<span style=\"color:black;font-weight:bold;\">WHERE</span> ss_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1999\n    <span style=\"color:black;font-weight:bold;\">AND</span> ((i_category <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Books'</span>, <span style=\"color:firebrick;\">'Electronics'</span>, <span style=\"color:firebrick;\">'Sports'</span>)\n<span style=\"color:black;font-weight:bold;\">AND</span> i_class <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'computers'</span>, <span style=\"color:firebrick;\">'stereo'</span>, <span style=\"color:firebrick;\">'football'</span>))\n    <span style=\"color:black;font-weight:bold;\">OR</span> (i_category <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Men'</span>, <span style=\"color:firebrick;\">'Jewelry'</span>, <span style=\"color:firebrick;\">'Women'</span>)\n<span style=\"color:black;font-weight:bold;\">AND</span> i_class <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'shirts'</span>, <span style=\"color:firebrick;\">'birdal'</span>, <span style=\"color:firebrick;\">'dresses'</span>)))\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_category,\n    i_class,\n    i_brand,\n    s_store_name,\n    s_company_name,\n    d_moy) tmp1\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (avg_monthly_sales <> 0) <span style=\"color:black;font-weight:bold;\">THEN</span>\n    (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales)\n<span style=\"color:black;font-weight:bold;\">ELSE</span>\n    <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">END</span> > 0.1\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    sum_sales - avg_monthly_sales,\n    s_store_name\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ094": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">cast</span>(amc <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4)) / <span style=\"color:black;font-weight:bold;\">cast</span>(pmc <span style=\"color:black;font-weight:bold;\">AS</span> decimal(15, 4)) am_pm_ratio\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        <span style=\"color:black;font-weight:bold;\">count</span>(*) amc\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales,\n        household_demographics,\n        time_dim,\n        web_page\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ws_sold_time_sk = time_dim.t_time_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws_web_page_sk = web_page.wp_web_page_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_hour <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 8 <span style=\"color:black;font-weight:bold;\">AND</span> 8 + 1\n        <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_dep_count = 6\n        <span style=\"color:black;font-weight:bold;\">AND</span> web_page.wp_char_count <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 5000 <span style=\"color:black;font-weight:bold;\">AND</span> 5200) AT,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">count</span>(*) pmc\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_sales,\n            household_demographics,\n            time_dim,\n            web_page\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ws_sold_time_sk = time_dim.t_time_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws_web_page_sk = web_page.wp_web_page_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_hour <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 19 <span style=\"color:black;font-weight:bold;\">AND</span> 19 + 1\n            <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_dep_count = 6\n            <span style=\"color:black;font-weight:bold;\">AND</span> web_page.wp_char_count <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 5000 <span style=\"color:black;font-weight:bold;\">AND</span> 5200) pt\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    am_pm_ratio\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ095": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, <span style=\"color:black;font-weight:bold;\">sum</span>(cr_net_loss) Returns_Loss\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cr_call_center_sk = cc_call_center_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cr_returned_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cr_returning_customer_sk = c_customer_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cd_demo_sk = c_current_cdemo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> hd_demo_sk = c_current_hdemo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ca_address_sk = c_current_addr_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_year = 1998\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_moy = 11\n    <span style=\"color:black;font-weight:bold;\">AND</span> ((cd_marital_status = <span style=\"color:firebrick;\">'M'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_education_status = <span style=\"color:firebrick;\">'Unknown'</span>)\n        <span style=\"color:black;font-weight:bold;\">OR</span> (cd_marital_status = <span style=\"color:firebrick;\">'W'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> cd_education_status = <span style=\"color:firebrick;\">'Advanced Degree'</span>))\n    <span style=\"color:black;font-weight:bold;\">AND</span> hd_buy_potential <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Unknown%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ca_gmt_offset = - 7\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(cr_net_loss)\n    <span style=\"color:black;font-weight:bold;\">DESC</span>;\n\n</pre>\n\t\t", "DSQ096": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_discount_amt) <span style=\"color:black;font-weight:bold;\">AS</span> \"Excess Discount Amount\"\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    web_sales,\n    item,\n    date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    i_manufact_id = 350\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_item_sk = ws_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:firebrick;\">'2000-01-27'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-04-26'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date_sk = ws_sold_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws_ext_discount_amt > (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            1.3 * <span style=\"color:black;font-weight:bold;\">avg</span>(ws_ext_discount_amt)\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_sales,\n            date_dim\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ws_item_sk = i_item_sk\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:firebrick;\">'2000-01-27'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'2000-04-26'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n            <span style=\"color:black;font-weight:bold;\">AND</span> d_date_sk = ws_sold_date_sk)\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_discount_amt)\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ097": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    ss_customer_sk,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(act_sales) sumsales\n<span style=\"color:black;font-weight:bold;\">FROM</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        ss_item_sk,\n        ss_ticket_number,\n        ss_customer_sk,\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> sr_return_quantity IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">THEN</span>\n        (ss_quantity - sr_return_quantity) * ss_sales_price\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        (ss_quantity * ss_sales_price)\n        <span style=\"color:black;font-weight:bold;\">END</span> act_sales\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales\n    <span style=\"color:black;font-weight:bold;\">LEFT</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> store_returns <span style=\"color:black;font-weight:bold;\">ON</span> (sr_item_sk = ss_item_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> sr_ticket_number = ss_ticket_number),\n    reason\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    sr_reason_sk = r_reason_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> r_reason_desc = <span style=\"color:firebrick;\">'reason 28'</span>) t\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    ss_customer_sk\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    sumsales,\n    ss_customer_sk\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ098": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">count</span>(<span style=\"color:black;font-weight:bold;\">DISTINCT</span> ws_order_number) <span style=\"color:black;font-weight:bold;\">AS</span> \"order <span style=\"color:black;font-weight:bold;\">count</span>\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_ship_cost) <span style=\"color:black;font-weight:bold;\">AS</span> \"total shipping cost\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ws_net_profit) <span style=\"color:black;font-weight:bold;\">AS</span> \"total net profit\"\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    web_sales ws1,\n    date_dim,\n    customer_address,\n    web_site\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:firebrick;\">'1999-02-01'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1999-04-02'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws1.ws_ship_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws1.ws_ship_addr_sk = ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ca_state = <span style=\"color:firebrick;\">'IL'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws1.ws_web_site_sk = web_site_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> web_company_name = <span style=\"color:firebrick;\">'pri'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            *\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_sales ws2\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ws1.ws_order_number = ws2.ws_order_number\n            <span style=\"color:black;font-weight:bold;\">AND</span> ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">EXISTS</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            *\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_returns wr1\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            ws1.ws_order_number = wr1.wr_order_number)\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    <span style=\"color:black;font-weight:bold;\">count</span>(<span style=\"color:black;font-weight:bold;\">DISTINCT</span> ws_order_number)\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ099": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> ws_wh <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        ws1.ws_order_number,\n        ws1.ws_warehouse_sk wh1,\n        ws2.ws_warehouse_sk wh2\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        web_sales ws1,\n        web_sales ws2\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ws1.ws_order_number = ws2.ws_order_number\n        <span style=\"color:black;font-weight:bold;\">AND</span> ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">count</span>(<span style=\"color:black;font-weight:bold;\">DISTINCT</span> ws_order_number) <span style=\"color:black;font-weight:bold;\">AS</span> \"order <span style=\"color:black;font-weight:bold;\">count</span>\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ws_ext_ship_cost) <span style=\"color:black;font-weight:bold;\">AS</span> \"total shipping cost\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ws_net_profit) <span style=\"color:black;font-weight:bold;\">AS</span> \"total net profit\"\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    web_sales ws1,\n    date_dim,\n    customer_address,\n    web_site\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:firebrick;\">'1999-02-01'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1999-04-02'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws1.ws_ship_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws1.ws_ship_addr_sk = ca_address_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ca_state = <span style=\"color:firebrick;\">'IL'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws1.ws_web_site_sk = web_site_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> web_company_name = <span style=\"color:firebrick;\">'pri'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws1.ws_order_number <span style=\"color:black;font-weight:bold;\">IN</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            ws_order_number\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            ws_wh)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ws1.ws_order_number <span style=\"color:black;font-weight:bold;\">IN</span> (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            wr_order_number\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            web_returns,\n            ws_wh\n        <span style=\"color:black;font-weight:bold;\">WHERE</span>\n            wr_order_number = ws_wh.ws_order_number)\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    <span style=\"color:black;font-weight:bold;\">count</span>(<span style=\"color:black;font-weight:bold;\">DISTINCT</span> ws_order_number)\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ100": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">count</span>(*)\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    store_sales,\n    household_demographics,\n    time_dim,\n    store\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ss_sold_time_sk = time_dim.t_time_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_hdemo_sk = household_demographics.hd_demo_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_store_sk = s_store_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_hour = 20\n    <span style=\"color:black;font-weight:bold;\">AND</span> time_dim.t_minute >= 30\n    <span style=\"color:black;font-weight:bold;\">AND</span> household_demographics.hd_dep_count = 7\n    <span style=\"color:black;font-weight:bold;\">AND</span> store.s_store_name = <span style=\"color:firebrick;\">'ese'</span>\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    <span style=\"color:black;font-weight:bold;\">count</span>(*)\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ101": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">WITH</span> ssci <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        ss_customer_sk customer_sk,\n        ss_item_sk item_sk\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        store_sales,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        ss_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        ss_customer_sk,\n        ss_item_sk\n),\ncsci <span style=\"color:black;font-weight:bold;\">AS</span> (\n    <span style=\"color:black;font-weight:bold;\">SELECT</span>\n        cs_bill_customer_sk customer_sk,\n        cs_item_sk item_sk\n    <span style=\"color:black;font-weight:bold;\">FROM</span>\n        catalog_sales,\n        date_dim\n    <span style=\"color:black;font-weight:bold;\">WHERE</span>\n        cs_sold_date_sk = d_date_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11\n    <span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n        cs_bill_customer_sk,\n        cs_item_sk\n)\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> ssci.customer_sk IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> csci.customer_sk IS <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) store_only,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> ssci.customer_sk IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> csci.customer_sk IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) catalog_only,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> ssci.customer_sk IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> csci.customer_sk IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span> <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) store_and_catalog\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    ssci\n    <span style=\"color:black;font-weight:bold;\">FULL</span> <span style=\"color:black;font-weight:bold;\">OUTER</span> <span style=\"color:black;font-weight:bold;\">JOIN</span> csci <span style=\"color:black;font-weight:bold;\">ON</span> (ssci.customer_sk = csci.customer_sk\n        <span style=\"color:black;font-weight:bold;\">AND</span> ssci.item_sk = csci.item_sk)\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "DSQ102": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) <span style=\"color:black;font-weight:bold;\">AS</span> itemrevenue,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(ss_ext_sales_price) * 100.0000 / <span style=\"color:black;font-weight:bold;\">sum</span>(sum(ss_ext_sales_price)) OVER (<span style=\"color:black;font-weight:bold;\">PARTITION</span> <span style=\"color:black;font-weight:bold;\">BY</span> i_class) <span style=\"color:black;font-weight:bold;\">AS</span> revenueratio\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    store_sales,\n    item,\n    date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ss_item_sk = i_item_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> i_category <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sports'</span>, <span style=\"color:firebrick;\">'Books'</span>, <span style=\"color:firebrick;\">'Home'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ss_sold_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> d_date <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1999-02-22'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:black;font-weight:bold;\">cast</span>(<span style=\"color:firebrick;\">'1999-03-24'</span> <span style=\"color:black;font-weight:bold;\">AS</span> date)\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    i_category,\n    i_class,\n    i_item_id,\n    i_item_desc,\n    revenueratio;\n\n</pre>\n\t\t", "DSQ103": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    w_substr,\n    sm_type,\n    cc_name,\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (cs_ship_date_sk - cs_sold_date_sk <= 30) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \"30 days\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (cs_ship_date_sk - cs_sold_date_sk > 30)\n            <span style=\"color:black;font-weight:bold;\">AND</span> (cs_ship_date_sk - cs_sold_date_sk <= 60) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \"31-60 days\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (cs_ship_date_sk - cs_sold_date_sk > 60)\n            <span style=\"color:black;font-weight:bold;\">AND</span> (cs_ship_date_sk - cs_sold_date_sk <= 90) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \"61-90 days\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (cs_ship_date_sk - cs_sold_date_sk > 90)\n            <span style=\"color:black;font-weight:bold;\">AND</span> (cs_ship_date_sk - cs_sold_date_sk <= 120) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \"91-120 days\",\n    <span style=\"color:black;font-weight:bold;\">sum</span>(\n        <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> (cs_ship_date_sk - cs_sold_date_sk > 120) <span style=\"color:black;font-weight:bold;\">THEN</span>\n            1\n        <span style=\"color:black;font-weight:bold;\">ELSE</span>\n            0\n        <span style=\"color:black;font-weight:bold;\">END</span>) <span style=\"color:black;font-weight:bold;\">AS</span> \">120 days\"\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    catalog_sales,\n    (\n        <span style=\"color:black;font-weight:bold;\">SELECT</span>\n            <span style=\"color:black;font-weight:bold;\">SUBSTRING</span>(w_warehouse_name, 1, 20) w_substr,\n            *\n        <span style=\"color:black;font-weight:bold;\">FROM</span>\n            warehouse) <span style=\"color:black;font-weight:bold;\">AS</span> sq1,\n    ship_mode,\n    call_center, date_dim\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    d_month_seq <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1200 <span style=\"color:black;font-weight:bold;\">AND</span> 1200 + 11\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_ship_date_sk = d_date_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_warehouse_sk = w_warehouse_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_ship_mode_sk = sm_ship_mode_sk\n    <span style=\"color:black;font-weight:bold;\">AND</span> cs_call_center_sk = cc_call_center_sk\n<span style=\"color:black;font-weight:bold;\">GROUP</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    w_substr, sm_type, cc_name\n<span style=\"color:black;font-weight:bold;\">ORDER</span> <span style=\"color:black;font-weight:bold;\">BY</span>\n    w_substr, sm_type, cc_name\n<span style=\"color:black;font-weight:bold;\">LIMIT</span> 100;\n\n</pre>\n\t\t", "IndexCreationBaseline": "<h1>Description</h1><p></p>", "BulkDelete": "<h1>Description</h1><p>BulkDelete - [bulkupdate]\nRun a bulk delete followed by an aggregate</p>", "IndexCreationUniformRandomData": "<h1>Description</h1><p></p>", "Append100KIntegersINSERTAutoCommitDisk": "<h1>Description</h1><p></p>", "PointQueryWithIndex": "<h1>Description</h1><p></p>", "RangeQueryWithIndex": "<h1>Description</h1><p></p>", "RangeQueryWithIndexBaseline": "<h1>Description</h1><p></p>", "BulkUpdate": "<h1>Description</h1><p>BulkUpdate - [bulkupdate]\nRun a bulk update followed by an aggregate</p>", "PointQueryWithIndexBaseline": "<h1>Description</h1><p></p>", "IMDBQ005": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[de]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ006": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[nl]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ007": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[sm]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ008": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ009": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%sequel%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>, <span style=\"color:firebrick;\">'Norway'</span>, <span style=\"color:firebrick;\">'Germany'</span>, <span style=\"color:firebrick;\">'Denmark'</span>, <span style=\"color:firebrick;\">'Swedish'</span>, <span style=\"color:firebrick;\">'Denish'</span>, <span style=\"color:firebrick;\">'Norwegian'</span>, <span style=\"color:firebrick;\">'German'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2005\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id;\n\n</pre>\n\t\t", "IMDBQ010": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%sequel%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Bulgaria'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id;\n\n</pre>\n\t\t", "IMDBQ011": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%sequel%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>, <span style=\"color:firebrick;\">'Norway'</span>, <span style=\"color:firebrick;\">'Germany'</span>, <span style=\"color:firebrick;\">'Denmark'</span>, <span style=\"color:firebrick;\">'Swedish'</span>, <span style=\"color:firebrick;\">'Denish'</span>, <span style=\"color:firebrick;\">'Norwegian'</span>, <span style=\"color:firebrick;\">'German'</span>, <span style=\"color:firebrick;\">'USA'</span>, <span style=\"color:firebrick;\">'American'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 1990\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id;\n\n</pre>\n\t\t", "IMDBQ012": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    it.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%sequel%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info > <span style=\"color:firebrick;\">'5.0'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2005\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ013": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    it.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%sequel%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info > <span style=\"color:firebrick;\">'9.0'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ014": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    it.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%sequel%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info > <span style=\"color:firebrick;\">'2.0'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 1990\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ015": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> typical_european_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(theatrical)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(France)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>, <span style=\"color:firebrick;\">'Norway'</span>, <span style=\"color:firebrick;\">'Germany'</span>, <span style=\"color:firebrick;\">'Denmark'</span>, <span style=\"color:firebrick;\">'Swedish'</span>, <span style=\"color:firebrick;\">'Denish'</span>, <span style=\"color:firebrick;\">'Norwegian'</span>, <span style=\"color:firebrick;\">'German'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2005\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi.info_type_id;\n\n</pre>\n\t\t", "IMDBQ016": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> american_vhs_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(VHS)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(1994)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'USA'</span>, <span style=\"color:firebrick;\">'America'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi.info_type_id;\n\n</pre>\n\t\t", "IMDBQ017": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> american_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(TV)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>, <span style=\"color:firebrick;\">'Norway'</span>, <span style=\"color:firebrick;\">'Germany'</span>, <span style=\"color:firebrick;\">'Denmark'</span>, <span style=\"color:firebrick;\">'Swedish'</span>, <span style=\"color:firebrick;\">'Denish'</span>, <span style=\"color:firebrick;\">'Norwegian'</span>, <span style=\"color:firebrick;\">'German'</span>, <span style=\"color:firebrick;\">'USA'</span>, <span style=\"color:firebrick;\">'American'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 1990\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi.info_type_id;\n\n</pre>\n\t\t", "IMDBQ018": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(k.keyword) <span style=\"color:black;font-weight:bold;\">AS</span> movie_keyword,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> actor_name,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> marvel_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword = <span style=\"color:firebrick;\">'marvel-cinematic-universe'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Downey%Robert%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id;\n\n</pre>\n\t\t", "IMDBQ019": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(k.keyword) <span style=\"color:black;font-weight:bold;\">AS</span> movie_keyword,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> actor_name,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> hero_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'superhero'</span>, <span style=\"color:firebrick;\">'sequel'</span>, <span style=\"color:firebrick;\">'second-part'</span>, <span style=\"color:firebrick;\">'marvel-comics'</span>, <span style=\"color:firebrick;\">'based-on-comic'</span>, <span style=\"color:firebrick;\">'tv-special'</span>, <span style=\"color:firebrick;\">'fight'</span>, <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Downey%Robert%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2014\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id;\n\n</pre>\n\t\t", "IMDBQ020": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(k.keyword) <span style=\"color:black;font-weight:bold;\">AS</span> movie_keyword,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> actor_name,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> marvel_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword = <span style=\"color:firebrick;\">'marvel-cinematic-universe'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Downey%Robert%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2014\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id;\n\n</pre>\n\t\t", "IMDBQ021": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(k.keyword) <span style=\"color:black;font-weight:bold;\">AS</span> movie_keyword,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> actor_name,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> hero_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'superhero'</span>, <span style=\"color:firebrick;\">'sequel'</span>, <span style=\"color:firebrick;\">'second-part'</span>, <span style=\"color:firebrick;\">'marvel-comics'</span>, <span style=\"color:firebrick;\">'based-on-comic'</span>, <span style=\"color:firebrick;\">'tv-special'</span>, <span style=\"color:firebrick;\">'fight'</span>, <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Downey%Robert%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id;\n\n</pre>\n\t\t", "IMDBQ022": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(k.keyword) <span style=\"color:black;font-weight:bold;\">AS</span> movie_keyword,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> actor_name,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> marvel_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword = <span style=\"color:firebrick;\">'marvel-cinematic-universe'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Downey%Robert%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id;\n\n</pre>\n\t\t", "IMDBQ023": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(k.keyword) <span style=\"color:black;font-weight:bold;\">AS</span> movie_keyword,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> actor_name,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> hero_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'superhero'</span>, <span style=\"color:firebrick;\">'sequel'</span>, <span style=\"color:firebrick;\">'second-part'</span>, <span style=\"color:firebrick;\">'marvel-comics'</span>, <span style=\"color:firebrick;\">'based-on-comic'</span>, <span style=\"color:firebrick;\">'tv-special'</span>, <span style=\"color:firebrick;\">'fight'</span>, <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id;\n\n</pre>\n\t\t", "IMDBQ024": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> of_person,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> biography_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    person_info <span style=\"color:black;font-weight:bold;\">AS</span> pi,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    an.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%a%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'mini biography'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link = <span style=\"color:firebrick;\">'features'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name_pcode_cf <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:firebrick;\">'A'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:firebrick;\">'F'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (n.gender = <span style=\"color:firebrick;\">'m'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> (n.gender = <span style=\"color:firebrick;\">'f'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'B%'</span>))\n    <span style=\"color:black;font-weight:bold;\">AND</span> pi.note = <span style=\"color:firebrick;\">'Volker Boehm'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1980 <span style=\"color:black;font-weight:bold;\">AND</span> 1995\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = pi.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = n.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.linked_movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = pi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> pi.person_id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> pi.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = ml.linked_movie_id;\n\n</pre>\n\t\t", "IMDBQ025": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> of_person,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> biography_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    person_info <span style=\"color:black;font-weight:bold;\">AS</span> pi,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    an.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%a%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'mini biography'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link = <span style=\"color:firebrick;\">'features'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name_pcode_cf <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'D%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'m'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> pi.note = <span style=\"color:firebrick;\">'Volker Boehm'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1980 <span style=\"color:black;font-weight:bold;\">AND</span> 1984\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = pi.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = n.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.linked_movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = pi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> pi.person_id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> pi.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = ml.linked_movie_id;\n\n</pre>\n\t\t", "IMDBQ026": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> cast_member_name,\n    MIN(pi.info) <span style=\"color:black;font-weight:bold;\">AS</span> cast_member_info\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    person_info <span style=\"color:black;font-weight:bold;\">AS</span> pi,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    an.name IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (an.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%a%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> an.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'A%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'mini biography'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'references'</span>,\n        <span style=\"color:firebrick;\">'referenced in'</span>,\n        <span style=\"color:firebrick;\">'features'</span>,\n        <span style=\"color:firebrick;\">'featured in'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name_pcode_cf <span style=\"color:black;font-weight:bold;\">BETWEEN</span> <span style=\"color:firebrick;\">'A'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> <span style=\"color:firebrick;\">'F'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (n.gender = <span style=\"color:firebrick;\">'m'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> (n.gender = <span style=\"color:firebrick;\">'f'</span>\n            <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'A%'</span>))\n    <span style=\"color:black;font-weight:bold;\">AND</span> pi.note IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1980 <span style=\"color:black;font-weight:bold;\">AND</span> 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = pi.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = n.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.linked_movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = pi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> pi.person_id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> pi.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = ml.linked_movie_id;\n\n</pre>\n\t\t", "IMDBQ027": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(an1.name) <span style=\"color:black;font-weight:bold;\">AS</span> actress_pseudonym,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> japanese_movie_dubbed\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an1,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n1,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note = <span style=\"color:firebrick;\">'(voice: English version)'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[jp]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(Japan)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n1.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Yo%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n1.name <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Yu%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> an1.person_id = n1.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n1.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.role_id = rt.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an1.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id;\n\n</pre>\n\t\t", "IMDBQ028": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(an.name) <span style=\"color:black;font-weight:bold;\">AS</span> acress_pseudonym,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> japanese_anime_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note = <span style=\"color:firebrick;\">'(voice: English version)'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[jp]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(Japan)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(2006)%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(2007)%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Yo%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Yu%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2006 <span style=\"color:black;font-weight:bold;\">AND</span> 2007\n    <span style=\"color:black;font-weight:bold;\">AND</span> (t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'One Piece%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Dragon Ball Z%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = n.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.role_id = rt.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id;\n\n</pre>\n\t\t", "IMDBQ029": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(a1.name) <span style=\"color:black;font-weight:bold;\">AS</span> writer_pseudo_name,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> a1,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n1,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'writer'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> a1.person_id = n1.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n1.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.role_id = rt.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> a1.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id;\n\n</pre>\n\t\t", "IMDBQ030": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(an1.name) <span style=\"color:black;font-weight:bold;\">AS</span> costume_designer_pseudo,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_with_costumes\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an1,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n1,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'costume designer'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> an1.person_id = n1.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n1.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.role_id = rt.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an1.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id;\n\n</pre>\n\t\t", "IMDBQ031": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(an.name) <span style=\"color:black;font-weight:bold;\">AS</span> alternative_name,\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> character_name,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(voice)'</span>, <span style=\"color:firebrick;\">'(voice: Japanese version)'</span>, <span style=\"color:firebrick;\">'(voice) (uncredited)'</span>, <span style=\"color:firebrick;\">'(voice: English version)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(worldwide)%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Ang%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2005 <span style=\"color:black;font-weight:bold;\">AND</span> 2015\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.role_id = rt.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = n.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = ci.person_id;\n\n</pre>\n\t\t", "IMDBQ032": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(an.name) <span style=\"color:black;font-weight:bold;\">AS</span> alternative_name,\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> voiced_character,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> voicing_actress,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> american_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note = <span style=\"color:firebrick;\">'(voice)'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(200%)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(worldwide)%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Angel%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2007 <span style=\"color:black;font-weight:bold;\">AND</span> 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.role_id = rt.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = n.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = ci.person_id;\n\n</pre>\n\t\t", "IMDBQ033": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(an.name) <span style=\"color:black;font-weight:bold;\">AS</span> alternative_name,\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> voiced_character_name,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> voicing_actress,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> american_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(voice)'</span>, <span style=\"color:firebrick;\">'(voice: Japanese version)'</span>, <span style=\"color:firebrick;\">'(voice) (uncredited)'</span>, <span style=\"color:firebrick;\">'(voice: English version)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%An%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.role_id = rt.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = n.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = ci.person_id;\n\n</pre>\n\t\t", "IMDBQ034": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(an.name) <span style=\"color:black;font-weight:bold;\">AS</span> alternative_name,\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> voiced_char_name,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> voicing_actress,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> american_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(voice)'</span>, <span style=\"color:firebrick;\">'(voice: Japanese version)'</span>, <span style=\"color:firebrick;\">'(voice) (uncredited)'</span>, <span style=\"color:firebrick;\">'(voice: English version)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.role_id = rt.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = n.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = ci.person_id;\n\n</pre>\n\t\t", "IMDBQ035": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> uncredited_voiced_character,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> russian_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(voice)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(uncredited)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[ru]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actor'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2005\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.id = ci.role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id;\n\n</pre>\n\t\t", "IMDBQ036": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> character,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> russian_mov_with_actor_producer\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(producer)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[ru]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actor'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.id = ci.role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id;\n\n</pre>\n\t\t", "IMDBQ037": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> character,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_with_american_producer\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(producer)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 1990\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.id = ci.role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id;\n\n</pre>\n\t\t", "IMDBQ038": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> from_company,\n    MIN(lt.link) <span style=\"color:black;font-weight:bold;\">AS</span> movie_link_type,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> non_polish_sequel_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code != <span style=\"color:firebrick;\">'[pl]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Film%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Warner%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'sequel'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%follow%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1950 <span style=\"color:black;font-weight:bold;\">AND</span> 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_type_id = ct.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id;\n\n</pre>\n\t\t", "IMDBQ039": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> from_company,\n    MIN(lt.link) <span style=\"color:black;font-weight:bold;\">AS</span> movie_link_type,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> sequel_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code != <span style=\"color:firebrick;\">'[pl]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Film%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Warner%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'sequel'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%follows%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year = 1998\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Money%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_type_id = ct.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id;\n\n</pre>\n\t\t", "IMDBQ040": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> from_company,\n    MIN(mc.note) <span style=\"color:black;font-weight:bold;\">AS</span> production_note,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_based_on_book\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code != <span style=\"color:firebrick;\">'[pl]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'20th Century Fox%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Twentieth Century Fox%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind != <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'sequel'</span>,\n        <span style=\"color:firebrick;\">'revenge'</span>,\n        <span style=\"color:firebrick;\">'based-on-novel'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 1950\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_type_id = ct.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id;\n\n</pre>\n\t\t", "IMDBQ041": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> from_company,\n    MIN(mc.note) <span style=\"color:black;font-weight:bold;\">AS</span> production_note,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_based_on_book\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code != <span style=\"color:firebrick;\">'[pl]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind != <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'sequel'</span>, <span style=\"color:firebrick;\">'revenge'</span>, <span style=\"color:firebrick;\">'based-on-novel'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 1950\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_type_id = ct.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id;\n\n</pre>\n\t\t", "IMDBQ042": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> movie_company,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> drama_horror_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'genres'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Drama'</span>, <span style=\"color:firebrick;\">'Horror'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info > <span style=\"color:firebrick;\">'8.0'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2005 <span style=\"color:black;font-weight:bold;\">AND</span> 2008\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info_type_id = it1.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info_type_id = it2.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id;\n\n</pre>\n\t\t", "IMDBQ043": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> budget,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> unsuccsessful_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> ct.kind = <span style=\"color:firebrick;\">'distributors'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'budget'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'bottom 10 rank'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> (t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Birdemic%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Movie%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info_type_id = it1.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info_type_id = it2.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id;\n\n</pre>\n\t\t", "IMDBQ044": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> movie_company,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> mainstream_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'genres'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Drama'</span>, <span style=\"color:firebrick;\">'Horror'</span>, <span style=\"color:firebrick;\">'Western'</span>, <span style=\"color:firebrick;\">'Family'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info > <span style=\"color:firebrick;\">'7.0'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2000 <span style=\"color:black;font-weight:bold;\">AND</span> 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info_type_id = it1.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info_type_id = it2.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id;\n\n</pre>\n\t\t", "IMDBQ045": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> release_date,\n    MIN(miidx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> german_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> miidx,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[de]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind = <span style=\"color:firebrick;\">'movie'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> miidx.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = miidx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = miidx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> miidx.movie_id = mc.movie_id;\n\n</pre>\n\t\t", "IMDBQ046": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> producing_company,\n    MIN(miidx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_about_winning\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> miidx,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind = <span style=\"color:firebrick;\">'movie'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.title != '<span style=\"color:firebrick;\">'\n    AND (t.title LIKE '</span>%Champion%<span style=\"color:firebrick;\">'\n        OR t.title LIKE '</span>%Loser%')\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> miidx.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = miidx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = miidx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> miidx.movie_id = mc.movie_id;\n\n</pre>\n\t\t", "IMDBQ047": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> producing_company,\n    MIN(miidx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_about_winning\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> miidx,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind = <span style=\"color:firebrick;\">'movie'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.title != '<span style=\"color:firebrick;\">'\n    AND (t.title LIKE '</span>Champion%<span style=\"color:firebrick;\">'\n        OR t.title LIKE '</span>Loser%')\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> miidx.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = miidx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = miidx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> miidx.movie_id = mc.movie_id;\n\n</pre>\n\t\t", "IMDBQ048": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> producing_company,\n    MIN(miidx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> miidx,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind = <span style=\"color:firebrick;\">'movie'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> miidx.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = miidx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = miidx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> miidx.movie_id = mc.movie_id;\n\n</pre>\n\t\t", "IMDBQ049": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> northern_dark_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    it1.info = <span style=\"color:firebrick;\">'countries'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>, <span style=\"color:firebrick;\">'murder-in-title'</span>, <span style=\"color:firebrick;\">'blood'</span>, <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind = <span style=\"color:firebrick;\">'movie'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>,\n        <span style=\"color:firebrick;\">'Norway'</span>,\n        <span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'Denmark'</span>,\n        <span style=\"color:firebrick;\">'Swedish'</span>,\n        <span style=\"color:firebrick;\">'Denish'</span>,\n        <span style=\"color:firebrick;\">'Norwegian'</span>,\n        <span style=\"color:firebrick;\">'German'</span>,\n        <span style=\"color:firebrick;\">'USA'</span>,\n        <span style=\"color:firebrick;\">'American'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info < <span style=\"color:firebrick;\">'8.5'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ050": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> western_dark_production\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    it1.info = <span style=\"color:firebrick;\">'countries'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>, <span style=\"color:firebrick;\">'murder-in-title'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind = <span style=\"color:firebrick;\">'movie'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>,\n        <span style=\"color:firebrick;\">'Norway'</span>,\n        <span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'Denmark'</span>,\n        <span style=\"color:firebrick;\">'Swedish'</span>,\n        <span style=\"color:firebrick;\">'Denish'</span>,\n        <span style=\"color:firebrick;\">'Norwegian'</span>,\n        <span style=\"color:firebrick;\">'German'</span>,\n        <span style=\"color:firebrick;\">'USA'</span>,\n        <span style=\"color:firebrick;\">'American'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info > <span style=\"color:firebrick;\">'6.0'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> (t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%murder%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Murder%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Mord%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ051": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> north_european_dark_production\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    it1.info = <span style=\"color:firebrick;\">'countries'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>, <span style=\"color:firebrick;\">'murder-in-title'</span>, <span style=\"color:firebrick;\">'blood'</span>, <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'movie'</span>,\n        <span style=\"color:firebrick;\">'episode'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>,\n        <span style=\"color:firebrick;\">'Norway'</span>,\n        <span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'Denmark'</span>,\n        <span style=\"color:firebrick;\">'Swedish'</span>,\n        <span style=\"color:firebrick;\">'Danish'</span>,\n        <span style=\"color:firebrick;\">'Norwegian'</span>,\n        <span style=\"color:firebrick;\">'German'</span>,\n        <span style=\"color:firebrick;\">'USA'</span>,\n        <span style=\"color:firebrick;\">'American'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info < <span style=\"color:firebrick;\">'8.5'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2005\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ052": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> release_date,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> internet_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_title <span style=\"color:black;font-weight:bold;\">AS</span> at,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(200%)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(worldwide)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%internet%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:% 200%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id;\n\n</pre>\n\t\t", "IMDBQ053": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> release_date,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> youtube_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_title <span style=\"color:black;font-weight:bold;\">AS</span> at,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.name = <span style=\"color:firebrick;\">'YouTube'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(200%)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(worldwide)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%internet%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:% 200%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2005 <span style=\"color:black;font-weight:bold;\">AND</span> 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id;\n\n</pre>\n\t\t", "IMDBQ054": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> release_date,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> modern_american_internet_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_title <span style=\"color:black;font-weight:bold;\">AS</span> at,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%internet%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:% 199%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:% 200%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 1990\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id;\n\n</pre>\n\t\t", "IMDBQ055": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(at.title) <span style=\"color:black;font-weight:bold;\">AS</span> aka_title,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> internet_movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_title <span style=\"color:black;font-weight:bold;\">AS</span> at,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%internet%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 1990\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = at.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id;\n\n</pre>\n\t\t", "IMDBQ056": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(an.name) <span style=\"color:black;font-weight:bold;\">AS</span> cool_actor_pseudonym,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> series_named_after_char\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.episode_nr >= 50\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.episode_nr < 100\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = n.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ057": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(an.name) <span style=\"color:black;font-weight:bold;\">AS</span> cool_actor_pseudonym,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> series_named_after_char\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = n.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ058": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(an.name) <span style=\"color:black;font-weight:bold;\">AS</span> cool_actor_pseudonym,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> series_named_after_char\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.episode_nr < 100\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = n.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ059": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(an.name) <span style=\"color:black;font-weight:bold;\">AS</span> cool_actor_pseudonym,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> series_named_after_char\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.episode_nr >= 5\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.episode_nr < 100\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = n.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> an.person_id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ060": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> member_in_charnamed_american_movie,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> a1\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'B%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ061": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> member_in_charnamed_movie,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> a1\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Z%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ062": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> member_in_charnamed_movie,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> a1\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'X%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ063": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> member_in_charnamed_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Bert%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ064": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> member_in_charnamed_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ065": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> member_in_charnamed_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%B%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id;\n\n</pre>\n\t\t", "IMDBQ066": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_budget,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_votes,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(producer)'</span>, <span style=\"color:firebrick;\">'(executive producer)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'budget'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'votes'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'m'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Tim%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ067": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_budget,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_votes,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(writer)'</span>, <span style=\"color:firebrick;\">'(head writer)'</span>, <span style=\"color:firebrick;\">'(written by)'</span>, <span style=\"color:firebrick;\">'(story)'</span>, <span style=\"color:firebrick;\">'(story editor)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'genres'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Horror'</span>,\n        <span style=\"color:firebrick;\">'Thriller'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.note IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info > <span style=\"color:firebrick;\">'8.0'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2008 <span style=\"color:black;font-weight:bold;\">AND</span> 2014\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ068": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_budget,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_votes,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(writer)'</span>, <span style=\"color:firebrick;\">'(head writer)'</span>, <span style=\"color:firebrick;\">'(written by)'</span>, <span style=\"color:firebrick;\">'(story)'</span>, <span style=\"color:firebrick;\">'(story editor)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'genres'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'votes'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Horror'</span>,\n        <span style=\"color:firebrick;\">'Action'</span>,\n        <span style=\"color:firebrick;\">'Sci-Fi'</span>,\n        <span style=\"color:firebrick;\">'Thriller'</span>,\n        <span style=\"color:firebrick;\">'Crime'</span>,\n        <span style=\"color:firebrick;\">'War'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'m'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ069": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> voicing_actress,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> voiced_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(voice)'</span>, <span style=\"color:firebrick;\">'(voice: Japanese version)'</span>, <span style=\"color:firebrick;\">'(voice) (uncredited)'</span>, <span style=\"color:firebrick;\">'(voice: English version)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(worldwide)%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Japan:%200%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:%200%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Ang%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2005 <span style=\"color:black;font-weight:bold;\">AND</span> 2009\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.id = ci.role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id;\n\n</pre>\n\t\t", "IMDBQ070": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> voicing_actress,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> kung_fu_panda\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note = <span style=\"color:firebrick;\">'(voice)'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(200%)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(worldwide)%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Japan:%2007%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:%2008%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Angel%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2007 <span style=\"color:black;font-weight:bold;\">AND</span> 2008\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Kung%Fu%Panda%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.id = ci.role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id;\n\n</pre>\n\t\t", "IMDBQ071": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> voicing_actress,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> jap_engl_voiced_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(voice)'</span>, <span style=\"color:firebrick;\">'(voice: Japanese version)'</span>, <span style=\"color:firebrick;\">'(voice) (uncredited)'</span>, <span style=\"color:firebrick;\">'(voice: English version)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Japan:%200%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:%200%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%An%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.id = ci.role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id;\n\n</pre>\n\t\t", "IMDBQ072": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> voicing_actress,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> jap_engl_voiced_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(voice)'</span>, <span style=\"color:firebrick;\">'(voice: Japanese version)'</span>, <span style=\"color:firebrick;\">'(voice) (uncredited)'</span>, <span style=\"color:firebrick;\">'(voice: English version)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.id = ci.role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id;\n\n</pre>\n\t\t", "IMDBQ073": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_downey_ironman_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'cast'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%complete%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.name <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Sherlock%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (chn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Tony%Stark%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> chn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Iron%Man%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'superhero'</span>,\n        <span style=\"color:firebrick;\">'sequel'</span>,\n        <span style=\"color:firebrick;\">'second-part'</span>,\n        <span style=\"color:firebrick;\">'marvel-comics'</span>,\n        <span style=\"color:firebrick;\">'based-on-comic'</span>,\n        <span style=\"color:firebrick;\">'tv-special'</span>,\n        <span style=\"color:firebrick;\">'fight'</span>,\n        <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind = <span style=\"color:firebrick;\">'movie'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 1950\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ074": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_downey_ironman_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'cast'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%complete%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.name <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Sherlock%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (chn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Tony%Stark%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> chn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Iron%Man%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'superhero'</span>,\n        <span style=\"color:firebrick;\">'sequel'</span>,\n        <span style=\"color:firebrick;\">'second-part'</span>,\n        <span style=\"color:firebrick;\">'marvel-comics'</span>,\n        <span style=\"color:firebrick;\">'based-on-comic'</span>,\n        <span style=\"color:firebrick;\">'tv-special'</span>,\n        <span style=\"color:firebrick;\">'fight'</span>,\n        <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind = <span style=\"color:firebrick;\">'movie'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Downey%Robert%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ075": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> cast_member,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_dynamic_hero_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'cast'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%complete%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.name IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (chn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%man%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> chn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Man%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'superhero'</span>,\n        <span style=\"color:firebrick;\">'marvel-comics'</span>,\n        <span style=\"color:firebrick;\">'based-on-comic'</span>,\n        <span style=\"color:firebrick;\">'tv-special'</span>,\n        <span style=\"color:firebrick;\">'fight'</span>,\n        <span style=\"color:firebrick;\">'violence'</span>,\n        <span style=\"color:firebrick;\">'magnet'</span>,\n        <span style=\"color:firebrick;\">'web'</span>,\n        <span style=\"color:firebrick;\">'claw'</span>,\n        <span style=\"color:firebrick;\">'laser'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind = <span style=\"color:firebrick;\">'movie'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ076": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> company_name,\n    MIN(lt.link) <span style=\"color:black;font-weight:bold;\">AS</span> link_type,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> western_follow_up\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code != <span style=\"color:firebrick;\">'[pl]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Film%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Warner%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'sequel'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%follow%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>,\n        <span style=\"color:firebrick;\">'Norway'</span>,\n        <span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'Denmark'</span>,\n        <span style=\"color:firebrick;\">'Swedish'</span>,\n        <span style=\"color:firebrick;\">'Denish'</span>,\n        <span style=\"color:firebrick;\">'Norwegian'</span>,\n        <span style=\"color:firebrick;\">'German'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1950 <span style=\"color:black;font-weight:bold;\">AND</span> 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_type_id = ct.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id;\n\n</pre>\n\t\t", "IMDBQ077": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> company_name,\n    MIN(lt.link) <span style=\"color:black;font-weight:bold;\">AS</span> link_type,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> german_follow_up\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code != <span style=\"color:firebrick;\">'[pl]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Film%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Warner%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'sequel'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%follow%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'German'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2000 <span style=\"color:black;font-weight:bold;\">AND</span> 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_type_id = ct.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id;\n\n</pre>\n\t\t", "IMDBQ078": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> company_name,\n    MIN(lt.link) <span style=\"color:black;font-weight:bold;\">AS</span> link_type,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> western_follow_up\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code != <span style=\"color:firebrick;\">'[pl]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Film%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Warner%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'sequel'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%follow%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>,\n        <span style=\"color:firebrick;\">'Norway'</span>,\n        <span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'Denmark'</span>,\n        <span style=\"color:firebrick;\">'Swedish'</span>,\n        <span style=\"color:firebrick;\">'Denish'</span>,\n        <span style=\"color:firebrick;\">'Norwegian'</span>,\n        <span style=\"color:firebrick;\">'German'</span>,\n        <span style=\"color:firebrick;\">'English'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1950 <span style=\"color:black;font-weight:bold;\">AND</span> 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_type_id = ct.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id;\n\n</pre>\n\t\t", "IMDBQ079": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> movie_company,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> western_violent_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code != <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'countries'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>, <span style=\"color:firebrick;\">'murder-in-title'</span>, <span style=\"color:firebrick;\">'blood'</span>, <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'movie'</span>,\n        <span style=\"color:firebrick;\">'episode'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(200%)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'German'</span>,\n        <span style=\"color:firebrick;\">'USA'</span>,\n        <span style=\"color:firebrick;\">'American'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info < <span style=\"color:firebrick;\">'7.0'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2008\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id;\n\n</pre>\n\t\t", "IMDBQ080": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> movie_company,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> western_violent_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code != <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'countries'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>, <span style=\"color:firebrick;\">'murder-in-title'</span>, <span style=\"color:firebrick;\">'blood'</span>, <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'movie'</span>,\n        <span style=\"color:firebrick;\">'episode'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(200%)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'German'</span>,\n        <span style=\"color:firebrick;\">'USA'</span>,\n        <span style=\"color:firebrick;\">'American'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info < <span style=\"color:firebrick;\">'7.0'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2009\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id;\n\n</pre>\n\t\t", "IMDBQ081": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> movie_company,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> western_violent_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code != <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'countries'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>, <span style=\"color:firebrick;\">'murder-in-title'</span>, <span style=\"color:firebrick;\">'blood'</span>, <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'movie'</span>,\n        <span style=\"color:firebrick;\">'episode'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(200%)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>,\n        <span style=\"color:firebrick;\">'Norway'</span>,\n        <span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'Denmark'</span>,\n        <span style=\"color:firebrick;\">'Swedish'</span>,\n        <span style=\"color:firebrick;\">'Danish'</span>,\n        <span style=\"color:firebrick;\">'Norwegian'</span>,\n        <span style=\"color:firebrick;\">'German'</span>,\n        <span style=\"color:firebrick;\">'USA'</span>,\n        <span style=\"color:firebrick;\">'American'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info < <span style=\"color:firebrick;\">'8.5'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2005\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id;\n\n</pre>\n\t\t", "IMDBQ082": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> movie_company,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> western_violent_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn.country_code != <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'countries'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>, <span style=\"color:firebrick;\">'murder-in-title'</span>, <span style=\"color:firebrick;\">'blood'</span>, <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'movie'</span>,\n        <span style=\"color:firebrick;\">'episode'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>,\n        <span style=\"color:firebrick;\">'Norway'</span>,\n        <span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'Denmark'</span>,\n        <span style=\"color:firebrick;\">'Swedish'</span>,\n        <span style=\"color:firebrick;\">'Danish'</span>,\n        <span style=\"color:firebrick;\">'Norwegian'</span>,\n        <span style=\"color:firebrick;\">'German'</span>,\n        <span style=\"color:firebrick;\">'USA'</span>,\n        <span style=\"color:firebrick;\">'American'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info < <span style=\"color:firebrick;\">'8.5'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2005\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id;\n\n</pre>\n\t\t", "IMDBQ083": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(kt.kind) <span style=\"color:black;font-weight:bold;\">AS</span> movie_kind,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_us_internet_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'complete+verified'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'movie'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%internet%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:% 199%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:% 200%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ084": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(kt.kind) <span style=\"color:black;font-weight:bold;\">AS</span> movie_kind,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_nerdy_internet_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'complete+verified'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'nerd'</span>, <span style=\"color:firebrick;\">'loner'</span>, <span style=\"color:firebrick;\">'alienation'</span>, <span style=\"color:firebrick;\">'dignity'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'movie'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%internet%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:% 200%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ085": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(kt.kind) <span style=\"color:black;font-weight:bold;\">AS</span> movie_kind,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_us_internet_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'complete+verified'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'movie'</span>, <span style=\"color:firebrick;\">'tv movie'</span>, <span style=\"color:firebrick;\">'video movie'</span>, <span style=\"color:firebrick;\">'video game'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%internet%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:% 199%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:% 200%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 1990\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ086": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> voiced_char_name,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> voicing_actress_name,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> voiced_action_movie_jap_eng\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(voice)'</span>, <span style=\"color:firebrick;\">'(voice: Japanese version)'</span>, <span style=\"color:firebrick;\">'(voice) (uncredited)'</span>, <span style=\"color:firebrick;\">'(voice: English version)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'hero'</span>,\n        <span style=\"color:firebrick;\">'martial-arts'</span>,\n        <span style=\"color:firebrick;\">'hand-to-hand-combat'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Japan:%201%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:%201%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%An%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.id = ci.role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id;\n\n</pre>\n\t\t", "IMDBQ087": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> voiced_char_name,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> voicing_actress_name,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> kung_fu_panda\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(voice)'</span>, <span style=\"color:firebrick;\">'(voice: Japanese version)'</span>, <span style=\"color:firebrick;\">'(voice) (uncredited)'</span>, <span style=\"color:firebrick;\">'(voice: English version)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.name = <span style=\"color:firebrick;\">'DreamWorks Animation'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'hero'</span>,\n        <span style=\"color:firebrick;\">'martial-arts'</span>,\n        <span style=\"color:firebrick;\">'hand-to-hand-combat'</span>,\n        <span style=\"color:firebrick;\">'computer-animated-movie'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Japan:%201%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:%201%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%An%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Kung Fu Panda%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.id = ci.role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id;\n\n</pre>\n\t\t", "IMDBQ088": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_budget,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_votes,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> male_writer,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> violent_movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(writer)'</span>, <span style=\"color:firebrick;\">'(head writer)'</span>, <span style=\"color:firebrick;\">'(written by)'</span>, <span style=\"color:firebrick;\">'(story)'</span>, <span style=\"color:firebrick;\">'(story editor)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'genres'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'votes'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>,\n        <span style=\"color:firebrick;\">'blood'</span>,\n        <span style=\"color:firebrick;\">'gore'</span>,\n        <span style=\"color:firebrick;\">'death'</span>,\n        <span style=\"color:firebrick;\">'female-nudity'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info = <span style=\"color:firebrick;\">'Horror'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'m'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id;\n\n</pre>\n\t\t", "IMDBQ089": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_budget,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_votes,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> male_writer,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> violent_movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(writer)'</span>, <span style=\"color:firebrick;\">'(head writer)'</span>, <span style=\"color:firebrick;\">'(written by)'</span>, <span style=\"color:firebrick;\">'(story)'</span>, <span style=\"color:firebrick;\">'(story editor)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'genres'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'votes'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>,\n        <span style=\"color:firebrick;\">'blood'</span>,\n        <span style=\"color:firebrick;\">'gore'</span>,\n        <span style=\"color:firebrick;\">'death'</span>,\n        <span style=\"color:firebrick;\">'female-nudity'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info = <span style=\"color:firebrick;\">'Horror'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'m'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Vampire%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id;\n\n</pre>\n\t\t", "IMDBQ090": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_budget,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_votes,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> male_writer,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> violent_movie_title\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(writer)'</span>, <span style=\"color:firebrick;\">'(head writer)'</span>, <span style=\"color:firebrick;\">'(written by)'</span>, <span style=\"color:firebrick;\">'(story)'</span>, <span style=\"color:firebrick;\">'(story editor)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'genres'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'votes'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>,\n        <span style=\"color:firebrick;\">'violence'</span>,\n        <span style=\"color:firebrick;\">'blood'</span>,\n        <span style=\"color:firebrick;\">'gore'</span>,\n        <span style=\"color:firebrick;\">'death'</span>,\n        <span style=\"color:firebrick;\">'female-nudity'</span>,\n        <span style=\"color:firebrick;\">'hospital'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Horror'</span>,\n        <span style=\"color:firebrick;\">'Action'</span>,\n        <span style=\"color:firebrick;\">'Sci-Fi'</span>,\n        <span style=\"color:firebrick;\">'Thriller'</span>,\n        <span style=\"color:firebrick;\">'Crime'</span>,\n        <span style=\"color:firebrick;\">'War'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'m'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id;\n\n</pre>\n\t\t", "IMDBQ091": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> character_name,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> playing_actor,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_hero_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'cast'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%complete%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.name IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (chn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%man%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> chn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Man%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'superhero'</span>,\n        <span style=\"color:firebrick;\">'marvel-comics'</span>,\n        <span style=\"color:firebrick;\">'based-on-comic'</span>,\n        <span style=\"color:firebrick;\">'tv-special'</span>,\n        <span style=\"color:firebrick;\">'fight'</span>,\n        <span style=\"color:firebrick;\">'violence'</span>,\n        <span style=\"color:firebrick;\">'magnet'</span>,\n        <span style=\"color:firebrick;\">'web'</span>,\n        <span style=\"color:firebrick;\">'claw'</span>,\n        <span style=\"color:firebrick;\">'laser'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind = <span style=\"color:firebrick;\">'movie'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info > <span style=\"color:firebrick;\">'7.0'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ092": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> character_name,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_hero_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'cast'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%complete%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.name IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (chn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%man%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> chn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Man%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'superhero'</span>,\n        <span style=\"color:firebrick;\">'marvel-comics'</span>,\n        <span style=\"color:firebrick;\">'based-on-comic'</span>,\n        <span style=\"color:firebrick;\">'fight'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind = <span style=\"color:firebrick;\">'movie'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info > <span style=\"color:firebrick;\">'8.0'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2005\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ093": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> character_name,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_hero_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'cast'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%complete%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.name IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (chn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%man%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> chn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Man%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'superhero'</span>,\n        <span style=\"color:firebrick;\">'marvel-comics'</span>,\n        <span style=\"color:firebrick;\">'based-on-comic'</span>,\n        <span style=\"color:firebrick;\">'tv-special'</span>,\n        <span style=\"color:firebrick;\">'fight'</span>,\n        <span style=\"color:firebrick;\">'violence'</span>,\n        <span style=\"color:firebrick;\">'magnet'</span>,\n        <span style=\"color:firebrick;\">'web'</span>,\n        <span style=\"color:firebrick;\">'claw'</span>,\n        <span style=\"color:firebrick;\">'laser'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind = <span style=\"color:firebrick;\">'movie'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ094": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> producing_company,\n    MIN(lt.link) <span style=\"color:black;font-weight:bold;\">AS</span> link_type,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_western_sequel\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'cast'</span>, <span style=\"color:firebrick;\">'crew'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind = <span style=\"color:firebrick;\">'complete'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code != <span style=\"color:firebrick;\">'[pl]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Film%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Warner%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'sequel'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%follow%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>,\n        <span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'Swedish'</span>,\n        <span style=\"color:firebrick;\">'German'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1950 <span style=\"color:black;font-weight:bold;\">AND</span> 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_type_id = ct.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id;\n\n</pre>\n\t\t", "IMDBQ095": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> producing_company,\n    MIN(lt.link) <span style=\"color:black;font-weight:bold;\">AS</span> link_type,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_western_sequel\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'cast'</span>, <span style=\"color:firebrick;\">'crew'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind = <span style=\"color:firebrick;\">'complete'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code != <span style=\"color:firebrick;\">'[pl]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Film%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Warner%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'sequel'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%follow%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>,\n        <span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'Swedish'</span>,\n        <span style=\"color:firebrick;\">'German'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year = 1998\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_type_id = ct.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id;\n\n</pre>\n\t\t", "IMDBQ096": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> producing_company,\n    MIN(lt.link) <span style=\"color:black;font-weight:bold;\">AS</span> link_type,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_western_sequel\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'cast'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'complete%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code != <span style=\"color:firebrick;\">'[pl]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Film%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Warner%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'sequel'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%follow%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note IS <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>,\n        <span style=\"color:firebrick;\">'Norway'</span>,\n        <span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'Denmark'</span>,\n        <span style=\"color:firebrick;\">'Swedish'</span>,\n        <span style=\"color:firebrick;\">'Denish'</span>,\n        <span style=\"color:firebrick;\">'Norwegian'</span>,\n        <span style=\"color:firebrick;\">'German'</span>,\n        <span style=\"color:firebrick;\">'English'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 1950 <span style=\"color:black;font-weight:bold;\">AND</span> 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_type_id = ct.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.company_id = cn.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = t.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id;\n\n</pre>\n\t\t", "IMDBQ097": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> movie_company,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_euro_dark_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'crew'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind != <span style=\"color:firebrick;\">'complete+verified'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code != <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'countries'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>, <span style=\"color:firebrick;\">'murder-in-title'</span>, <span style=\"color:firebrick;\">'blood'</span>, <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'movie'</span>,\n        <span style=\"color:firebrick;\">'episode'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(200%)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>,\n        <span style=\"color:firebrick;\">'Norway'</span>,\n        <span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'Denmark'</span>,\n        <span style=\"color:firebrick;\">'Swedish'</span>,\n        <span style=\"color:firebrick;\">'Danish'</span>,\n        <span style=\"color:firebrick;\">'Norwegian'</span>,\n        <span style=\"color:firebrick;\">'German'</span>,\n        <span style=\"color:firebrick;\">'USA'</span>,\n        <span style=\"color:firebrick;\">'American'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info < <span style=\"color:firebrick;\">'8.5'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ098": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> movie_company,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_euro_dark_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'crew'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind != <span style=\"color:firebrick;\">'complete+verified'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code != <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'countries'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>, <span style=\"color:firebrick;\">'murder-in-title'</span>, <span style=\"color:firebrick;\">'blood'</span>, <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'movie'</span>,\n        <span style=\"color:firebrick;\">'episode'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(200%)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>,\n        <span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'Swedish'</span>,\n        <span style=\"color:firebrick;\">'German'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info > <span style=\"color:firebrick;\">'6.5'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2005\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ099": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn.name) <span style=\"color:black;font-weight:bold;\">AS</span> movie_company,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> rating,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_euro_dark_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'cast'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind = <span style=\"color:firebrick;\">'complete'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code != <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'countries'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>, <span style=\"color:firebrick;\">'murder-in-title'</span>, <span style=\"color:firebrick;\">'blood'</span>, <span style=\"color:firebrick;\">'violence'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'movie'</span>,\n        <span style=\"color:firebrick;\">'episode'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(USA)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(200%)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Sweden'</span>,\n        <span style=\"color:firebrick;\">'Norway'</span>,\n        <span style=\"color:firebrick;\">'Germany'</span>,\n        <span style=\"color:firebrick;\">'Denmark'</span>,\n        <span style=\"color:firebrick;\">'Swedish'</span>,\n        <span style=\"color:firebrick;\">'Danish'</span>,\n        <span style=\"color:firebrick;\">'Norwegian'</span>,\n        <span style=\"color:firebrick;\">'German'</span>,\n        <span style=\"color:firebrick;\">'USA'</span>,\n        <span style=\"color:firebrick;\">'American'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.info < <span style=\"color:firebrick;\">'8.5'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2005\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt.id = t.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ100": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> voiced_char,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> voicing_actress,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> voiced_animation\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it3,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    person_info <span style=\"color:black;font-weight:bold;\">AS</span> pi,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'cast'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind = <span style=\"color:firebrick;\">'complete+verified'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.name = <span style=\"color:firebrick;\">'Queen'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(voice)'</span>, <span style=\"color:firebrick;\">'(voice) (uncredited)'</span>, <span style=\"color:firebrick;\">'(voice: English version)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it3.info = <span style=\"color:firebrick;\">'trivia'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'computer-animation'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Japan:%200%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:%200%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%An%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.title = <span style=\"color:firebrick;\">'Shrek 2'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2000 <span style=\"color:black;font-weight:bold;\">AND</span> 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.id = ci.role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = pi.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = pi.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it3.id = pi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ101": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> voiced_char,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> voicing_actress,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> voiced_animation\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it3,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    person_info <span style=\"color:black;font-weight:bold;\">AS</span> pi,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'cast'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind = <span style=\"color:firebrick;\">'complete+verified'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.name = <span style=\"color:firebrick;\">'Queen'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(voice)'</span>, <span style=\"color:firebrick;\">'(voice) (uncredited)'</span>, <span style=\"color:firebrick;\">'(voice: English version)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it3.info = <span style=\"color:firebrick;\">'height'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'computer-animation'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:%200%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%An%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.title = <span style=\"color:firebrick;\">'Shrek 2'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2000 <span style=\"color:black;font-weight:bold;\">AND</span> 2005\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.id = ci.role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = pi.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = pi.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it3.id = pi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ102": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(chn.name) <span style=\"color:black;font-weight:bold;\">AS</span> voiced_char,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> voicing_actress,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> voiced_animation\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    aka_name <span style=\"color:black;font-weight:bold;\">AS</span> an,\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    char_name <span style=\"color:black;font-weight:bold;\">AS</span> chn,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it3,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    person_info <span style=\"color:black;font-weight:bold;\">AS</span> pi,\n    role_type <span style=\"color:black;font-weight:bold;\">AS</span> rt,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'cast'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind = <span style=\"color:firebrick;\">'complete+verified'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(voice)'</span>, <span style=\"color:firebrick;\">'(voice: Japanese version)'</span>, <span style=\"color:firebrick;\">'(voice) (uncredited)'</span>, <span style=\"color:firebrick;\">'(voice: English version)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'release dates'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it3.info = <span style=\"color:firebrick;\">'trivia'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword = <span style=\"color:firebrick;\">'computer-animation'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Japan:%200%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mi.info <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'USA:%200%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'f'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%An%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.role = <span style=\"color:firebrick;\">'actress'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2000 <span style=\"color:black;font-weight:bold;\">AND</span> 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> rt.id = ci.role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = an.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> chn.id = ci.person_role_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = pi.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.person_id = pi.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it3.id = pi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ103": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_budget,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_votes,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> writer,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_violent_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'cast'</span>, <span style=\"color:firebrick;\">'crew'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind = <span style=\"color:firebrick;\">'complete+verified'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(writer)'</span>,\n        <span style=\"color:firebrick;\">'(head writer)'</span>,\n        <span style=\"color:firebrick;\">'(written by)'</span>,\n        <span style=\"color:firebrick;\">'(story)'</span>,\n        <span style=\"color:firebrick;\">'(story editor)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'genres'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'votes'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>,\n        <span style=\"color:firebrick;\">'violence'</span>,\n        <span style=\"color:firebrick;\">'blood'</span>,\n        <span style=\"color:firebrick;\">'gore'</span>,\n        <span style=\"color:firebrick;\">'death'</span>,\n        <span style=\"color:firebrick;\">'female-nudity'</span>,\n        <span style=\"color:firebrick;\">'hospital'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Horror'</span>,\n        <span style=\"color:firebrick;\">'Thriller'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'m'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ104": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_budget,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_votes,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> writer,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_gore_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'cast'</span>, <span style=\"color:firebrick;\">'crew'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind = <span style=\"color:firebrick;\">'complete+verified'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(writer)'</span>,\n        <span style=\"color:firebrick;\">'(head writer)'</span>,\n        <span style=\"color:firebrick;\">'(written by)'</span>,\n        <span style=\"color:firebrick;\">'(story)'</span>,\n        <span style=\"color:firebrick;\">'(story editor)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'genres'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'votes'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>,\n        <span style=\"color:firebrick;\">'violence'</span>,\n        <span style=\"color:firebrick;\">'blood'</span>,\n        <span style=\"color:firebrick;\">'gore'</span>,\n        <span style=\"color:firebrick;\">'death'</span>,\n        <span style=\"color:firebrick;\">'female-nudity'</span>,\n        <span style=\"color:firebrick;\">'hospital'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Horror'</span>,\n        <span style=\"color:firebrick;\">'Thriller'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'m'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> (t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Freddy%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Jason%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Saw%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ105": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_budget,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_votes,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> writer,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> complete_violent_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    complete_cast <span style=\"color:black;font-weight:bold;\">AS</span> cc,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct1,\n    comp_cast_type <span style=\"color:black;font-weight:bold;\">AS</span> cct2,\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cct1.kind = <span style=\"color:firebrick;\">'cast'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.kind = <span style=\"color:firebrick;\">'complete+verified'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(writer)'</span>, <span style=\"color:firebrick;\">'(head writer)'</span>, <span style=\"color:firebrick;\">'(written by)'</span>, <span style=\"color:firebrick;\">'(story)'</span>, <span style=\"color:firebrick;\">'(story editor)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'genres'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'votes'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>,\n        <span style=\"color:firebrick;\">'violence'</span>,\n        <span style=\"color:firebrick;\">'blood'</span>,\n        <span style=\"color:firebrick;\">'gore'</span>,\n        <span style=\"color:firebrick;\">'death'</span>,\n        <span style=\"color:firebrick;\">'female-nudity'</span>,\n        <span style=\"color:firebrick;\">'hospital'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Horror'</span>,\n        <span style=\"color:firebrick;\">'Action'</span>,\n        <span style=\"color:firebrick;\">'Sci-Fi'</span>,\n        <span style=\"color:firebrick;\">'Thriller'</span>,\n        <span style=\"color:firebrick;\">'Crime'</span>,\n        <span style=\"color:firebrick;\">'War'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'m'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = cc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct1.id = cc.subject_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cct2.id = cc.status_id;\n\n</pre>\n\t\t", "IMDBQ106": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_budget,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_votes,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> writer,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> violent_liongate_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(writer)'</span>, <span style=\"color:firebrick;\">'(head writer)'</span>, <span style=\"color:firebrick;\">'(written by)'</span>, <span style=\"color:firebrick;\">'(story)'</span>, <span style=\"color:firebrick;\">'(story editor)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Lionsgate%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'genres'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'votes'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>,\n        <span style=\"color:firebrick;\">'violence'</span>,\n        <span style=\"color:firebrick;\">'blood'</span>,\n        <span style=\"color:firebrick;\">'gore'</span>,\n        <span style=\"color:firebrick;\">'death'</span>,\n        <span style=\"color:firebrick;\">'female-nudity'</span>,\n        <span style=\"color:firebrick;\">'hospital'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Horror'</span>,\n        <span style=\"color:firebrick;\">'Thriller'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'m'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id;\n\n</pre>\n\t\t", "IMDBQ107": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_budget,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_votes,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> writer,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> violent_liongate_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(writer)'</span>, <span style=\"color:firebrick;\">'(head writer)'</span>, <span style=\"color:firebrick;\">'(written by)'</span>, <span style=\"color:firebrick;\">'(story)'</span>, <span style=\"color:firebrick;\">'(story editor)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Lionsgate%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'genres'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'votes'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>,\n        <span style=\"color:firebrick;\">'violence'</span>,\n        <span style=\"color:firebrick;\">'blood'</span>,\n        <span style=\"color:firebrick;\">'gore'</span>,\n        <span style=\"color:firebrick;\">'death'</span>,\n        <span style=\"color:firebrick;\">'female-nudity'</span>,\n        <span style=\"color:firebrick;\">'hospital'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(Blu-ray)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Horror'</span>,\n        <span style=\"color:firebrick;\">'Thriller'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.gender = <span style=\"color:firebrick;\">'m'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> (t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Freddy%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%Jason%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> t.title <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Saw%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id;\n\n</pre>\n\t\t", "IMDBQ108": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mi.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_budget,\n    MIN(mi_idx.info) <span style=\"color:black;font-weight:bold;\">AS</span> movie_votes,\n    MIN(n.name) <span style=\"color:black;font-weight:bold;\">AS</span> writer,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> violent_liongate_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    cast_info <span style=\"color:black;font-weight:bold;\">AS</span> ci,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info <span style=\"color:black;font-weight:bold;\">AS</span> mi,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    name <span style=\"color:black;font-weight:bold;\">AS</span> n,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ci.note <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'(writer)'</span>, <span style=\"color:firebrick;\">'(head writer)'</span>, <span style=\"color:firebrick;\">'(written by)'</span>, <span style=\"color:firebrick;\">'(story)'</span>, <span style=\"color:firebrick;\">'(story editor)'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.name <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'Lionsgate%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'genres'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'votes'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.keyword <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'murder'</span>,\n        <span style=\"color:firebrick;\">'violence'</span>,\n        <span style=\"color:firebrick;\">'blood'</span>,\n        <span style=\"color:firebrick;\">'gore'</span>,\n        <span style=\"color:firebrick;\">'death'</span>,\n        <span style=\"color:firebrick;\">'female-nudity'</span>,\n        <span style=\"color:firebrick;\">'hospital'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.info <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'Horror'</span>,\n        <span style=\"color:firebrick;\">'Action'</span>,\n        <span style=\"color:firebrick;\">'Sci-Fi'</span>,\n        <span style=\"color:firebrick;\">'Thriller'</span>,\n        <span style=\"color:firebrick;\">'Crime'</span>,\n        <span style=\"color:firebrick;\">'War'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = ci.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ci.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> n.id = ci.person_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> k.id = mk.keyword_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn.id = mc.company_id;\n\n</pre>\n\t\t", "IMDBQ109": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(lt.link) <span style=\"color:black;font-weight:bold;\">AS</span> link_type,\n    MIN(t1.title) <span style=\"color:black;font-weight:bold;\">AS</span> first_movie,\n    MIN(t2.title) <span style=\"color:black;font-weight:bold;\">AS</span> second_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t1,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t2\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword = <span style=\"color:firebrick;\">'10,000-mile-club'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t1.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = t1.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.linked_movie_id = t2.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = t1.id;\n\n</pre>\n\t\t", "IMDBQ110": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(lt.link) <span style=\"color:black;font-weight:bold;\">AS</span> link_type,\n    MIN(t1.title) <span style=\"color:black;font-weight:bold;\">AS</span> first_movie,\n    MIN(t2.title) <span style=\"color:black;font-weight:bold;\">AS</span> second_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    keyword <span style=\"color:black;font-weight:bold;\">AS</span> k,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_keyword <span style=\"color:black;font-weight:bold;\">AS</span> mk,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t1,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t2\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    k.keyword = <span style=\"color:firebrick;\">'character-name-in-title'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.keyword_id = k.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t1.id = mk.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = t1.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.linked_movie_id = t2.id\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mk.movie_id = t1.id;\n\n</pre>\n\t\t", "IMDBQ111": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn1.name) <span style=\"color:black;font-weight:bold;\">AS</span> first_company,\n    MIN(cn2.name) <span style=\"color:black;font-weight:bold;\">AS</span> second_company,\n    MIN(mi_idx1.info) <span style=\"color:black;font-weight:bold;\">AS</span> first_rating,\n    MIN(mi_idx2.info) <span style=\"color:black;font-weight:bold;\">AS</span> second_rating,\n    MIN(t1.title) <span style=\"color:black;font-weight:bold;\">AS</span> first_movie,\n    MIN(t2.title) <span style=\"color:black;font-weight:bold;\">AS</span> second_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn1,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn2,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt1,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt2,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc1,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc2,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx1,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx2,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t1,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t2\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn1.country_code = <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt1.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'tv series'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt2.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'tv series'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'sequel'</span>,\n        <span style=\"color:firebrick;\">'follows'</span>,\n        <span style=\"color:firebrick;\">'followed by'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx2.info < <span style=\"color:firebrick;\">'3.0'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t2.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2005 <span style=\"color:black;font-weight:bold;\">AND</span> 2008\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t1.id = ml.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t2.id = ml.linked_movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi_idx1.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t1.id = mi_idx1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt1.id = t1.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn1.id = mc1.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t1.id = mc1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mi_idx1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mc1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx1.movie_id = mc1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx2.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t2.id = mi_idx2.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt2.id = t2.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn2.id = mc2.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t2.id = mc2.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.linked_movie_id = mi_idx2.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.linked_movie_id = mc2.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx2.movie_id = mc2.movie_id;\n\n</pre>\n\t\t", "IMDBQ112": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn1.name) <span style=\"color:black;font-weight:bold;\">AS</span> first_company,\n    MIN(cn2.name) <span style=\"color:black;font-weight:bold;\">AS</span> second_company,\n    MIN(mi_idx1.info) <span style=\"color:black;font-weight:bold;\">AS</span> first_rating,\n    MIN(mi_idx2.info) <span style=\"color:black;font-weight:bold;\">AS</span> second_rating,\n    MIN(t1.title) <span style=\"color:black;font-weight:bold;\">AS</span> first_movie,\n    MIN(t2.title) <span style=\"color:black;font-weight:bold;\">AS</span> second_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn1,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn2,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt1,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt2,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc1,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc2,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx1,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx2,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t1,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t2\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn1.country_code = <span style=\"color:firebrick;\">'[nl]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt1.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'tv series'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt2.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'tv series'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%follow%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx2.info < <span style=\"color:firebrick;\">'3.0'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t2.production_year = 2007\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t1.id = ml.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t2.id = ml.linked_movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi_idx1.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t1.id = mi_idx1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt1.id = t1.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn1.id = mc1.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t1.id = mc1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mi_idx1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mc1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx1.movie_id = mc1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx2.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t2.id = mi_idx2.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt2.id = t2.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn2.id = mc2.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t2.id = mc2.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.linked_movie_id = mi_idx2.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.linked_movie_id = mc2.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx2.movie_id = mc2.movie_id;\n\n</pre>\n\t\t", "IMDBQ113": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(cn1.name) <span style=\"color:black;font-weight:bold;\">AS</span> first_company,\n    MIN(cn2.name) <span style=\"color:black;font-weight:bold;\">AS</span> second_company,\n    MIN(mi_idx1.info) <span style=\"color:black;font-weight:bold;\">AS</span> first_rating,\n    MIN(mi_idx2.info) <span style=\"color:black;font-weight:bold;\">AS</span> second_rating,\n    MIN(t1.title) <span style=\"color:black;font-weight:bold;\">AS</span> first_movie,\n    MIN(t2.title) <span style=\"color:black;font-weight:bold;\">AS</span> second_movie\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn1,\n    company_name <span style=\"color:black;font-weight:bold;\">AS</span> cn2,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it1,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it2,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt1,\n    kind_type <span style=\"color:black;font-weight:bold;\">AS</span> kt2,\n    link_type <span style=\"color:black;font-weight:bold;\">AS</span> lt,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc1,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc2,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx1,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx2,\n    movie_link <span style=\"color:black;font-weight:bold;\">AS</span> ml,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t1,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t2\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    cn1.country_code != <span style=\"color:firebrick;\">'[us]'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.info = <span style=\"color:firebrick;\">'rating'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt1.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'tv series'</span>, <span style=\"color:firebrick;\">'episode'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt2.kind <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'tv series'</span>,\n        <span style=\"color:firebrick;\">'episode'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.link <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'sequel'</span>,\n        <span style=\"color:firebrick;\">'follows'</span>,\n        <span style=\"color:firebrick;\">'followed by'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx2.info < <span style=\"color:firebrick;\">'3.5'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t2.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2000 <span style=\"color:black;font-weight:bold;\">AND</span> 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> lt.id = ml.link_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t1.id = ml.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t2.id = ml.linked_movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it1.id = mi_idx1.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t1.id = mi_idx1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt1.id = t1.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn1.id = mc1.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t1.id = mc1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mi_idx1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.movie_id = mc1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx1.movie_id = mc1.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it2.id = mi_idx2.info_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t2.id = mi_idx2.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> kt2.id = t2.kind_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> cn2.id = mc2.company_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t2.id = mc2.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.linked_movie_id = mi_idx2.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> ml.linked_movie_id = mc2.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mi_idx2.movie_id = mc2.movie_id;\n\n</pre>\n\t\t", "ExpressionReorderingH0": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_quantity <= 1 + 10;\n\n</pre>\n\t\t", "ExpressionReorderingH1": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_shipdate > date <span style=\"color:firebrick;\">'1992-01-01'</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH2": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_receiptdate >= l_commitdate;\n\n</pre>\n\t\t", "ExpressionReorderingH3": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_shipinstruct < l_comment;\n\n</pre>\n\t\t", "ExpressionReorderingH4": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_commitdate = l_receiptdate;\n\n</pre>\n\t\t", "ExpressionReorderingH5": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_orderkey != 0;\n\n</pre>\n\t\t", "ExpressionReorderingH6": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_discount = 1.0;\n\n</pre>\n\t\t", "ExpressionReorderingH7": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_returnflag = <span style=\"color:firebrick;\">'R'</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH8": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_shipinstruct != <span style=\"color:firebrick;\">'DELIVER IN PERSON'</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH9": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_returnflag IS <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">NULL</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH10": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_quantity IS <span style=\"color:black;font-weight:bold;\">NULL</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH11": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_shipinstruct <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'DE%I%ER%'</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH12": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_comment <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%str%'</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH13": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_shipinstruct SIMILAR TO <span style=\"color:firebrick;\">'DE.*I.*ER.*'</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH14": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_comment <span style=\"color:black;font-weight:bold;\">NOT</span> SIMILAR TO <span style=\"color:firebrick;\">'.*str.*'</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH15": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_shipmode <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'MAIL'</span>, <span style=\"color:firebrick;\">'SHIP'</span>);\n\n</pre>\n\t\t", "ExpressionReorderingH16": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span> (\n    <span style=\"color:black;font-weight:bold;\">CASE</span> <span style=\"color:black;font-weight:bold;\">WHEN</span> l_orderkey = 2 <span style=\"color:black;font-weight:bold;\">THEN</span>\n        1\n    <span style=\"color:black;font-weight:bold;\">ELSE</span>\n        0\n    <span style=\"color:black;font-weight:bold;\">END</span>) = 1;\n\n</pre>\n\t\t", "ExpressionReorderingH17": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_discount + l_tax;\n\n</pre>\n\t\t", "ExpressionReorderingH18": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_tax - l_discount;\n\n</pre>\n\t\t", "ExpressionReorderingH19": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_receiptdate - l_commitdate;\n\n</pre>\n\t\t", "ExpressionReorderingH20": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_discount * l_tax;\n\n</pre>\n\t\t", "ExpressionReorderingH21": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_discount / l_tax;\n\n</pre>\n\t\t", "ExpressionReorderingH22": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_orderkey % 5;\n\n</pre>\n\t\t", "ExpressionReorderingH23": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_orderkey & l_partkey;\n\n</pre>\n\t\t", "ExpressionReorderingH24": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_orderkey # l_partkey;\n\n</pre>\n\t\t", "ExpressionReorderingH25": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_orderkey >> l_partkey;\n\n</pre>\n\t\t", "ExpressionReorderingH26": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_orderkey << l_partkey;\n\n</pre>\n\t\t", "ExpressionReorderingH27": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    abs(l_extendedprice);\n\n</pre>\n\t\t", "ExpressionReorderingH28": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    round(l_discount, 1);\n\n</pre>\n\t\t", "ExpressionReorderingH29": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_shipinstruct || l_returnflag = <span style=\"color:firebrick;\">'R'</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH30": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    length(l_comment);\n\n</pre>\n\t\t", "ExpressionReorderingH31": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    lower(l_comment) = <span style=\"color:firebrick;\">'R'</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH32": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    upper(l_comment) = <span style=\"color:firebrick;\">'R'</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH33": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    substring(l_shipinstruct, 1, 7) = <span style=\"color:firebrick;\">'R'</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH34": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    date_part(<span style=\"color:firebrick;\">'year'</span>, l_commitdate);\n\n</pre>\n\t\t", "ExpressionReorderingH35": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_orderkey::VARCHAR = <span style=\"color:firebrick;\">'1'</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH36": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_orderkey::DOUBLE = 3.0;\n\n</pre>\n\t\t", "ExpressionReorderingH37": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_comment SIMILAR TO <span style=\"color:firebrick;\">'.*str.*'</span>;\n\n</pre>\n\t\t", "ExpressionReorderingH38": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    l_quantity < 10\n    <span style=\"color:black;font-weight:bold;\">OR</span> l_quantity > 20;\n\n</pre>\n\t\t", "ExpressionReorderingH39": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span> (l_quantity < 10\n    <span style=\"color:black;font-weight:bold;\">AND</span> l_shipdate > date <span style=\"color:firebrick;\">'1992-01-01'</span>)\n    <span style=\"color:black;font-weight:bold;\">OR</span> l_quantity > 20;\n\n</pre>\n\t\t", "ExpressionReorderingH40": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    EXTRACT(YEAR <span style=\"color:black;font-weight:bold;\">FROM</span> l_shipdate) = 1995;\n\n</pre>\n\t\t", "ExpressionReorderingH41": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\">pragma enable_profiling = <span style=\"color:firebrick;\">'json'</span>;\n\n<span style=\"color:black;font-weight:bold;\">SELECT</span>\n    *\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    lineitem\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    YEAR (l_shipdate)\n    <span style=\"color:black;font-weight:bold;\">IN</span> (<span style=\"color:firebrick;\">'1995'</span>,\n        <span style=\"color:firebrick;\">'1996'</span>);\n\n</pre>\n\t\t", "IMDBQ001": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mc.note) <span style=\"color:black;font-weight:bold;\">AS</span> production_note,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title,\n    MIN(t.production_year) <span style=\"color:black;font-weight:bold;\">AS</span> movie_year\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'top 250 rank'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(as Metro-Goldwyn-Mayer Pictures)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(co-production)%'</span>\n        <span style=\"color:black;font-weight:bold;\">OR</span> mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(presents)%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ002": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mc.note) <span style=\"color:black;font-weight:bold;\">AS</span> production_note,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title,\n    MIN(t.production_year) <span style=\"color:black;font-weight:bold;\">AS</span> movie_year\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'bottom 10 rank'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(as Metro-Goldwyn-Mayer Pictures)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year <span style=\"color:black;font-weight:bold;\">BETWEEN</span> 2005 <span style=\"color:black;font-weight:bold;\">AND</span> 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ003": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mc.note) <span style=\"color:black;font-weight:bold;\">AS</span> production_note,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title,\n    MIN(t.production_year) <span style=\"color:black;font-weight:bold;\">AS</span> movie_year\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'top 250 rank'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(as Metro-Goldwyn-Mayer Pictures)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> (mc.note <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(co-production)%'</span>)\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2010\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi_idx.info_type_id;\n\n</pre>\n\t\t", "IMDBQ004": "\n\t\t<h1>SQL Code</h1>\n\t\t<pre style=\"font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px\"><span style=\"color:black;font-weight:bold;\">SELECT</span>\n    MIN(mc.note) <span style=\"color:black;font-weight:bold;\">AS</span> production_note,\n    MIN(t.title) <span style=\"color:black;font-weight:bold;\">AS</span> movie_title,\n    MIN(t.production_year) <span style=\"color:black;font-weight:bold;\">AS</span> movie_year\n<span style=\"color:black;font-weight:bold;\">FROM</span>\n    company_type <span style=\"color:black;font-weight:bold;\">AS</span> ct,\n    info_type <span style=\"color:black;font-weight:bold;\">AS</span> it,\n    movie_companies <span style=\"color:black;font-weight:bold;\">AS</span> mc,\n    movie_info_idx <span style=\"color:black;font-weight:bold;\">AS</span> mi_idx,\n    title <span style=\"color:black;font-weight:bold;\">AS</span> t\n<span style=\"color:black;font-weight:bold;\">WHERE</span>\n    ct.kind = <span style=\"color:firebrick;\">'production companies'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.info = <span style=\"color:firebrick;\">'bottom 10 rank'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.note <span style=\"color:black;font-weight:bold;\">NOT</span> <span style=\"color:black;font-weight:bold;\">LIKE</span> <span style=\"color:firebrick;\">'%(as Metro-Goldwyn-Mayer Pictures)%'</span>\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.production_year > 2000\n    <span style=\"color:black;font-weight:bold;\">AND</span> ct.id = mc.company_type_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mc.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> t.id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> mc.movie_id = mi_idx.movie_id\n    <span style=\"color:black;font-weight:bold;\">AND</span> it.id = mi_idx.info_type_id;\n\n</pre>\n\t\t"}