<h1>SQL Code</h1>
		<pre style="font:courier-new;background-color:rgb(234,234,234);padding:10px;padding-left:20px"><span style="color:black;font-weight:bold;">SELECT</span>
    s_store_name,
    <span style="color:black;font-weight:bold;">sum</span>(ss_net_profit)
<span style="color:black;font-weight:bold;">FROM</span>
    store_sales,
    date_dim,
    store,
    (
        <span style="color:black;font-weight:bold;">SELECT</span>
            ca_zip
        <span style="color:black;font-weight:bold;">FROM</span> (
            <span style="color:black;font-weight:bold;">SELECT</span>
                <span style="color:black;font-weight:bold;">SUBSTRING</span>(ca_zip, 1, 5) ca_zip
            <span style="color:black;font-weight:bold;">FROM</span>
                customer_address
            <span style="color:black;font-weight:bold;">WHERE</span>
                <span style="color:black;font-weight:bold;">SUBSTRING</span>(ca_zip, 1, 5)
                <span style="color:black;font-weight:bold;">IN</span> (<span style="color:firebrick;">'24128'</span>, <span style="color:firebrick;">'76232'</span>, <span style="color:firebrick;">'65084'</span>, <span style="color:firebrick;">'87816'</span>, <span style="color:firebrick;">'83926'</span>, <span style="color:firebrick;">'77556'</span>, <span style="color:firebrick;">'20548'</span>, <span style="color:firebrick;">'26231'</span>, <span style="color:firebrick;">'43848'</span>, <span style="color:firebrick;">'15126'</span>, <span style="color:firebrick;">'91137'</span>, <span style="color:firebrick;">'61265'</span>, <span style="color:firebrick;">'98294'</span>, <span style="color:firebrick;">'25782'</span>, <span style="color:firebrick;">'17920'</span>, <span style="color:firebrick;">'18426'</span>, <span style="color:firebrick;">'98235'</span>, <span style="color:firebrick;">'40081'</span>, <span style="color:firebrick;">'84093'</span>, <span style="color:firebrick;">'28577'</span>, <span style="color:firebrick;">'55565'</span>, <span style="color:firebrick;">'17183'</span>, <span style="color:firebrick;">'54601'</span>, <span style="color:firebrick;">'67897'</span>, <span style="color:firebrick;">'22752'</span>, <span style="color:firebrick;">'86284'</span>, <span style="color:firebrick;">'18376'</span>, <span style="color:firebrick;">'38607'</span>, <span style="color:firebrick;">'45200'</span>, <span style="color:firebrick;">'21756'</span>, <span style="color:firebrick;">'29741'</span>, <span style="color:firebrick;">'96765'</span>, <span style="color:firebrick;">'23932'</span>, <span style="color:firebrick;">'89360'</span>, <span style="color:firebrick;">'29839'</span>, <span style="color:firebrick;">'25989'</span>, <span style="color:firebrick;">'28898'</span>, <span style="color:firebrick;">'91068'</span>, <span style="color:firebrick;">'72550'</span>, <span style="color:firebrick;">'10390'</span>, <span style="color:firebrick;">'18845'</span>, <span style="color:firebrick;">'47770'</span>, <span style="color:firebrick;">'82636'</span>, <span style="color:firebrick;">'41367'</span>, <span style="color:firebrick;">'76638'</span>, <span style="color:firebrick;">'86198'</span>, <span style="color:firebrick;">'81312'</span>, <span style="color:firebrick;">'37126'</span>, <span style="color:firebrick;">'39192'</span>, <span style="color:firebrick;">'88424'</span>, <span style="color:firebrick;">'72175'</span>, <span style="color:firebrick;">'81426'</span>, <span style="color:firebrick;">'53672'</span>, <span style="color:firebrick;">'10445'</span>, <span style="color:firebrick;">'42666'</span>, <span style="color:firebrick;">'66864'</span>, <span style="color:firebrick;">'66708'</span>, <span style="color:firebrick;">'41248'</span>, <span style="color:firebrick;">'48583'</span>, <span style="color:firebrick;">'82276'</span>, <span style="color:firebrick;">'18842'</span>, <span style="color:firebrick;">'78890'</span>, <span style="color:firebrick;">'49448'</span>, <span style="color:firebrick;">'14089'</span>, <span style="color:firebrick;">'38122'</span>, <span style="color:firebrick;">'34425'</span>, <span style="color:firebrick;">'79077'</span>, <span style="color:firebrick;">'19849'</span>, <span style="color:firebrick;">'43285'</span>, <span style="color:firebrick;">'39861'</span>, <span style="color:firebrick;">'66162'</span>, <span style="color:firebrick;">'77610'</span>, <span style="color:firebrick;">'13695'</span>, <span style="color:firebrick;">'99543'</span>, <span style="color:firebrick;">'83444'</span>, <span style="color:firebrick;">'83041'</span>, <span style="color:firebrick;">'12305'</span>, <span style="color:firebrick;">'57665'</span>, <span style="color:firebrick;">'68341'</span>, <span style="color:firebrick;">'25003'</span>, <span style="color:firebrick;">'57834'</span>, <span style="color:firebrick;">'62878'</span>, <span style="color:firebrick;">'49130'</span>, <span style="color:firebrick;">'81096'</span>, <span style="color:firebrick;">'18840'</span>, <span style="color:firebrick;">'27700'</span>, <span style="color:firebrick;">'23470'</span>, <span style="color:firebrick;">'50412'</span>, <span style="color:firebrick;">'21195'</span>, <span style="color:firebrick;">'16021'</span>, <span style="color:firebrick;">'76107'</span>, <span style="color:firebrick;">'71954'</span>, <span style="color:firebrick;">'68309'</span>, <span style="color:firebrick;">'18119'</span>, <span style="color:firebrick;">'98359'</span>, <span style="color:firebrick;">'64544'</span>, <span style="color:firebrick;">'10336'</span>, <span style="color:firebrick;">'86379'</span>, <span style="color:firebrick;">'27068'</span>, <span style="color:firebrick;">'39736'</span>, <span style="color:firebrick;">'98569'</span>, <span style="color:firebrick;">'28915'</span>, <span style="color:firebrick;">'24206'</span>, <span style="color:firebrick;">'56529'</span>, <span style="color:firebrick;">'57647'</span>, <span style="color:firebrick;">'54917'</span>, <span style="color:firebrick;">'42961'</span>, <span style="color:firebrick;">'91110'</span>, <span style="color:firebrick;">'63981'</span>, <span style="color:firebrick;">'14922'</span>, <span style="color:firebrick;">'36420'</span>, <span style="color:firebrick;">'23006'</span>, <span style="color:firebrick;">'67467'</span>, <span style="color:firebrick;">'32754'</span>, <span style="color:firebrick;">'30903'</span>, <span style="color:firebrick;">'20260'</span>, <span style="color:firebrick;">'31671'</span>, <span style="color:firebrick;">'51798'</span>, <span style="color:firebrick;">'72325'</span>, <span style="color:firebrick;">'85816'</span>, <span style="color:firebrick;">'68621'</span>, <span style="color:firebrick;">'13955'</span>, <span style="color:firebrick;">'36446'</span>, <span style="color:firebrick;">'41766'</span>, <span style="color:firebrick;">'68806'</span>, <span style="color:firebrick;">'16725'</span>, <span style="color:firebrick;">'15146'</span>, <span style="color:firebrick;">'22744'</span>, <span style="color:firebrick;">'35850'</span>, <span style="color:firebrick;">'88086'</span>, <span style="color:firebrick;">'51649'</span>, <span style="color:firebrick;">'18270'</span>, <span style="color:firebrick;">'52867'</span>, <span style="color:firebrick;">'39972'</span>, <span style="color:firebrick;">'96976'</span>, <span style="color:firebrick;">'63792'</span>, <span style="color:firebrick;">'11376'</span>, <span style="color:firebrick;">'94898'</span>, <span style="color:firebrick;">'13595'</span>, <span style="color:firebrick;">'10516'</span>, <span style="color:firebrick;">'90225'</span>, <span style="color:firebrick;">'58943'</span>, <span style="color:firebrick;">'39371'</span>, <span style="color:firebrick;">'94945'</span>, <span style="color:firebrick;">'28587'</span>, <span style="color:firebrick;">'96576'</span>, <span style="color:firebrick;">'57855'</span>, <span style="color:firebrick;">'28488'</span>, <span style="color:firebrick;">'26105'</span>, <span style="color:firebrick;">'83933'</span>, <span style="color:firebrick;">'25858'</span>, <span style="color:firebrick;">'34322'</span>, <span style="color:firebrick;">'44438'</span>, <span style="color:firebrick;">'73171'</span>, <span style="color:firebrick;">'30122'</span>, <span style="color:firebrick;">'34102'</span>, <span style="color:firebrick;">'22685'</span>, <span style="color:firebrick;">'71256'</span>, <span style="color:firebrick;">'78451'</span>, <span style="color:firebrick;">'54364'</span>, <span style="color:firebrick;">'13354'</span>, <span style="color:firebrick;">'45375'</span>, <span style="color:firebrick;">'40558'</span>, <span style="color:firebrick;">'56458'</span>, <span style="color:firebrick;">'28286'</span>, <span style="color:firebrick;">'45266'</span>, <span style="color:firebrick;">'47305'</span>, <span style="color:firebrick;">'69399'</span>, <span style="color:firebrick;">'83921'</span>, <span style="color:firebrick;">'26233'</span>, <span style="color:firebrick;">'11101'</span>, <span style="color:firebrick;">'15371'</span>, <span style="color:firebrick;">'69913'</span>, <span style="color:firebrick;">'35942'</span>, <span style="color:firebrick;">'15882'</span>, <span style="color:firebrick;">'25631'</span>, <span style="color:firebrick;">'24610'</span>, <span style="color:firebrick;">'44165'</span>, <span style="color:firebrick;">'99076'</span>, <span style="color:firebrick;">'33786'</span>, <span style="color:firebrick;">'70738'</span>, <span style="color:firebrick;">'26653'</span>, <span style="color:firebrick;">'14328'</span>, <span style="color:firebrick;">'72305'</span>, <span style="color:firebrick;">'62496'</span>, <span style="color:firebrick;">'22152'</span>, <span style="color:firebrick;">'10144'</span>, <span style="color:firebrick;">'64147'</span>, <span style="color:firebrick;">'48425'</span>, <span style="color:firebrick;">'14663'</span>, <span style="color:firebrick;">'21076'</span>, <span style="color:firebrick;">'18799'</span>, <span style="color:firebrick;">'30450'</span>, <span style="color:firebrick;">'63089'</span>, <span style="color:firebrick;">'81019'</span>, <span style="color:firebrick;">'68893'</span>, <span style="color:firebrick;">'24996'</span>, <span style="color:firebrick;">'51200'</span>, <span style="color:firebrick;">'51211'</span>, <span style="color:firebrick;">'45692'</span>, <span style="color:firebrick;">'92712'</span>, <span style="color:firebrick;">'70466'</span>, <span style="color:firebrick;">'79994'</span>, <span style="color:firebrick;">'22437'</span>, <span style="color:firebrick;">'25280'</span>, <span style="color:firebrick;">'38935'</span>, <span style="color:firebrick;">'71791'</span>, <span style="color:firebrick;">'73134'</span>, <span style="color:firebrick;">'56571'</span>, <span style="color:firebrick;">'14060'</span>, <span style="color:firebrick;">'19505'</span>, <span style="color:firebrick;">'72425'</span>, <span style="color:firebrick;">'56575'</span>, <span style="color:firebrick;">'74351'</span>, <span style="color:firebrick;">'68786'</span>, <span style="color:firebrick;">'51650'</span>, <span style="color:firebrick;">'20004'</span>, <span style="color:firebrick;">'18383'</span>, <span style="color:firebrick;">'76614'</span>, <span style="color:firebrick;">'11634'</span>, <span style="color:firebrick;">'18906'</span>, <span style="color:firebrick;">'15765'</span>, <span style="color:firebrick;">'41368'</span>, <span style="color:firebrick;">'73241'</span>, <span style="color:firebrick;">'76698'</span>, <span style="color:firebrick;">'78567'</span>, <span style="color:firebrick;">'97189'</span>, <span style="color:firebrick;">'28545'</span>, <span style="color:firebrick;">'76231'</span>, <span style="color:firebrick;">'75691'</span>, <span style="color:firebrick;">'22246'</span>, <span style="color:firebrick;">'51061'</span>, <span style="color:firebrick;">'90578'</span>, <span style="color:firebrick;">'56691'</span>, <span style="color:firebrick;">'68014'</span>, <span style="color:firebrick;">'51103'</span>, <span style="color:firebrick;">'94167'</span>, <span style="color:firebrick;">'57047'</span>, <span style="color:firebrick;">'14867'</span>, <span style="color:firebrick;">'73520'</span>, <span style="color:firebrick;">'15734'</span>, <span style="color:firebrick;">'63435'</span>, <span style="color:firebrick;">'25733'</span>, <span style="color:firebrick;">'35474'</span>, <span style="color:firebrick;">'24676'</span>, <span style="color:firebrick;">'94627'</span>, <span style="color:firebrick;">'53535'</span>, <span style="color:firebrick;">'17879'</span>, <span style="color:firebrick;">'15559'</span>, <span style="color:firebrick;">'53268'</span>, <span style="color:firebrick;">'59166'</span>, <span style="color:firebrick;">'11928'</span>, <span style="color:firebrick;">'59402'</span>, <span style="color:firebrick;">'33282'</span>, <span style="color:firebrick;">'45721'</span>, <span style="color:firebrick;">'43933'</span>, <span style="color:firebrick;">'68101'</span>, <span style="color:firebrick;">'33515'</span>, <span style="color:firebrick;">'36634'</span>, <span style="color:firebrick;">'71286'</span>, <span style="color:firebrick;">'19736'</span>, <span style="color:firebrick;">'58058'</span>, <span style="color:firebrick;">'55253'</span>, <span style="color:firebrick;">'67473'</span>, <span style="color:firebrick;">'41918'</span>, <span style="color:firebrick;">'19515'</span>, <span style="color:firebrick;">'36495'</span>, <span style="color:firebrick;">'19430'</span>, <span style="color:firebrick;">'22351'</span>, <span style="color:firebrick;">'77191'</span>, <span style="color:firebrick;">'91393'</span>, <span style="color:firebrick;">'49156'</span>, <span style="color:firebrick;">'50298'</span>, <span style="color:firebrick;">'87501'</span>, <span style="color:firebrick;">'18652'</span>, <span style="color:firebrick;">'53179'</span>, <span style="color:firebrick;">'18767'</span>, <span style="color:firebrick;">'63193'</span>, <span style="color:firebrick;">'23968'</span>, <span style="color:firebrick;">'65164'</span>, <span style="color:firebrick;">'68880'</span>, <span style="color:firebrick;">'21286'</span>, <span style="color:firebrick;">'72823'</span>, <span style="color:firebrick;">'58470'</span>, <span style="color:firebrick;">'67301'</span>, <span style="color:firebrick;">'13394'</span>, <span style="color:firebrick;">'31016'</span>, <span style="color:firebrick;">'70372'</span>, <span style="color:firebrick;">'67030'</span>, <span style="color:firebrick;">'40604'</span>, <span style="color:firebrick;">'24317'</span>, <span style="color:firebrick;">'45748'</span>, <span style="color:firebrick;">'39127'</span>, <span style="color:firebrick;">'26065'</span>, <span style="color:firebrick;">'77721'</span>, <span style="color:firebrick;">'31029'</span>, <span style="color:firebrick;">'31880'</span>, <span style="color:firebrick;">'60576'</span>, <span style="color:firebrick;">'24671'</span>, <span style="color:firebrick;">'45549'</span>, <span style="color:firebrick;">'13376'</span>, <span style="color:firebrick;">'50016'</span>, <span style="color:firebrick;">'33123'</span>, <span style="color:firebrick;">'19769'</span>, <span style="color:firebrick;">'22927'</span>, <span style="color:firebrick;">'97789'</span>, <span style="color:firebrick;">'46081'</span>, <span style="color:firebrick;">'72151'</span>, <span style="color:firebrick;">'15723'</span>, <span style="color:firebrick;">'46136'</span>, <span style="color:firebrick;">'51949'</span>, <span style="color:firebrick;">'68100'</span>, <span style="color:firebrick;">'96888'</span>, <span style="color:firebrick;">'64528'</span>, <span style="color:firebrick;">'14171'</span>, <span style="color:firebrick;">'79777'</span>, <span style="color:firebrick;">'28709'</span>, <span style="color:firebrick;">'11489'</span>, <span style="color:firebrick;">'25103'</span>, <span style="color:firebrick;">'32213'</span>, <span style="color:firebrick;">'78668'</span>, <span style="color:firebrick;">'22245'</span>, <span style="color:firebrick;">'15798'</span>, <span style="color:firebrick;">'27156'</span>, <span style="color:firebrick;">'37930'</span>, <span style="color:firebrick;">'62971'</span>, <span style="color:firebrick;">'21337'</span>, <span style="color:firebrick;">'51622'</span>, <span style="color:firebrick;">'67853'</span>, <span style="color:firebrick;">'10567'</span>, <span style="color:firebrick;">'38415'</span>, <span style="color:firebrick;">'15455'</span>, <span style="color:firebrick;">'58263'</span>, <span style="color:firebrick;">'42029'</span>, <span style="color:firebrick;">'60279'</span>, <span style="color:firebrick;">'37125'</span>, <span style="color:firebrick;">'56240'</span>, <span style="color:firebrick;">'88190'</span>, <span style="color:firebrick;">'50308'</span>, <span style="color:firebrick;">'26859'</span>, <span style="color:firebrick;">'64457'</span>, <span style="color:firebrick;">'89091'</span>, <span style="color:firebrick;">'82136'</span>, <span style="color:firebrick;">'62377'</span>, <span style="color:firebrick;">'36233'</span>, <span style="color:firebrick;">'63837'</span>, <span style="color:firebrick;">'58078'</span>, <span style="color:firebrick;">'17043'</span>, <span style="color:firebrick;">'30010'</span>, <span style="color:firebrick;">'60099'</span>, <span style="color:firebrick;">'28810'</span>, <span style="color:firebrick;">'98025'</span>, <span style="color:firebrick;">'29178'</span>, <span style="color:firebrick;">'87343'</span>, <span style="color:firebrick;">'73273'</span>, <span style="color:firebrick;">'30469'</span>, <span style="color:firebrick;">'64034'</span>, <span style="color:firebrick;">'39516'</span>, <span style="color:firebrick;">'86057'</span>, <span style="color:firebrick;">'21309'</span>, <span style="color:firebrick;">'90257'</span>, <span style="color:firebrick;">'67875'</span>, <span style="color:firebrick;">'40162'</span>, <span style="color:firebrick;">'11356'</span>, <span style="color:firebrick;">'73650'</span>, <span style="color:firebrick;">'61810'</span>, <span style="color:firebrick;">'72013'</span>, <span style="color:firebrick;">'30431'</span>, <span style="color:firebrick;">'22461'</span>, <span style="color:firebrick;">'19512'</span>, <span style="color:firebrick;">'13375'</span>, <span style="color:firebrick;">'55307'</span>, <span style="color:firebrick;">'30625'</span>, <span style="color:firebrick;">'83849'</span>, <span style="color:firebrick;">'68908'</span>, <span style="color:firebrick;">'26689'</span>, <span style="color:firebrick;">'96451'</span>, <span style="color:firebrick;">'38193'</span>, <span style="color:firebrick;">'46820'</span>, <span style="color:firebrick;">'88885'</span>, <span style="color:firebrick;">'84935'</span>, <span style="color:firebrick;">'69035'</span>, <span style="color:firebrick;">'83144'</span>, <span style="color:firebrick;">'47537'</span>, <span style="color:firebrick;">'56616'</span>, <span style="color:firebrick;">'94983'</span>, <span style="color:firebrick;">'48033'</span>, <span style="color:firebrick;">'69952'</span>, <span style="color:firebrick;">'25486'</span>, <span style="color:firebrick;">'61547'</span>, <span style="color:firebrick;">'27385'</span>, <span style="color:firebrick;">'61860'</span>, <span style="color:firebrick;">'58048'</span>, <span style="color:firebrick;">'56910'</span>, <span style="color:firebrick;">'16807'</span>, <span style="color:firebrick;">'17871'</span>, <span style="color:firebrick;">'35258'</span>, <span style="color:firebrick;">'31387'</span>, <span style="color:firebrick;">'35458'</span>, <span style="color:firebrick;">'35576'</span>)
            <span style="color:black;font-weight:bold;">INTERSECT</span>
            <span style="color:black;font-weight:bold;">SELECT</span>
                ca_zip
            <span style="color:black;font-weight:bold;">FROM</span> (
                <span style="color:black;font-weight:bold;">SELECT</span>
                    <span style="color:black;font-weight:bold;">SUBSTRING</span>(ca_zip, 1, 5) ca_zip,
                    <span style="color:black;font-weight:bold;">count</span>(*) cnt
                <span style="color:black;font-weight:bold;">FROM</span>
                    customer_address,
                    customer
                <span style="color:black;font-weight:bold;">WHERE</span>
                    ca_address_sk = c_current_addr_sk
                    <span style="color:black;font-weight:bold;">AND</span> c_preferred_cust_flag = <span style="color:firebrick;">'Y'</span>
                <span style="color:black;font-weight:bold;">GROUP</span> <span style="color:black;font-weight:bold;">BY</span>
                    ca_zip
                <span style="color:black;font-weight:bold;">HAVING</span>
                    <span style="color:black;font-weight:bold;">count</span>(*) > 10) A1) A2) V1
<span style="color:black;font-weight:bold;">WHERE</span>
    ss_store_sk = s_store_sk
    <span style="color:black;font-weight:bold;">AND</span> ss_sold_date_sk = d_date_sk
    <span style="color:black;font-weight:bold;">AND</span> d_qoy = 2
    <span style="color:black;font-weight:bold;">AND</span> d_year = 1998
    <span style="color:black;font-weight:bold;">AND</span> (<span style="color:black;font-weight:bold;">SUBSTRING</span>(s_zip, 1, 2) = <span style="color:black;font-weight:bold;">SUBSTRING</span>(V1.ca_zip, 1, 2))
<span style="color:black;font-weight:bold;">GROUP</span> <span style="color:black;font-weight:bold;">BY</span>
    s_store_name
<span style="color:black;font-weight:bold;">ORDER</span> <span style="color:black;font-weight:bold;">BY</span>
    s_store_name
<span style="color:black;font-weight:bold;">LIMIT</span> 100;

</pre>